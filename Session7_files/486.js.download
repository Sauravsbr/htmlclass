(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[486],{2117:function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});var r={editItem:1,newItem:2,displayItem:3};function i(e){switch(e){case r.editItem:return"Edit";case r.newItem:return"New";case r.displayItem:return"Display";default:return"Unknown"}}},2217:function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});var r,i;(function(e){e[e.fail=0]="fail";e[e.partialSuccess=1]="partialSuccess";e[e.success=2]="success"})(r||(r={}));(function(e){e[e.pending=0]="pending";e[e.success=1]="success"})(i||(i={}))},2221:function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});n.d(t,"n",function(){return u});n.d(t,"u",function(){return a});n.d(t,"r",function(){return f});n.d(t,"i",function(){return l});n.d(t,"o",function(){return h});n.d(t,"s",function(){return p});var r=n(18),i=n(2369),s="_ComplianceTag",o="_ComplianceFlags",u=200;function a(e){return!!(256&e)}function f(e){if(!e.HasRetentionAction)return" ";if(0===e.TagDuration)return e.BlockDelete?i.RetainForeverText:" ";var t=c(e.TagDuration);return e.BlockDelete?r.format(i.PreserveTagText,t):e.AutoDelete?r.format(i.DeleteTagText,t):" "}function l(e){if(e.Notes)return e.Notes;if(!e.HasRetentionAction)return i.NoRetentionTooltip;if(0===e.TagDuration)return e.BlockDelete?i.PreserveForeverTooltip:i.NoRetentionTooltip;var t=c(e.TagDuration),n="",s="";if(e.BlockDelete){n="PreserveTag"+e.TagRetentionBasedOn+"Tooltip";e.BlockEdit&&(s=i.PreserveIsRecordTooltipModifier);e.ReviewerEmail?s+=i.ReviewTooltip:s+=e.AutoDelete?i.PreserveAutoDeleteTooltipModifier:i.PreserveNoDeleteTooltipModifier}else e.AutoDelete&&(n="DeleteTag"+e.TagRetentionBasedOn+"Tooltip");var o=i[n];return o?r.format(o,t)+s:null}function c(e){var t="";if(e>0){var n=Math.floor(e/365);if(n>0){var s=n>1?i.RetentionPeriodYears:i.RetentionPeriodYear;t=r.format(s,n)}else{var o=Math.floor(e/30);if(o>0){var u=o>1?i.RetentionPeriodMonths:i.RetentionPeriodMonth;t=r.format(u,o)}else{var a=e>1?i.RetentionPeriodDays:i.RetentionPeriodDay;t=r.format(a,e)}}}return t}function h(e){return!!(e&&e.schema&&(t=e.schema.FieldType,n=e.schema.Id,t&&"boolean"===t.toLowerCase()&&n&&n.toLowerCase()==="96BE7325-AFA4-48CF-8503-9258F0A7817D".toLowerCase()));var t,n}function p(e){return!!(e&&e.schema&&(t=e.schema.FieldType,n=e.schema.Id,t&&"lookup"===t.toLowerCase()&&n&&n.toLowerCase()==="D4B6480A-4BED-4094-9A52-30181EA38F1D".toLowerCase()));var t,n}},2239:function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(327),i=n(354);function s(e,t){var n=Object(r.e)(e).id;t&&t.urlParts&&(n===t.urlParts.fullListUrl||n===t.urlParts.serverRelativeListUrl)&&(n=void 0);return n}function o(e,t){var n=e;0!==n.indexOf("id")&&(n=Object(i.e)({id:e,listurl:t}));return n}},2250:function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});var r,i;(function(e){e[e.remove=0]="remove";e[e.add=1]="add"})(r||(r={}));(function(e){e[e.attachment=0]="attachment";e[e.image=1]="image"})(i||(i={}))},2306:function(e,t,n){"use strict";var r=n(0),i=n(1134),s=n(19).e.isActivated("8a599b0b-8859-422a-aa10-ca6a49ce77eb","04/04/2022","Switch to newer sensitivity label api path"),o=(function(){function e(e,t){this._pageContext=t.pageContext;this._graphDataRequestor=t.graphDataRequestor||new i.e({},{});this._getOAuthToken=e.getOAuthToken;this._getOAuthToken2=t.getOAuthToken}e.prototype.getSensitivityLabels=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!this._getOAuthToken&&!this._getOAuthToken2)return[2,Promise.resolve([])];e="".concat(this._pageContext.msGraphEndpointUrl);return this._getOAuthToken?[4,this._getOAuthToken(["InformationProtection.Read.All"],e)]:[3,2];case 1:n=r.sent();return[3,4];case 2:return[4,this._getOAuthToken2(e)];case 3:n=r.sent();r.label=4;case 4:t=n;return[4,this._graphDataRequestor.send({endpoint:e,path:"".concat(e,s?"/beta/me/informationprotection/policy/labels":"/beta/me/security/informationProtection/sensitivityLabels"),apiName:"GraphDataProvider.getSensitivityLabels",accessToken:{accessToken:t},requestType:"GET",useAuthorizationHeaders:!0,parseResponse:function(e){return JSON.parse(e.responseText).value.filter(function(e){return!0===e.isActive}).sort(function(e,t){return e.sensitivity>t.sensitivity?1:-1})}})];case 5:return[2,r.sent()]}})})};e.prototype.getDocLibSensitivityLabels=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t,n,i,s=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!this._getOAuthToken&&!this._getOAuthToken2)return[2,Promise.resolve([])];e="".concat(this._pageContext.msGraphEndpointUrl);return this._getOAuthToken?[4,this._getOAuthToken(["InformationProtection.Read.All"],e)]:[3,2];case 1:n=r.sent();return[3,4];case 2:return[4,this._getOAuthToken2(e)];case 3:n=r.sent();r.label=4;case 4:t=n;if(!this._sensitivityLabels)return[3,5];i=this._sensitivityLabels;return[3,7];case 5:return[4,this._graphDataRequestor.send({endpoint:e,path:"".concat(e,"/beta/me/informationprotection/sensitivityLabels"),apiName:"GraphDataProvider.getSensitivityLabels",accessToken:{accessToken:t},requestType:"GET",useAuthorizationHeaders:!0,parseResponse:function(e){var t=JSON.parse(e.responseText).value;s._sensitivityLabels=t;return t}})];case 6:i=r.sent();r.label=7;case 7:return[2,i]}})})};e.prototype.setSensitivityLabel=function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var i,s,o,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:i={id:n,assignmentMethod:"standard",justificationText:"set document sensitivity label",actionSource:"auto"};if(!this._getOAuthToken&&!this._getOAuthToken2)return[2,Promise.resolve("")];s="".concat(this._pageContext.msGraphEndpointUrl);return this._getOAuthToken?[4,this._getOAuthToken(["InformationProtection.Read.All"],s)]:[3,2];case 1:u=r.sent();return[3,4];case 2:return[4,this._getOAuthToken2(s)];case 3:u=r.sent();r.label=4;case 4:o=u;return[4,this._graphDataRequestor.send({endpoint:s,path:"".concat(s,"/beta/drives/").concat(e,"/items/").concat(t,"/setSensitivityLabel"),apiName:"GraphDataProvider.setSensitivityLabel",postData:JSON.stringify(i),accessToken:{accessToken:o},requestType:"POST",useAuthorizationHeaders:!0,parseResponse:function(e){return null==e?void 0:e.responseText}})];case 5:return[2,r.sent()]}})})};return e})();t.e=o},2338:function(e,t,n){"use strict";var r=n(4209),i=n(2624),s={id:"none",key:"none",text:i.e,title:i.e},o=(function(){function e(){}e.processSensitivityLabelsForDropdownOption=function(e){var t={};e.forEach(function(e){var n,r,i=e.name,s=null===(n=null==e?void 0:e.parent)||void 0===n?void 0:n.name;if(s)if(t[s])null===(r=t[s])||void 0===r||r.push({name:i,id:e.id,isParent:!1,tooltip:e.tooltip});else{t[s]=[{name:s,id:"".concat(e.id,"isParent"),isParent:!0,tooltip:e.tooltip}];t[s].push({name:i,id:e.id,isParent:!1,tooltip:e.tooltip})}else t[i]=[{name:i,id:e.id,isParent:!1,tooltip:e.tooltip}]});var n=[];t&&Object.keys(t).length>0&&Object.keys(t).forEach(function(e){var i=t[e];if((null==i?void 0:i.length)>1){var s=i[0];i.forEach(function(e){var t=e.isParent?r.e.Header:r.e.Normal,i=e.isParent?e.name:"".concat(s.name," \\ ").concat(e.name);n.push({id:e.id,key:e.id,text:i,title:e.tooltip,data:{text:e.name,isParent:e.isParent},itemType:t})});n.push({key:"divider_2",text:"-",itemType:r.e.Divider})}else n.push({id:i[0].id,key:i[0].id,text:i[0].name,title:i[0].tooltip,data:{text:i[0].name}})});return n};e.processSensLabelsForDropdownOptionDocLib=function(e){var t=[];t.push(s);e.forEach(function(e){var n=e.displayName;if(0===e.sublabels.length){if(a(e.labelActions)){var r=u(e.id,e.id,n,e.toolTip);t.push(r)}}else e.sublabels.forEach(function(e){if(a(e.labelActions)){var r="".concat(n," \\ ").concat(e.displayName),i=u(e.id,e.id,r,e.toolTip);t.push(i)}})});return t};e.processLabelsForItem=function(e){var t=[];t.push(s);e.forEach(function(e){var n=e.displayName;if(0===e.sublabels.length){if(a(e.labelActions)){var r=u(e.id,e.id,n,e.tooltip);t.push(r)}}else e.sublabels.forEach(function(e){if(a(e.labelActions)){var r="".concat(n," \\ ").concat(e.displayName),i=u(e.id,e.id,r,e.tooltip);t.push(i)}})});return t};return e})();t.e=o;function u(e,t,n,r){return{id:e,key:t,text:n,title:r}}function a(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if("userDefinedRights"===e[t].encryptWith)return!1;return!0}},2339:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r="f9ebc8b2-a976-48f0-a8fa-0846164c0466"},2345:function(e,t,n){"use strict";n.d(t,"e",function(){return ce});var r,i,s,o=n(91),u=n(173),a=n(121),f=n(334);(function(e){e[e.Unknown=0]="Unknown";e[e.Legacy=1]="Legacy";e[e.Classic=2]="Classic";e[e.Modern=3]="Modern";e[e.PowerApp=4]="PowerApp";e[e.Customized=5]="Customized"})(r||(r={}));(function(e){e[e.ready=0]="ready";e[e.saving=1]="saving";e[e.updating=2]="updating"})(i||(i={}));(function(e){e[e.Dropdown=0]="Dropdown";e[e.Radio=1]="Radio"})(s||(s={}));var l=n(0),c=n(65),h=n(2174),p=n(1230),d=n(1761),v=n(530),m=n(2217),g=n(2117),y=n(373),b=n(905),w=n(398),E=n(670),S=n(94),x=n(2400),T=n(1266),N=n(910),C=n(2393),k=n(1268),L=n(10),A=(function(){function e(e){this._listContext=e.listContext;this._pageContext=e.pageContext;this._itemStore=e.itemStore}e.prototype.processData=function(e,t){Object(T.updateListContext)(t,this._listContext);Object(T.updateListContextGroupInfo)(this._listContext);var n=t.ListSchema&&"TRUE"===t.ListSchema.Collapse,r=this._processSchema(t.ListSchema),i=t.ListContenTypes,s=t.ListData||t,o=C.e.buildRootItem(e,t,this._listContext,this._itemStore),u=this._processItems(s,n,o);return{root:o,items:u.items,groups:u.groups,totalCount:u.totalCount,startIndex:this._getStartIndex(s),columns:r,contentTypes:i,nextRequestToken:this._getNextRequestToken(s),isAllGroupsCollapsed:n}};e.prototype._processSchema=function(e){if(e){var t={},n={hasFixedSchema:this._listContext.listTemplateType===L.n.mySiteDocumentLibrary};this._listContext.listSchema=Object(N.buildSchema)(e,this._listContext,n,t);Object.keys(t).length&&(this._listContext.groupSchema=t)}return this._listContext.listSchema};e.prototype._processItems=function(e,t,n){var r;(r=t?Object(k.e)(e.Row,this._listContext):C.e.buildItems(e,this._listContext,this._pageContext,n,this._itemStore)).groups&&r.groups.length>0&&(this._listContext.lastGroup=r.groups[r.groups.length-1]);return{items:r.items?r.items:[],groups:r.groups,totalCount:r.totalCount}};e.prototype._getStartIndex=function(e){var t=0;this._listContext.group?t=this._listContext.group.startIndex:e.FirstRow&&(t=e.FirstRow-1);return t};e.prototype._getNextRequestToken=function(e){var t="";e.NextHref&&(t=(t=e.NextHref).replace("&View=00000000-0000-0000-0000-000000000000",""));return t};return e})(),O=n(2348),M=n(2250),_=n(2377),D=n(2221),P=n(2384),H=n(109),B=n(52),j=n(87);function F(e,t){void 0===t&&(t=1);try{for(var n=e.fields.length,r=0;r<n;r++)if("TaxonomyFieldType"===e.fields[r].schema.FieldType||"TaxonomyFieldTypeMulti"===e.fields[r].schema.FieldType){var i=I(e.fields[r].serverData,e.fields[r].data);if(0===i.addedTagsCount&&0===i.deletedTagsCount)continue;var s=e.fields[r].schema.FieldType.toLowerCase();e.isBulkEdit||t>1?s+=".BulkEdit.":s+=".NotBulkEdit.";s+="OnChangingTags";for(var o=0;o<t;o++)H.e.logData({name:s,isIntentional:!0,extraData:{deletedTagsCount:i.deletedTagsCount,addedTagsCount:i.addedTagsCount}})}}catch(e){j.e.logError(e,{eventName:"OnChangingTags"});return}}function I(e,t){var n=q(e),r=q(t),i=0,s=Object.keys(n).length,o=Object.keys(r).length;if(s>0&&o>0)for(var u in n)r[u]&&i++;return{deletedTagsCount:s-i,addedTagsCount:o-i}}function q(e){if(!e)return{};for(var t={},n=0,r=e.split(";");n<r.length;n++){t[r[n]]=!0}delete t[""];return t}var R=n(19),U=n(1264),z=n(107),W=n(2371),X=n(904),V=n(2306),$=n(2338),J="0x0120",K={ODB:788,OneDrive:!0},Q={ODB:573,OneDrive:!0},G={ODB:1261},Y={ODB:1293},Z={ODB:60087,ODC:!1,OneDrive:!1,Fallback:!1},ee={ODB:60092,ODC:void 0,Fallback:!1},te=1,ne=2,re=4,ie=8,se=16,oe=R.t.isActivated("DC2F1582-A7C4-4DDA-AB48-39490F5EBB18","04/18/2022","fix event fields on update"),ue={ODB:60925},ae=R.t.isActivated("8aa8a122-dec2-44e9-b2a4-cf41f74ca447","06/14/2022","when contentType name and id are returned from the server, use the value directly instead of reading it from the cache"),fe=(function(e){Object(l.__extends)(t,e);function t(t,n){var r=e.call(this,{},n)||this;r._clientForms=null;r._init=function(e,t){var n=t.pageContext,i=t.apiUrlHelper,s=t.itemUrlHelper;r._itemUrlHelper=s||new y.e({},{pageContext:n});r._apiUrlHelper=i||new E.e({},{itemUrlHelper:r._itemUrlHelper,pageContext:n});e.complianceTagProvider?r._complianceTagProvider=e.complianceTagProvider:r._complianceTagProvider=new _.e({pageContext:n});e.fileUploaderProvider?r._fileUploaderProvider=e.fileUploaderProvider:r._fileUploaderProvider=new O.e({pageContext:n});r.isFeatureEnabled=e.isFeatureEnabled?e.isFeatureEnabled:function(e){return a.n.isFeatureEnabled(e,r._pageContext&&r._pageContext.ExpFeatures)};r.isFeatureEnabled(ue)&&r._pageContext.isLabelIRMEnabled&&(r._sensitivityLabelsDataSource=new V.e({},{pageContext:r._pageContext,getOAuthToken:null==t?void 0:t.getGraphAuthToken}))};r._getAdditionalPostData=function(e){e.isListDataRenderOptionChangeFeatureEnabled=r.isFeatureEnabled(K);e.isSpotlightFeatureEnabled=r.isFeatureEnabled(Q);return w.e(e)};r._init(t,n);return r}Object.defineProperty(t.prototype,"listContext",{set:function(e){this._listContext=e},enumerable:!1,configurable:!0});t.prototype.updateContext=function(e,t){this._init(e,t)};t.prototype.getClientFormSchema=function(e,t,n){var r,i=this,s=function(){var r=i._locateClientFormWithContentTypeInfos(e,t);if(n&&r&&r.fields){var s=r.fields.filter(function(e){return!i._isFieldRequireUniqueValue(e)});return Object(l.__assign)(Object(l.__assign)({},r),{fields:s})}return r};e===g.e.newItem&&t&&this._contentTypeIdToNameMap&&(r=this._contentTypeIdToNameMap[t[0].contentTypeId]);if(null===this._clientForms||this._listContext.refreshClientForm||!r){this._listContext.refreshClientForm=void 0;return this.fetchAllClientFormSchemas().then(function(){return s()})}return o.n.wrap(s())};t.prototype.getClientForm=function(e,t,n,r){var i=this;return new o.n(function(s,o){i.getData(function(){var t=c.e.encodeRestUriStringToken(i._listContext.listUrl),n=new B.t(window.location.href,{queryCaseInsensitive:!0}).getQueryParameter("VersionNo")||"0",r=",cutoffVersion=".concat(n),s=ne+re+ie+se;return"".concat(i._pageContext.webAbsoluteUrl,"/_api/web/GetList(@v1)")+"/RenderExtendedListFormData(itemId=".concat(e,",formId='editform',mode='2',options=").concat(s).concat(r,")")+"?@v1='".concat(t,"'")},function(e){if(null!=e){var t=JSON.parse(e);if(t.d.RenderExtendedListFormData){t=JSON.parse(t.d.RenderExtendedListFormData);n&&n.length>0&&!n[0].contentType&&t.ListData&&t.ListData.ContentType&&(n[0].contentType=t.ListData.ContentType);t.ListDataLite=t.ListData;t.ListData=t.Data;t.Data=void 0;return t}}return null},"GetItemDataForClientForm",function(){return""},"POST",i._getAdditionalHeaders()).then(function(e){var o;if(!r&&i.isFeatureEnabled(ue)&&i._pageContext.isLabelIRMEnabled)null===(o=i._sensitivityLabelsDataSource)||void 0===o||o.getDocLibSensitivityLabels().then(function(o){i._sensitivityLabelOptions=$.e.processLabelsForItem(o);var u=i._processGetClientFormServerData(e,t,n,r);s(u)}).catch(function(e){});else{var u=i._processGetClientFormServerData(e,t,n,r);s(u)}},function(e){var t=e.code?e.code.split(","):e.error.code.split(","),n=t.length>1?Number(t[0]):-1;o({errorCode:n,message:e&&e.message?e.message.value?e.message.value:e.message:""})})})};t.prototype.updatePanelViewInfo=function(e){var t=this;return new o.n(function(n,r){t.getData(function(){var n=c.e.encodeRestUriStringToken(t._listContext.listUrl);return"".concat(t._pageContext.webAbsoluteUrl,"/_api/web/GetList(@v1)")+"/contentTypes('".concat(e.contentTypeId,"')")+"/ReorderFields()"+"?@v1='".concat(n,"'")},function(){return null},"CustomPanelSaveDataToServer",function(){return JSON.stringify({fieldNames:e.data})}).then(function(){n(e.serverResponse({message:{value:"updated Information"}}))},function(t){r(e.serverResponse(t))})})};t.prototype.saveCustomShowHideRules=function(e,t,n){var r=this,i={__metadata:{type:"SP.Field"},ClientValidationFormula:e.rules,ClientValidationMessage:e.errMsg};return this.getData(function(){return r._getListApiUrl(t).segment("Fields").method("GetByInternalNameOrTitle",n).toString()},function(e){return e},"saveCustomValidationRules",function(){return JSON.stringify(i)},"MERGE")};t.prototype._isFieldRequireUniqueValue=function(e){var t=e.FieldType.toLowerCase(),n=e.Name;return"file"===t||"attachments"===t||"Title"===n||"LinkTitle"===n||"LinkTitleNoMenu"===n||"thumbnail"===t};t.prototype._getListApiUrl=function(e){var t=this._itemUrlHelper.getUrlParts({path:e||this._pageContext.listUrl,listUrl:e||this._pageContext.listUrl});return this._apiUrlHelper.build().webByItemUrl(t).method("GetList",t.serverRelativeListUrl)};t.prototype.saveClientFormCustomFormatter=function(e,t){var n=this,r={__metadata:{type:"SP.ContentType"},ClientFormCustomFormatter:JSON.stringify(e.ClientFormCustomFormatterJson)};return this.getData(function(){return n._getListApiUrl(t).segment("contentTypes('"+e.ContentTypeId+"')").toString()},function(e){return e},"saveCustomFormFormatterJSON",function(){return JSON.stringify(r)},"MERGE")};t.prototype.getClientFormCustomFormatter=function(e,t){var n=this;return this.getData(function(){return n._getListApiUrl(t).segment("contentTypes('"+e+"')").toString()},function(e){return e},"GetCustomFormatter",null,"GET")};t.prototype.getResourceProviders=function(){return{ComplianceTagProvider:this._complianceTagProvider,FileUploaderProvider:this._fileUploaderProvider}};t.prototype._processGetClientFormServerData=function(e,t,n,r){var s=this,o=new A({listContext:this._listContext,pageContext:this._pageContext}).processData("parent",e),u=o&&o.items&&o.items[0];this._clientForms={};var a=e.ListSchema,f=e.ItemContentTypeId,c=e.ItemContentTypeName,h=e.ClientFormCustomFormatter;h&&(this._ctIdToClientFormCustomFormatter=h);if(a){a.New&&this._processClientFormResponse(g.e.newItem,a.New,f,c);if(a.Edit){this._processClientFormResponse(g.e.editItem,a.Edit,f,c);this._processClientFormResponse(g.e.displayItem,a.Edit,f,c)}}var p=this._locateClientFormWithContentTypeInfos(t,n);if(r&&p&&p.fields){var d=p.fields.filter(function(e){return!s._isFieldRequireUniqueValue(e)});p=Object(l.__assign)(Object(l.__assign)({},p),{fields:d})}var v={item:u,formType:p.formType,contentType:p.contentType,contentTypeId:p.contentTypeId,fields:[],isBulkEdit:r,clientFormCustomFormatter:p.clientFormCustomFormatter};this._generateFieldsFromSchema(v,p);for(var m=[],y=0,b=v.fields;y<b.length;y++){if((S=b[y]).state===i.ready){S.state=i.updating;m.push(S)}}t!==g.e.newItem&&this._handleServerData(v,e,{},m);for(var w=0,E=m;w<E.length;w++){var S;(S=E[w]).state=i.ready}return v};t.prototype._generateFieldsFromSchema=function(e,t){for(var n=this._listContext&&(this._listContext.enableAttachments||void 0===this._listContext.enableAttachments),r=0,i=t.fields.length;r<i;r++){var s=t.fields[r];("Attachments"!==s.Type||n)&&!(e.isBulkEdit&&s.ReadOnlyField)&&e.fields.push(this._generateField(e,s))}if(!e.isBulkEdit&&this.isFeatureEnabled(ue)&&this._pageContext.isLabelIRMEnabled&&this._sensitivityLabelOptions){var o=this._generateSensitivityLabelField(this._sensitivityLabelOptions);e.fields.push(this._generateField(e,o))}};t.prototype._generateField=function(e,t){return{hasException:!1,errorMessage:"",schema:t,state:i.ready}};t.prototype._generateSensitivityLabelField=function(e){return{Id:"sensitivitylabel",Name:"Sensitivity Label",Type:"SensitivityLabel",Hidden:!1,InternalName:"sensitivitylabel",Title:"Sensitivity Label",SensitivityLabels:e,FieldType:"sensitivitylabel"}};t.prototype.updateFormValues=function(e,t){var n=this,r=e.item;if(!r||!r.properties||!r.properties.ID)return o.n.wrap();for(var s=[],u=0,a=e.fields;u<a.length;u++){var f=a[u];if(f.state===i.ready){f.state=i.updating;s.push(f)}}return this.getData(function(){var e=r.properties.ID,t=c.e.encodeRestUriStringToken(n._listContext.listUrl),i=te+ne+re+ie,s=new B.t(window.location.href,{queryCaseInsensitive:!0}).getQueryParameter("VersionNo")||"0",o=",cutoffVersion=".concat(s);return"".concat(n._pageContext.webAbsoluteUrl,"/_api/web/GetList(@v1)")+"/RenderExtendedListFormData(itemId=".concat(e,",formId='editform',mode='2',options=").concat(i).concat(o,")")+"?@v1='".concat(t,"'")},function(e){if(null!=e){var t=JSON.parse(e);if(t.d.RenderExtendedListFormData)return t=JSON.parse(t.d.RenderExtendedListFormData)}return null},"GetItemDataForClientForm",function(){return""},"POST",this._getAdditionalHeaders(),"",0,!0).then(function(r){n._handleServerData(e,r,t,s);for(var o=0,u=s;o<u.length;o++){u[o].state=i.ready}},function(e){for(var t=e.code?e.code.split(","):e.error.code.split(","),n=t.length>1?Number(t[0]):-1,r=0,u=s;r<u.length;r++){u[r].state=i.ready}return o.n.wrapError({errorCode:n,message:e&&e.message?e.message.value?e.message.value:e.message:""})})};t.prototype.createItem=function(e){var t=this,n=this._getUrlInfo(),r=n.listUrl,i=n.itemUrlParts,s="AddValidateUpdateItemUsingPath",u=function(){return t._apiUrlHelper.build().webByItemUrl(i).method("GetList",r).method(s).toString()},a=!!e.clientForm.contentTypeId&&0===e.clientForm.contentTypeId.lastIndexOf(J,0),f=function(t){var n=e.rootFolder||r;return JSON.stringify({listItemCreateInfo:{__metadata:{type:"SP.ListItemCreationInformationUsingPath"},FolderPath:{__metadata:{type:"SP.ResourcePath"},DecodedUrl:n},UnderlyingObjectType:a?"1":void 0},formValues:t,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment})};return this._ensureClientForms().then(function(){return t._fileUploaderProvider&&t._fileUploaderProvider.imageOperationsPool.length>0?t._updateImages(!0).then(function(n){var r=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()});t._fileUploaderProvider.imageOperationsPool=[];if(t.handleFileUploaderErrors(n,null,r)){n&&n.length>0&&n.forEach(function(t){if(t&&t.image){var n=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()&&e.schema.Name===t.image.fieldName})[0];if(n){var r=Object(X.e)(n.data);if(r){r.serverRelativeUrl=t.image.serverRelativeUrl;r.id=t.image.id;r.serverUrl=t.image.serverUrl}try{n.data=JSON.stringify(r)}catch(e){n.data=""}}}});return t._doCreateItem(u,f,e,s)}return o.n.wrap({status:m.e.fail})}):t._doCreateItem(u,f,e,s)})};t.prototype._doCreateItem=function(e,t,n,r){var i=this;return this._createOrUpdateItem("CreateItem",e,t,n,r).then(function(e){return i._postUpdateFields("CreateItem",n,[]).then(function(t){if(e.status===m.e.success&&t.status===m.e.fail){t.status=m.e.partialSuccess;return t}return e})})};t.prototype.updateItem=function(e){var t=this,n=e.clientForm.isBulkEdit&&e.itemdIds&&e.itemdIds.length>1?e.itemdIds:void 0,r=n&&n.length>1,i=function(e){var n=t._getUrlInfo(),i=n.listUrl,s=n.itemUrlParts;return r?t._apiUrlHelper.build().webByItemUrl(s).method("GetList",i).method("BulkValidateUpdateListItems").toString():t._apiUrlHelper.build().webByItemUrl(s).method("GetList",i).method("items",e.properties.ID).method("ValidateUpdateListItem").toString()},s=function(i){var s;r&&(s=t._listContext.folderPath);return JSON.stringify({itemIds:n,formValues:i,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment,folderPath:s})};return this._ensureClientForms().then(function(){return t._fileUploaderProvider&&t._fileUploaderProvider.imageOperationsPool.length>0?t._updateImages(!1).then(function(u){var a=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()});t._fileUploaderProvider.imageOperationsPool=[];if(t.handleFileUploaderErrors(u,null,a)){u&&u.length>0&&u.forEach(function(t){if(t&&t.image){var n=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()&&e.schema.Name===t.image.fieldName})[0];if(n&&n.data!==n.serverData){var r=Object(X.e)(n.data);if(r){r.serverRelativeUrl=t.image.serverRelativeUrl;r.id=t.image.id;r.serverUrl=t.image.serverUrl}n.data=r?JSON.stringify(r):""}}});return t._doUpdateItem(i,s,e,r,n)}return o.n.wrap({status:m.e.fail})}):t._doUpdateItem(i,s,e,r,n)})};t.prototype._doUpdateItem=function(e,t,n,r,i){var s=this;return this._createOrUpdateItem("UpdateItem",e,t,n,r?"BulkValidateUpdateListItems":"ValidateUpdateListItem",i).then(function(e){return s._postUpdateFields("UpdateItem",n,i).then(function(t){if(e.status===m.e.success&&t.status===m.e.fail){t.status=m.e.partialSuccess;return t}return e})})};t.prototype.fetchAllClientFormSchemas=function(){var e=this;this._clientFormsDebouncer||(this._clientFormsDebouncer=new h.e);this._clientFormsDebouncer.isExecuting()||(this._clientFormsPromise=this._clientFormsDebouncer.debounce(this.getData(function(){return e._getServerConnectionUrl().toString()},function(t){e._clientForms={};var n=JSON.parse(t);n.ContentTypeIdToNameMap&&(e._contentTypeIdToNameMap=n.ContentTypeIdToNameMap);n.ClientFormCustomFormatter&&(e._ctIdToClientFormCustomFormatter=n.ClientFormCustomFormatter);var r=n.ClientForms;if(r){r.New&&e._processClientFormResponse(g.e.newItem,r.New);if(r.Edit){e._processClientFormResponse(g.e.editItem,r.Edit);e._processClientFormResponse(g.e.displayItem,r.Edit)}}n.Navigation&&(e._listContext.leftNavigationData={quickLaunchNodes:n.Navigation.Nodes});e._listContext.enableAttachments="true"===n.EnableAttachments;n.FormRenderModes&&e._processFormRenderMode(n.FormRenderModes);(n.PowerAppFormId||n.AppId)&&(e._powerAppFormId=n.PowerAppFormId||n.AppId);n.AppRenderInfo&&(e._powerAppFormInfo=n.AppRenderInfo||{});n.AppAdditionalData&&(e._powerAppAdditionalData=n.AppAdditionalData);n.CachedFileUrlTemplate&&n.CacheAppFiles&&(e._powerAppFormCacheInfo=JSON.stringify({appFiles:n.CacheAppFiles,cachedFileUrlTemplate:n.CachedFileUrlTemplate}))},"GetClientForms",function(){return e._getAdditionalPostData({needsSchema:!1,viewXml:'<View><ViewFields><FieldRef Name="ID"/></ViewFields></View>',needsForms:!0,needsQuickLaunch:!1})},"POST",this._getAdditionalHeaders())));return this._clientFormsPromise};t.prototype.getFieldFilterData=function(e,t,n){return new x.e({parentKey:void 0,listContext:this._listContext,pageContext:this._pageContext,folderPath:n,itemUrlHelper:this._itemUrlHelper,apiUrlHelper:this._apiUrlHelper}).getFilterData(e,"",t,void 0)};t.prototype.getContentTypes=function(e){var t=[];if(this._clientForms&&this._clientForms[e])for(var n in this._clientForms[e])this._clientForms[e].hasOwnProperty(n)&&t.push({displayName:n,description:n,templateUrl:null});return t};t.prototype.hasFormRenderMode=function(e){var t=this;return this._ensureClientForms(function(){return t._checkRenderModes(e)})};t.prototype.getFormRenderMode=function(e,t){var n=this;return this._ensureClientForms(function(){return n._getFormRenderMode(e,t)})};t.prototype.getPowerAppFormId=function(){return this._powerAppFormId};t.prototype.getPowerAppRenderInfo=function(){return this._powerAppFormInfo};t.prototype.getPowerAppAdditionalData=function(){return this._powerAppAdditionalData};t.prototype.getPowerAppFormCacheInfo=function(){return this._powerAppFormCacheInfo};t.prototype.getPowerAppFormDesignUrl=function(e){var t=this;return this.getData(function(){return"".concat(t._pageContext.webAbsoluteUrl,"/_api/SP.Internal.FormsCustomization.GetPowerAppsFormDesignUrl?listName='")+e+"'&visualizationTarget="+P.e.browser},function(e){var t=JSON.parse(e),n="";t.d&&t.d.Value&&(n=JSON.parse(t.d.Value));return n},"GetPowerAppFormDesignUrl",null,"GET")};t.prototype._getServerConnectionUrl=function(e){var t=this._itemUrlHelper.getUrlParts({listUrl:this._listContext.listUrl});return b.t({webUrl:this._pageContext.webAbsoluteUrl,listId:this._listContext.listId,urlParts:t,rootFolder:this._listContext.folderPath,requestToken:"?"})};t.prototype._processClientFormResponse=function(e,t,n,i){this._clientForms[e]||(this._clientForms[e]={});var s=this._clientForms[e];for(var o in t)if(t.hasOwnProperty(o)&&!s[o]){var u=void 0;u=ae||o!==i?this._reverseLookupContentTypeIdByName(o):n;var a=this._ctIdToClientFormCustomFormatter?this._ctIdToClientFormCustomFormatter[u]:void 0;s[o]={contentType:o,contentTypeId:u,formType:e,fields:[],clientFormCustomFormatter:a?JSON.parse(a):void 0,mode:r.Unknown};for(var f=s[o],l=t[o],c=0,h=l.length;c<h;c++)f.fields.push(l[c])}this._clientForms[e]=s};t.prototype._reverseLookupContentTypeIdByName=function(e){for(var t in this._contentTypeIdToNameMap)if(e===this._contentTypeIdToNameMap[t])return t;return null};t.prototype._processFormRenderMode=function(e){if(e)for(var t in e)for(var n in e[t]){var i=g.e.newItem;switch(n){case"Edit":i=g.e.editItem;break;case"Display":i=g.e.displayItem}var s=r.Unknown;switch(e[t][n].RenderType){case 1:s=r.Classic;break;case 2:s=r.Modern;break;case 3:s=r.PowerApp;break;case 4:s=r.Customized;break;default:p.e.logData({name:"ClientFormDataSource.InvalidFormRenderMode",message:"Server returned RenderType="+e[t][n].RenderType})}this._clientForms[i][t].mode=s}};t.prototype._locateClientFormWithContentTypeInfos=function(e,t){if(!t||!t.length)return this._locateClientForm(e,void 0,void 0);var n=t[0],r=this._locateClientForm(e,n.contentType,n.contentTypeId);if(1===t.length||!r||!r.fields)return r;for(var i=r.fields.slice(),s=function(n){if(0===i.length)return"break";var r=t[n],s=o._locateClientForm(e,r.contentType,r.contentTypeId);i=i.filter(function(e){for(var t=0,n=s.fields;t<n.length;t++){if(n[t].Name===e.Name)return!0}return!1})},o=this,u=1;u<t.length;u++){if("break"===s(u))break}return Object(l.__assign)(Object(l.__assign)({},r),{fields:i})};t.prototype._locateClientForm=function(e,t,n){!t&&n&&this._contentTypeIdToNameMap&&(t=this._contentTypeIdToNameMap[n]);if(!t&&this._clientForms[e])for(var i in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(i)){t=i;break}if(n&&0===n.lastIndexOf(J,0)&&this._clientForms[e]&&!this._clientForms[e][t]){var s={FileLeafRef:1,Title:1,URL:1};for(var i in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(i)){var o=this._clientForms[e][i].fields.filter(function(e){return!!s[e.Name]})[0];if(o){this._clientForms[e].Folder={contentType:"Folder",contentTypeId:n,formType:e,fields:[o],mode:r.Unknown};return this._clientForms[e].Folder}}}if(!this._clientForms[e]||!this._clientForms[e][t]){if("folder"===t.toLowerCase()&&!n)for(var i in this._clientForms[e])if(this._clientForms[e][i]&&!this._clientForms[e][i].contentTypeId)return this._clientForms[e][i];return null}return this._clientForms[e][t]};t.prototype._getAdditionalHeaders=function(e){var t=b.r(this._listContext);if(this.isFeatureEnabled(ee)&&t&&e)if(e===g.e.newItem){t.Scenario="CreateListItem";t.ScenarioType="AUO"}else if(e===g.e.editItem){t.Scenario="EditListItem";t.ScenarioType="AUO"}return t};t.prototype._handleServerData=function(e,t,n,r){var i=t.ListDataLite?t.ListDataLite:t.ListData,s=t.ListDataLite?t.ListData.Row[0]:t.Data.Row[0],o=e.item;this._ctIdToClientFormCustomFormatter=t.ClientFormCustomFormatter;this.isFeatureEnabled(ue)&&this._pageContext.isLabelIRMEnabled&&(e.sensitivityLabel=t.ListData.Row&&t.ListData.Row[0]&&t.ListData.Row[0]._DisplayName);for(var u=0,a=r.length;u<a;u++){var f=r[u],l=f.schema;if(!n||!n.hasOwnProperty(l.Name)){void 0===f.data&&(f.data=null);void 0===f.serverData&&(f.serverData=null);if(i.hasOwnProperty(l.Name)){l.FieldType&&"boolean"===l.FieldType.toLowerCase()&&""===s[l.Name]&&"0"===i[l.Name]?f.serverData="":l.FieldType&&"thumbnail"===l.FieldType.toLowerCase()&&s[l.Name]?f.serverData=s[l.Name]:f.serverData=i[l.Name];o.hasOwnProperty(l.Name)||o.properties.hasOwnProperty(l.Name)||(o.properties[l.Name]=s[l.Name]);if(this.isFeatureEnabled(Z)){o.properties.hasOwnProperty("ItemExpirationDate")||(o.properties.ItemExpirationDate=s._ExpirationDate);if(!o.properties.hasOwnProperty("IsItemExpirationModifiable")){var c=s.MetaInfo,h=c&&c[0]&&c[0].lookupValue||"",p=new RegExp(/vti_stream_isexpirationmodifiable:([a-zA-Z]{2})\|false/gi).test(h);o.properties.IsItemExpirationModifiable=!p}}}else if(D.s(f)){f.serverData=s[D.t];o.hasOwnProperty(l.Name)||o.properties.hasOwnProperty(l.Name)||(o.properties[l.Name]=s[l.Name])}else o.folder&&f.schema.FieldType&&"file"===f.schema.FieldType.toLowerCase()&&f.schema.Title&&"name"===f.schema.Title.toLowerCase()&&i.Title?f.serverData=i.Title:l.FieldType&&"sensitivitylabel"===l.FieldType?f.serverData=e.sensitivityLabel:f.serverData=null;e.isBulkEdit&&(f.serverData=null);if(f.schema.AppendOnly){f.appendOnlyData=t[f.schema.Name];f.data=""}else f.data=f.serverData}}o.hasClientFormData=!0};t.prototype._createOrUpdateItem=function(e,t,n,r,s,u){var a=this,f=r.clientForm.fields,l=[],c=[],h={},p=[],d=!1,v=!1;r.clientForm.formType===g.e.editItem&&r.clientForm.item&&!r.clientForm.isBulkEdit&&this._listContext&&!this._listContext.isDocLib&&r.clientForm.item.properties&&"1"===r.clientForm.item.properties.FSObjType&&(v=!0);this.isFeatureEnabled(Y)&&(u?F(r.clientForm,u.length):F(r.clientForm));for(var y=void 0,b=!1,w=0,E=f;w<E.length;w++){var x=E[w];if(null!==x.data&&void 0!==x.data){var T=x.data;if("thumbnail"===x.schema.FieldType.toLowerCase()&&"string"!=typeof T)try{T=JSON.stringify(T)}catch(e){}if(!this._isClientFormFieldUpdated(r,T,x.serverData,x)||"attachments"===x.schema.FieldType.toLowerCase()||"sensitivitylabel"===x.schema.FieldType||D.s(x)||D.o(x)){h[x.schema.Name]=!0;oe||y||!this._isEventField(x)||(y=x)}else{l.push(x);var N=x.schema.Name;if("ContentType"===N){T=this._reverseLookupContentTypeIdByName(T.displayName);N="ContentTypeId";d=!0}c.push({FieldName:N,FieldValue:T,HasException:!1,ErrorMessage:null});oe||b||!this._isEventField(x)||(b=!0);"Title"===N&&v&&c.push({FieldName:"FileLeafRef",FieldValue:T,HasException:!1,ErrorMessage:null});var C=x.schema.FieldType.toLowerCase();H.e.logData({name:"ClientFormUpdate",extraData:{FieldType:C,Host:Object(U.e)()}})}}}!oe&&b&&y&&c.push({FieldName:y.schema.Name,FieldValue:y.data,HasException:!1,ErrorMessage:null});if(d){4096==(4096&this._listContext.flags2)&&c.push({FieldName:"PrimeCorrectedByUser",FieldValue:"true",HasException:!1,ErrorMessage:null})}else r.clientForm.formType===g.e.newItem?c.push({FieldName:"ContentType",FieldValue:r.clientForm.contentType,HasException:!1,ErrorMessage:null}):r.clientForm.formType===g.e.editItem&&r.clientForm.item&&r.clientForm.item.properties&&!r.clientForm.isBulkEdit&&c.push({FieldName:"ContentTypeId",FieldValue:r.clientForm.item.properties.ContentTypeId,HasException:!1,ErrorMessage:null});if(0===l.length&&0===p.length)return o.n.wrap({status:m.e.success});p.push(this._getUpdateItemPromise(e,t,n,r,s,l,c,r.clientForm.item,u));return o.n.all(p).then(function(e){for(var t={status:m.e.success},n=0,r=e;n<r.length;n++){var i=r[n];if(i&&i.hasOwnProperty("status")){t.status=i.status;i.failedItemIds&&(t.failedItemIds=i.failedItemIds)}break}return t},function(e){var t,n;if((e=Array.isArray(e)?e:[e])&&e[0]&&e[0].code){var s=e[0].code.split(", ");if(s&&2===s.length){t=s[0];n=s[1]}}for(var o="-2146232832"===t&&"Microsoft.SharePoint.SPFieldValidationException"===n,u=0;u<l.length;u++){var f=l[u];f.hasException=0===u||o;f.state=i.ready}var c=Object(S.s)(a._pageContext)+r.clientForm.item.properties.FileRef;throw e=e.filter(function(e){return e&&e.message&&e.message.value}).map(function(e){e.message.value=e.message.value.replace('"'.concat(c,'" '),"");return e})})};t.prototype._isEventField=function(e){var t,n,r=null===(n=null===(t=e.schema)||void 0===t?void 0:t.Id)||void 0===n?void 0:n.toLowerCase();return"64cd368d-2f95-4bfc-a1f9-8d4324ecb007"===r||"2684f9f2-54be-429f-ba06-76754fc056bf"===r};t.prototype._getUpdateItemPromise=function(e,t,n,r,s,u,a,f,l){var c=this;return a&&0!==a.length&&u&&0!==u.length?this.getData(t.bind(null,f),function(e){var t=JSON.parse(e);if(!t.d||!t.d[s]||!t.d[s].results){for(var n=0,a=u;n<a.length;n++){(O=a[n]).state=i.ready}return o.n.wrapError("The server response couldn't be processed")}for(var h=null,p={},d="",v=0,y=t.d[s].results;v<y.length;v++){var b=y[v];if(r.clientForm.formType===g.e.newItem&&"Id"===b.FieldName){var w=f;w.properties||(w.properties={});w.properties.ID=b.FieldValue}if(!0===b.HasException||null!==b.ErrorMessage){var E=b.FieldName;p[E]||(p[E]=[]);void 0!==b.ItemId&&p[E].indexOf(b.ItemId)<0&&p[E].push(b.ItemId);if(!h){h={};for(var S=0,x=r.clientForm.fields;S<x.length;S++){var T=x[S];h[T.schema.Name]=T}}if(h[E]){h[E].errorMessage=b.ErrorMessage;h[E].hasException=!0;var N=h[E].schema.Title;d=d?d+", "+N:N}}}var C={status:d?m.e.fail:m.e.success};if(l&&l.length&&p.null){var k=p.null;k.length<l.length?C.status=m.e.partialSuccess:C.status=m.e.fail;C.failedItemIds=k}for(var L=0,A=u;L<A.length;L++){var O=A[L];if(d){if(!p[O.schema.Name]&&r.isInteractiveSave){O.errorMessage="Cannot save due to errors in other fields: "+d;O.hasException=!0}}else{O.errorMessage="";O.hasException=!1}O.state=i.ready}c._raiseCreateOrUpdateEvents(r,C);return C},e,function(){return n(a)},"POST",this._getAdditionalHeaders(r.clientForm.formType),void 0,5):o.n.wrap()};t.prototype._getUrlInfo=function(){var e=this._itemUrlHelper.getUrlParts({listUrl:this._listContext.listUrl});return{listUrl:e&&e.serverRelativeListUrl?e.serverRelativeListUrl:this._listContext.listUrl,itemUrlParts:e}};t.prototype._isClientFormFieldUpdated=function(e,t,n,r){return(!e.clientForm.isBulkEdit||""!==t||null!==n)&&(!(r.schema.AppendOnly&&!t&&!Object(L.i)(this._pageContext.listBaseTemplate))&&!d.e(t,n))};t.prototype._postUpdateFields=function(e,t,n){var r=this,i=t.clientForm.item;if(!this.isValidItem(i))return o.n.wrap({status:m.e.fail});for(var s=this._itemUrlHelper.getItemUrlParts(i.key).serverRelativeListUrl,u=n&&n.length>1,a=[],f=null,l=null,c=0;c<t.clientForm.fields.length;c++){var h=t.clientForm.fields[c];if(D.s(h)){if(!u&&h.data===h.serverData)continue;if(u){var p=this._updateMultipleComplianceTagsPromises(n,h,s);if(p)for(var d=0,v=p;d<v.length;d++){var g=v[d];a.push(g)}}else a.push(this._updateComplianceTagField(h,i));H.e.logData({name:"ClientFormUpdate."+h.schema.FieldType.toLowerCase()})}else if(D.o(h)){if(!this.isFeatureEnabled(G)||h.data===h.serverData)continue;var y=D.u(i.properties[D.e]);if(y===("1"===h.data)||u)continue;a.push(this._updateUnlockRecordField(i,h,s,y));H.e.logData({name:"ClientFormUpdate."+h.schema.FieldType.toLowerCase()})}else"attachments"===h.schema.FieldType.toLowerCase()?f=h:"sensitivitylabel"===h.schema.InternalName&&(l=h)}if(this.isFeatureEnabled(ue)&&this._pageContext.isLabelIRMEnabled){var b=t.graph,w=null==b?void 0:b.driveId,E=null==b?void 0:b.itemId;w&&E&&l&&a.push(o.n.resolve(this._sensitivityLabelsDataSource.setSensitivityLabel(w,E,l.data).then(function(e){t.clientForm.sensitivityLabel=r._getCurrentSensitivityLabelTitle(r._sensitivityLabelOptions,l.data);return{status:m.e.success}},function(e){l.errorMessage=e.message;return{status:m.e.fail}})))}n&&0!==n.length||a.push(this._updateAttachmentsField(f,i,e));return o.n.all(a).then(function(e){for(var t,n={status:m.e.success},r=0,i=e;r<i.length;r++){var s=i[r];s&&s.status===m.e.fail&&(n.status=s.status);s&&s.failedItemIds&&s.failedItemIds.length>0&&(t=n.failedItemIds).push.apply(t,s.failedItemIds)}return n})};t.prototype._getCurrentSensitivityLabelTitle=function(e,t){for(var n=0;n<e.length;n++)if(e[n].id===t)return e[n].text;return""};t.prototype._updateComplianceTagField=function(e,t){var n,r=e.schema;r.ComplianceTags&&(n=r.ComplianceTags.filter(function(t){return t&&t.tagValue===e.data})[0]);if(n){e.state=i.saving;return this._complianceTagProvider.updateComplianceTag(t,n).then(function(){e.state=i.ready;return{status:m.e.success}},function(t){if(t&&e){e.errorMessage=t.message&&t.message.value?t.message.value:t;e.hasException=!0}e.state=i.ready;return{status:m.e.fail}})}return o.n.wrap(null)};t.prototype._updateMultipleComplianceTagsPromises=function(e,t,n){var r,s=t.schema,o=[];s.ComplianceTags&&(r=s.ComplianceTags.filter(function(e){return e&&e.tagValue===t.data})[0]);if(!r)return o;t.state=i.saving;for(var u=[],a=0,f=0,l=e.length;f<l;f++){u.push(e[f]);if(++a===D.n||f===e.length-1){o.push(this._complianceTagProvider.updateComplianceTagInBatch(u,r,n).then(function(e){t.state=i.ready;return e&&e.length>0?{status:m.e.fail,failedItemIds:e}:{status:m.e.success}},function(e){if(e&&t){t.errorMessage=e.message&&e.message.value?e.message.value:e;t.hasException=!0}t.state=i.ready;return{status:m.e.fail,failedItemIds:u}}));u=[];a=0}}return o};t.prototype._updateUnlockRecordField=function(e,t,n,r){var s="1"===t.data;t.state=i.saving;return s?this._complianceTagProvider.unlockRecord(e,n).then(function(e){t.serverData=e?"1":"0";t.state=i.ready;return{status:m.e.success}},function(e){if(e&&t){t.serverData=r?"1":"0";t.data="0";t.errorMessage=e.message&&e.message.value?e.message.value:e;t.hasException=!0}t.state=i.ready;return{status:m.e.fail}}):this._complianceTagProvider.lockRecord(e,n).then(function(e){t.serverData=e?"1":"0";t.state=i.ready;return{status:m.e.success}},function(e){if(e&&t){t.serverData=r?"1":"0";t.data="1";t.errorMessage=e.message&&e.message.value?e.message.value:e;t.hasException=!0}t.state=i.ready;return{status:m.e.fail}})};t.prototype._updateAttachmentsField=function(e,t,n){var r=this;if(this._fileUploaderProvider&&this._fileUploaderProvider.operationsPool.length>0){this._fileUploaderProvider.operationsPool.some(function(e){return e.fileType===M.e.attachment})&&(e.state=i.saving);return this._fileUploaderProvider.executeAllOperations(this._fileUploaderProvider.operationsPool,!0,"CreateItem"===n&&t&&t.properties?Number(t.properties.ID):void 0).then(function(t){r._fileUploaderProvider.operationsPool=[];return{status:r.handleFileUploaderErrors(t,e,[])?m.e.success:m.e.fail}},function(t){r._fileUploaderProvider.operationsPool=[];return{status:r.handleFileUploaderErrors(t,e,[])?m.e.success:m.e.fail}})}return o.n.wrap(null)};t.prototype.isValidItem=function(e){return e&&e.properties&&e.properties.ID&&"0"!==e.properties.ID};t.prototype.handleFileUploaderErrors=function(e,t,n){var r={attachments:[]},s=!0;e.forEach(function(e){if(!e.result){e.attachment&&r.attachments.push(e.errorMsg);e.image&&(r[e.image.fieldName]=e.errorMsg);s=!1}});if(t){if(r.attachments.length>0){var o=r.attachments.reduce(function(e,t){return e+(e?"\r\n":"")+t+"\r\n"},"");t.errorMessage=o;t.hasException=!0}t.state=i.ready;H.e.logData({name:"ClientFormUpdate."+t.schema.FieldType.toLowerCase()})}n.forEach(function(e){if(r[e.schema.Name]){e.errorMessage=r[e.schema.Name];e.hasException=!0}e.state=i.ready;H.e.logData({name:"ClientFormUpdate."+e.schema.FieldType.toLowerCase()})});return s};t.prototype._ensureClientForms=function(e){if(this._clientForms&&this._contentTypeIdToNameMap&&!this._listContext.refreshClientForm)return e?o.n.wrap(e()):o.n.wrap();this._listContext.refreshClientForm=void 0;return e?this.fetchAllClientFormSchemas().then(e):this.fetchAllClientFormSchemas().then(function(){return o.n.wrap()})};t.prototype._checkRenderModes=function(e){for(var t in this._clientForms)for(var n in this._clientForms[t])if(this._clientForms[t][n].mode===e)return!0;return!1};t.prototype._getFormRenderMode=function(e,t){var n=this._contentTypeIdToNameMap[t],i=this._clientForms[e][n];return i?i.mode:this._checkRenderModes(r.PowerApp)?r.PowerApp:r.Unknown};t.prototype._raiseCreateOrUpdateEvents=function(e,t){var n=e.clientForm;if(t&&t.status===m.e.success&&n){var r=n.item&&n.item.properties&&n.item.properties.ID?n.item.properties.ID:void 0,i=e.itemdIds&&e.itemdIds.length?e.itemdIds.map(String):r?[r]:void 0;i&&z.t.raise(window,n.formType===g.e.newItem?W.e.newItemCreated:W.e.itemUpdated,{itemIds:i})}};t.prototype._updateImages=function(e){return this._fileUploaderProvider&&this._fileUploaderProvider.imageOperationsPool.length>0?this._fileUploaderProvider.executeAllOperations(this._fileUploaderProvider.imageOperationsPool,!0,e?0:void 0):o.n.wrap([])};return t})(v.t),le={ODB:60087,ODC:!1,OneDrive:!1,Fallback:!1},ce=(function(){function e(e,t){var n=this;this._buffer=[];this._bufferSize=5;this._init=function(e,t){var r,i;if(t&&t.pageContext){n._pageContext=t.pageContext;n._listContext=t.listContext;r=t.apiUrlHelper;i=t.itemUrlHelper}else{n._pageContext=e.pageContext;n._listContext=e.listContext;r=e.apiUrlHelper;i=e.itemUrlHelper;n._defaultValueOverride=e.defaultValueOverride||{}}var s={isFeatureEnabled:e.isFeatureEnabled,fileUploaderProvider:e.fileUploaderProvider,complianceTagProvider:e.complianceTagProvider},o={pageContext:n._pageContext,apiUrlHelper:r,itemUrlHelper:i,getGraphAuthToken:null==e?void 0:e.getGraphAuthToken};n._clientFormDataSource?n._clientFormDataSource.updateContext(s,o):n._clientFormDataSource=new fe(s,o);n._clientFormDataSource.listContext=n._listContext;n.isFeatureEnabled=e.isFeatureEnabled?e.isFeatureEnabled:function(e){return a.n.isFeatureEnabled(e,n._pageContext&&n._pageContext.ExpFeatures)}};this._getStoredClientFormId=function(e,t,n){return e+"|"+t+"|"+n};this._getClientFormData=function(e){if(e.status===m.t.pending){var t=new f.e;e.onFinish=function(n){n=e.status||n;t.complete(e.clientForm)};return t.getPromise()}return o.n.resolve(e.clientForm)};this._init(e,t)}e.prototype.updateContext=function(e,t){this._init(e,t)};e.prototype.getClientForm=function(e,t,n){var r,i,s=this;void 0===t&&(t=!1);void 0===n&&(n=!1);t&&(this._listContext.refreshClientForm=!0);var a,f,l=e.itemId,c=e.item;if(!l&&c){var h=this._getBufferKeyFromItem(c,e.contentType);a=e.isBulkEdit?void 0:this._getClientFormFromBuffer(h);c.type!==u.t.Folder||e.contentType||(e.contentType="Folder");if(a){if(c.hasClientFormData){a.item=e.item;return o.n.wrap(a)}this._deleteClientFormFromBuffer(h)}}var p=[];if(e.isBulkEdit&&e.selection&&!e.isSwitchingContentType)for(var d={},v=0,y=e.selection;v<y.length;v++){var b=y[v];if(b){var w=b.properties;if(w){var E=(T=b.type!==u.t.Folder||w.ContentType?w.ContentType:"Folder")+(S=w.ContentTypeId);if(!d[E]){p.push({contentType:T,contentTypeId:S});d[E]=!0}}}}else p.push({contentType:e.contentType,contentTypeId:e.contentTypeId});if(l){var S,x=e.isBulkEdit,T=e.contentType,N=e.clientFormType,C=(S=e.contentTypeId)&&0===S.lastIndexOf(J,0),k="Media.Meeting"===(null===(i=null===(r=null==e?void 0:e.item)||void 0===r?void 0:r.properties)||void 0===i?void 0:i.ProgId)&&n&&!x&&!C;if(this.isFeatureEnabled(le)&&k){var L=this._getStoredClientFormId(l,T,x),A=this._getStoredClientForm(L);if(A&&void 0!==A.status)return this._getClientFormData(A).then(function(e){s._deleteClientFormFromStoredClientForm(L);return e});this._completeStoredClientForm(A,m.t.pending);return this._clientFormDataSource.getClientForm(l,N,p,x).then(function(e){s._completeStoredClientForm(A,m.t.success,e);return e})}return this._clientFormDataSource.getClientForm(l,e.clientFormType,p,e.isBulkEdit)}return this._clientFormDataSource.getClientFormSchema(e.clientFormType,p).then(function(t){if(e.item&&!e.item.properties.ContentTypeId){e.item.properties.ContentTypeId=t.contentTypeId;e.item.properties.ContentType=t.contentType}f={item:e.item,formType:t.formType,contentType:t.contentType,contentTypeId:t.contentTypeId,fields:[],clientFormCustomFormatter:t.clientFormCustomFormatter,isBulkEdit:e.isBulkEdit};s._generateFieldsFromSchema(f,t);if(e.clientFormType!==g.e.newItem)return s.updateFormValues(f)}).then(function(){s._addClientFormToBuffer(f);return o.n.wrap(f)})};e.prototype.updateFormValues=function(e,t){return this._clientFormDataSource.updateFormValues(e,t)};e.prototype.updateItem=function(t){if(t.clientForm.isBulkEdit&&t.itemdIds){this._buffer=[];e._clientFormStore=[]}return this._clientFormDataSource.updateItem(t)};e.prototype.saveCustomShowHideRules=function(e,t,n){return this._clientFormDataSource.saveCustomShowHideRules(e,t,n)};e.prototype.saveClientFormCustomFormatter=function(e,t){return this._clientFormDataSource.saveClientFormCustomFormatter(e,t)};e.prototype.getClientFormCustomFormatter=function(e,t){return this._clientFormDataSource.getClientFormCustomFormatter(e,t)};e.prototype.createItem=function(e){return this._clientFormDataSource.createItem(e)};e.prototype.getFieldFilterData=function(e,t,n){return this._clientFormDataSource.getFieldFilterData(e,t,n)};e.prototype.getClientFormSchema=function(e,t,n){return this._clientFormDataSource.getClientFormSchema(e,[{contentType:t,contentTypeId:n}])};e.prototype.updatePanelViewInfo=function(e){return this._clientFormDataSource.updatePanelViewInfo(e)};e.prototype.getContentTypes=function(e){return this._clientFormDataSource.getContentTypes(e)};e.prototype.getContentInfoTypes=function(e){var t=[];if(e.isBulkEdit&&e.selection&&!e.isSwitchingContentType)for(var n={},r=0,i=e.selection;r<i.length;r++){var s=i[r];if(s){var o=s.properties;if(o){var a=s.type!==u.t.Folder||o.ContentType?o.ContentType:"Folder",f=o.ContentTypeId,l=a+f;if(!n[l]){t.push({contentType:a,contentTypeId:f});n[l]=!0}}}}else t.push({contentType:e.contentType,contentTypeId:e.contentTypeId});return t};e.prototype.hasFormRenderMode=function(e){return this._clientFormDataSource.hasFormRenderMode(e)};e.prototype.getFormRenderMode=function(e,t){return this._clientFormDataSource.getFormRenderMode(e,t)};e.prototype.getPowerAppFormId=function(){return this._clientFormDataSource.getPowerAppFormId()};e.prototype.getPowerAppRenderInfo=function(){return this._clientFormDataSource.getPowerAppRenderInfo()};e.prototype.getPowerAppAdditionalData=function(){return this._clientFormDataSource.getPowerAppAdditionalData()};e.prototype.getPowerAppFormCacheInfo=function(){return this._clientFormDataSource.getPowerAppFormCacheInfo()};e.prototype.getPowerAppFormDesignUrl=function(e){return this._clientFormDataSource.getPowerAppFormDesignUrl(e)};e.prototype.fetchAllClientFormSchemas=function(){return this._clientFormDataSource.fetchAllClientFormSchemas()};e.prototype.clearBuffer=function(){this._buffer=[]};e.prototype.updateListContext=function(e){this._listContext=e;this._clientFormDataSource.listContext=e};e.prototype.getResourceProviders=function(){return this._clientFormDataSource.getResourceProviders()};e.prototype.updateDefaultValueOverride=function(e){this._defaultValueOverride=e};e.prototype.clearStoreClientForm=function(){e._clientFormStore=[]};e.prototype._generateFieldsFromSchema=function(e,t){for(var n=this._listContext&&this._listContext.enableAttachments,r=0,i=t.fields.length;r<i;r++){var s=t.fields[r];if(void 0!==this._defaultValueOverride[s.InternalName]){s.DefaultValue=this._defaultValueOverride[s.InternalName];s.DefaultValueFormatted="";s.DefaultValueTyped=""}("Attachments"!==s.Type||n)&&!(e.isBulkEdit&&s.ReadOnlyField)&&e.fields.push(this._generateField(e,s))}};e.prototype._generateField=function(e,t){return{hasException:!1,errorMessage:"",schema:t,state:i.ready}};e.prototype._getBufferKeyFromItem=function(e,t){return e.properties.ID+e.name+"|"+t};e.prototype._getClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++){var r=this._buffer[t].key;if(r===e){if(0===t)return this._buffer[t].form;var i=this._buffer[t].form;this._buffer.splice(t,1);this._buffer.unshift({key:r,form:i});return i}}return null};e.prototype._addClientFormToBuffer=function(e){if(!e.isBulkEdit){var t=e.item;t&&void 0!==t.properties.ID&&this._buffer.unshift({key:this._getBufferKeyFromItem(t,e.contentType),form:e})>this._bufferSize&&this._buffer.pop()}};e.prototype._deleteClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++){if(this._buffer[t].key===e){this._buffer.splice(t,1);break}}};e.prototype._getStoredClientForm=function(t){for(var n=0;n<e._clientFormStore.length;n++){if(e._clientFormStore[n].clientFormId===t)return e._clientFormStore[n]}var r={onFinish:void 0,clientFormId:t,clientForm:void 0,status:void 0};e._clientFormStore.push(r);return r};e.prototype._deleteClientFormFromStoredClientForm=function(t){for(var n=0;n<e._clientFormStore.length;n++){if(e._clientFormStore[n].clientFormId===t){e._clientFormStore.splice(n,1);break}}};e.prototype._completeStoredClientForm=function(t,n,r){for(var i=0;i<e._clientFormStore.length;i++){if(e._clientFormStore[i].clientFormId===t.clientFormId){e._clientFormStore[i].status=n;r&&(e._clientFormStore[i].clientForm=r);t.onFinish&&t.onFinish(n)}}};e._clientFormStore=[];return e})()},2348:function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(91),i=n(18),s=n(2250),o=n(0),u=n(19),a=n(530),f=n(94),l=(function(e){Object(o.__extends)(t,e);function t(t,n){var r=e.call(this,{},n)||this,i=t.apiUrlHelper,s=t.itemUrlHelper;r._itemUrlHelper=s;r._apiUrlHelper=i;return r}t.prototype.getAttachments=function(e,t){var n=this;return this.getData(function(){return n.buildAttachmentBaseUrl(e,t).toString()},function(e){var t=JSON.parse(e);if(t&&t.d&&t.d.resultes&&0===t.d.results.length)return[];var r=t.d.results;return n.transformAttachmentData(r)},"Attachments")};t.prototype.addAttachment=function(e,t,n){var i=this;return new r.n(function(r,s){var o=new FileReader;o.onload=function(u){var a=o.result;i.doUploadAttachment(e,t,n.name,a).then(r,s)};o.readAsArrayBuffer(n)},function(){})};t.prototype.deleteAttachment=function(e,t,n,i){var s=this;return new r.n(function(r,o){s.doDeleteAttachment(e,t,n,i||!1).then(r,o)},function(){})};t.prototype.getDataSourceName=function(){return"AttachmentDataSource"};t.prototype.addImage=function(e,t,n,i,s,o,u){var a=this;return new r.n(function(r,f){var l=new FileReader;l.onload=function(c){var h=l.result;a.doUploadImage(t,i,s,u.name,h,n,e,o).then(r,f)};l.readAsArrayBuffer(u)},function(){})};t.prototype.buildAttachmentBaseUrl=function(e,t,n){var r=this._itemUrlHelper.getItemUrlParts(t),i=this._apiUrlHelper.build().webByItemUrl(r).method("GetList",r.serverRelativeListUrl).method("Items",e);return i=n?i.method("AttachmentFiles",n):i.segment("AttachmentFiles")};t.prototype.transformAttachmentData=function(e){var t=this;return e.map(function(e){return{type:"attachment",fileName:e.FileName,serverRelativeUrl:Object(f.s)(t._pageContext)+e.ServerRelativeUrl,uploaded:!0}})};t.prototype.doUploadAttachment=function(e,t,n,r){var i=this;return this.dataRequestor.getData({url:this.buildAttachmentBaseUrl(e,t).methodWithAliases("addUsingPath",{decodedUrl:n}).toString(),parseResponse:function(e){var t=JSON.parse(e);if(!t.d)return null;var n=[t.d],r=i.transformAttachmentData(n);return r&&1===r.length?r[0]:null},qosName:"UploadAttachment",additionalPostData:r,noRedirect:!0})};t.prototype.doDeleteAttachment=function(e,t,n,r){var i=this;return this.getData(function(){return i.buildAttachmentBaseUrl(e,t,n).segment(r?"DeleteObject":"RecycleObject").toString()},function(e){try{var t=JSON.parse(e);return r&&void 0!==t.d.DeleteObject||!r&&void 0!==t.d.RecycleObject}catch(e){return!1}},r?"DeleteAttachment":"RecycleAttachment")};t.prototype.doUploadImage=function(e,t,n,r,i,s,o,a){var f=this,l=this._itemUrlHelper.getItemUrlParts(e),c=this._apiUrlHelper.build().webByItemUrl(l).methodWithAliases("UploadImage",{listTitle:t,imageName:r,listId:s,itemId:o,fieldId:a});u.t.isActivated("dd617e52-55d0-40bc-9e0f-ffd875d6a25c","11/10/2021","pipe through filed id to UploadImage call")&&(c=this._apiUrlHelper.build().webByItemUrl(l).methodWithAliases("UploadImage",{listTitle:t,imageName:r,listId:s,itemId:o}));return this.dataRequestor.getData({url:c.toString(),parseResponse:function(e){var t=JSON.parse(e);if(!t.d||!t.d.UploadImage)return null;var r=t.d.UploadImage,i=f.transformImageData(r,n,a);return i||null},qosName:"UploadImage",additionalPostData:i,noRedirect:!0})};t.prototype.transformImageData=function(e,t,n){return{type:"thumbnail",fileName:e.Name,serverRelativeUrl:e.ServerRelativeUrl,id:e.UniqueId,fieldName:t,serverUrl:Object(f.s)(this._pageContext),fieldId:n}};return t})(a.e),c=n(670),h=n(373),p=n(2713),d=n(109),v=n(46),m=(function(){function e(e){this.operationsPool=[];this.imageOperationsPool=[];this.listTitle=e.pageContext.listTitle;this.listId=v.e.normalizeLower(e.pageContext.listId,!1);var t=new h.e({},{pageContext:e.pageContext}),n=new c.e({},{itemUrlHelper:t,pageContext:e.pageContext}),r={pageContext:e.pageContext};this.dataSource=new l({apiUrlHelper:n,itemUrlHelper:t},r)}e.prototype.createAddAttachmentOperation=function(e,t,n){var r={type:s.t.add,listItemId:e,listItemKey:t,fileType:s.e.attachment,fileName:n.name,file:n};this.handleNewOperation(r,this.operationsPool)};e.prototype.createDeleteAttachmentOperation=function(e,t,n){var r={type:s.t.remove,listItemId:e,listItemKey:t,fileType:s.e.attachment,fileName:n};this.handleNewOperation(r,this.operationsPool)};e.prototype.createAddImageOperation=function(e,t,n,r,i){var o={type:s.t.add,listItemId:e,listItemKey:t,fileType:s.e.image,fileName:n.name,file:n,fieldName:r,fieldId:i};this.handleNewOperation(o,this.imageOperationsPool)};e.prototype.createDeleteImageOperation=function(e,t,n,r){var i={type:s.t.remove,listItemId:e,listItemKey:t,fileType:s.e.image,fileName:n,fieldName:r};this.handleNewOperation(i,this.imageOperationsPool)};e.prototype.executeAllOperations=function(e,t,n){var i=this;return new r.n(function(t,r){if(e.length>0){var o=e[0],u=e.slice(1),a=void 0;if(o.type===s.t.add){void 0!==n&&(o.listItemId=n);a=i.processUpload(o.listItemId,o.listItemKey,o.file,o.fileType,o.fieldName,o.fieldId)}else a=i.processDelete(o.listItemId,o.listItemKey,o.fileName,o.fileType,o.fieldName);var f=function(e){i.executeAllOperations(u,!1,n).done(function(n){return t([e].concat(n))},r)};a.done(f,f);d.e.logData({name:"ClientFormUpdate.attachments"})}else t([])})};e.prototype.processUpload=function(e,t,n,r,o,u){return r===s.e.image?this.dataSource.addImage(e,t,this.listId,this.listTitle,o,u,n).then(function(e){return{result:!0,attachment:null,image:e,errorMsg:e?null:i.format(p.n,n.name)+"."}},function(e){var t=i.format(p.n,n.name);e&&(e.code&&e.code.indexOf("InvalidDataException")>=0?t=p.r:e.message&&e.message.value&&(t+=" : "+e.message.value));throw{result:!1,attachment:null,image:{type:"thumbnail",fieldName:o,fileName:n.name,serverUrl:null,fieldId:u},errorMsg:t}}):this.dataSource.addAttachment(e,t,n).then(function(e){return{result:!0,attachment:e,errorMsg:e?null:i.format(p.t,n.name)+"."}},function(e){throw{result:!1,attachment:{type:"attachment",uploaded:!1,fileName:n.name},errorMsg:i.format(p.t,n.name)+(e&&e.message&&e.message.value?" : "+e.message.value:"")}})};e.prototype.processDelete=function(e,t,n,o,u,a){return o===s.e.image?r.n.wrap({result:!0,image:{type:"thumbnail",fieldName:u,fileName:n,serverRelativeUrl:null,serverUrl:null,fieldId:a},errorMsg:null}):this.dataSource.deleteAttachment(e,t,n).then(function(e){return{result:e,errorMsg:e?null:i.format(p.e,n)+"."}},function(e){throw{result:!1,errorMsg:i.format(p.e,n)+(e&&e.message&&e.message.value?" : "+e.message.value:"")}})};e.prototype.handleNewOperation=function(e,t){var n=e.type,r=this.findDuplicateOperation(e,t);n===s.t.add?r<0&&t.push(e):r<0?t.push(e):t.splice(r,1)};e.prototype.findDuplicateOperation=function(e,t){var n=e.fileType,r=-1;t.some(function(t,i){if(t.type===s.t.add&&t.fileName===e.fileName&&(n!==s.e.image||t.fieldName===e.fieldName)){r=i;return!0}});return r};return e})()},2371:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=(function(){function e(){}e.newItemCreated="clientFormNewItemCreated";e.itemUpdated="clientFormItemUpdated";return e})()},2377:function(e,t,n){"use strict";var r=n(0),i=n(91),s=n(1230),o=n(530),u=n(2221),a=n(2369),f=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,{},n)||this,i=t.apiUrlHelper,s=t.itemUrlHelper;r._apiUrlHelper=i;r._itemUrlHelper=s;return r}t.prototype.isAdvancedRecordVersioningDisabled=function(){return this.dataRequestor.getData({url:this._buildRecordVersioningUrl(),qosName:"GetAdvancedRecordVersioningDisabled",method:"GET"}).then(function(e){return!!(e&&e.d&&e.d.GetAdvancedRecordVersioningDisabled)&&e.d.GetAdvancedRecordVersioningDisabled},function(e){return i.n.wrapError(e)})};t.prototype.getAvailableTagsForSite=function(){var e=this;return this.dataRequestor.getData({url:this._buildComplianceTagsListUrl(),qosName:"GetAvailableTagsForSite",method:"GET",noRedirect:!0}).then(function(t){return e._transformToComplianceTags(t.d.GetAvailableTagsForSite.results)},function(e){return i.n.wrapError(a.GetAvailableTagsForSiteFailed)})};t.prototype.updateComplianceTagInBatch=function(e,t,n){if(!e||0===e.length){s.e.logData({name:"ComplianceTagDataSource.EmptyItemIds",message:"Empty item IDs selected for list: "+n});return i.n.wrap([])}var r=JSON.stringify({itemIds:e,listUrl:n,complianceTagValue:t.tagValue,blockDelete:t.blockDelete,blockEdit:t.blockEdit});return this.dataRequestor.getData({url:this._buildApplyLabelOnBulkItemsUrl(),qosName:"ApplyLabelOnBulkItems",additionalPostData:r,method:"POST"}).then(function(e){return e&&e.d&&e.d.ApplyLabelOnBulkItems&&e.d.ApplyLabelOnBulkItems.results?e.d.ApplyLabelOnBulkItems.results:[]},function(e){return i.n.wrapError(e)})};t.prototype.updateComplianceTag=function(e,t){var n=t.blockEdit||t.blockDelete,r=t.blockEdit,s=t.isEventTag,o=JSON.stringify({complianceTag:t.tagValue,isTagPolicyHold:n,isTagPolicyRecord:r,isEventBasedTag:s,isTagSuperLock:t.superLock,isUnlockedAsDefault:t.unlockedAsDefault});return this.dataRequestor.getData({url:this._buildUpdateHashtagsUrl(e,"SetComplianceTag"),qosName:"SetComplianceTag",additionalPostData:o,method:"POST",noRedirect:!0}).then(function(){return t.tagName},function(e){return i.n.wrapError(e)})};t.prototype.unlockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this.dataRequestor.getData({url:this._buildUnlockRecordUrl(),qosName:"UnlockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){if(e&&e.d&&e.d.UnlockRecordItem&&e.d.UnlockRecordItem.results){var t=e.d.UnlockRecordItem.results;return u.u(t)}return!1},function(e){return i.n.wrapError(e)})};t.prototype.lockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this.dataRequestor.getData({url:this._buildLockRecordUrl(),qosName:"LockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){if(e&&e.d&&e.d.LockRecordItem&&e.d.LockRecordItem.results){var t=e.d.LockRecordItem.results;return u.u(t)}return!1},function(e){return i.n.wrapError(e)})};t.prototype._buildRecordVersioningUrl=function(){return this._apiUrlHelper.build().methodWithAliases("SP.CompliancePolicy.SPPolicyStoreProxy.GetAdvancedRecordVersioningDisabled",{}).toString()};t.prototype._buildComplianceTagsListUrl=function(){return this._apiUrlHelper.build().methodWithAliases("SP.CompliancePolicy.SPPolicyStoreProxy.GetAvailableTagsForSite",{siteUrl:this._pageContext.webAbsoluteUrl}).toString()};t.prototype._buildUpdateHashtagsUrl=function(e,t){var n=this._itemUrlHelper.getItemUrlParts(e.key);return this._apiUrlHelper.build().webByItemUrl(n).method("GetList",n.serverRelativeListUrl).method("items",e.properties.ID).method(t).toString()};t.prototype._transformToComplianceTags=function(e){var t=[],n={tagName:a.NoneComplianceTagName,tagValue:"",blockDelete:!1,blockEdit:!1,tagDescription:a.NoneComplianceTagDescription,tagTooltip:a.NoneComplianceTagDescription,hasRetentionAction:!1,autoDelete:!1,isEventTag:!1,reviewerEmail:"",notes:"",displayName:"",superLock:!1,tagId:"",unlockedAsDefault:!1};t.push(n);for(var r=0,i=e;r<i.length;r++){var s=i[r],o=u.r(s),f=u.i(s),l={tagName:s.TagName,tagValue:s.TagName,blockDelete:s.BlockDelete,blockEdit:!!s.BlockEdit,tagDescription:o,tagTooltip:f,hasRetentionAction:s.HasRetentionAction,autoDelete:s.AutoDelete,isEventTag:s.IsEventTag,reviewerEmail:s.ReviewerEmail,notes:s.Notes,displayName:s.DisplayName,superLock:s.SuperLock,tagId:s.TagId,unlockedAsDefault:s.UnlockedAsDefault};t.push(l)}return t};t.prototype._buildApplyLabelOnBulkItemsUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.ApplyLabelOnBulkItems").toString()};t.prototype._buildUnlockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.UnlockRecordItem").toString()};t.prototype._buildLockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.LockRecordItem").toString()};return t})(o.e),l=n(670),c=n(373),h=(function(){function e(e){var t=new c.e({},{pageContext:e.pageContext}),n=new l.e({},{itemUrlHelper:t,pageContext:e.pageContext}),r={pageContext:e.pageContext};this._dataSource=new f({apiUrlHelper:n,itemUrlHelper:t},r)}e.prototype.isAdvancedRecordVersioningDisabled=function(){return this._dataSource.isAdvancedRecordVersioningDisabled()};e.prototype.getAvailableTagsForSite=function(){this._cachedTagsPromise||(this._cachedTagsPromise=this._dataSource.getAvailableTagsForSite());return this._cachedTagsPromise};e.prototype.updateComplianceTag=function(e,t){return this._dataSource.updateComplianceTag(e,t)};e.prototype.updateComplianceTagInBatch=function(e,t,n){return this._dataSource.updateComplianceTagInBatch(e,t,n)};e.prototype.unlockRecord=function(e,t){return this._dataSource.unlockRecord(e,t)};e.prototype.lockRecord=function(e,t){return this._dataSource.lockRecord(e,t)};e.prototype.hasComplianceTags=function(){return this.getAvailableTagsForSite().then(function(e){return!!(e&&e.length>1)})};return e})();t.e=h},2384:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.richClient=0]="richClient";e[e.browser=1]="browser"})(r||(r={}))},2393:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r,i=n(79);(function(e){e[e.Active=0]="Active";e[e.Restricted=1]="Restricted";e[e.RestrictedICN=2]="RestrictedICN";e[e.ConditionalAccessBlocked=3]="ConditionalAccessBlocked";e[e.ConditionalAccessViewOnly=4]="ConditionalAccessViewOnly"})(r||(r={}));var s,o=r,u=n(1266),a=n(1268),f=n(913),l=n(1240),c=n(46),h=n(2337),p=n(899),d=n(173),v=n(453),m=n(327),g=n(2239),y=n(1256),b=n(10);(function(e){e.buildItems=function(e,n,r,i,s){for(var o=[],u=[],a=e.Row,f=a.length,l=0;l<f;l++){var c=t(a[l],u,n,r);c.parent=i;c.parentKey=i.key;s&&s.setItem(c.key,c);o.push(c)}var h=0;if(u.length>0){var p=u[u.length-1];h=p.startIndex+p.count}else{u=void 0;h=f>0?e.LastRow:0}return{items:o,groups:u,totalCount:h}};e.buildRootItem=function(e,t,n,r){var i=(function(e){var t=e;if(0===e.indexOf("id")){var n=Object(m.e)(e);t=n.id}return t})(e),s=Object(g.e)(i,n.listUrl),o={key:s},u=t.ListTitle,a=t.AllowCreateFolder,l=t.EnableMinorVersions,c=t.verEnabled,h=t.AllowGridMode,p=t.DisableGridEditing,v=t.ListTemplateType,w=t.BasePermissions,E=void 0===w?{}:w,S=E.ManageLists,x=void 0===S?void 0:S,T=E.ManagePersonalViews,N=void 0===T?void 0:T,C=E.OpenItems,k=void 0===C?void 0:C,L=t.ListSchema,A=(void 0===L?{}:L).DefaultItemOpen,O=void 0===A?void 0:A,M=t.ExcludeFromOfflineClient,_=t.WebExcludeFromOfflineClient,D=t.ListData,P="string"==typeof O?"0"===O:void 0;if(r){var H=r.getItem(s);H&&(o=H)}o.type=d.t.Folder;o.isRootFolder=i===n.listUrl;Object(y.default)(o,{permissions:y.optional(D?f.e(D.FolderPermissions):void 0)});void 0===o.list&&(o.list={});Object(y.default)(o.list,{id:y.optional(t.listName),title:y.optional(u),allowGridMode:"boolean"==typeof h?h:y.backup(!0),allowCreateFolder:y.optional(a),disableCommenting:"boolean"==typeof t.DisableCommenting&&t.DisableCommenting,disableGridEditing:"boolean"==typeof p?p:y.backup(!1),enableMinorVersions:y.optional(l),enableVersions:y.optional(c),templateType:y.optional("string"==typeof v?Number(v):void 0),isDocumentLibrary:y.optional("string"==typeof v?Object(b.i)(v):void 0),isPromotedLinks:y.optional("string"==typeof v?Object(b.o)(v):void 0),isForceCheckout:y.optional(t.isForceCheckout),isModerated:y.optional(t.isModerated),enableRequestSignOff:y.optional(t.EnableRequestSignOff),newWOPIDocumentEnabled:y.optional(t.NewWOPIDocumentEnabled),newWOPIDocumentTypes:y.optional(t.NewWOPIDocumentTypes),permissions:{manageLists:y.optional(x),managePersonalViews:y.optional(N),openItems:y.optional(k)},openInClient:y.optional(P),excludeFromOfflineClient:y.optional("boolean"==typeof M||"boolean"==typeof _?M||_:void 0),contentTypesEnabled:y.optional(t.ContentTypesEnabled),metadataNavFeatureEnabled:y.optional(t.metadataNavFeatureEnabled),canUserCreateMicrosoftForm:y.optional(t.canUserCreateMicrosoftForm),itemCount:y.optional(t.ListSchema&&t.ListSchema.ItemCount),rowLimit:y.optional(D&&D.RowLimit)});o.isRootFolder&&(o.name=o.displayName=u);r&&r.setItem(s,o);return o};function t(e,t,n,r){if(e){var s={key:Object(g.e)((function(e){return e.id||e.FileRef||e.ServerRelativeUrl})(e),n.listUrl)};s.id=e.id||e.FileRef;s.itemId=e["name.FileSystemItemId"];var m=e.File_x0020_Type;s.extension=m?"."+m:void 0;s.policyTip=e._ip_UnifiedCompliancePolicyUIAction?Number(e._ip_UnifiedCompliancePolicyUIAction):i.r.none;s.type=(function(e,t,n){var r=d.t.File,i=e.File_x0020_Type;if("1"===e.FSObjType){var s=e["File_x0020_Type.mapapp"],o=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];r=s&&"onenote"===s.substring(0,7)||o&&-1!==o.indexOf("onenote")?d.t.OneNote:d.t.Folder}else h.e.isShortcutEnabled()&&h.e.isShortcutFileType(i)?r=d.t.Shortcut:"pdf"===i?r=d.t.Media:(r=p.i(i))===d.t.Unknown&&Object(b.s)(n.listTemplateType)&&(r=d.t.File);".ai"!==t.extension&&".eps"!==t.extension&&".psd"!==t.extension||(r=d.t.Media);r===d.t.Folder?t.isDocSet="Sharepoint.DocumentSet"===e.ProgId:r===d.t.File&&n&&!n.isDocLib&&(t.listItem={});return r})(e,s,n);s.extension&&(s.iconName=p.r(s));s.isRootFolder=e.isRootFolder;var y=Object(u.getItemName)(e,s.type,n);y&&(s.displayName=s.name=y);s.dateModifiedValue=e.Modified;s.dateModified=e["Modified.FriendlyDisplay"]?Object(l.e)(e["Modified.FriendlyDisplay"]):String(e.Modified);s.permissions=e.PermMask?f.e(e.PermMask):void 0;s.isPlaceholder=!e.PermMask;s.hasMissingMetadata=(function(e,t){if(!t.listSchema)return!1;var n=t.listSchema.filter(function(e){return e.isRequired&&Boolean(e.name)}),r=!1;if(n&&n.length>0)for(var i in n)if(i){var s=n[i];if(!e[s.internalName]){r=!0;break}}return r})(e,n);var w=e["serverurl.progid"];s.openUrl=w?w.substring(1):e.FileRef;-1!==s.openUrl.toLowerCase().indexOf("/wopiframe?")&&(s.openUrl=s.openUrl.replace(/\/_layouts\/WopiFrame.aspx\?/,"/_layouts/15/WopiFrame.aspx?"));s.previewIFrameUrl=e.ServerRedirectedEmbedUrl;s.appMap=e["File_x0020_Type.mapapp"]||e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];s.size=e.File_x0020_Size?Number(e.File_x0020_Size):void 0;s.totalSize=e.SMTotalSize?Number(e.SMTotalSize):void 0;r.blockDownloadsExperienceEnabled&&(s.type===d.t.Media||s.openUrl&&s.appMap)?s.itemStatus=o.ConditionalAccessViewOnly:r.blockDownloadsExperienceEnabled?s.itemStatus=o.ConditionalAccessBlocked:r.viewOnlyExperienceEnabled&&(s.itemStatus=o.ConditionalAccessViewOnly);if(s.type===d.t.Folder){s.folder={};s.childCount=Number(e.ItemChildCount)+Number(e.FolderChildCount);var E=Number(e.SMTotalFileCount);s.folder.totalCount=E>0?E:s.childCount;s.folder.childCount=s.childCount}s.isDraggable=!0;s.isDropEnabled=s.type===d.t.Folder;s.properties={};for(var S in e)e.hasOwnProperty(S)&&(s.properties[S]=e[S]);var x=e.UniqueId&&c.e.normalizeLower(e.UniqueId);x&&(s.properties.uniqueId=x);var T=s.name;s.extension&&(T=s.name.substring(0,s.name.toLowerCase().lastIndexOf(s.extension.toLowerCase())));s.properties.FileName=T;Number(e.PrincipalCount)>0?s.sharingType=v.e.Shared:void 0===e.PrincipalCount?s.sharingType=v.e.Unknown:s.sharingType=v.e.Private;Object(a.n)(e,t,n);return s}}e.buildItem=t})(s||(s={}))},2400:function(e,t,n){"use strict";n.d(t,"e",function(){return p});var r=n(0),i=n(530),s=n(65),o=n(42),u=n(373),a=n(670),f=n(374),l=n(2239),c=n(2339),h=n(19).t.isActivated("29873e89-d94c-4bb0-8f5b-dfd437f6422c","6/19/2021","Look for filters within the folder structure for doclib by using GetListUsingPath API"),p=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{},{pageContext:t.pageContext})||this;n._listContext=t.listContext;n._itemUrlHelper=t.itemUrlHelper||new u.e({},{pageContext:t.pageContext});n._apiUrlHelper=t.apiUrlHelper||new a.e({},{pageContext:t.pageContext,itemUrlHelper:n._itemUrlHelper});n._folderPath=t.folderPath;void 0===n._folderPath&&(n._folderPath=Object(l.t)(t.parentKey,n._listContext));return n}t.prototype.getFilterData=function(e,t,n,r){var i=this;return this.getData(function(){return i._getFilterDataUrl(e,t,n,r)},function(e){return e},"GetFilterData")};t.prototype._getFilterDataUrl=function(e,t,n,r){var i,u,a=this._itemUrlHelper.getUrlParts({path:this._listContext.listUrl,listUrl:this._listContext.listUrl});u=h?this._apiUrlHelper.build().webByItemUrl(a).method("GetList",a.serverRelativeListUrl).segment("RenderListFilterData").parameter("FieldInternalName",e):this._apiUrlHelper.build().webByItemUrl(a).methodWithAliases("GetListUsingPath",{DecodedUrl:a.serverRelativeListUrl}).segment("RenderListFilterData").parameter("FieldInternalName",e);n&&n!==c.e&&(u=u.parameter("ViewId",n));this._folderPath&&(u=u.parameter("RootFolder",{raw:s.e.encodeURIComponent(this._folderPath)}));r&&r===o.e.Taxonomy&&(u=u.parameter("ExcludeFieldFilteringHtml",!0));var l=Object(f.getFilterParams)(t,!0,{replaceMeFormatFilterWithCurrentUser:!0,currentUserDisplayName:null===(i=this._pageContext)||void 0===i?void 0:i.userDisplayName});return(u=u.rawParameter(l)).toString()};return t})(i.t)},2632:function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(7),i=n(36),s=n(2345),o={listContext:i.o,pageContext:i.h},u=new r.t({name:"ClientFormProviderV2",factory:{dependencies:o,create:function(e){var t=e.listContext,n=e.pageContext,r=new s.e({listContext:a(t),pageContext:n});return{instance:r,disposable:r}}}});function a(e){return{listUrl:e.listUrl,listId:e.listId,urlParts:e.urlParts,listTitle:e.listTitle,listTemplateType:e.listTemplateType,isDocLib:e.isDocLib,folderPath:e.folderPath,enableAttachments:!!e.enableAttachments,leftNavigationData:e.leftNavigationData,refreshClientForm:e.refreshClientForm,contentTypesEnabled:e.contentTypesEnabled,tenantTagPolicyEnabled:e.tenantTagPolicyEnabled,allowCreateFolder:e.allowCreateFolder,flags2:e.flags2}}},3775:function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return v});var r=n(119),i=n(0),s=n(91),o=n(94),u=n(88),a=n(211),f=n(2117),l=n(2379),c=n(2632),h=n(2411),p=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,n.pageContext)||this;r._pageContext=n.pageContext;return r}t.prototype.getClientForm=function(e){var t=e.resources,n=e.item,r=e.isBulkEdit,i=e.forceToFetch,s=this._getClientFormParmsV2(n,r),o=new u.e({name:"TMR.getClientForm"});return t.consume(c.t).getClientForm(s,i,!0).then(function(e){return e},function(e){o.end(Object(a.e)(e));throw e})};t.prototype.setItemExpirationDate=function(e,t){var n,r=Object(o.i)(this._pageContext),i=encodeURI(null===(n=null==e?void 0:e.id)||void 0===n?void 0:n.replace(/'/g,"%27")),s=r+"/_api/web/GetFileByServerRelativeUrl('".concat(i,"')/SetExpirationDate"),u={},a=null;t&&(a=t.toISOString());u.expirationDate=a;return this.dataRequestor.getData({url:s,parseResponse:function(e){},qosName:"TMR.setItemExpirationDate",additionalPostData:JSON.stringify(u),method:"POST",noRedirect:!0})};t.prototype.clearStoreClientForm=function(e){return s.n.resolve(e.consumeAsync(c.t)).then(function(e){return e.clearStoreClientForm()})};t.prototype.getItemExpirationDate=function(e){var t=Object(o.i)(this._pageContext),n=e.id,r=t+"/_api/web/GetFileByServerRelativeUrl('".concat(n,"')/ExpirationDate");return this.dataRequestor.getData({url:r,parseResponse:function(e){var t,n=JSON.parse(e);return!!(null===(t=null==n?void 0:n.d)||void 0===t?void 0:t.ExpirationDate)},qosName:"TMR.getItemExpirationDate",method:"GET",noRedirect:!0})};t.prototype._getClientFormParmsV2=function(e,t){var n=e.peek(),r=Object(h.n)(n),i=n.properties||{};return{clientFormType:f.e.editItem,item:r,itemId:i.ID,contentType:i.ContentType,contentTypeId:i.ContentTypeId,isBulkEdit:t,selection:[r]}};return t})(l.e),d=n(36),v=Object(r.s)("ExpirationStore",p,{pageContext:d.h})}}]);