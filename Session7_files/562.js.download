(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[562],{4222:function(e,t,n){"use strict";n.d(t,"e",function(){return d});var r=n(0),i=n(905),s=n(398),o=n(530),u=n(91),a=n(63),f=n(109),l=n(46),c=n(19),h=c.t.isActivated("270dfbb4-1b85-4fed-9ada-b85e650353f4","6/9/22","retry request for large list"),p=c.t.isActivated("3f7e1f54-43e3-4c37-a5f3-b78fb07ed315","7/12/22","read groupString from postDataContext when listContext group is empty"),d=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,{dataSourceName:"ListItemDataSource"},{pageContext:t.pageContext})||this}t.prototype.getItem=function(t,n,r,i){var s=this;t.postDataContext.isOnePage=!!t.newTargetListUrl||!!t.isOnePageNavigation;var o=t.remoteItem?this._getRemoteItemPostData():this.getAdditionalPostData(t.postDataContext,n,t.pageSize),a=function(){return t.remoteItem?s._getRemoteItemPostData():s.getAdditionalPostData(t.postDataContext,n,t.pageSize)},f=function(){return e.prototype.getData.call(s,function(){return s.getUrl(n,t)},function(e,t){return s._parseResponse(e,r.qosEvent,t)},r.qosName,h?function(){return o}:a,"POST",s._getListRequestHeaders(t,n),void 0,void 0,t.noRedirect,void 0,function(e){var t=s._telemetryHandler(e);i&&i(t.eventData);return t},void 0,t.authToken).then(function(e){return e},function(e){s._errorHandler(r.qosName,e);return u.n.reject(e)})};return f().then(function(e){return e},function(e){var n;if(!h&&-1!==(null===(n=e.code)||void 0===n?void 0:n.indexOf("Microsoft.SharePoint.SPQueryThrottledException"))){t.postDataContext.groupReplace=!0;return f()}return u.n.reject(e)})};t.prototype.getUrl=function(e,t){var n,r=t&&t.postDataContext;n={webUrl:this._pageContext.webAbsoluteUrl,listId:t.remoteItem?t.remoteItem.ListId:e.listId,urlParts:t.remoteItem?{}:e.urlParts,searchTerm:e.searchTerm,rootFolder:t.remoteItem?void 0:e.folderPath,isOnePageNavigation:t.isOnePageNavigation,remoteWebUrl:t.remoteItem?t.remoteItem.SiteUrl:t.remoteWebUrl,uniqueId:t.remoteItem&&t.remoteItem.UniqueId,authToken:null==t?void 0:t.authToken,inplaceSearchMultiLineFieldQuery:e.inplaceSearchMultiLineFieldQuery};c.t.isActivated("03784CEA-7833-4740-8D6A-4EA05116664F","5/18/21","Set prefetch param")||(n.isPrefetchPageContext=e.listId&&!this._pageContext.listUrl);if(this._isSpecifiedItemRequest(e))n.viewId=e.viewIdForRequest;else{(!e.viewXmlForRequest||r&&r.isOnePage)&&e.viewIdForRequest!==l.e.Empty&&(n.view=e.viewIdForRequest);!n.view&&e.viewPathForRequest&&(n.viewPath=e.viewPathForRequest);t&&t.ignoreFilterParams||(n.filterParams=e.filterParams);if(e.sortField){n.sortField=e.sortField;n.sortDir="false"===e.isAscending?"Desc":"Asc"}r&&r.groupReplace?n.requestToken=this._isExpandingGroup(n.groupString)?void 0:e.requestToken:n.requestToken=e.group?void 0:e.requestToken;!e.group||!this._isExpandingGroup(e.group.groupString)||r&&r.groupReplace?p||!t.group||!this._isExpandingGroup(t.group.groupString)||r&&r.groupReplace||(n.groupString=t.group.groupString):n.groupString=e.group.groupString;r&&r.webId&&(n.webId=r.webId)}return i.t(n)};t.prototype.getAdditionalPostData=function(e,t,n){return s.e(e,t,n)};t.prototype.needsRequestDigest=function(e){return!!c.t.isActivated("4CE25DD5-0B47-4B9E-B6F9-5037A00C6CF8","04/21/2021","need Request Digest")||-1===e.toLowerCase().indexOf("/renderlistdataasstream?")};t.prototype._getRemoteItemPostData=function(){return JSON.stringify({parameters:{RenderOptions:7}})};t.prototype._getListRequestHeaders=function(e,t){var n=i.r(t,e.postDataContext);n["X-ServiceWorker-Strategy"]=e.skipServiceWorkerCache?"SkipCache":"CacheFirst";return n};t.prototype._isSpecifiedItemRequest=function(e){return e.itemIds&&e.itemIds.length>0};t.prototype._isExpandingGroup=function(e){return e&&"__next__"!==e};t.prototype._parseResponse=function(e,t,n){var r=n.getServiceWorkerDataSourceHeader();try{if(void 0!==e)return this._getListItemResponse(e,r)}catch(n){if("{}"!==e.substring(0,2)){t.end({resultType:a.e.Failure,resultCode:"BadJSON"});throw n}return this._getListItemResponse(e.substring(2),r)}};t.prototype._getListItemResponse=function(e,t){var n;n=JSON.parse(e);"ServiceWorker-FromCache"===t&&(n.isFromServiceWorkerCache=!0);return n};t.prototype._telemetryHandler=function(e){var t=e.errorData,n=Object(r.__assign)({},e.eventData);if(t){var i=void 0,s=t.code?t.code:"";if(s.indexOf("2147024860")>-1)s="ListViewTreshold";else if(s.indexOf("2147024749")>-1)s="LookupColumnTreshold";else if(s.indexOf("2147024809")>-1&&s.indexOf("requestUrl")>-1)s="RequestURLFailure";else if(s.indexOf("2147024809")>-1&&s.indexOf("range")>-1)s="RangeError";else if(s.indexOf("2147024809")>-1&&s.indexOf("view")>-1)s="InvalidView";else if(s.indexOf("2130575340")>-1&&s.indexOf("field")>-1)s="FieldTypesNotInstalledProperly";else if(s.indexOf("2146232832")>-1){s="DefaultDoclibNotFound";if(500===t.status){i=!1;n.resultType=a.e.ExpectedFailure}}else if(s.indexOf("2147024895")>-1){s="PrefetchWebMismatch";if(500===t.status){i=!1;n.resultType=a.e.ExpectedFailure}}else s=n.resultCode;n.resultCode=s;return{canRetry:i,eventData:n}}return{eventData:n}};t.prototype._errorHandler=function(e,t){var n=t&&t.code?t.code:"";n.indexOf("2147024860")>-1?f.e.logData({name:e+".ListViewTreshold"}):n.indexOf("2147024749")>-1&&f.e.logData({name:e+".LookupColumnTreshold"})};return t})(o.t)},5045:function(e,t,n){"use strict";n.r(t);n.d(t,"KnockoutAuthTokenDataSource",function(){return v});n.d(t,"resourceKey",function(){return m});var r=n(0),i=n(91),s=n(88),o=n(4222),u=n(119),a=n(398),f=n(3667),l=n(2161),c=n(36),h=n(82),p=n(202),d=n(13).e.isActivated("0734D9E7-806F-4FD2-85CF-CF1F9A7E0B27","6/9/2021","Add noRedirect to auth token request"),v=(function(){function e(e,t){void 0===e&&(e={});this._itemTaskObserverType=t.itemTaskObserverType;this._itemUrlHelper=t.itemUrlHelper;this._listItemResultProcessor=t.listItemResultProcessor;this._pageContext=t.pageContext;this._urlDataSourceLite=t.urlDataSourceLite}e.prototype.getAuthToken=function(e){var t=this;if(!this._pageContext.isSPO)return i.n.reject(new Error("getAuthToken is not supported OnPrem"));var n=new o.e({pageContext:this._pageContext}),u=e&&e.key||this._urlDataSourceLite.getRootItemKey(),f=this._itemUrlHelper.getItemUrlParts(u),l=this._itemUrlHelper.getUrlParts({path:f.serverRelativeListUrl,listUrl:f.fullListUrl}),c=a.r({pageSize:1}),h=Object(r.__assign)({parentKey:u,postDataContext:{viewXml:c,needsSchema:!0,isListDataRenderOptionChangeFeatureEnabled:!0},skipServiceWorkerCache:!0},d?{}:{noRedirect:!0}),p={urlParts:l},v={qosEvent:new s.e({name:"FetchAuthToken"}),qosName:"AuthToken.GetData"};return n.getItem(h,p,v).then(function(e){var n=new t._itemTaskObserverType;t._listItemResultProcessor.processResponse({response:Object(r.__assign)(Object(r.__assign)({},e),{ListData:Object(r.__assign)(Object(r.__assign)({},e.ListData),{Row:[]})}),pageContext:void 0,requestKey:u,observer:n});n.flush();if(e&&e.ListSchema)return{data:e.ListSchema,allowCookies:!1}})};e.dependencies={itemTaskObserverType:l.resourceKey,itemUrlHelper:p.a,listItemResultProcessor:f.e,pageContext:c.h,urlDataSourceLite:h.me};return e})(),m=Object(u.s)("KnockoutAuthTokenDataSource",v)}}]);