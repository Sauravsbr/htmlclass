(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.items-view"],{1772:function(e,t,n){"use strict";n.r(t);n.d(t,"DropTargetHook",function(){return d});n.d(t,"DragSourceHook",function(){return v});n.d(t,"DragDropHook",function(){return b});var r=n(0),i=n("react-lib"),s=n(1470),o=n(1343),u=n(939),a=n(1608),f=n(4722),l=n(659),c=n(114),h=n(120),p=n(1586);var d=function(e){return i.createElement(s.e,null,i.createElement(o.e,Object(r.__assign)({},e)))};var v=function(e){var t=e.dragSourceKey,n=e.type,o=i.useState(),a=o[0],f=o[1],l=Object(h.e)(function(t){var n;e.hookCallback(t);f(null===(n=t.collectedProps)||void 0===n?void 0:n.isDragging)});return i.createElement(s.e,null,i.createElement(u.t,Object(r.__assign)({},e,{hookCallback:l})),e.showDefaultDragPreview||!a?null:i.createElement(u.e,{dragSourceKey:t,type:n},function(e){return i.createElement(y,{draggedItem:e.draggedItem,dropEffect:e.dropEffect})}))};function m(e){var t=e.resolve,n=Object(r.__rest)(e,["resolve"]);i.useEffect(function(){return function(){t()}},[]);return i.createElement(a.e,Object(r.__assign)({},n))}function g(e){var t=e.draggedItem,n=e.resolve;return i.createElement(s.e,null,i.createElement(u.e,{dragSourceKey:null==t?void 0:t.dragSourceKey,type:null==t?void 0:t.type,as:p.e,getItemStyles:p.n},function(e){return i.createElement(m,{draggedItem:e.draggedItem,dropEffect:e.dropEffect,resolve:n})}))}function y(e){var t=Object(l.i)({scope:"global"});i.useEffect(function(){if(e.draggedItem&&t){var n=new c.e,r=n.reject,s=n.resolve,o=n.promise,u=i.createElement(g,{draggedItem:e.draggedItem,reject:r,resolve:s});t.enqueue({content:u,promise:o,scope:"global"})}},[e.draggedItem]);return null}var b=i.memo(function(e){var t=e.dragDropKey,n=e.dragType,o=i.useState(),a=o[0],l=o[1],c=Object(h.e)(function(t){var n;e.hookCallback(t);l(null===(n=t.collectedDragProps)||void 0===n?void 0:n.isDragging)});return i.createElement(s.e,null,i.createElement(f.e,Object(r.__assign)({},e,{hookCallback:c})),e.showDefaultDragPreview||!a?null:i.createElement(u.e,{dragSourceKey:t,type:n},function(e){return i.createElement(y,{draggedItem:e.draggedItem,dropEffect:e.dropEffect})}))})},1858:function(e,t,n){"use strict";n.r(t);n.d(t,"ItemSwitchViewAction",function(){return b});n.d(t,"SwitchViewExecutor",function(){return w});var r=n(0),i=n("react-lib"),s=n(15),o=n(24),u=n(169),a=n(9),f=n(40),l=n(89),c=n(278),h=n(1),p=n(296),d=n(20),v=n(275),m=n(703),g=n(32),y=n(49),b=Object(y.t)(function(e,t){var n=t.itemKey,s=t.itemSetKey,y=t.viewId,b=t.currentDerivedView,w=e.demandItemFacet(f.e,n);if(!w)return null;var E=w.webAbsoluteUrl,S=w.listFullUrl,x=e.demandItemFacet(l.e,s),T=l.e.serialize({webAbsoluteUrl:E,listFullUrl:S,rootFolder:x&&x.rootFolder||"",viewKey:{viewId:y}}),N=b&&c.e.serialize({viewId:b.id}),C=e.isItemFacetResolved(h.jt,N)?e.demandItemFacet(h.jt,N):void 0,k=Object(g.t)(e,{itemKey:n,engagement:{name:"SwitchView",isIntentional:!0}}),L=e.dispatch,A=Object(d.i)(e,i.createElement(v.e,{itemKey:T}));return i.createElement(d.n,{action:A},function(e){var t=e.isAvailable,s=e.execute;return i.createElement(o.e,Object(r.__assign)({isAvailable:t,isToggled:b?y===b.id:""===y,onExecute:function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,i,o;return Object(r.__generator)(this,function(f){switch(f.label){case 0:L(Object(u.e)({items:Object(r.__assign)(Object(r.__assign)({},N?(t={},t[N]=Object(r.__assign)(Object(r.__assign)({},h.qt.pack(!1)),C&&b&&b.isDirty()?Object(r.__assign)({},h.y.pack(new p.e(C))):{}),t):{}),n?(i={},i[T]=Object(r.__assign)({},a.s.pack({itemKey:n})),i):{})}));N&&b&&b.isDirty()&&L(Object(m.e)({items:(o={},o[N]=[h.jt,h.y],o)}));return[4,s(e)];case 1:f.sent();return[2]}})})}},k))})}),w=Object(s.e)()(b)},3027:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(311),i=Object(r.e)(function(e){return{}})},3131:function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(23),i=n(14),s=new r.e("uploadProgress",{sourceEntryKey:i.e});function o(e){return s.serialize({sourceEntryKey:e})}},3146:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(2),i=new r.e("vault");new r.e("vaultQuotaRemainingFacet")},3219:function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(6),i=new r.e("progressListGroup",{maxChildItemCount:r.t}),s=new r.e("progressList",{groupControlHandler:Object(r.n)(i)})},3226:function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});var r=n(456),i=n(9),s=n(461),o=new(n(131).e)("childItemKeys",function(e,t){var n=t.itemKey,s=e.demandItemFacet(r.e,n),o=e.demandItemFacet(i.e,n),u=o&&o.itemKeys;return r.e.evaluate(s)(e,{itemKey:n,itemKeys:u}).itemKeys});function u(e,t){return Object(s.t)(e.demandItemFacet(o,t.itemSetKey))}},3386:function(e,t,n){"use strict";n.r(t);n.d(t,"hasManageListsPermission",function(){return m});n.d(t,"modifyColumn",function(){return g});var r=n(0),i=n(89),s=n(278),o=n(1807),u=n(12),a=n(126),f=n(1),l=n(9),c=n(236),h=n(112),p=n(1270),d=n(87),v=n(117);function m(e,t){var n=t.itemSetKey;if(n){var r=e.demandItemFacet(f.Xe,v.e.serialize({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl}));return!!(r&&r.permissions&&r.permissions.manageLists)}return!1}var g=Object(u.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.columnModifyTypeMap;return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var u,v,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_;return Object(r.__generator)(this,function(D){switch(D.label){case 0:if(!(u=e(Object(a.e)({setKey:i.e},t)).setKey))return[3,3];v=Object.keys(n)[0];g=n[v],y=g.modifyType,b=g.targetIndex;if(!(w=u.viewKey?s.e.serialize(u.viewKey):void 0))return[3,3];if(!(E=e(Object(a.e)({currentDerivedView:f.y},w)).currentDerivedView))return[3,3];S=E.getEffectiveFieldNames();if(!(x=e(Object(a.e)({internalName:f.ke},v)).internalName))return[3,3];if((T=S.indexOf(x))<0||1===y&&0===T||2===y&&T===S.length-1)return[2];N=E.isDirty();switch(y){case 0:E.updateField(x);break;case 1:E.updateField(x,T-1);break;case 2:E.updateField(x,T+1);break;case 3:E.updateField(x,b)}C=e(Object(h.e)(function(e){return m(e,{itemSetKey:u})}));k=!1;return C?[4,e(Object(p.e)({items:(A={},A[o.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl})]={views:(O={},O[w]={shouldSaveViewFieldsOnly:!0},O),qosName:"autoSaveModifyColumn"},A)})).then(function(){N||(E.baseViewXml=E.getEffectiveViewXml());k=!0},function(e){d.e.logError(e,{eventName:"ModifyColumn",feature:"ColumnFieldsAutoSave",columnFieldName:x,modifyType:y,errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});throw e})]:[3,2];case 1:D.sent();D.label=2;case 2:L=new c.e;k||L.resolveItems({items:(M={},M[w]=Object(r.__assign)({},f.qt.pack(!0)),M)});L.invalidateItems({items:(_={},_[t]=[l.e],_[w]=[f.y],_)});e(L.execute());D.label=3;case 3:return[2]}})})}})},3657:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(61),i=n(9),s=n(461),o=n(3226);function u(e,t){var n=t.maxLevels,u=[],a=function(t,s){for(var f=0,l=t;f<l.length;f++){var c=l[f];if(("number"!=typeof n||s<n)&&e.demandItemFacet(r.s,c,{suppressGetItems:!0})){var h=e.isItemFacetResolved(i.e,c),p=e.demandItemFacet(r.e,c,{suppressGetItems:!0}),d="number"==typeof p?p:1,v=e.demandItemFacet(o.e,c,{suppressGetItems:!h});if(v)a(v,s+1);else for(var m=0;m<d;m++)u.push(c)}else u.push(c)}};a(t.itemKeys,0);return Object(s.t)(u)}},3869:function(e,t,n){"use strict";n.d(t,"h",function(){return r});n.d(t,"n",function(){return i});n.d(t,"u",function(){return s});n.d(t,"t",function(){return o});n.d(t,"s",function(){return u});n.d(t,"i",function(){return a});n.d(t,"r",function(){return f});n.d(t,"o",function(){return l});n.d(t,"m",function(){return c});n.d(t,"g",function(){return h});n.d(t,"y",function(){return p});n.d(t,"p",function(){return d});n.d(t,"v",function(){return v});n.d(t,"e",function(){return m});n.d(t,"f",function(){return g});n.d(t,"d",function(){return y});n.d(t,"l",function(){return b});n.d(t,"c",function(){return w});n.d(t,"a",function(){return E});var r="new",i="newFolder",s="newWordDocument",o="newExcelWorkbook",u="newPowerPointPresentation",a="newOneNoteNotebook",f="newFormsForExcel",l="newVisioDrawing",c="upload",h="uploadFile",p="uploadFolder",d="open",v="share",m="copyLink",g="download",y="rename",b="copyTo",w="moveTo",E="delete"},3914:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(83),s=n(9),o=n(89),u=n(301),a=n(53),f=n(430),l=n(62);var c=Object(i.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([615],4406)];case 1:return[2,e.sent().SortActionExecutor]}})})},function(e,t){var n=t.sortFieldKey,i=t.itemSetKey,s=t.isAscending,u=e.demandItemFacet(o.e,i);if(!u)return!1;var c=Object(a.e)(e).itemsScopeItemKey;if(!c)return!1;var h=o.e.serialize(Object(r.__assign)(Object(r.__assign)({},u),{sortFieldKey:n,sortAscending:s})),p=e.demandItemFacet(f.e,h),d=f.e.evaluate(p)(e,{itemKey:h,itemsScopeItemKey:c,isAvailable:!0}),v=d.itemKey;if(!d.isAvailable)return!1;var m=e.demandItemFacet(l.n,c),g=m&&m.itemKey;return!!v&&v!==g},function(e,t){var n=t.sortFieldKey,r=t.itemSetKey,i=t.isAscending,a=e.demandItemFacet(o.e,r);if(!a)return!1;var f=e.demandItemFacet(s.u,r),l=f&&e.demandItemFacet(u.e,f.columnKey),c=l&&l.internalName||a.sortFieldKey,h=f?f.isAscending:a.sortAscending;return c===n&&h===i})},3915:function(e,t,n){"use strict";n.d(t,"e",function(){return d});var r=n(0),i=n(49),s=n(24),o=n(89),u=n(278),a=n(1),f=n(806),l=n(3386),c=n(4138),h=n(32),p=!1,d=Object(i.e)(function(e,t){var n=t.itemSetKey,i=t.modifyType,s=t.columnKey,f=!1,c=e.demandItem({setKey:o.e,canModifySchema:a.l},n),d=c.setKey,v=c.canModifySchema,m=d&&d.viewKey?u.e.serialize(d.viewKey):void 0,g=e.demandItem({currentDerivedView:a.y},m).currentDerivedView,y=e.demandItemFacet(a.ke,s);if(d&&v&&g&&g.baseViewXml&&y)if(1===i||2===i){var b=g.getEffectiveFieldNames();if(b&&b.length){var w=b.indexOf(y),E=d.groupByFieldKey?1:0;f=1===i?w>E+1:w>=E&&w<b.length-1}}else f=!0;p=!!d&&Object(l.hasManageListsPermission)(e,{itemSetKey:d});return Object(r.__assign)({isAvailable:f},Object(h.t)(e,{itemKey:n,engagement:{name:"ModifyColumn",isIntentional:!0}}))},function(e,t){var n=t.itemSetKey,i=t.modifyType,s=t.columnKey,o=t.targetIndex,u=p?c.modifyColumnWithProgress:f.e;return{onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,a;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,e(u({items:(t={},t[n]={columnModifyTypeMap:(a={},a[s]={modifyType:i,targetIndex:o},a)},t)}))];case 1:r.sent();return[2]}})})}}})(s.e)},3918:function(e,t,n){"use strict";n.r(t);n.d(t,"CreateViewAction",function(){return E});var r=n(0),i=n("react-lib"),s=n(49),o=n(89),u=n(117),a=n(416),f=n(1),l=n(41),c=n(1191),h=n(32),p=n(20),d=n(24),v=n(84),m=n(53),g=n(497),y=n(25),b=n(546),w=Object(v.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(73,4485)];case 1:return[2,e.sent().FreshViewCreator]}})})}),E=Object(s.t)(function(e,t){var n=t.isEditing,s=t.currentViewKey,v=Object(l.e)(e),E=Object(m.e)(e).itemsScopeItemKey,S=e.demandItemFacet(o.e,v),x=e.demandItemFacet(c.e,v),T=e.demandItemFacet(f.y,s),N=c.e.evaluate(x)(e,{viewKey:s}).onViewSaved;if(!v||!E)return null;var C=!1;if(S&&T){var k=u.e.serialize({webAbsoluteUrl:S.webAbsoluteUrl,listFullUrl:S.listFullUrl}),L=e.demandItemFacet(f.Xe,k);C=!!(L&&T&&T.viewType!==y.n.power&&L.permissions&&(L.permissions.managePersonalViews||L.permissions.manageLists))}var A=S?e.demandItemFacet(f.gn,a.e.serialize({webAbsoluteUrl:S.webAbsoluteUrl,listFullUrl:S.listFullUrl})):void 0,O=Object(b.t)(e,{mapping:{fieldData:f.fe},itemSetKey:v}).map(function(e){return e.fieldData}),M=e.demandItemFacet(f.ge,v),_=Number(null==M?void 0:M.ListTemplateType),D=Object(p.o)(function(e){return i.createElement(g.e,{itemsScopeItemKey:E},i.createElement(w,Object(r.__assign)({},e,t,{pageContext:A,itemSetKey:v,currentViewFields:O,listTemplateType:_,onViewSaved:N})))},{scope:"global"});return i.createElement(d.e,Object(r.__assign)({isAvailable:C,onExecute:D},Object(h.t)(e,{itemKey:v,engagement:{name:n?"EditView":"CreateNewView",isIntentional:!0}})))})},4138:function(e,t,n){"use strict";n.r(t);n.d(t,"modifyColumnWithProgress",function(){return L});var r,i=n(806),s=n(860),o=n(0),u=n(4278),a=n(12),f=n(660),l=n(428),c=n(350),h=n(3219),p=n(102),d=n(9),v=n(66),m=n(293),g=n(23),y=n(14),b=n(518),w=new g.e("modifyColumnProgressItem",{columnKey:y.e,modifyType:b.e,targetIndex:b.e}),E=new m.e("modifyColumnProgress",function(e,t){var n=Object.keys(t.columnModifyTypeMap)[0],r=t.columnModifyTypeMap[n].modifyType,i=t.columnModifyTypeMap[n].targetIndex;return w.serialize({columnKey:n,modifyType:r,targetIndex:i})}),S=n(1),x=((r={})[v.r.started]=u.n,r[v.r.completed]=u.e,r[v.r.failed]=u.t,r),T=Object(a.t)(function(){return function(e){e(Object(f.e)(E,l.e)(N));e(Object(f.e)(E,c.n)(C));e(Object(f.e)(E,h.t)(k))}});function N(e,t){var n,r=t.itemKey,i=t.format,s=Object(p.r)(e,t).phase,u=void 0,a=e.demandItemFacet(d.e,r),f=a&&a.itemKeys;if(f&&f.length>0)n=(u=x)&&u[s];else if("item"===i){var l=e.demandItemFacet(E,r),c=l&&l.taskKey;if(c){var h=e.demandItemFacet(w,c),v=h&&h.columnKey;if(v){n=e.demandItemFacet(S.ke,v)}}}return Object(o.__assign)({},n?{title:n}:{})}function C(e,t){return{reportMode:c.e.pin}}function k(e,t){return{maxChildItemCount:0}}var L=Object(s.e)({operationTypeFacet:i.t,progressKeyFacet:E,initializeBatch:function(){return T}})},4142:function(e,t,n){"use strict";n.d(t,"t",function(){return d});n.d(t,"n",function(){return v});n.d(t,"e",function(){return m});var r,i,s,o=n(0),u=n(25),a=n(434),f=n(440),l=n(195),c=n(279),h={details:"details",compactDetails:"compactDetails",tiles:"tiles"},p=((r={})[h.details]=l.t,r[h.compactDetails]=l.e,r[h.tiles]=c.e,r),d=Object(o.__assign)(Object(o.__assign)({},h),{kanban:"kanban",calendarMonth:"calendarMonth",playlistPlayback:"playlistPlayback"}),v=((i={})[u.n.standard]=[d.details,d.tiles],i[u.n.tiles]=[d.details,d.tiles],i[u.n.compactList]=[d.compactDetails,d.tiles],i[u.n.kanban]=[d.kanban],i[u.n.modernCalendar]=[d.calendarMonth],i[u.n.playlistPlayback]=[d.playlistPlayback],i),m=Object(o.__assign)(Object(o.__assign)({},p),((s={})[d.kanban]=f.e,s[d.calendarMonth]=a.e,s))},4157:function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n("react-lib"),s=n(89),o=n(278),u=n(49),a=n(177),f=n(24),l=n(20),c=n(32),h=n(6),p=new h.e("filterAction",{onFilter:h.t,isAvailable:h.t}),d=n(84),v=Object(d.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([611,"deferred.odsp-common","deferred.odsp-datasources","ondemand.resx-ondemand"],5313)];case 1:return[2,e.sent().FilterPanel]}})})}),m=Object(u.t)(function(e,t){var n=t.columnKey,u=t.itemSetKey,h=t.isToggled,d=e.demandItemFacet(p,u),m=e.demandItemFacet(s.e,u),g=m&&m.viewKey&&o.e.serialize(m.viewKey),y=!!(null==m?void 0:m.searchTerm)||!!(null==m?void 0:m.metadataSearchId),b=p.evaluate(d)(e,{viewKey:g,isAvailable:!(y&&!h)}).isAvailable,w=Object(l.o)(function(e){return i.createElement(v,{onClose:function(){e.reject(new a.e)},onComplete:function(){e.resolve()},columnKey:n,itemSetKey:u})});return i.createElement(f.e,Object(r.__assign)({isAvailable:b,isToggled:h,onExecute:w},Object(c.t)(e,{itemKey:u,engagement:{name:"LaunchFilterPanel",isIntentional:!0}})))})},4185:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(6),i=new r.e("itemAutoRefresh",{isAvailable:r.t,itemSubscriber:r.t})},4192:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(6),i=new r.e("openSyncIssuesAction",{action:r.t,isAvailable:r.t})},4257:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r,i;(function(e){e[e.MalwareDetected=0]="MalwareDetected";e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut";e[e.DLPBlocked=2]="DLPBlocked";e[e.MissingMetaData=3]="MissingMetaData";e[e.DLPWarning=4]="DLPWarning";e[e.AwaitingApproval=5]="AwaitingApproval";e[e.Trending=6]="Trending";e[e.New=7]="New";e[e.NeedsRepublishing=8]="NeedsRepublishing"})(r||(r={}));(function(e){e[e.Mail=0]="Mail";e[e.CalendarEvent=1]="CalendarEvent";e[e.Teams=2]="Teams"})(i||(i={}))},4260:function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n("react-lib"),s=n(49),o=n(32),u=n(24),a=n(15),f=n(217),l=n(231),c=n(3027),h=n(108),p=n(3028),d=function(e){var t=e.undoRedoActionType,n=e.dispatch,s=e.isAvailable,o=i.useState(0),a=o[0],f=o[1],l=i.useState(0),d=l[0],v=l[1],m=i.useRef(new h.e({})),g=s&&("undo"===t&&a>0||"redo"===t&&d>0);i.useEffect(function(){var e=n(c.e);m.current.on(e,p.e.undoRealCmdCountChangeEventName,function(e){f(e.undoRealCmdCount)});m.current.on(e,p.e.redoRealCmdCountChangeEventName,function(e){v(e.redoRealCmdCount)});return function(){m.current.dispose()}},[]);return i.createElement(u.e,Object(r.__assign)({},e,{isAvailable:g}))},v=Object(s.t)(function(e,t){var n=t.itemKey,s=t.undoRedoActionType,u="undo"===s,a=Object(f.e)(e)===l.e,v=e.dispatch;return i.createElement(d,Object(r.__assign)({undoRedoActionType:s,dispatch:v,isAvailable:a,onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){e=v(c.e);h.e.raise(e,u?p.e.undoChangeEventName:p.e.redoChangeEventName);return[2]})})}},Object(o.t)(e,{itemKey:n,engagement:{name:u?"QuickEditUndoAction":"QuickEditRedoAction",isIntentional:!0}})))}),m=Object(a.n)()(v)},4261:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n("react-lib"),s=n(24),o=n(49),u=Object(o.t)(function(e,t){return i.createElement(s.e,{onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(n){e=null;t.selector?e=document.querySelector(t.selector):t.elementId&&(e=document.getElementById(t.elementId));if(e){e.focus();t.shouldClick&&e.click&&e.click()}return[2]})})},engagement:{name:"SetFocus",isIntentional:!0}})})},4263:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n("react-lib"),i=n(58),s=n(71),o=n(4265),u={key:n(4264).e,automationId:"launchMovePickerCommand",name:i.g,ariaLabel:i.g,action:r.createElement(s.t,null,r.createElement(o.t,null)),iconProps:{iconName:"FabricMoveToFolder"}}},4264:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(90),i=Object(r.e)("launchMovePickerCommand")},4265:function(e,t,n){"use strict";n.d(t,"t",function(){return g});n.d(t,"e",function(){return y});var r=n(0),i=n("react-lib"),s=n(15),o=n(24),u=n(20),a=n(49),f=n(153),l=n(73),c=n(84),h=n(32),p=n(978),d=Object(l.e)()(Object(c.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(4,4924)];case 1:return[2,e.sent().LaunchMoveCopyPickerWizard]}})})})),v=Object(a.t)(function(e,t){var n=t.itemKeys,s=t.isMove,a=void 0!==s&&s;if(0===n.length)return null;var l=Object(f.e)(e);if(!l)return null;var c=e.demandItemFacet(p.e,n[0]),v=p.e.evaluate(c)(e,{entryItemKey:l,sourceItemKeys:n,isMove:a,isAvailable:!1,moveCopyPickerWizard:d}),m=v.isAvailable,g=v.moveCopyPickerWizard;if(!m||!g)return null;var y=Object(u.o)(function(e){return i.createElement(g,Object(r.__assign)({isMove:a,entryItemKey:l,sourceItemKeys:n},e))},{scope:"global"});return i.createElement(o.e,Object(r.__assign)({onExecute:y},Object(h.t)(e,{itemKey:n[0],engagement:{name:a?"MoveTo":"CopyTo"}})))}),m=Object(s.s)()(v),g=Object(a.e)(function(){return{isMove:!0}})(m),y=Object(a.e)(function(){return{isMove:!1}})(m)},4266:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n("react-lib"),i=n(58),s=n(71),o=n(4265),u={key:n(4267).e,automationId:"launchCopyPickerCommand",name:i.t,ariaLabel:i.t,action:r.createElement(s.t,null,r.createElement(o.e,null)),iconProps:{iconName:"Copy"}}},4267:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(90),i=Object(r.e)("launchCopyPickerCommand")},4277:function(e,t,n){"use strict";n.r(t);n.d(t,"GroupByActionExecutor",function(){return y});var r=n(0),i=n("react-lib"),s=n(89),o=n(40),u=n(278),a=n(24),f=n(9),l=n(1),c=n(275),h=n(20),p=n(32),d=n(49),v=n(240),m=n(236),g=n(2362),y=Object(d.t)(function(e,t){var n=t.groupByFieldKey,d=t.itemSetKey,y=e.demandItemFacet(s.e,d);if(!y)return i.createElement(h.n,null);var b=e.demandItemFacet(l.E,d),w=!y.groupByFieldKey&&!!b&&-1!==b.indexOf(n),E=y.groupByFieldKey===n||w,S=s.e.serialize(Object(r.__assign)(Object(r.__assign)({},y),{groupByFieldKey:E?void 0:n})),x=o.e.serialize(y),T=y.viewKey&&u.e.serialize(y.viewKey),N=e.demandItemFacet(l.y,T),C=Object(p.t)(e,{itemKey:d,engagement:{name:"GroupBy",isIntentional:!0}}),k=e.dispatch,L=Object(v.r)(e,i.createElement(c.e,{itemKey:S}));return i.createElement(h.n,{action:L},function(e){var t=e.execute,s=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,o,u,a,c,h,p,d;return Object(r.__generator)(this,function(v){switch(v.label){case 0:i=new m.e({publisher:s});if(T&&w&&N&&(o=N.getDomParts())&&o.groupBy){u=Object(g.n)(o.groupBy);a=void 0;u.group1.fieldName===n?u.group2&&(a={isCollapsed:u.isCollapsed,group1:u.group2}):(null===(d=u.group2)||void 0===d?void 0:d.fieldName)===n&&(a={isCollapsed:u.isCollapsed,group1:u.group1});N.updateGroupBy(a);i.invalidateItems({items:(c={},c[S]=[f.e],c[T]=[l.y],c)})}i.resolveItems({items:Object(r.__assign)((h={},h[S]=Object(r.__assign)({},f.s.pack({itemKey:x})),h),T?(p={},p[T]=Object(r.__assign)({},l.qt.pack(!0)),p):{})});k(i.execute());return[4,t(e)];case 1:v.sent();return[2]}})})};return i.createElement(a.e,Object(r.__assign)({onExecute:s},C))})})},4280:function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"n",function(){return i});n.d(t,"r",function(){return s});n.d(t,"i",function(){return o});n.d(t,"s",function(){return u});n.d(t,"e",function(){return a});var r="socialBarList_36611a00",i="socialBarPanel_36611a00",s="socialBarPanelContent_36611a00",o="socialBarPanelPersona_36611a00",u="socialBarPanelPersonaDescription_36611a00",a="analyticsStatsLink_36611a00"},4511:function(e,t,n){"use strict";n.d(t,"e",function(){return h});var r=n(12),i=n(660),s=n(40),o=n(0),u=n("react-lib"),a=n(84),f=Object(a.e)(function(){return Object(o.__awaiter)(void 0,void 0,void 0,function(){return Object(o.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([42,"deferred.odsp-datasources","ondemand.resx-ondemand"],3727)];case 1:return[2,e.sent().PropertiesForm]}})})});function l(e,t){return{getPropertiesForm:function(e){return u.createElement(f,Object(o.__assign)({},e))}}}var c=n(1188),h=Object(r.t)(function(){return function(e){e(Object(i.e)(s.e,c.e)(l))}})},4517:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n("react-lib"),s=n(2007),o=n(3303),u=n(2646),a=n(2033),f=n(490),l=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onClose=function(){n.setState({isOpen:!1})};n._iframeOnLoad=function(){var e=n.props.heightOffset;if(n._iframeElement&&n._iframeElement.contentDocument){var t=n._iframeElement.contentDocument.body.clientHeight;t<=0&&e&&(t=document.body.clientHeight*e);n._iframeElement.style.height=t+"px"}n.setState({isIFrameLoaded:!0});n.props.onLoad&&n._iframeElement&&n.props.onLoad(n._iframeElement)};n.state={isOpen:!0,isIFrameLoaded:!1};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({isIFrameLoaded:!1})};t.prototype.render=function(){var e=this,t=this.props,n=t.url,l=(t.heightOffset,Object(r.__rest)(t,["url","heightOffset"])),c=this.state.isIFrameLoaded;return i.createElement(o.e,Object(r.__assign)({className:"IFrameDialog_d45656a1",hidden:!this.state.isOpen,type:u.e.close},l),i.createElement(s.e,null,!c&&i.createElement(a.e,{size:f.e.large}),i.createElement("iframe",{ref:function(t){return e._setupIFrameElementFunctions(t)},src:n,style:{display:c?"block":"none"},onLoad:this._iframeOnLoad})))};t.prototype._setupIFrameElementFunctions=function(e){if(e){var t=e;t.cancelPopUp=this._onClose;t.commitPopup=this._onClose}this._iframeElement=e};return t})(i.Component)},4662:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(83),s=n(15),o=n(357);var u=Object(s.s)()(Object(s.r)()(Object(i.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([35],3868)];case 1:return[2,e.sent().GoToChannelAction]}})})},function(e,t){var n=t.itemKey;return!!e.demandItemFacet(o.e,n)})))},4664:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n("react-lib"),i=n(303),s=n(2),o=n(4261),u={key:new s.e("GetNPSSurveyFocusShortcut").id,automationId:"GetNPSSurveyFocusShortcut",shortcutProps:{keySequences:["AltDown"],content:i.o},action:r.createElement(o.e,{elementId:"obf-TPromptContainer"})}},4921:function(e,t,n){"use strict";n.r(t);n.d(t,"OpenAsHyperLinkExecutor",function(){return u});n.d(t,"OpenAsShortcutExecutor",function(){return a});n.d(t,"NewItemInOfficeClientAction",function(){return f.t});n.d(t,"ItemOpenInOfficeClientAction",function(){return f.e});n.d(t,"OpenInOfficeClientAction",function(){return f.n});n.d(t,"ItemOpenInOfficeOnlineAction",function(){return l.e});n.d(t,"OpenInOfficeOnlineAction",function(){return l.t});n.d(t,"OpenInBFileAction",function(){return x});n.d(t,"ItemSwitchViewAction",function(){return T.ItemSwitchViewAction});n.d(t,"SwitchViewExecutor",function(){return T.SwitchViewExecutor});n.d(t,"SetDefaultViewAction",function(){return N.e});n.d(t,"ViewCreator",function(){return le});n.d(t,"LaunchFilterPanelAction",function(){return he.e});n.d(t,"SortAction",function(){return pe.e});n.d(t,"GroupByAction",function(){return be});n.d(t,"GroupByActionExecutor",function(){return we.GroupByActionExecutor});n.d(t,"ModifyColumnAction",function(){return Ee.e});n.d(t,"ModifyColumnAggregateTypeAction",function(){return Te});n.d(t,"ApproveRejectAction",function(){return Ne.e});n.d(t,"ItemFileHandlerOpenAction",function(){return Ce.t});n.d(t,"FileHandlerOpenAction",function(){return Ce.e});var r,i=n(0),s=n("react-lib"),o=n(4517),u=(function(e){Object(i.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onDismiss=function(){t.props.resolve()};return t}t.prototype.render=function(){var e=this.props,t=e.title,n=e.linkLocation,r=e.launchBehaviorType;if(n&&void 0!==r){if("dialog"===r)return s.createElement(o.e,{url:n,heightOffset:.7,dialogContentProps:{title:t},onDismiss:this._onDismiss});"inPageNavigation"===r?window.open(n,"_self"):window.open(n,"_blank")}this.props.resolve();return null};return t})(s.PureComponent),a=(function(e){Object(i.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.targetUrl;e&&window.open(e,"_blank");this.props.resolve();return null};return t})(s.PureComponent),f=n(972),l=n(982),c=n(49),h=n(24),p=n(32),d=n(40),v=n(117),m=n(1),g=n(624),y=n(5),b=n(1011),w=n(99),E=n(19),S=n(44),x=Object(c.e)(function(e,t){var n=t.itemKey,r=e.demandItem({key:d.e,itemUrl:y.q,driveItem:w.e,fileName:y.d},n),s=r.key,o=r.itemUrl,u=r.driveItem,a=r.fileName,f=Object(S.e)(e,n),l="",c="",h="",x=!1;if(E.t.isActivated("3deefa50-273b-494f-81c7-72a6f9f4876a","09/21/2021","Use drive item to get driveId and itemId")&&s&&o){var T=v.e.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}),N=e.demandItem({driveUrl:m.N},T).driveUrl;if(N){var C=Object(g.e)(N);if(C){l=C.driveId||"";if(a){h=a.extension;(C=Object(g.e)(o))&&(x=!!(c=C.itemId||""))}}}}else if(u){l=u.driveId||"";x=!!(c=u.itemId||"");h=(null==a?void 0:a.extension)||""}var k,L=s?Object(b.e)("spo:".concat(s.webAbsoluteUrl)):void 0,A=encodeURIComponent(null!=L?L:""),O=encodeURIComponent(l),M=encodeURIComponent(c),_=h.toLowerCase();if(".note"===_)k="https://www.onenote.com/notes/".concat(A,"/").concat(O,"/").concat(M);else if(".whiteboard"===_)if(!E.t.isActivated("A1AE7AB1-F5D8-49BE-AB01-4CC90527BADD","09/12/2021","Whiteboard GCCH support")&&f){var D="https://whiteboard.office.com";"gcch"===(null==f?void 0:f.cloudType)?D="https://whiteboard.office365.us":"dod"===(null==f?void 0:f.cloudType)&&(D="https://whiteboard.apps.mil");k="".concat(D,"/me/whiteboards/p/").concat(A,"/").concat(O,"/").concat(M)}else k="https://whiteboard.office.com/me/whiteboards/p/".concat(A,"/").concat(O,"/").concat(M);else{var P=e.demandItemFacet(y.i,n)||"",H=s?s.webAbsoluteUrl:"";k="https://www.office.com/launch/fluid/content?drive=".concat(l,"&item=").concat(c,"&file=").concat(encodeURIComponent(P),"&siteUrl=").concat(encodeURIComponent(H))}return Object(i.__assign)({isAvailable:x,onExecute:x?function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){window.open(k);return[2]})})}:void 0},Object(p.t)(e,{itemKey:n,engagement:{name:"OpenInBFile",isIntentional:!0}}))})(h.e),T=n(1858),N=n(1465),C=n(1559),k=n(177),L=n(1393),A=n(3684),O=n(18),M=n(415),_=n(126),D=n(256),P=n(89),H=n(278),B=n(84),j=n(120),F=n(206),I=n(53),q=n(9),R=n(1270),U=n(860),z=n(12),W=n(660),X=n(350),V=n(428),$=n(102),J=n(66),K=new(n(293).e)("saveView",function(e,t){return Object.keys(t.views)[0]}),Q=((r={})[J.r.started]=A.a,r[J.r.completed]=A.o,r[J.r.failed]=A.u,r),G=Object(z.t)(function(){return function(e){e(Object(W.e)(K,V.e)(Y));e(Object(W.e)(K,X.n)(Z))}});function Y(e,t){var n,r=t.itemKey,s=t.format,o=Object($.r)(e,t).phase,u=void 0,a=e.demandItemFacet(q.e,r),f=a&&a.itemKeys;if(f&&f.length>0)n=(u=Q)&&u[o];else if("item"===s){var l=e.demandItemFacet(K,r),c=l&&l.taskKey;if(c){var h=e.demandItemFacet(m.y,c);n=h&&h.title}}return Object(i.__assign)({},n?{title:n}:{})}function Z(e,t){return{reportMode:X.e.pin}}var ee=Object(U.e)({operationTypeFacet:R.t,progressKeyFacet:K,initializeBatch:function(){return G}}),te=n(1793),ne=n(236),re=n(703),ie=E.e.isActivated("85744AA0-6A45-4990-B676-3C17E1529B4C","06/21/2022","Do not return AutoSwitchViewAction in save view scenario"),se=new M.e("saveViewProgressBatch"),oe=Object(B.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([33,"ondemand.resx-ondemand"],5457)];case 1:return[2,e.sent().SaveViewDialog]}})})});function ue(){return se.serializeNext()}var ae=Object(D.t)()(T.SwitchViewExecutor);function fe(e){var t=this,n=e.viewTitle,r=e.isPublicView,o=e.onViewSaved,u=e.currentViewKey,a=e.itemSetKey,f=e.itemsScopeItemKey,l=e.listViewSetKey,c=e.reject,h=e.resolve,p=e.currentDerivedView,d=e.saveViewOperation,v=s.useState(!0),m=v[0],g=v[1],y=s.useState(ue)[0],b=s.useState(),w=b[0],E=b[1],S=s.useState(),x=S[0],T=S[1],N=Object(F.t)(),M=Object(j.e)(function(){T(!0);o&&o();h()}),D=Object(j.e)(function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,n,r,s,o,h,v,m,b;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e.viewTitle,n=e.isPublicView;r=p&&p.title!==t;s=N(Object(_.e)({deserializedSetKey:P.e},a)).deserializedSetKey;if(!(r&&s&&p))return[3,3];if(!(o=t.trim()))throw new Error(A.e);return[4,N(Object(L.t)({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}))];case 1:if(i.sent().some(function(e){return e.serverView.Title===t}))throw new Error(O.format(A.r,t));return[4,N(Object(C.e)({items:(m={},m[l]={views:(b={},b[o]={itemSetKey:a,isPublic:n,sourceView:p,progressItemKey:y},b)},m)}))];case 2:i.sent();if(h=N(Object(_.e)({createdViewKey:H.e},y)).createdViewKey){E(h.viewId);g(!1)}return[3,5];case 3:if(!f){c(new Error("Cannot save a view without a current ItemsScope"));return[2]}return[4,N(ce({itemsScopeItemKey:f,listViewSetKey:l,itemSetKey:a,currentViewKey:u,saveViewOperation:d}))];case 4:i.sent();if(v=N(Object(_.e)({savedViewKey:H.e},u)).savedViewKey){E(v.viewId);g(!1);ie||M()}i.label=5;case 5:return[2]}})})}),B=Object(j.e)(function(){c(new k.e)});return m?s.createElement(oe,{viewTitle:n,isPublicView:r,onContinue:D,onCancel:B}):!x&&w?s.createElement(ae,{viewId:w,currentDerivedView:p,onComplete:M,itemSetKey:a}):null}var le=Object(c.t)(function(e,t){var n=Object(I.e)(e).itemsScopeItemKey,r=Object(S.e)(e,t.itemSetKey),o=!!r&&Object(E.n)(r).isActivated("49F1ADD5-332D-4BAF-A4F9-FBEA104C76BE","01/20/21","Use saveViewWithProgress operation"),u=e.demandItemFacet(m.y,t.currentViewKey),a=o?R.e:ee;return s.createElement(fe,Object(i.__assign)({},t,{itemsScopeItemKey:n,currentDerivedView:u,saveViewOperation:a}))});function ce(e){return function(t){var n,r,s=e.listViewSetKey,o=e.itemSetKey,u=e.currentViewKey,a=e.saveViewOperation,f=t(Object(_.e)({childItems:q.e,parentItem:q.s,deserializedItemSetKey:P.e},o)),l=f.childItems,c=f.parentItem,h=f.deserializedItemSetKey;return t(a({items:(n={},n[s]={views:(r={},r[u]={itemSetKey:o},r)},n)})).then(function(){var e,n;if(h){var r=P.e.serialize(Object(i.__assign)(Object(i.__assign)({},h),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0})),s=t(Object(_.e)({filterOptionSets:q.n},r)).filterOptionSets;if(s&&h.filterParams){var o={};for(var a in s)s.hasOwnProperty(a)&&(o[s[a]]=!0);t(Object(te.e)({items:o}))}var f=new ne.e({publisher:ce});f.resolveItems({items:(e={},e[r]=Object(i.__assign)(Object(i.__assign)({},l?q.e.pack(l):{}),c?q.s.pack(c):{}),e[u]=Object(i.__assign)({},m.qt.pack(!1)),e)});t(f.execute());t(Object(re.e)({items:(n={},n[u]=[m.jt,m.y],n[r]=[q.e],n)}))}})}}var he=n(4157),pe=n(3914),de=n(83),ve=n(6),me=new ve.e("groupByAction",{groupedItemSetKey:ve.t,isAvailable:ve.t,onGroupBy:ve.t}),ge=n(10),ye=n(30);var be=Object(de.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(0,4277)];case 1:return[2,e.sent().GroupByActionExecutor]}})})},function(e,t){var n=t.groupByFieldKey,r=t.itemSetKey,s=e.demandItemFacet(P.e,r);if(!s)return!1;var o=v.e.serialize(s),u=e.demandItemFacet(m.Xe,o),a=u&&u.templateType===ge.n.mySiteDocumentLibrary,f=Object(ye.e)(e,{enableGroupByInOneDrive:m.j}).enableGroupByInOneDrive,l=e.demandItemFacet(m.E,r),c=s.groupByFieldKey===n||!!l&&-1!==l.indexOf(n),h=P.e.serialize(Object(i.__assign)(Object(i.__assign)({},s),{groupByFieldKey:c?void 0:n})),p=s.viewKey&&H.e.serialize(s.viewKey),d=e.demandItemFacet(me,r);return me.evaluate(d)(e,{itemSetKey:r,viewKey:p,groupedItemSetKey:h,isAvailable:!a||!!f}).isAvailable},function(e,t){var n=t.groupByFieldKey,r=t.itemSetKey,i=e.demandItemFacet(P.e,r);if(!i)return!1;var s=e.demandItemFacet(m.E,r);return i.groupByFieldKey===n||!!s&&-1!==s.indexOf(n)}),we=n(4277),Ee=n(3915),Se=n(1563),xe=n(332),Te=Object(c.e)(function(e,t){var n=t.itemSetKey,r=t.columnKey,s=t.aggregateType,o=e.demandItemFacet(m.p,n),u=o&&o[r]&&o[r].aggregateFunctionType||xe.t[xe.e.NONE],a=u===xe.t[s]?void 0:xe.t[s];return Object(i.__assign)({isAvailable:!0,isToggled:u===xe.t[s]},a?Object(p.t)(e,{itemKey:n,engagement:{isIntentional:!0,action:"ModifyColumnAggregateType",name:a||"AggregateTypeNone",extraData:{PreviousAggregateType:u||"AggregateTypeNone",component:"ColumnContextMenu"}}}):{})},function(e,t){var n=t.itemSetKey,r=t.columnKey,s=t.aggregateType;return{onExecute:function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var t;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(Se.e)({items:(t={},t[n]={aggregateType:s,columnKey:r},t)}))];case 1:i.sent();return[2]}})})}}})(h.e),Ne=n(1189),Ce=n(1190)},4960:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n("react-lib"),i=n(4260),s=n(47),o=n(90),u={key:Object(o.e)("quickEditUndo"),automationId:"quickEditUndoCommand",name:s.he,iconProps:{iconName:"Undo"},isPermanent:!0,action:r.createElement(i.e,{undoRedoActionType:"undo"})}},4961:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n("react-lib"),i=n(47),s=n(90),o=Object(s.e)("quickEditRedo"),u=n(4260),a={key:o,automationId:"quickEditRedoCommand",name:i.ce,iconProps:{iconName:"Redo"},action:r.createElement(u.e,{undoRedoActionType:"redo"})}},4974:function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n("react-lib"),s=n(1814),o=n(5042),u=n(20),a=n(15),f=n(24),l=n(84),c=n(32),h=n(49),p=Object(l.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([85,"ondemand.resx-ondemand"],5192)];case 1:return[2,e.sent().default]}})})}),d=Object(h.t)(function(e,t){var n=t.itemKey,s=Object(u.o)(function(e){return i.createElement(p,Object(r.__assign)({},e,{itemKey:n}))},{scope:"global"});return i.createElement(f.e,Object(r.__assign)({onExecute:s},Object(c.t)(e,{itemKey:n,engagement:{name:"SocialBar",isIntentional:!0}})))}),v=(Object(a.i)()(d),n(4280)),m=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.likeLabel,n=e.itemKey,r=i.createElement(o.e,{activityDescription:t,isCompact:!0});return i.createElement(u.n,{action:i.createElement(d,{itemKey:n})},function(e){var t=e.isAvailable,n=e.execute,o=t?function(){n().catch(function(){})}:void 0;return i.createElement(s.e,{disabled:!1,className:v.e,onClick:o},r)})};return t})(i.Component)},5015:function(e,t,n){"use strict";n.r(t);n.d(t,"ItemAutoRefresh",function(){return o});n.d(t,"CurrentItemAutoRefresh",function(){return u});var r=n(15),i=n(49),s=n(4185),o=Object(i.t)(function(e,t){var n=t.itemKey,r=e.demandItemFacet(s.e,n),i=s.e.evaluate(r)(e,{itemKey:n,itemSubscriber:null,isAvailable:!0}),o=i.isAvailable,u=i.itemSubscriber,a=void 0===u?null:u;return o&&a||null}),u=Object(r.n)()(o)},5291:function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointAddonAutoRefresh",function(){return Ne});var r,i=n(12),s=n(660),o=n(89),u=n(4185),a=n(0),f=n("react-lib"),l=n(378),c=n(30),h=n(9),p=n(5),d=n(236),v=n(172),m=n(199),g=n(19),y=n(1453),b=n(4268),w=n(599),E=n(88),S=n(63);(function(e){e[e.New=0]="New";e[e.Update=1]="Update";e[e.Delete=2]="Delete"})(r||(r={}));var x={ODB:459},T=(function(){function e(e){var t=this;this.subscribe=function(){t._log("Subscribe");if(0===t._subscribers){t._async=new v.e;g.t.isActivated("90f6bcb1-03a0-4a02-9370-1e6807d6763a","7/22/2021","Fix Item Auto Refresh Bug")||(t._syncToken="latest");var e=t._async.debounce(function(){return t._onNotification()},1e4,{leading:!0,maxWait:1e4});t._pushChannelService.setupNotificationHandler({source:b.t.WebhookSubscription},function(){t._log("PushChannelMessageSource",b.t.WebhookSubscription);e()});t._pushChannelService.setupNotificationHandler({source:b.t.EventHub},function(){t._log("PushChannelMessageSource",b.t.EventHub);e()});t._pushChannelService.addConnectionHandler(t._id,function(e){return t._onPushChannelConnection(e)})}t._subscribers++;t._pushChannelService.isConnected()||t._pushChannelService.connect(t._getNotification(),{methodInvoker:"ItemAutoRefreshHelper.subscribe"});return t._unsubscribe.bind(t)};this._id=e.id;this._driveUrlParts=e.driveUrl?Object(y.e)(e.driveUrl):void 0;this._dispatch=e.dispatch;this._template=e.template;this._itemScopeItemKey=e.itemsScopeItemKey||"";this._pushChannelService=e.pushChannelService;this._onUnsubscribe=e.onUnsubscribe;this._isTestMode=e.isTestMode;this._onPushChannelConnected=e.onPushChannelConnected;this._onNotificationReceived=e.onNotificationReceived;this._subscribers=0;this._syncToken="latest";this._getChangesAttempts=0}e.prototype._unsubscribe=function(){this._log("Unsubscribe");this._subscribers--;this._template.onUnsubscribe(this._subscribers);if(0===this._subscribers){if(this._async){this._async.dispose();this._async=void 0;this._refreshSubscriptionTimeoutId=void 0}this._pushChannelService.setupNotificationHandler({source:b.t.WebhookSubscription},function(){});this._pushChannelService.removeConnectionHandler(this._id);this._pushChannelService.disconnect()}this._onUnsubscribe(this._subscribers);return this._subscribers};e.prototype._onPushChannelConnection=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(a.__generator)(this,function(r){switch(r.label){case 0:if(!e){this._log("Disconnected");this._clearRefreshSubscriptionTimeout();return[2]}this._log("Connected");this._isTestMode&&this._onPushChannelConnected&&this._onPushChannelConnected();if(g.t.isActivated("90f6bcb1-03a0-4a02-9370-1e6807d6763a","7/22/2021","Fix Item Auto Refresh Bug"))return[3,5];r.label=1;case 1:r.trys.push([1,3,,4]);return[4,this._resolveChangeMessages()];case 2:r.sent();return[3,4];case 3:t=r.sent();this._handleError(t);return[2];case 4:return[3,9];case 5:if("latest"!==this._syncToken)return[3,9];r.label=6;case 6:r.trys.push([6,8,,9]);return[4,this._getChangeMessages()];case 7:r.sent();return[3,9];case 8:n=r.sent();this._handleError(n);return[2];case 9:this._refreshSubscriptionHandler();return[2]}})})};e.prototype._handleError=function(e){var t=this;this._getChangesAttempts++;if(!(this._getChangesAttempts>10)){var n=!1;if(Object(w.s)(e))switch(e.status){case 404:case 410:n=!0;this._syncToken="latest"}n&&this._async&&this._async.setTimeout(function(){return t._onPushChannelConnection(t._pushChannelService.isConnected())},500+Math.pow(2,this._getChangesAttempts))}};e.prototype._getNotification=function(){return this._template.getSubscription&&this._template.getSubscription(this._dispatch)};e.prototype._refreshSubscriptionHandler=function(){var e=this;if(this._async){var t=this._pushChannelService.getSocketIoSubscription();if(t){var n=105001*Math.random()+15e3,r=Date.parse(t.expirationDateTime),i=Date.now(),s=r-i-n;if(s<12e4){if(m.e.isFeatureEnabled(x)){var o={refreshDelay:s,expirationDateTime:t.expirationDateTime,expirationDateTimeinMS:r,dateTimeNow:i,recreateBufferRandom:n};new E.e({name:"ItemAutoRefreshHelper.refreshSubscription",extraData:o}).end({resultType:S.e.Failure,extraData:o})}s=12e4}this._clearRefreshSubscriptionTimeout();this._refreshSubscriptionTimeoutId=this._async.setTimeout(function(){return Object(a.__awaiter)(e,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:this._log("Refreshing subscription");this._refreshSubscriptionTimeoutId=void 0;return[4,this._pushChannelService.refreshSubscription()];case 1:!0===e.sent()&&this._refreshSubscriptionHandler();return[2]}})})},s)}}};e.prototype._clearRefreshSubscriptionTimeout=function(){if(this._async&&void 0!==this._refreshSubscriptionTimeoutId){this._async.clearTimeout(this._refreshSubscriptionTimeoutId);this._refreshSubscriptionTimeoutId=void 0}};e.prototype._getChangeMessages=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,this._template.getChangeMessages(this._dispatch,this._syncToken,this._driveUrlParts)];case 1:e=t.sent();this._syncToken=e.syncToken?e.syncToken:"latest";this._getChangesAttempts=0;return[2,e]}})})};e.prototype._onNotification=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);if(this._template.hasPendingRequest())return[2];this._isTestMode&&this._onNotificationReceived&&this._onNotificationReceived();return[4,this._resolveChangeMessages()];case 1:t.sent();return[3,3];case 2:e=t.sent();this._log("onNotification error",e);return[3,3];case 3:return[2]}})})};e.prototype._resolveChangeMessages=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,i,s,o,u,f,l,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:t=new d.e({publisher:e});return[4,this._getChangeMessages()];case 1:n=a.sent();this._log("Change messages",n);i=this._processMessages(n.messages);this._log("Changes",i);t.merge(n.itemResolver);for(s=0,o=i;s<o.length;s++)switch((u=o[s]).type){case r.New:t.invalidateItems({items:(f={},f[u.invalidateKey]=[h.t],f)});break;case r.Update:u.hasSelection&&this._itemScopeItemKey?this._updateItems(u.invalidateKey):t.invalidateItems({items:(l={},l[u.invalidateKey]=[u.invalidateFacet],l)});break;case r.Delete:t.invalidateItems({items:(c={},c[u.invalidateKey]=[p.l],c)})}this._dispatch(t.execute());return[2]}})})};e.prototype._processMessages=function(e){var t=[];e.sort(function(e,t){return e.parentItemKey?0:1});for(var n=0;n<e.length;n++){var r=e[n],i=this._template.processMessage(this._dispatch,r,this._itemScopeItemKey);if(void 0!==i){this._log("Change",i.invalidateKey,i.reason);t.push(i)}else if(r.parentItemKey)for(var s=n+1;s<e.length;s++){if(e[s].itemKey===r.parentItemKey){e.splice(s,1);break}}}return t};e.prototype._updateItems=function(e){this._template.updateItems(this._dispatch,e)};e.prototype._log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];0};return e})(),N=n(777),C=n(927),k=n(85),L=n(4669),A=n(4665),O=n(10),M=n(237),_=n(54),D=n(1),P=n(40),H=n(416),B=n(117),j=n(126),F=n(112),I=n(192),q=n(99),R=n(624),U=n(778),z=n(1672),W=n(70),X=(function(){function e(e){this._dataRequestor=e.dataRequestor;this._rootItemKey=e.rootItemKey;this._pendingRequest=!1}e.prototype.onUnsubscribe=function(e){};e.prototype.getSubscription=function(e){var t=this,n=e(Object(F.e)(function(e){return{spItem:e.demandItemFacet(P.e,t._rootItemKey)}})).spItem;if((null==n?void 0:n.webAbsoluteUrl)&&n.listFullUrl){var r=B.e.serialize({webAbsoluteUrl:null==n?void 0:n.webAbsoluteUrl,listFullUrl:null==n?void 0:n.listFullUrl}),i=e(Object(F.e)(function(e){return e.demandItemFacet(D.Ge,r)}));if((null==i?void 0:i.notificationUrl)&&(null==i?void 0:i.expirationDateTime)&&(null==i?void 0:i.subscribeID))return{notificationUrl:null==i?void 0:i.notificationUrl,expirationDateTime:null==i?void 0:i.expirationDateTime,id:null==i?void 0:i.subscribeID}}};e.prototype.hasPendingRequest=function(){return this._pendingRequest};e.prototype.getChangeMessages=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,i,s,o,u,f,l,c,h,p,v,m,y,b,w,E,S,x,T,N,L,A,O,M,_,H,X,V,$,J,K,Q=this;return Object(a.__generator)(this,function(G){switch(G.label){case 0:if(void 0===n||void 0===n.endpoint||void 0===n.driveId)throw"Invalid drive url parts";r="".concat(n.endpoint,"/drives/").concat(n.driveId);i=e(Object(I.e)({isTAB:k.k})).isTAB;s=e(Object(F.e)(function(e){return{spItem:e.demandItemFacet(P.e,Q._rootItemKey)}})).spItem;o=new d.e;if("latest"===t&&s){u=B.e.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl});f=e(Object(F.e)(function(e){return e.demandItemFacet(D.Xe,u)}));if(l=null==f?void 0:f.tick){c=l-621355968e9;c/=1e4;h=new Date(c);if(!g.t.isActivated("90f6bcb1-03a0-4a02-9370-1e6807d6763a","7/22/2021","Fix Item Auto Refresh Bug")){t="".concat(h.toISOString());p=new Date;if((p.getTime()-h.getTime())/1e3<30)return[2,{syncToken:t,messages:[],itemResolver:o}]}return[2,{syncToken:"".concat(h.toISOString()),messages:[],itemResolver:o}]}}return(y=n.endpoint)?[4,e(Object(C.getSessionToken)({endpoint:n.endpoint,driveUrl:r}))]:[3,2];case 1:y=G.sent();G.label=2;case 2:if(void 0===(v=(m=y)&&m.accessToken))throw new W.e({code:"authFailure"});this._pendingRequest=!0;b="".concat(r,"/root/view.delta?token=").concat(encodeURIComponent(t));return[4,this._dataRequestor.send({apiName:"viewDelta",path:b,accessToken:{accessToken:v,tokenUrl:r},useAuthorizationHeaders:!0,headers:Object(a.__assign)({"X-RestrictedReadCapabilities":"ForceCheckOut,RequiredColumn,ContentApproval,Irm,ExcludeFromOfflineClient,DocumentParser,DraftItemSecurity,ItemLevelPermissions"},i?{}:{ScenarioType:"BGO"})})];case 3:w=G.sent();E=[];if(w&&w.value)for(S=0,x=w.value;S<x.length;S++){T=x[S];N=void 0;L={endpoint:n.endpoint,driveId:n.driveId,itemId:T.id};if(T.root){H=Object(R.t)(L);for(A=0,O=H;A<O.length;A++){$=O[A];o.mapKeys({mappings:(J={},J[$]=this._rootItemKey,J)})}}else if(T.webUrl&&(M=Object(U.n)(T.webUrl))){_=z.e.serialize({itemFullUrl:M});if(e(Object(j.e)({spItemKey:P.e},_)).spItemKey){H=Object(R.t)(L);for(X=0,V=H;X<V.length;X++){$=V[X];o.mapKeys({mappings:(K={},K[$]=_,K)})}}}if(!T.root){T.parentReference&&(N=T.parentReference.id);E.push({itemKey:q.e.serialize(L),parentItemKey:N&&q.e.serialize({endpoint:n.endpoint,driveId:n.driveId,itemId:N}),isDeleted:!!T.deleted,isShared:!!T.shared,name:T.name,dateModified:T.lastModifiedDateTime,eTag:T.eTag})}}this._pendingRequest=!1;return[2,{syncToken:w["@delta.token"],messages:E,itemResolver:o}]}})})};e.prototype.updateItems=function(e,t,n){};e.prototype.processMessage=function(e,t,n){if(t.isDeleted){if(e(Object(j.e)({deleted:p.l},t.itemKey)).deleted)return;return{type:r.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}var i=e(Object(j.e)({spItemKey:P.e,mediaTransformSchema:M.e,displayName:p.h},t.itemKey)),s=i.spItemKey,o=i.mediaTransformSchema,u=i.displayName;if(void 0===s){if(!t.parentItemKey)return;return{type:r.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(o&&t.eTag){var a=o[".etag"];if(a&&t.eTag&&t.eTag!==a)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:M.e,reason:"eTag changed from ".concat(a," to ").concat(t.eTag)}}if(void 0!==t.name&&u!==t.name)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:p.h,reason:"Name changed from ".concat(u," to ").concat(t.name)}};return e})(),V=n(296),$=n(42),J=n(67),K=n(901),Q=n(46),G=n(158),Y=n(582),Z=(function(){function e(e){this._dispatch=e.dispatch;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._listId=e.listId}e.prototype.getSocketIoSubscription=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,r,i,s,o,u,f,c,h,p,d,v,m,g;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(e.existingSubscription)return[3,5];n=Object(Y.n)({webAbsoluteUrl:this._webAbsoluteUrl}).segments("microservicemanager","getserviceurls").parameter("service","push");return[4,this._dispatch(Object(G.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:n.toString(),method:"GET",qosName:"GetServiceUrls",noRedirect:!0})).catch(function(e){0})];case 1:r=a.sent();i=this._dispatch(Object(I.e)({isTest:k.k})).isTest;if(!(s=r&&r.d&&r.d.GetServiceUrls&&r.d.GetServiceUrls.results&&r.d.GetServiceUrls.results[0])&&!i)throw new Error("Unable to retrieve PushChannel base url");i&&(s="https://northcentralus0-pushs.svc.ms");o="".concat(s,"/notifications/register");u=Q.e.generate();f=this._dispatch(Object(l.e)({name:"SubscriptionServiceGenericList.Register"}));c={correlationId:u};a.label=2;case 2:a.trys.push([2,4,,5]);return[4,K.e.start({url:o,method:"GET",headers:{"X-Correlation-Id":u},requestTimeoutInMS:1e4})];case 3:(h=a.sent())&&h.responseText&&h.responseText.length>0&&(p=JSON.parse(h.responseText))&&p.serverUrl&&p.webhookUrl&&(t=p.webhookUrl);if(void 0===t)throw new Error("Unable to retireve PushChannel notification url");this._dispatch(f({resultType:J.e.success,extraData:c}));return[3,5];case 4:d=a.sent();this._dispatch(f({resultType:J.e.failure,extraData:c}));throw d;case 5:v=Object(Y.r)({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId);if(e.existingSubscription){v=v.method("Subscriptions",{guid:e.existingSubscription.id}).segment("Update");t=e.existingSubscription.notificationUrl}else v=v.segments("Subscriptions","Add");m={parameters:{resource:this._listId,notificationUrl:t,expirationDateTime:new Date(Date.now()+3e5).toISOString(),clientState:""}};return[4,this._dispatch(Object(G.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:v.toString(),body:JSON.stringify(m),qosName:"SubscriptionServiceGenericList.getSocketIoSubscription",method:"POST",noRedirect:!0}))];case 6:if((g=a.sent())&&g.d){delete g.d.__metadata;if(e.existingSubscription){g.d.id=e.existingSubscription.id;g.d.notificationUrl=e.existingSubscription.notificationUrl;g.d.expirationDateTime=m.parameters.expirationDateTime}return[2,g.d]}throw new Error("Invalid subscription object")}})})};e.prototype.deleteSocketIoSubscription=function(e){var t=Object(Y.r)({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId).method("Subscriptions",e.id);return this._dispatch(Object(G.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:t.toString(),qosName:"SubscriptionServiceGenericList.deleteSocketIoSubscription",method:"DELETE",noRedirect:!0}))};return e})(),ee=n(351),te=n(44),ne=n(135),re=n(352),ie=n(233),se=(function(){function e(e){this._pushChannelService=e.pushChannelService;this._subscriptionService=e.subscriptionService;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._itemSetKey=e.itemSetKey;this._serverResponse=void 0;this._pendingRequest=!1}e.prototype.onUnsubscribe=function(e){if(0===e&&this._subscriptionService instanceof Z){var t=this._pushChannelService.getSocketIoSubscription();t&&this._subscriptionService&&this._subscriptionService.deleteSocketIoSubscription(t)}};e.prototype.getSubscription=function(e){if(this._webAbsoluteUrl&&this._listFullUrl){var t=B.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),n=e(Object(F.e)(function(e){return e.demandItemFacet(D.Ge,t)}));if((null==n?void 0:n.notificationUrl)&&(null==n?void 0:n.expirationDateTime)&&(null==n?void 0:n.subscribeID))return{notificationUrl:null==n?void 0:n.notificationUrl,expirationDateTime:null==n?void 0:n.expirationDateTime,id:null==n?void 0:n.subscribeID}}};e.prototype.getChangeMessages=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,r,i,s,o,u,f,l,c,h,p,v,m,y,b,w,E,S,x,T,N,C,L,A,O,M,_,H,j,q,R,U,z,W=this;return Object(a.__generator)(this,function(X){switch(X.label){case 0:if("latest"===t){n=B.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl});r=e(Object(F.e)(function(e){return e.demandItemFacet(D.Xe,n)}));if(i=null==r?void 0:r.lastItemModifiedTime){s=new d.e;return[2,{syncToken:"".concat("SPO_LIST,").concat(i),messages:[],itemResolver:s}]}}this._pendingRequest=!0;if(f=!!t&&"SPO_LIST,"===t.substr(0,9)){l=t.split(",");c=l[1];h='<Gt><FieldRef Name="Modified" />';h+='<Value Type="DateTime" IncludeTimeValue="True" StorageTZ="True">'.concat(c,"</Value>");o=h+="</Gt>";u=["ID","FileRef","Modified","Title"];p=this._getListColumns(e);for(v=0,m=p;v<m.length;v++)"ID"!==(y=m[v]).internalName&&"FileRef"!==y.internalName&&"Modified"!==y.internalName&&"Title"!==y.internalName&&u.push(y.internalName)}else{if(!g.t.isActivated("9e144a63-594c-45c9-8189-a4b0eb40e708","10/26/2021","Return empty messages and current time as sync token for initial sync")){this._pendingRequest=!1;return[2,{syncToken:"SPO_LIST,".concat((new Date).toISOString()),messages:[],itemResolver:new d.e}]}u=["ID","FileRef","Modified"]}"ID";b=f;w=f?200:1;E=new V.e("<View></View>");o&&E.addFilters([o]);u&&E.replaceFields(u);E.updateSort({fieldName:"ID",isAscending:b});E.updateRowLimit({rowLimit:w,isPerPage:!1});S=e(Object(F.e)(function(e){return Object(te.e)(e,P.e.serialize({webAbsoluteUrl:W._webAbsoluteUrl,listFullUrl:W._listFullUrl}))}));return[4,e(Object(I.e)({isTAB:k.k}))];case 1:x=X.sent().isTAB;this._requestDatesInUtc=!S;return[4,e(Object(ee.e)({getItemContext:Object(a.__assign)(Object(a.__assign)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,qosName:"ItemAutoRefreshGenericList.GetChanges",viewXml:E.getEffectiveViewXml()},x?{}:{isBackground:!0}),{postDataContext:{requestDatesInUtc:this._requestDatesInUtc,needsSchema:!0},currentPageContext:S})}))];case 2:T=X.sent();this._serverResponse=T;N=T.ListData;C=N&&N.Row||[];L=[];A=f?this._getLastModifiedTimeInList(C,S):(new Date).toISOString();for(O=0,M=C;O<M.length;O++)if(void 0!==(_=M[O]).FileRef){H={};j=Object.keys(_);for(q=0,R=j;q<R.length;q++){U=R[q];z=0===U.indexOf("OData_")?U.substr(6):U;H[z]=_[U]}L.push(Object(a.__assign)(Object(a.__assign)({itemKey:P.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,itemId:_.ID}),parentItemKey:P.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1,name:_.Title||""},_.Modified?{dateModified:"".concat(_.Modified)}:{}),{fields:H}))}0===L.length&&L.push({itemKey:P.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1});this._pendingRequest=!1;return[2,{syncToken:"SPO_LIST,".concat(A),messages:L,itemResolver:new d.e}]}})})};e.prototype.hasPendingRequest=function(){return this._pendingRequest};e.prototype.updateItems=function(e,t){if(t&&o.e.matches(this._itemSetKey)&&this._serverResponse){var n=o.e.deserialize(this._itemSetKey),r={webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,rootFolder:n.rootFolder||""},i=e(Object(ie.n)({itemSetKey:r})),s=e(Object(ie.e)(n,i,"getSPItem")),u=e(Object(re.t)({serverData:this._serverResponse,itemSetKey:r,contentTypes:i,currentPageContext:s.currentPageContext,isItemSetRequest:!1})).itemResolver;e(u.execute())}this._serverResponse=void 0};e.prototype.processMessage=function(e,t,n){var i=e(Object(F.e)(function(e){var r=Object(ne.e)(e,{itemsScopeItemKey:n});return e.isItemFacetResolved(P.e,t.itemKey)?{rowData:e.demandItemFacet(D.Bt,t.itemKey),spItemKey:e.demandItemFacet(P.e,t.itemKey),title:e.demandItemFacet(D.Cn,t.itemKey),selectedItemKeys:r}:{rowData:void 0,spItemKey:void 0,title:void 0,selectedItemKeys:r}})),s=i.rowData,o=i.spItemKey,u=i.title,a=i.selectedItemKeys,f=a&&a.length>0;if(void 0===t.parentItemKey){if(f)return;return{type:r.New,invalidateKey:t.itemKey,reason:"Deleted an unknown item"}}if(t.isDeleted){if(e(Object(j.e)({deleted:p.l},t.itemKey)).deleted||f)return;return{type:r.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}if(void 0===o||void 0===s){if(!t.parentItemKey)return;if(void 0===e(Object(j.e)({spParentItemKey:P.e},t.parentItemKey)).spParentItemKey)return;return f?void 0:{type:r.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(void 0!==u&&void 0!==t.name&&u!==t.name)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:D.Cn,hasSelection:f,reason:'Item title changed from "'.concat(u,'" to ').concat(t.name,")")};if(t.fields){f||(this._serverResponse=void 0);for(var l=this._getListColumns(e),c=function(e){for(var n=e.internalName,i=0,o=Object.keys(t.fields).filter(function(e){return e!==n+".COUNT"&&0===e.indexOf(n)});i<o.length;i++){var u=o[i],a=s&&s[u],l=t.fields[u];try{"object"==typeof a&&(a=JSON.stringify(a));"object"==typeof l&&(l=JSON.stringify(l));if(h._requestDatesInUtc&&"DateTime"===e.fieldType){var c=Date.parse(a),p=Date.parse(l);if(!isNaN(c)&&!isNaN(p)){a=c;l=p}}}catch(e){continue}if(a!==l)return{value:{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:D.Bt,hasSelection:f,reason:'Item field "'.concat(n,'" changed from "').concat(a,'" (').concat(typeof a,")")+' to "'.concat(l,'" (').concat(typeof l,")")}}}},h=this,d=0,v=l;d<v.length;d++){var m=c(v[d]);if("object"==typeof m)return m.value}}};e.prototype._getLastModifiedTimeInList=function(e,t){var n=(new Date).toISOString();if(e&&e.length>0)for(var r=void 0,i=0,s=e;i<s.length;i++){var o=s[i];if(this._requestDatesInUtc){var u=o.Modified;if(u){f=new Date(u);if(void 0===r||r<f){r=f;n="".concat(u)}}}else{var a=o["Modified."];if(a){var f=new Date(a),l=t&&t.webTimeZoneData?t.webTimeZoneData.Bias-f.getTimezoneOffset():0;l&&f.setTime(f.getTime()+6e4*l);if(void 0===r||r<f){r=f;n=f.toISOString()}}}}return n};e.prototype._getListColumns=function(e){var t=[],n=e(Object(j.e)({schema:h.o},this._itemSetKey)).schema,r=n&&n.columnKeys;if(r)for(var i=0,s=r;i<s.length;i++){var o=s[i],u=e(Object(j.e)({internalName:D.ke,fieldType:D.pe,mappedFieldType:D.Ye},o)),a=u.internalName,f=u.fieldType,l=u.mappedFieldType;void 0!==a&&void 0!==f&&void 0!==l&&l!==$.t.Title&&t.push({internalName:a,fieldType:f,mappedFieldType:l})}return t};return e})(),oe=n(206),ue=n(311),ae=n(53),fe=n(23),le=n(14),ce=n(217),he=n(231),pe=n(191),de=n(2800),ve=(function(){function e(e){this._connectionCallbacks={};this._notificationCallback=void 0;this._notificationId=void 0;this._siteId=e.siteId;this._listId=e.listId;this._isConnected=!1;this._client=e.dataSyncClient}e.prototype.isConnected=function(){return this._isConnected};e.prototype.getSocketIoSubscription=function(){};e.prototype.addConnectionHandler=function(e,t){this._connectionCallbacks[e]=t};e.prototype.removeConnectionHandler=function(e){this._connectionCallbacks[e]&&delete this._connectionCallbacks[e]};e.prototype.setupNotificationHandler=function(e,t){this._notificationCallback=t;return!0};e.prototype.disconnect=function(){this._notificationCallback=void 0;this._connectionCallbacks={};this._notificationId&&this._client&&this._client.removeListStatusCallback(this._notificationId);this._isConnected=!1};e.prototype.refreshSubscription=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2,!0]})})};e.prototype.connect=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,r,i,s;return Object(a.__generator)(this,function(o){switch(o.label){case 0:t=(e=this)._client,n=e._siteId,r=e._listId;i={siteId:n,listId:r};return[4,t.isListDataSyncEnabledAsync(i)];case 1:if(!o.sent())return[3,3];s=this;return[4,t.addListStatusCallbackAsync(this._onNotification.bind(this),i,{sendConnectionNotifications:!0})];case 2:s._notificationId=o.sent();return[2,!0];case 3:return[2,!1]}})})};e.prototype._onNotification=function(e){if(1===e.length){var t=e[0];t.dataRefreshNeeded?this._notificationCallback&&this._notificationCallback(void 0):t.state===de.e.ListStatusConnected?this._notifyConnectionHandlers(!0):t.state===de.e.ListStatusConnectionLost&&this._notifyConnectionHandlers(!1)}};e.prototype._notifyConnectionHandlers=function(e){this._isConnected=e;for(var t in this._connectionCallbacks)this._connectionCallbacks.hasOwnProperty(t)&&this._connectionCallbacks[t](e)};return e})(),me=n(218),ge={ODB:860},ye={ODB:818},be=new fe.e("itemAutoRefreshHelper",{itemsScopeItemKey:le.e,spPageContextKey:le.e}),we=Object(ue.e)(function(e){return{}});function Ee(e){var t=e.spPageContextKey,n=e.pageContext,r=e.listId,i=e.webAbsoluteUrl,s=e.listFullUrl,o=e.isTAB,u=e.itemKey,a=e.driveUrl,f=e.itemsScopeItemKey,c=e.getDataSyncClient;return function(h){var p=h(we),d=be.serialize({itemsScopeItemKey:f,spPageContextKey:t}),v=p[d];if(!v){var m,y=void 0,b=void 0,w=!n||!Object(g.n)(n).isActivated("f3c67c53-3465-4927-924d-963e1011836b","09/29/2020","Skip checking the subscription service");if(c&&e.pushChannelService&&(w||e.subscriptionService)){y=e.pushChannelService;b=e.subscriptionService}else{if(n){var E=h(N.e).dataRequestor;b=new L.e({listId:r,webAbsoluteUrl:i},{dataRequestor:E})}else b=new Z({dispatch:h,webAbsoluteUrl:i,listFullUrl:s,listId:r});y=new A.e({disableWebSockets:!0},{subscriptionService:b})}m=new se({pushChannelService:y,subscriptionService:b,webAbsoluteUrl:i,listFullUrl:s,itemSetKey:u});v=p[d]=new T({id:d,isTestMode:o,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},onNotificationReceived:function(){return window._tabPushNotification=!0},driveUrl:a,dispatch:h,template:m,itemsScopeItemKey:f,pushChannelService:y,logQoS:function(e){var t=h(Object(l.e)(e));return function(e){return h(t(e))}},onUnsubscribe:function(e){0===e&&delete p[d]}})}return v}}function Se(e){var t=Object(oe.t)();f.useLayoutEffect(function(){if(e.getDataSyncClient){var n=new Promise(function(n){(function(e){var t=this,n=e.pageContext,r=e.listId,i=e.getDataSyncClient;return i?i.then(function(i){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,s,o;return Object(a.__generator)(this,function(u){switch(u.label){case 0:t=void 0;s=void 0;return(o=i&&n&&r&&n.siteId)?[4,i.isListDataSyncEnabledAsync({listId:r,siteId:n.siteId})]:[3,2];case 1:o=u.sent();u.label=2;case 2:if(o){t=new ve({listId:r,siteId:n.siteId,dataSyncClient:i});s=void 0;return[2,Ee(Object(a.__assign)(Object(a.__assign)({},e),{subscriptionService:s,pushChannelService:t}))]}return[2,Ee(e)]}})})}):Promise.resolve(Ee(e))})(e).then(function(e){var r=t(e);n(r.subscribe())})});return function(){n.then(function(e){return e()})}}return t(Ee(e)).subscribe()},[]);return null}function xe(e){var t=Object(oe.t)();f.useLayoutEffect(function(){return t((function(e){var t=this,n=e.spPageContextKey,r=e.webAbsoluteUrl,i=e.listFullUrl,s=e.isTAB,o=e.driveUrl,u=e.endpoint,f=e.itemsScopeItemKey;return function(e){var c=e(we),h=be.serialize({itemsScopeItemKey:f,spPageContextKey:n}),p=c[h];if(!p){var d,v,m=e(N.e).dataRequestor;v=new X({dataRequestor:m,rootItemKey:P.e.serialize({webAbsoluteUrl:r,listFullUrl:i,rootFolder:""})});d=new A.e({disableWebSockets:!0},{subscriptionService:new L.e({},{dataRequestor:m}),sessionTokenFetcher:function(){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,n,r;return Object(a.__generator)(this,function(i){switch(i.label){case 0:return(n=u)?[4,e(Object(C.getSessionToken)({endpoint:u,driveUrl:o}))]:[3,2];case 1:n=i.sent();i.label=2;case 2:if(!(r=(t=n)&&t.accessToken))throw new W.e({code:"authFailure"});return[2,{accessToken:r,tokenUrl:o}]}})})}});p=c[h]=new T({id:h,isTestMode:s,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},onNotificationReceived:function(){return window._tabPushNotification=!0},driveUrl:o,dispatch:e,itemsScopeItemKey:f,template:v,pushChannelService:d,logQoS:function(t){var n=e(Object(l.e)(t));return function(t){return e(n(t))}},onUnsubscribe:function(e){0===e&&delete c[h]}})}return p}})(e)).subscribe()},[]);return null}function Te(e,t){var n,r=t.itemKey,i=t.itemSubscriber;if(!r)return{};var s=e.demandItem({key:o.e},r).key;if(!s||!s.webAbsoluteUrl||!s.listFullUrl)return{};var u=s.webAbsoluteUrl,a=s.listFullUrl,l=H.e.serialize({webAbsoluteUrl:u,listFullUrl:a}),h=e.demandItemFacet(D.gn,l);if(!Object(_.e)(e,{feature:ge,pageContext:h})||!Object(_.e)(e,{feature:ye,pageContext:h}))return{};var p=Object(me.p)(function(t){return Object(_.e)(e,{feature:t})},me.e.SharePointList)?null===(n=e.demandItemFacet(D.Qt,pe.e))||void 0===n?void 0:n.dataSyncClient:void 0,d=B.e.serialize({webAbsoluteUrl:u,listFullUrl:a}),v=e.demandItem({listFacets:D.Xe,listMediaTransformSchema:M.n},d),m=v.listFacets,g=v.listMediaTransformSchema;if(!m||void 0===m.id||void 0===m.templateType)return{};var b=m.isDocumentLibrary,w=O.s(m.templateType);if(!b&&!w)return{};var E,S=Object(c.e)(e,{isTAB:k.k}).isTAB,x=g&&g[".driveUrl"],T=x&&Object(y.e)(x),N=T&&T.endpoint,C=Object(ae.e)(e).itemsScopeItemKey||"itemsSCopeItemKey";if(b&&!x)return{};var L=Object(ce.e)(e,{itemsScopeItemKey:C});if(L&&L.id===he.e.id)return{};if(b){if(!g)return{};if(!x)return{};if(S){var A=g[".driveAccessToken"];E=A&&A.replace("access_token=","")}if(!T)return{};var P=T.driveId;return N&&P?{itemSubscriber:f.createElement(f.Fragment,null,f.createElement(xe,{spPageContextKey:l,driveUrl:x,isTAB:S,listFullUrl:a,endpoint:N,driveAccessToken:E,webAbsoluteUrl:u,pageContext:h,itemsScopeItemKey:C}),i)}:{}}return{itemSubscriber:f.createElement(f.Fragment,null,f.createElement(Se,{spPageContextKey:l,isTAB:S,itemKey:r,listFullUrl:a,webAbsoluteUrl:u,listId:m.id,pageContext:h,driveUrl:x,itemsScopeItemKey:C,getDataSyncClient:p}),i)}}var Ne=Object(i.t)(function(){return function(e){e(Object(s.e)(o.e,u.e)(Te))}})},5410:function(e,t,n){"use strict";n.r(t);n.d(t,"constrainLibrariesDropdownSizeKillswitchIsActive",function(){return A});n.d(t,"fixFocusKillswitchIsActive",function(){return O});n.d(t,"ItemLibrariesDropdown",function(){return P});n.d(t,"LibrariesDropdown",function(){return H});var r=n(0),i=n("react-lib"),s=n(159),o=n(4592),u=n(164),a=n(89),f=n(117),l=n(733),c=n(39),h=n(9),p=n(5),d=n(40),v=n(1),m=n(459),g=n(120),y=n(10),b=n(275),w=n(30),E=n(843),S=n(15),x=n(1587),T=n(143),N=n(109),C=n(204),k=n(84),L=n(19),A=L.t.isActivated("511cf8c4-478d-4428-be23-88fdb3dc803a","03/28/2022",'Constrain the size of the libraries dropdown so that very very long library names don"t break it'),O=L.t.isActivated("32E14D10-7F57-4A91-BF35-B6FB88FAD6F1","05/12/2022","Fix the focus style of the dropdown in all endpoints."),M=Object(k.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(5,1945)];case 1:return[2,e.sent().ActionContextMenu]}})})}),_={component:"LibrariesDropdown;"},D=Object(T.t)({withContext:_}),P=Object(C.n)(D)(function(e){var t,n=i.useRef(null),r=i.useState(!1),S=r[0],C=r[1],k=Object(g.e)(function(){return C(!1)}),L=Object(c.e)("librariesDropdown_c258b0e8",e.className,S?"librariesDropdownOpen_c258b0e8":"librariesDropdownNotOpen_c258b0e8",((t={}).librariesDropdownWithFocus_c258b0e8=!O,t));return i.createElement(u.e,null,function(t){var r,u=t.itemCache,g=(t.dispatch,null===(r=Object(T.n)(u))||void 0===r?void 0:r.telemetry),O=e.itemKey,_=u.demandItemFacet(d.e,O),D=u.demandItemFacet(a.e,O),P=Object(E.e)(u);if(_||D){var H=Object(w.e)(u,{enableLibrariesDropdown:v.q}).enableLibrariesDropdown,B=void 0,j=void 0,F=void 0;if(_){B=_.webAbsoluteUrl;j=_.rootFolder;F=f.e.serialize(_)}else{if(!D)return null;B=D.webAbsoluteUrl;j=D.rootFolder;F=f.e.serialize(D)}var I=u.demandItemFacet(v.Xe,F),q=!(P||!H||!I||I.templateType!==y.n.documentLibrary||""!==j),R=u.demandItemFacet(x.e,O);if(!x.e.evaluate(R)(u,{itemKey:O,isAvailable:q}).isAvailable)return null;var U=[],z=null;if(S){var W=u.demandItemFacet(h.e,l.e.serialize({webAbsoluteUrl:B}));if(W&&W.itemKeys&&W.itemKeys.length){z=function(){g&&g(N.e).logData({name:"LibrariesDropdown.Load",component:"LibrariesDropdown;",objectType:"Libraries",extraData:{numberOfLibraries:W.itemKeys.length},isIntentional:!0})};U=W.itemKeys.map(function(e){return{key:e,name:u.demandItemFacet(p.h,e)||"",action:i.createElement(b.e,{itemKey:e})}})}}return i.createElement(i.Fragment,null,i.createElement("button",{className:L,onClick:S?k:function(){g&&g(N.e).logData({name:"LibrariesDropdown.OpenDropdown",component:"LibrariesDropdown;",isIntentional:!0});C(!0)},ref:n,"aria-label":o.e,"aria-haspopup":"menu","aria-expanded":S?"true":"false",title:o.e},i.createElement(m.e,{iconName:"Library",className:Object(c.e)("librariesDropdownIcon_c258b0e8")}),i.createElement(m.e,{iconName:"ChevronDown",className:Object(c.e)("librariesDropdownChevron_c258b0e8")})),S?i.createElement(M,{commands:U,target:n.current,directionalHint:s.e.bottomLeftEdge,alignTargetEdge:!0,onDismiss:k,isOpen:!0,onMenuOpened:z||void 0,calloutProps:A?{}:{calloutMaxHeight:500,calloutMaxWidth:300}}):null)}return null})}),H=Object(S.e)()(P)}}]);