(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[114],{2825:function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){var t=document.createElement("input");t.setAttribute("type","text");t.setAttribute("value",e);document.body.appendChild(t);var n=!1;try{t.focus();t.select();n=document.execCommand("copy")}catch(e){}if(!n&&window.navigator&&window.navigator.clipboard)try{window.navigator.clipboard.writeText(t.value);n=!0}catch(e){}document.body.removeChild(t);return n}},3175:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(91),i=n(63),s=n(119),o=n(82),u=(function(){function e(e,t){this._ticketRedeemer=t.ticketRedeemer}e.prototype.redeemItem=function(e,t,n){return this.redeemItems([e],t,n)};e.prototype.redeemItems=function(e,t,n){return e&&e.some(function(e){return e&&e.tokenNeedsRedeeming})||n?r.n.resolve(this._ticketRedeemer()).then(function(n){return n?n.startRedeem(t,e&&e[0]):{resultType:i.e.Success}}):r.n.resolve({resultType:i.e.Success})};return e})(),a=Object(s.s)("ItemRedeemer",u,{ticketRedeemer:o.de.async.optional})},4776:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n("react-lib"),i=n(1884);function s(e){var t=r.useState(e),n=t[0],s=t[1],o=r.useRef(n),u=Object(i.e)(function(){return function(){s(!0);o.current=!0}}),a=Object(i.e)(function(){return function(){s(!1);o.current=!1}}),f=Object(i.e)(function(){return function(){return o.current?a():u()}});return[n,{setTrue:u,setFalse:a,toggle:f}]}},5312:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(91),s=n(1121),o=n(2193),u=n(2060),a=n(2044),f=n(2090),l=n("react-lib"),c=n(3308),h=n(2653),p=n(1906),d=n(1483),v=n(4939),m=n(5376),g=n(2730),y=n(2734),b=n(2693),w=n(4481),E=n(2033),S=n(490),x=n(18),T=n(5365),N=n(4776),C=n(37),k=n(370),L=n(4777),A=n(181),O=n(3175),M=n(2825),_=n(243),D=n(170);Object(D.n)([{rawString:".od-new-embed-dialog .od-embed-dialog-preview{border-radius:10px;margin-top:22px}.od-new-embed-dialog .od-new-embed-start-time{display:flex;align-items:baseline;margin-top:40px}"}]);var P,H=n(801);(function(e){e.HD="1280 x 720";e.Standard="853 x 480";e.Normal="640 x 360";e.Minimum="560 x 315"})(P||(P={}));var B=[{key:"size-1",text:P.HD},{key:"size-2",text:P.Standard},{key:"size-3",text:P.Normal},{key:"size-4",text:P.Minimum}],j={root:{marginRight:10}},F={childrenGap:30},I={childrenGap:10},q={root:{width:"90px",height:"28px",marginLeft:"8px"}},R={root:{paddingTop:"30px"}},U={root:{marginTop:"35px"}},z={root:{marginTop:"15px"}},W={root:{alignItems:"center",display:"flex",overflow:"hidden",minWidth:80,marginRight:10}},X=function(e){var t=e.item,n=e.resources,i=e.hostApp,s=n.consume(A.r),o=n.consume(A.a.optional),u=n.consume(k.e),a=n.consume(O.e),f=Object(N.e)(!0),D=f[0],X=f[1],V=Object(N.e)(!0),$=V[0],J=V[1].setFalse,K=Object(l.useRef)(),Q=Object(l.useState)(""),G=Q[0],Y=Q[1],Z=Object(N.e)(!1),ee=Z[0],te=Z[1],ne=Object(N.e)(!1),re=ne[0],ie=ne[1],se=Object(N.e)(!0),oe=se[0],ue=se[1],ae=Object(N.e)(!1),fe=ae[0],le=ae[1],ce=Object(l.useState)(0),he=ce[0],pe=ce[1],de=P.Normal.split(" x "),ve=Object(l.useState)(de[0]),me=ve[0],ge=ve[1],ye=Object(l.useState)(de[1]),be=ye[0],we=ye[1],Ee=Object(l.useMemo)(function(){return t.video&&t.type===_.e.Media},[t]),Se=Object(l.useMemo)(function(){return!!t.audio},[t]);Object(l.useEffect)(function(){var e=t.properties.uniqueId;Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,a.redeemItem(t,{name:"EmbedDialog",resources:n}).then(function(){return s.getEmbedInfo(t)})];case 1:i=r.sent();o=i.embedUrl+"?UniqueId=".concat(e);Y(o);X.setFalse();return[2]}})});var i=document.querySelector("#button-closeNavigation");i&&i.click()},[t]);var xe=Object(l.useMemo)(function(){var e='{"playbackOptions":{"startTimeInSeconds":'.concat(he,"}}");return"".concat(G).concat(fe&&Ee?"&nav=".concat(encodeURIComponent(e)):"")},[G,Ee,fe,he]),Te=Object(C._)().isInverted,Ne=Object(l.useMemo)(function(){return"".concat(Te?"":'"ust":true').concat(Te||!ee&&oe?"":",").concat(ee?'"af":true':"").concat(ee&&!oe?",":"").concat(oe?"":'"hvm":true')},[ee,oe]),Ce=Object(l.useMemo)(function(){return"".concat(xe).concat(!Ee||!ee&&oe&&Te?"":"&embed=".concat(encodeURIComponent("{".concat(Ne,"}"))))},[Ee,ee,oe,xe,Ne]),ke=Object(l.useMemo)(function(){var e='{"hv":"CopyEmbedCode"'.concat(Ne?",".concat(Ne):"","}");return"".concat(xe).concat(Ee?"&embed=".concat(encodeURIComponent(e)).concat(i?"&client_id=".concat(i):""):"")},[Ee,xe,Ne]),Le=Object(l.useMemo)(function(){var e='<iframe src="'.concat(Ce).concat(Ee?"&referrer=".concat(i,"&referrerScenario=EmbedDialog.Create"):"",'" width="').concat(me,'" height="').concat(be,'" frameborder="0" scrolling="no" allowfullscreen ').concat('title="'.concat(t.name,'"')).concat(Ee&&re?' style="'.concat("border:none; position: absolute; top: 0; left: 0; right: 0; bottom: 0; height: 100%; max-width: 100%;",'"'):"","></iframe>");Ee&&re&&(e='<div style="max-width: '.concat(me,'px"><div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">').concat(e,"</div></div>"));return e},[Ce,re,me,be,Ee]),Ae=function(){if(u){var e={location:"EmbedDialog",usageType:H.e[H.e.Click],isIntentional:!0,currentPage:o&&o.currentPageName(),previousPage:o&&o.previousPageName(),extraData:{width:me,height:be,responsive:re,autoPlay:ee,showTitle:oe,startTime:he}};u.logData(Object(r.__assign)(Object(r.__assign)({},e),{name:"Embed.EmbedOptions.Copy"}))}Object(M.e)(Le);J()},Oe=Object(l.useCallback)(function(){return D?null:l.createElement("div",null,l.createElement(p.e,{onClick:Ae,styles:j},L.c),l.createElement(d.e,{onClick:J},L.n))},[J,D,Ae]),Me=function(e){return/^([0-9]*):?[0-9]*:?[0-9]*$/.test(e)},_e=function(e){return/^[0-9]+$/.test(e)},De=Se?L.l:L.d;return l.createElement(c.e,{className:"od-new-embed-dialog",isOpen:$,onDismiss:J,type:h.e.custom,customWidth:"418px",headerText:L.i,closeButtonAriaLabel:L.n,onRenderFooterContent:Oe,isFooterAtBottom:!0,isLightDismiss:!0},D?l.createElement(E.e,{size:S.e.large,styles:R}):l.createElement(g.e,{tokens:F},l.createElement(y.e,{styles:z},l.createElement(T.e,null,x.format(L.h,t.name),Ee?" ".concat(L.p):"")),l.createElement("iframe",{ref:K,className:"od-embed-dialog-preview",height:"208px",src:ke,title:t.name,tabIndex:0,scrolling:"no"}),Ee&&l.createElement(l.Fragment,null,l.createElement("div",{className:"od-new-embed-start-time"},l.createElement(w.e,{label:L.u,onChange:le.toggle}),l.createElement(b.e,{underlined:!0,styles:q,disabled:!fe,onGetErrorMessage:function(e){return Me(e)||_e(e)?"":"Input value must be numeric"},onChange:function(e,t){if(_e(t)||Me(t)){var n=t.split(":").map(function(e){return Number(e)}).reduce(function(e,t){return 60*e+t},0);pe(n)}else fe||pe(0)},validateOnLoad:!1,placeholder:"00:00",ariaLabel:L.a})),l.createElement(v.e,{placeholder:P.Normal,label:De,options:B,onChange:function(e,t){var n,r=null===(n=null==t?void 0:t.text)||void 0===n?void 0:n.split(" x ");ge(r[0]);we(r[1])}}),l.createElement(g.e,{horizontal:!0,disableShrink:!0,horizontalAlign:"space-between",tokens:I},l.createElement(y.e,{styles:W},l.createElement(m.e,{label:L.e,onText:L.t,offText:L.f,onChange:te.toggle})),l.createElement(y.e,{styles:W},l.createElement(m.e,{label:L.s,onText:L.t,offText:L.f,onChange:ie.toggle})),l.createElement(y.e,{styles:W},l.createElement(m.e,{label:L.o,defaultChecked:!0,onText:L.t,offText:L.f,onChange:ue.toggle})))),l.createElement(y.e,{styles:U},l.createElement(b.e,{multiline:!0,readOnly:!0,value:Le,onChange:function(e,t){Y(t)},resizable:!0,rows:3,styles:{root:{overflow:"auto"}},autoAdjustHeight:!0,ariaLabel:L.r}))))},V=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({react:f.t});n.controlProps=n.observables.pureCompute(function(){return{item:t.item(),resources:n.resources,hostApp:t.hostApp}});n.controlComponent=X;return n}return t})(a.t),$=n(2045).e({tagName:"od-embed-dialog-builder",template:'<div class="od-embed-dialog" role="group" data-bind="react:{componentType:controlComponent,props:controlProps}"></div>',viewModel:V,synchronous:!0}),J=n(2434),K=n(101),Q=n(2102),G=n(10),Y=n(43),Z=n(2059),ee=n(82),te=n(19),ne=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._itemSelectionHelper=new(n.child(u.e))({overrideItem:t.item,allowMultiSelect:!1,canFallback:!1});n.state=n.createPureComputed(n._computeState);n._itemCommandHelper=new(n.managed(Q.e));n._isOneDriveXboxApp=Object(K.t)();n._urlDataSource=n.resources.consume(ee.ve);n._itemParentHelper=n.resources.consume(Z.e);return n}t.prototype.getParams=function(){return{item:this._itemSelectionHelper.firstItem,hostApp:"OneUpFileViewer"}};t.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem(),t=!this._isOneDriveXboxApp;return{isAvailable:te.e.isActivated("D7435F04-4BBF-479C-AA09-9E448BECE629","7/7/2022","Check if embed action is available or not")?t&&e&&this._itemCommandHelper.isCommandSupported(e,J.n):t&&e&&this._isAvailable()}};t.prototype._isAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(!this._itemCommandHelper.isCommandSupported(e,J.n))return!1;if(!e||e.queryType===Y.e.RecycleBin||e.queryType===Y.e.SecondStageRecycleBin)return!1;var t=this.observables.unwrap(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return!!t&&((!t||!t.list||t.list.templateType!==G.n.webPageLibrary)&&(!this._urlDataSource.isCurrentQuery(Y.e.DocumentLibraries)&&(e&&e.list&&(e.isRootFolder||e.list)?this._itemCommandHelper.isCommandSupported(e,J.n)&&!e.isPlaceholder&&!e.subsite:!!e&&this._itemCommandHelper.isCommandSupported(e,J.n)&&!e.isPlaceholder&&!e.isRootFolder&&!e.list&&!e.subsite)))};return t})(s.default),re=Object(o.e)({name:"Embed.EmbedOptions",source:{moduleDefinition:{path:"./EmbedDialogBuilder",getModule:function(){return i.n.resolve($)}}},handlerType:ne});t.default=re}}]);