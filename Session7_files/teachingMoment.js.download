(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[532],{3851:function(e,t,n){"use strict";n.r(t),n.d(t,"TeachingMoment",function(){return p});var a=n(0),i=n(3835),r=n(1182),o=n(874),s=n(743),c=n(40),d=n.n(c),l=n(3551),u="wasTeachingMomentAlreadyShown",f="teachingMomentAlreadyShownIdList",p=function(e){var t=d.a.useState(!1),n=t[0],c=t[1],p=d.a.useState(!1),m=p[0],_=p[1],h="".concat(e.userActionName,"_").concat(e.pluginIdentifier.pluginName),b=function(e){var t=e?{right:"unset !important"}:{};return Object(l.t)({positioningContainer:{selectors:{"@media(max-width: 640px)":t}}})}(m),g="popupName_".concat(h),v=function(t){e.log.appLogic("PluginAppLogic",Object(a.e)({name:"TeachingMoment".concat(t,"-").concat(e.userActionName)},e.pluginIdentifier))},y=function(t){e.log.userAction("PluginButtonAction",Object(a.e)(Object(a.e)({name:"TeachingMoment".concat(t,"-").concat(e.userActionName)},e.pluginIdentifier),{playbackTimeSec:-1,actionType:"Unknown"}))},S=function(e){void 0===e&&(e="true"),sessionStorage.setItem(u,e)},D=function(){var e=localStorage.getItem(f);return e?JSON.parse(e):[]};if(d.a.useEffect(function(){return function(){var t=!1;if(Object(i.n)()&&Object(i.r)()){if(!sessionStorage.getItem(u))if(document.getElementsByClassName("ms-TeachingBubble-content").length>0)S("true");else{var n=D().filter(function(e){return e===h}).length;n>1&&e.log.warn("PluginError","The instanceId ".concat(h," is not unique, please pass unique props.\n        Note that it is being built this way: {props.userActionName}_{props.pluginIdentifier.pluginName}"),Object(a.e)({isExpected:!1,name:"TeachingMomentInstanceIdNotUnique"},e.pluginIdentifier)),0===n&&(t=!0,S("true"),v("CoachmarkShowed")),c(t)}}else e.log.warn("PluginError","LocalStorage/SessionStorage are not available",Object(a.e)({isExpected:!1,name:"TeachingMomentLocalStorageNotAvailable"},e.pluginIdentifier))}(),function(){Object(s.r)(void 0)}},[]),!n)return Object(s.r)(void 0),null;var I=e.layerHostId?"#".concat(e.layerHostId):"#".concat(h);return Object(s.r)(I),d.a.createElement(d.a.Fragment,null,d.a.createElement("div",{id:h},d.a.createElement("p",{id:g,"aria-label":e.ariaLabel,style:{display:"none"}})),d.a.createElement(r.e,Object(a.e)({ariaLabelledBy:"coachmark_".concat(h),persistentBeak:!0,preventFocusOnMount:!0},e.coachmarkProps,{target:"#".concat(h),onAnimationOpenEnd:function(){var e;(e=D()).some(function(e){return e===h})||(e.push(h),localStorage.setItem(f,JSON.stringify(e))),_(!0),v("BubbleShowed")},positioningContainerProps:Object(a.e)({className:b.positioningContainer},e.coachmarkProps.positioningContainerProps||{})}),d.a.createElement(o.e,Object(a.e)({},e.teachingBubbleProps,{ariaLabelledBy:g,onDismiss:function(){c(!1),y("Dismiss")},primaryButtonProps:Object(a.e)(Object(a.e)({},e.teachingBubbleProps.primaryButtonProps),{onClick:function(){c(!1),y("PrimaryAction"),e.teachingBubbleProps.primaryButtonProps.onClick&&e.teachingBubbleProps.primaryButtonProps.onClick()}}),secondaryButtonProps:e.teachingBubbleProps.secondaryButtonProps?Object(a.e)(Object(a.e)({},e.teachingBubbleProps.secondaryButtonProps),{onClick:function(){var t;c(!1),y("SecondaryAction"),(null===(t=e.teachingBubbleProps.secondaryButtonProps)||void 0===t?void 0:t.onClick)&&e.teachingBubbleProps.secondaryButtonProps.onClick()}}):void 0}),e.teachingBubbleProps.body)))};t.default=p}}]);