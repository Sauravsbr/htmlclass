(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[216,485],{2395:function(e,t,n){"use strict";n.r(t);n.d(t,"disabledCampaign",function(){return d});n.d(t,"resourceKey",function(){return m});var r=n(0),i=n(33),s=n(1121),o=n(119),u=n(183),a=n(100),f=n(140),l=n(181),c=n(2431),h=n(2394),p=n(60),d={campaignGuid:"00000000-0000-0000-0000-000000000000",endDate:new Date(1970,1,1),flag:i.Off,isCoachmark:!0},v=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._dataStore=new u.e("CoachmarkProvider",a.e.session);r._currentCampaign=r.createObservable(d);r._isVisible=r.createObservable(!1);r._navigation=n.navigation;r._firstRunExperienceStatus=n.firstRunExperienceStatus;r._currentTeachingBubble=r.createObservable({campaign:r._currentCampaign,isVisible:r._isVisible});r._navigation.viewParams.resetAllBubbles&&r._dataStore.remove("CoachmarkTearDropSeen");var i=r.resources.consume(p.e);r._teachingBubbleProviderPromise=i.waitForPLT().then(function(){return r.resources.consume(l.C)});return r}Object.defineProperty(t.prototype,"isVisible",{get:function(){return this._isVisible},enumerable:!1,configurable:!0});Object.defineProperty(t.prototype,"currentCampaign",{get:function(){return this._currentCampaign},enumerable:!1,configurable:!0});t.prototype.hideCampaign=function(){this._isVisible(!1);this._currentCampaign(d)};t.prototype.setCampaign=function(e){var t=this;if(e){if(this._firstRunExperienceStatus.get()!==h.e.visible){var n="".concat(e.name).concat("CoachmarkTearDropSeen");this._dataStore.getValue("CoachmarkTearDropSeen")||this._teachingBubbleProviderPromise.then(function(r){r&&r.shouldBubbleBeAdded(e,!1).then(function(r){if(r){t._currentCampaign(e);t._isVisible(!0);t._dataStore.setValue(n,!0)}})})}}else{this._currentCampaign(d);this._isVisible(!1)}};t.prototype.getCurrentTeachingBubble=function(){return this._currentTeachingBubble};t.dependencies=Object(r.__assign)(Object(r.__assign)({},s.default.dependencies),{navigation:f.e,firstRunExperienceStatus:c.e});return t})(s.default);t.default=v;var m=Object(o.s)("CoachmarkProvider",v)},5147:function(e,t,n){"use strict";n.r(t);n.d(t,"OpenInImageEditorHandler",function(){return T});var r=n(0),i=n(182),s=n(2193),o=n(1121),u=n(91),a=n(82),f=n(2060),l=n(2102),c=n(43),h=n(101),p=n(3859),d=n(2323),v=n(33),m=n(902),g=n(903),y=n(2395),b=n(243),w={jpg:"image/jpg",jpeg:"image/jpeg"},E={png:"image/png"},S={heic:"image/heic",heif:"image/heif"},x={bmp:"image/bmp",emf:"image/emf",gif:"image/gif",tiff:"image/tiff",tif:"image/tif",webp:"image/webp",wmf:"image/wmf"},T=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._itemSelectionHelper=new(n.child(f.e))({allowMultiSelect:!1,canFallback:!0});n._isOneDriveWinApp=Object(h.e)();n._urlDataSource=n.resources.consume(a.ve);n._itemCommandHelper=n.resources.consume(l.t);n._platformDetection=n.resources.consume(i.e);n._identityDataSource=n.resources.consume(a.S);n._coachmarkProvider=n.resources.consume(y.resourceKey.optional);n._imageEditorDataSource=n.resources.consume(p.e.optional);n.state=n.createPureComputed(n._computeState);return n}t.prototype.getParams=function(){return this._itemSelectionHelper.resolveFirst().then(function(e){return{item:e}})};t.prototype._computeState=function(){return{isAvailable:this._isAvailable()}};t.prototype._isAvailable=function(){if(!this._imageEditorDataSource)return!1;var e=this._itemSelectionHelper.firstItem();if(!e)return!1;if(e.video&&e.video.burstPhotoType)return!1;var t=this._itemCommandHelper.isCommandSupported(e,d.o),n=this._isSupportedFileType(e),r=this._itemSelectionHelper.currentItem(),i=this._urlDataSource.getKeyParams(r.key),s=this._urlDataSource.getQueryType(i),o=this._shouldEnableImageEditor()&&t&&n&&(!this._platformDetection.isIE||Object(v.isFeatureEnabled)(v.EnableEditUtilityControlIE))&&(!this._platformDetection.isSafari||Object(v.isFeatureEnabled)(v.EnableEditUtilityControlSafari))&&(!this._platformDetection.isMobile||Object(v.isFeatureEnabled)(v.EnableEditUtilityControlMobile))&&!!e&&0===e.sharingRole&&s!==c.e.SharedWithMe&&!this._isOneDriveWinApp&&!this._urlDataSource.isRecycleBin(s)&&4!==e.itemStatus&&3!==e.itemStatus&&this._imageEditorDataSource.canSave({item:e});o&&Object(v.isFeatureEnabled)(v.EnableEditControlTeachingBubble)&&!Object(v.isFeatureEnabled)(v.MentionTeachingUIAA)&&!Object(v.isFeatureEnabled)(v.EnableExpirationSectionForTMR)&&this._coachmarkProvider.setCampaign(g.PHOTO_EDIT);return o};t.prototype._shouldEnableImageEditor=function(){if(Object(v.isFeatureEnabled)(v.EnableEditUtilityControl))return!0;if(Object(v.isFeatureEnabled)(v.EnableEditControlExperimentAA)){if(this._identityDataSource){var e=this._identityDataSource.getIdentity();e&&m.t.init({userLoginName:e.email})}var t={name:"EnableEditControlExperiment",startDate:"2/09/2021",version:m.e.v2};return new m.t(t,v.EnableEditControlExperimentAB).isOn()}return!1};t.prototype._isSupportedFileType=function(e){if(!(function(e){Object(v.isFeatureEnabled)(v.EnableEditAllImageFormats)&&k.forEach(function(e){C.push(e);C.push(e.toUpperCase())});if(Object(v.isFeatureEnabled)(v.EnableEditPNG)){C.push(".png");C.push(".PNG")}if(Object(v.isFeatureEnabled)(v.EnableEditHEIC)){C.push(".heic");C.push(".heif");C.push(".HEIC");C.push(".HEIF")}return C.some(function(t){return e.toLowerCase()===t})})(e.extension||""))return!1;if(e&&e.extension&&(e.type===b.e.File||e.type===b.e.Media)){var t=e.extension;t=((t&&"."===t[0]?t.substring(1):t)||"").toLowerCase();if(w.hasOwnProperty(t))return!0;if(Object(v.isFeatureEnabled)(v.EnableEditPNG)&&E.hasOwnProperty(t))return!0;if(Object(v.isFeatureEnabled)(v.EnableEditHEIC)&&S.hasOwnProperty(t))return!0;if(Object(v.isFeatureEnabled)(v.EnableEditAllImageFormats)&&x.hasOwnProperty(t))return!0}return!1};return t})(o.default),N=Object(s.e)({name:"OpenInImageEditor",source:{moduleDefinition:{path:"./OpenInImageEditorExecutor",getModule:function(){return u.n.resolve(n.ee([217],4928))}}},handlerType:T}),C=[".jpg",".jpeg",".JPG",".JPEG"],k=[".bmp",".emf",".gif",".tiff",".tif",".webp",".wmf"];t.default=N}}]);