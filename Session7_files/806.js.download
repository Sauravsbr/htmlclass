(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[806],{5316:function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return k});var r=n(7),i=n(4340),s=n(181),o=n(119),u=n(952),a=(function(){function e(e,t){this._instrumentationProvider=t.instrumentationProvider;this._darkModeHelper=t.darkModeHelper}e.prototype.getEngagementData=function(){var e,t=this._instrumentationProvider,n=null===(e=this._darkModeHelper)||void 0===e?void 0:e.isODBDarkMode;return{currentPage:t.currentPageName()||"NA",previousPage:t.previousPageName()||"NA",extraData:{isDarkMode:void 0!==n?n:"NA"}}};e.dependencies={instrumentationProvider:s.a,darkModeHelper:u.e};return e})(),f=Object(o.s)("PageEngagementHandler",a),l=n(1154),c=(function(){function e(e,t){this._searchSession=t.searchSession}e.prototype.getEngagementData=function(){return{extraData:{olsSearchSessionId:this._searchSession}}};e.dependencies={searchSession:l.e};return e})(),h=Object(o.s)("SearchEngagementHandler",c),p=n(1880),d=n(171),v=n(2246),m=n(597),g=n(598),y=(function(){function e(e,t){this._currentItem=t.currentItem}e.prototype.getEngagementData=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=this._currentItem,i=Object(p.getMostSpecificMatchingContext)(v.e,t),s=null!==(e=Object(g.r)(null==i?void 0:i.item))&&void 0!==e?e:Object(g.r)(r);if(s){var o=s.list,u={extension:s.extension,createdFromExcel:o&&o.createdFromExcel,createdFromExisting:o&&o.createdFromExisting},a=s.graph&&s.graph.itemId||s.itemId;a&&(u.itemGraphId=a);var f=s.graph&&s.graph.driveId;f&&(u.itemGraphDriveId=f);var l=s.tsTraceId;l&&(u.tsTraceId=l);var c,h=s.queryType;h&&(u.queryType=h);Object(m.e)(s.queryType)&&(c=s.searchProperties.isMetadataSearch?"MetadataSearch":"DoclibSearch");return{scenario:c,extraData:u}}};e.dependencies={currentItem:d.o.optional};return e})(),b=Object(o.s)("ItemEngagementHandler",y),w=n(2059),E=n(36),S=n(205),x=n(2204),T=(function(){function e(e,t){this._currentItem=t.currentItem;this._itemParentHelper=t.itemParentHelper;this._pageContext=t.pageContext}e.prototype.getEngagementData=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=this._currentItem,i=Object(p.getMostSpecificMatchingContext)(v.e,t),s=null!==(e=Object(g.r)(null==i?void 0:i.item))&&void 0!==e?e:Object(g.r)(r);if(s){var o=this._itemParentHelper,u=o.getFacetedAncestorOrSelf(s,"list"),a=u&&u.peek(),f=o.getFacetedAncestorOrSelf(s,"subsite"),l=f&&f.peek(),c={docId:s.properties.uniqueId};if(a){var h=a.list,d=h.id,m=h.templateType;c.listId=d;c.listTemplateId="".concat(m)}if(l&&l.subsite.serverRelativeUrl!==this._pageContext.webAbsoluteUrl){var y=l.subsite,b=(d=y.id,y.siteCollectionId),w=y.webTemplateId;c.webId=d;c.webTemplateId="".concat(w);c.siteId=b}var E=this._pageContext.userDisplayName,T=this._pageContext.userLoginName,N=T&&-1!==T.lastIndexOf("@")?T.substring(0,T.lastIndexOf("@")):void 0;c.extraData||(c.extraData={});var C=void 0;if(s&&s.sharingType){var k=s&&s.sharingType;C=k===x.e.Shared||k===x.e.Public||k===x.e.PublicUnlisted}S.e(c.extraData,{isInODB:s.itemFromServer&&s.itemFromServer.SiteTitle&&E?-1!==s.itemFromServer.SiteTitle.indexOf(E):void 0,isInODBv2:s.openUrl&&N?-1!==s.openUrl.toLowerCase().indexOf(N.toLowerCase()):void 0,isItemShared:C});return c}};e.dependencies={currentItem:d.o.optional,itemParentHelper:w.e,pageContext:E.h};return e})(),N=Object(o.s)("ItemEngagementHandler",T),C={pageContext:i.e.optional,page:f.optional,search:h.optional,item:b.optional,sharePointItem:N.optional},k=new r.t({name:"LegacyKnockoutEngagementHandlers",factory:{dependencies:C,create:function(e){var t=[],n=e.pageContext,r=e.page,i=e.search,s=e.item,o=e.sharePointItem;n&&t.push(n);r&&t.push(r);i&&t.push(i);s&&t.push(s);o&&t.push(o);return{instance:t}}}})}}]);