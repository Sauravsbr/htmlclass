(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[210],{3762:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(91),s=n(2064),o=n(2108),u=n(2084),a=n(2180),f=n(2094),l=n(2236),c=n(63),h=n(170);Object(h.n)([{rawString:".od-RemoveFromSharedList-Status{padding-top:5px}.od-RemoveFromSharedList-Status--error{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}html[dir=ltr] input.od-isSpam{margin-right:5px}html[dir=rtl] input.od-isSpam{margin-left:5px}"}]);var p=n(2044),d=n(3278),v=n(243),m=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{})||this;n.allowSpam=!!t.isSpam;n.isSpam=t.isSpam;n.status=t.status;n.hasError=t.hasError;var r=t.selection;t.hasError()?n.subText="":t.removeAccess?n.subText=r.length>1?d.h:r[0].type===v.e.Folder?d.a:d.i:n.subText=r.length>1?d.p:r[0].type===v.e.Folder?d.f:d.s;n.spamText=r.length>1?d.c:r[0].type===v.e.Folder?d.u:d.r;return n}return t})(p.t),g=n(2045).e({tagName:"ms-remove-from-sharedlist",template:'<div class="od-RemoveFromSharedList"><div class="od-RemoveFromSharedList-SubText" data-bind="text:subText"></div><span data-bind="if:allowSpam"><input id="RemoveFromSharedList-isSpam" type="checkbox" name="isSpam" class="od-isSpam" data-bind="checked:isSpam"><label for="RemoveFromSharedList-isSpam" class="spamText" data-bind="text:spamText"></label></span><div class="od-RemoveFromSharedList-Status" data-bind="text:status,css:{\'od-RemoveFromSharedList-Status--error\':hasError}"></div></div>',viewModel:m,synchronous:!0}),y=n(18),b=n(43),w=n(33),E=n(2056),S=n(370),x=n(2063),T=n(82),N=n(2060),C=n(2052),k=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=n.resources;n.name="RemoveFromSharedList";n._operationProvider=r.consume(o.resourceKey);n._urlDataSource=r.consume(T.ve);n._dialogProvider=r.consume(s.e);n._itemProvider=r.consume(x.resourceKey);n._engagement=r.consume(S.e);n._itemSelectionHelper=new(n.child(N.e))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item});return n}t.prototype.onIsAvailable=function(){if(!Object(w.isFeatureEnabled)(w.RemoveFromSharedList))return!1;var e=this._itemSelectionHelper.currentItem();if(!this._urlDataSource.isCurrentQuery(b.e.SharedWithMe,this._urlDataSource.getKeyParams(e.key)))return!1;var t=this._itemSelectionHelper.firstItem();return!(!t||t.queryType!==b.e.SharedWithMe)};t.prototype.onExecute=function(){return Object(r.__awaiter)(this,void 0,i.n,function(){var e,t,n,s,o,a,f=this;return Object(r.__generator)(this,function(h){switch(h.label){case 0:e=this.observables;return[4,this._itemSelectionHelper.resolveSelection()];case 1:t=h.sent();n=e.create("");s=e.create(!1);o=e.create(!0);a=function(e){return Object(r.__awaiter)(f,void 0,i.n,function(){return Object(r.__generator)(this,function(t){s(!0);n(e);return[2,1]})})};if(t.length>14){a(y.format(d.n,14));o(!1);this._engagement.logData({name:"RemoveFromSharedList.TooManyItems",extraData:{itemCount:t.length}})}return[4,this._dialogProvider.requestDialog({title:t.length>1?d.d:t[0].type===v.e.File||t[0].type===v.e.Media?d.o:d.l,component:{name:g.tagName,params:{isSpam:null,selection:t,removeAccess:!1,hasError:s,status:n}},actions:[{name:d.e,execute:function(){return Object(r.__awaiter)(f,void 0,i.n,function(){var e,n,i,s,o=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:e=new l.e;n=t.map(function(t){return o._operationProvider.register({name:t.displayName,type:u.e.removeFromSharedList,batch:e})});r.label=1;case 1:r.trys.push([1,3,,4]);return[4,this._itemProvider.removeFromSharedList({items:t,markAsSpam:!1,parentKey:this._urlDataSource.getRootItemKey(b.e.SharedWithMe)})];case 2:if(i=r.sent())for(s=0;s<i.length;s++)L(i[s],n[s]);return[3,4];case 3:r.sent();for(s=0;s<n.length;s++)L(d.t,n[s]);return[3,4];case 4:return[2,2]}})})},isAvailable:o,isDefault:!0,icon:new E.e("Cancel"),automationId:"removeFromSharedListConfirm"}]}).wait()];case 2:h.sent();return[2,{resultType:c.e.Success}]}})})};return t})(C.e);t.default=k;function L(e,t){if(e){t.error(new a.e({message:e}));t.state(f.e.failed)}else t.state(f.e.completed)}}}]);