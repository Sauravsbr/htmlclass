(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[219],{2391:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"n",function(){return o});var a=function(e){var t=e/1e3,n=Math.floor(t%60),a=(t=Math.floor(t/60))%60;return[Math.floor(t/60),a,n]},i=function(e){var t=Math.floor(e%1e3),n=a(e),i=n[0],r=n[1],o=n[2];return i.toString().padStart(2,"0")+":"+r.toString().padStart(2,"0")+":"+o.toString().padStart(2,"0")+"."+t.toString().padStart(3,"0")},r=function(e){var t=a(e),n=t[0],i=t[1],r=t[2];return(n>0?n.toString()+":"+i.toString().padStart(2,"0"):i.toString())+":"+r.toString().padStart(2,"0")},o=function(e){return void 0===e?NaN:e.match(/^((\d{1,}:)?[0-5]?\d:[0-5]\d)(\.\d+)?$/)?function(e){var t=e.split(":").reverse(),n=0;return t[0]&&(n+=parseFloat(t[0])),t[1]&&(n+=60*parseInt(t[1],10)),t[2]&&(n+=60*parseInt(t[2],10)*60),Math.round(1e3*n)}(e):NaN}},3655:function(e,t,n){"use strict";n.r(t),n.d(t,"ModalDialog",function(){return d});var a=n(3551),i=n(756),r=n(40),o=n.n(r),s=n(120),c=Object(a.t)({container:{display:"flex"}}),d=function(e){var t,n=!!(e.modal&&e.modal.isValid&&e.modal.props.settingsStore)&&Object(s.e)(e.modal.props.settingsStore.getSetting("isModalTabIndexDisabled","boolean"));return e.modal&&e.modal.isValid?o.a.createElement(i.e,{onDismiss:function(){e.modal.dismiss()},isOpen:!0,topOffsetFixed:null!==(t=e.modal.props.isTopOffsetFixed)&&void 0!==t&&t,containerClassName:c.container,titleAriaId:e.modal.props.titleAriaId,isBlocking:e.modal.props.isBlocking,isAlert:e.modal.props.isAlert},o.a.createElement("div",{tabIndex:n&&e.modal.props.preventTabIndex?void 0:-1,onKeyDown:function(t){"Escape"===t.key&&e.modal.isValid&&(t.preventDefault(),t.stopPropagation(),e.modal.dismiss())}},e.modal.props.getContent())):null};t.default=d},3780:function(e,t,n){"use strict";n.r(t),n.d(t,"MarkerCollection",function(){return R});var a=n(0),i=n(3542),r=n(1327),o=n(462),s=n(40),c=n.n(s),d=n(120),l=n(316),u=n(171),f=n(289),p=n(3539),m=n(2391),_=n(3551),h="white",b=function(e,t,n){return{icon:g(e,t,n),iconHovered:{color:"".concat(h)},root:v,rootHovered:y,rootPressed:S,rootFocused:D}},g=function(e,t,n){return n?{"@media screen and (-ms-high-contrast: active)":{color:"Highlight !important",backgroundColor:"HighlightText !important"},color:"".concat(h," !important"),fontSize:e,lineHeight:e,height:e,margin:"".concat(t,"px"),pointerEvents:"auto",fontStyle:"normal"}:{color:"".concat(h," !important"),fontSize:e,lineHeight:e,height:e,margin:"".concat(t,"px"),pointerEvents:"auto",fontStyle:"normal"}},v=Object(a.e)({},{backgroundColor:"unset"}),y={backgroundColor:"#323130",borderRadius:"50%"},S={backgroundColor:"#3B3A39",borderRadius:"50%"},D={border:"1px solid #A19F9D",boxSizing:"border-box",borderRadius:"50%",selectors:{"::after":{outline:"none !important"}}},I=n(80),x=function(e){return{maxWidth:"160px",calloutProps:{gapSpace:8,beakWidth:12,calloutMaxWidth:160,styles:{beak:{display:e?"none":"visible"}},doNotLayer:!0}}},C="MarkerAriaDescription",O=function(e){var t=e.options,n=e.tooltip,i=e.id,r=e.ariaLabel,o=e.markerTimeMs,s=e.relativePosition,d=e.isMarkerListItemReadoutFixEnabled,h=e.isMarkerTooltipBeakHidden,g=e.tooltipToggleHandler,v=e.isFluentMtcEnabled,y=e.onClick,S=e.log,D=e.localization,I=e.pluginIdentifier,O=e.playbackTimeSec,E=e.userActionName,A=t.icon,L=c.a.createRef();e.isFluentMtcEnabled&&w(L);var k,M={onMouseEnter:function(){g(!0),I&&S.userAction("PluginButtonAction",Object(a.e)(Object(a.e)({},I),{name:"MarkerHover-".concat(E),playbackTimeSec:O,actionType:"Hover"}))},onMouseLeave:function(){return g(!1)}},P=(k=100*s,Object(_.t)({container:{position:"absolute",left:"calc(".concat(k,"% - ").concat(16,"px)"),bottom:"100%",zIndex:4}})),T=Object(a.e)(Object(a.e)({},x(h)),{onRenderContent:function(){return c.a.createElement("div",{"aria-hidden":"true",className:U().textClipping}," ",n," ")}}),U=function(){return Object(_.t)({textClipping:{overflow:"hidden",whiteSpace:"pre-line",textOverflow:"ellipsis",minWidth:"16px",textAlign:"center",maxWidth:"144px",width:"max-content"}})};return c.a.createElement("div",Object(a.e)({key:"marker-".concat(i),className:P.container,id:"marker-container-".concat(i)},M),c.a.createElement(l.e,{id:"tooltip-marker-".concat(i),delay:u.e.zero,styles:{root:{display:"inline-block",zIndex:1e6}},tooltipProps:T},c.a.createElement(f.e,{elementRef:L,styles:b(20,6,v),onClick:y,iconProps:{iconName:A,id:"marker-".concat(i)},ariaLabel:r,"aria-description":Object(p.e)(D.getString(C),"Event",Object(m.e)(o)),role:d?"listitem":void 0})))},w=function(e){c.a.useEffect(function(){var t=function(e){e.preventDefault(),e.stopPropagation()},n=null==e?void 0:e.current;return n&&(n.addEventListener("mousedown",t),n.addEventListener("touchstart",t)),function(){n&&(n.removeEventListener("mousedown",t),n.removeEventListener("touchstart",t))}},[])},E=n(186),A=function(e){return{display:"block",position:"absolute",top:"5px",left:e?"1px":"2px",width:e?"5px":"4px",height:"4px",backgroundColor:"black"}},L=function(e){return{position:"absolute",left:"3px",top:"1px",visibility:e?"visible":"hidden",width:"1px",height:"12px",backgroundColor:"#FFFFFF"}},k={display:"block",width:"9px",height:"14px",background:"linear-gradient(to bottom, transparent 0px, transparent 5px, black 5px, black 9px, transparent 9px, transparent 100%)",maskImage:"linear-gradient(to right, transparent 0px, transparent 3px, white 3px, white 6px, transparent 6px, transparent 100%), linear-gradient(to bottom, transparent 0px, transparent 1px, white 1px, white 13px, transparent 13px, transparent 100%)",WebkitMaskImage:"linear-gradient(to right, transparent 0px, transparent 3px, white 3px, white 6px, transparent 6px, transparent 100%), linear-gradient(to bottom, transparent 0px, transparent 1px, white 1px, white 13px, transparent 13px, transparent 100%)",maskComposite:"intersect",WebkitMaskComposite:"destination-in"},M={display:"block",width:"9px",height:"14px",background:"linear-gradient(to bottom, transparent 0px, transparent 4px, black 4px, black 9px, transparent 9px, transparent 100%)",maskImage:"linear-gradient(to right, transparent 0px, transparent 3px, white 3px, white 6px, transparent 6px, transparent 100%), linear-gradient(to bottom, transparent 0px, transparent 1px, white 1px, white 13px, transparent 13px, transparent 100%)",WebkitMaskImage:"linear-gradient(to right, transparent 0px, transparent 3px, white 3px, white 6px, transparent 6px, transparent 100%), linear-gradient(to bottom, transparent 0px, transparent 1px, white 1px, white 13px, transparent 13px, transparent 100%)",maskComposite:"intersect",WebkitMaskComposite:"copy"},P={background:"linear-gradient(to right, transparent 0px, transparent 4px, white 4px, white 5px, transparent 5px, transparent 100%), linear-gradient(to bottom, transparent 0px, transparent 5px, black 5px, black 9px, transparent 9px, transparent 100%)",maskImage:"linear-gradient(to right, transparent 0px, transparent 2px, white 2px, white 7px, transparent 7px, transparent 100%), linear-gradient(to bottom, transparent 0px, transparent 1px, white 1px, white 13px, transparent 13px, transparent 100%)",WebkitMaskImage:"linear-gradient(to right, transparent 0px, transparent 2px, white 2px, white 7px, transparent 7px, transparent 100%), linear-gradient(to bottom, transparent 0px, transparent 1px, white 1px, white 13px, transparent 13px, transparent 100%)"},T=function(e){return{outlineColor:e,outlineOffset:"-3px",maskImage:"linear-gradient(to right, transparent 0px, transparent 2px, white 2px, white 7px, transparent 7px, transparent 100%), linear-gradient(to bottom, transparent 0px, transparent 1px, white 1px, white 13px, transparent 13px, transparent 100%)",WebkitMaskImage:"linear-gradient(to right, transparent 0px, transparent 2px, white 2px, white 7px, transparent 7px, transparent 100%), linear-gradient(to bottom, transparent 0px, transparent 1px, white 1px, white 13px, transparent 13px, transparent 100%)"}},U=function(e,t){return void 0===t&&(t=!1),{root:t?M:k,rootHovered:P,rootFocused:T(e)}},F=function(e){var t=e.tooltip,n=e.id,i=e.ariaLabel,r=e.markerTimeMs,o=e.relativePosition,s=e.isMarkerListItemReadoutFixEnabled,d=e.isMarkerTooltipBeakHidden,h=e.isTimelineMarkerGradientRenderingEnabled,b=e.isFluentMtcEnabled,g=e.localization,v=e.tooltipToggleHandler,y=e.onClick,S=Object(E.e)().semanticColors.focusBorder,D=function(e,t){return t?Object(_.t)({container:{position:"absolute",left:"".concat(e,"%"),bottom:"auto",zIndex:0,pointerEvents:"auto"}}):Object(_.t)({container:{position:"absolute",left:"".concat(e,"%"),bottom:"auto",zIndex:12}})}(100*o,b),O=Object(a.e)(Object(a.e)({},x(d)),{onRenderContent:function(){return c.a.createElement("div",{"aria-hidden":"true",className:Object(I.te)({textClipping:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}}).textClipping}," ",t," ")}});return c.a.createElement("div",{key:"marker-".concat(n),className:D.container,id:"marker-container-".concat(n)},c.a.createElement(l.e,{id:"tooltip-marker-".concat(n),delay:u.e.zero,styles:{root:{display:"block",height:"14px",width:"8px",transform:"translateX(-50%)",zIndex:1e6}},tooltipProps:O,onTooltipToggle:v},h?c.a.createElement(f.e,{styles:U(S,b),onClick:y,id:"marker-".concat(n),role:s?"listitem":void 0,ariaLabel:i,"aria-description":Object(p.e)(g.getString(C),"Chapter",Object(m.e)(r))}):c.a.createElement("div",{style:{display:"block",height:"100%",width:"100%"},onMouseEnter:function(){var e=document.getElementById("marker-".concat(n)),t=A(!0);e&&(e.style.width=String(t.width),e.style.left=String(t.left));var a=document.getElementById("timeline-marker-snap-pointer-".concat(n));a&&(a.style.visibility=String(L(!0).visibility))},onMouseLeave:function(){var e=document.getElementById("marker-".concat(n)),t=A(!1);e&&(e.style.width=String(t.width),e.style.left=String(t.left));var a=document.getElementById("timeline-marker-snap-pointer-".concat(n));a&&(a.style.visibility=String(L(!1).visibility))}},c.a.createElement("div",{id:"marker-".concat(n),style:A(!1),tabIndex:0,role:s?"listitem":"button","aria-label":i,"data-is-focusable":!0,onClick:y}),c.a.createElement("div",{id:"timeline-marker-snap-pointer-".concat(n),style:L(!1)}))))},H=function(e){return e.isVisible?"AboveTimeline"===e.options.type?c.a.createElement(O,Object(a.e)({},e,{options:e.options})):c.a.createElement(F,Object(a.e)({},e)):null},R=function(e){var t=Object(d.e)(e.settingsStore.getSetting("isMarkerHidingOnSmallScreensEnabled","boolean")),n=Object(d.e)(e.settingsStore.getSetting("isMarkerTooltipBeakHidden","boolean")),s=Object(d.e)(e.settingsStore.getSetting("isMarkerClickLoggingInsidePlatformEnabled","boolean")),l=Object(d.e)(e.settingsStore.getSetting("isTimelineMarkerGradientRenderingEnabled","boolean")),u=Object(d.e)(e.settingsStore.getSetting("isMarkerCollisionLogicEnabled","boolean")),f=c.a.useState(new Set),p=f[0],m=(f[1],c.a.useState(e.videoRegionWidth.value)),_=m[0],h=m[1];c.a.useEffect(function(){if(t&&e.videoRegionWidth){var n=Object(i.t)(function(){e.videoRegionWidth&&h(e.videoRegionWidth.value)},200);return e.videoRegionWidth.subscribe(n)}},[t,e.videoRegionWidth]);var b=c.a.useMemo(function(){return Object(a.c)([],e.components,!0).sort(function(e,t){return e.timeMs-t.timeMs})},[e.components]),g=Object(d.e)(e.settingsStore.getSetting("isMarkerListItemReadoutFixEnabled","boolean"));c.a.useMemo(function(){if(u){var t=function(t){return t*_/e.videoLengthInMs};[["AboveTimeline",36],["OnTimeline",9]].forEach(function(n){var i=n[0],r=n[1],o=b.filter(function(e){return e.props.markerOptions.type===i});if(o.length){var s=t(o[0].timeMs);o.slice(1).forEach(function(n){var o=t(n.timeMs);if(null!==s&&o-s<r&&n.pluginIdentifier&&!p.has(n.id)&&(!n.props.videoContainerWidthThreshold||_>n.props.videoContainerWidthThreshold))return e.log.appLogic("PluginAppLogic",Object(a.e)({name:"MarkerCollision".concat(i,"-").concat(n.props.userActionLoggingInfo.userActionName)},n.pluginIdentifier)),void p.add(n.id);s=o})}})}},[u,b,e.log,e.videoLengthInMs,_,p]);var v=function(i){var r;return!(null==i?void 0:i.isVisible)||t&&i.props.videoContainerWidthThreshold&&_<i.props.videoContainerWidthThreshold?null:c.a.createElement(H,{key:"marker-".concat(i.id),isMarkerTooltipBeakHidden:n,isTimelineMarkerGradientRenderingEnabled:l,isMarkerListItemReadoutFixEnabled:g,isVisible:i.isVisible,id:i.id,ariaLabel:i.props.ariaLabel,markerTimeMs:i.props.timeMs,tooltip:i.tooltip,options:i.props.markerOptions,relativePosition:i.timeMs/e.videoLengthInMs,onClick:function(){var t;if(e.currentPlaybackTimeInSeconds.value=i.timeMs/1e3,i.props.onClick(),s&&i.pluginIdentifier){var n=i.props.userActionLoggingInfo.additionalSchema||{};e.log.userAction("PluginButtonAction",Object(a.e)(Object(a.e)(Object(a.e)({name:"MarkerClick-".concat(i.props.userActionLoggingInfo.userActionName)},i.pluginIdentifier),n),{actionType:"LeftClick",playbackTimeSec:null!==(t=e.currentPlaybackTimeInSeconds.value)&&void 0!==t?t:-1}))}},tooltipToggleHandler:e.tooltipToggleHandler,log:e.log,localization:e.localization,pluginIdentifier:i.pluginIdentifier,playbackTimeSec:null!==(r=e.currentPlaybackTimeInSeconds.value)&&void 0!==r?r:-1,userActionName:i.props.userActionLoggingInfo.userActionName,isFluentMtcEnabled:e.isFluentMtcEnabled})};return e.showLoadingUi?null:g?c.a.createElement(r.e,{direction:1,onKeyDown:function(e){if("Tab"===e.key){var t=e.currentTarget.querySelectorAll('[role="listitem"]');t.forEach(function(e,t){e.setAttribute("tabIndex",t?"-1":"0")}),t[0].focus()}},role:"list"},b.map(function(e){return v(e)})):c.a.createElement(r.e,{direction:1},c.a.createElement(o.e,{items:b,onRenderCell:v}))};t.default=R},3848:function(e,t,n){"use strict";n.r(t),n.d(t,"ButtonCollection",function(){return m});var a=n(0),i=n(3542),r=n(215),o=n(316),s=n(171),c=n(154),d=n(401),l=n(40),u=n.n(l),f=n(120),p=n(3551),m=function(e){var t=u.a.useState(screen.width),n=t[0],l=t[1],m=Object(p.t)({container:{display:"flex",justifyContent:"flex-end"}}),_=Object(f.e)(e.settingsStore.getSetting("isControlBarButtonsLocalizationEnabled","boolean")),h=Object(f.e)(e.settingsStore.getSetting("areAriaLabeAndRoleWhenButtonCollectionHasOneChildDisabled","boolean")),b=function(e,t){var i={},r={},o="";return t&&t.isUnderlined&&(i={content:"''",display:"block",height:"4px",width:"calc(100% - 4px)",margin:"0 2px",position:"absolute",bottom:"-8px",backgroundColor:"rgba(255, 255, 255, 0.5)",boxSizing:"inherit"},r=Object(a.e)(Object(a.e)({},i),{bottom:"-8px !important",top:"unset !important",left:"unset !important",right:"unset !important",outline:"unset !important"}),o="1px solid"),{root:{backgroundColor:"unset",border:0,minWidth:32,padding:0,color:"white",selectors:{"::after":i},display:e&&t&&t.reflowThreshold&&n<t.reflowThreshold?"none":"inline-block"},rootHovered:{backgroundColor:"unset",color:"white"},rootPressed:{backgroundColor:"unset"},rootFocused:{selectors:{"::after":r},outline:o},rootCheckedHovered:{selectors:{"::after":r},backgroundColor:"unset"},rootChecked:{selectors:{"::after":r},backgroundColor:"unset"},icon:{color:"white !important",fontSize:"20px",margin:0},label:{margin:0},iconHovered:{color:"white"}}},g=function(t){var n=Object(f.e)(e.settingsStore.getSetting("addAriaAttributesToToggleButton","boolean"));return e.components.filter(function(e){return e.props.type===t&&e.isVisible}).map(function(e){var a;return{key:"button-".concat(e.id),text:"Secondary"===t?e.tooltip:"",iconProps:{iconName:e.icon},iconOnly:!0,onClick:y(e.props.onClick,e.userActionName,e.pluginIdentifier),disabled:!e.isEnabled,tooltip:e.tooltip,ariaLabel:e.ariaLabel,isUnderlined:e.isUnderlined,reflowThreshold:e.reflowThreshold,toggle:n?!!e.props.toggleButtonRole:null,role:n?null!==(a=e.props.toggleButtonRole)&&void 0!==a?a:"button":null,"aria-checked":n&&e.props.toggleButtonRole&&"switch"===e.props.toggleButtonRole?e.isUnderlined:null,checked:n&&e.props.toggleButtonRole&&"switch"!==e.props.toggleButtonRole?e.isUnderlined:null}})},v=function(){return g("Primary")};u.a.useEffect(function(){var e=function(){l(Math.min(screen.width,window.innerWidth))},t=Object(i.n)(e,200);return e(),window.addEventListener("resize",t),function(){window.removeEventListener("resize",t)}},[]);var y=function(t,n,i){return function(){var r;t(),i&&e.log.userAction("PluginButtonAction",Object(a.e)(Object(a.e)({name:n},i),{actionType:"LeftClick",playbackTimeSec:null!==(r=e.currentPlaybackTimeInSeconds.value)&&void 0!==r?r:-1}))}},S=h&&1===v().length?void 0:_?e.localization.getString("ControlBarButtonsAriaLabel"):"Control Bar Buttons",D=h&&1===v().length?void 0:"menubar";return v().length>0?u.a.createElement("div",{className:m.container},u.a.createElement(d.e,{vertical:e.vertical,"aria-label":S,role:D,items:v(),overflowItems:g("Secondary"),onRenderOverflowButton:function(e){return u.a.createElement(c.e,{role:"menuitem",title:"More items",styles:b(),menuIconProps:{iconName:r.e.More,styles:{root:{color:"white !important"}}},menuProps:{items:e}})},onRenderItem:function(t){var n=Object(f.e)(e.settingsStore.getSetting("enableHidingButtonOnReflow","boolean")),i=b(n,t),r={root:{display:i.root.valueOf().display,zIndex:1e6}};return u.a.createElement(o.e,{delay:s.e.zero,content:t.tooltip,id:"tooltip-".concat(t.key),styles:r,calloutProps:{doNotLayer:!0}},u.a.createElement(c.e,Object(a.e)({},t,{styles:i})))}})):null};t.default=m}}]);