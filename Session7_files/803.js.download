(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[803,322,485,571],Array(1822).concat([function(e,t,n){"use strict";var r=n(812);n.d(t,"e",function(){return r.t});n.d(t,"t",function(){return r.n});n.d(t,"n",function(){return r.r});n.d(t,"r",function(){return r.s});n.d(t,"i",function(){return r.o});n.d(t,"s",function(){return r.u})},,function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return o});var r=n(1121),i=n(7),s=n(1286),o=new i.t({name:"".concat("IsDetailsPaneExpanded",".isDetailsPaneExpanded"),factory:{dependencies:{detailsPaneId:s.e,observablesFactoryType:r.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})}],Array(49),[function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return xt});var r=n(170);Object(r.n)([{rawString:".OneUp{position:absolute;left:0;right:0;top:0;bottom:0;overflow:hidden;outline:0;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.OneUp.OneUp--darkBackground{background-color:#1b1a19}.OneUp-detailsBar{visibility:hidden;opacity:0}.OneUp-detailsBar .CommandBarItem{flex:0 0 auto}html[dir=ltr] .OneUp-detailsBar .CommandBarItem{margin-right:0}html[dir=rtl] .OneUp-detailsBar .CommandBarItem{margin-left:0}.OneUp-detailsBar .CommandBarItem .CommandBarItem-icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.OneUp-detailsBar .CommandBarItem{background-color:"},{theme:"menuItemBackgroundHovered",defaultValue:"#f3f2f1"},{rawString:";opacity:.9}.OneUp-detailsBar .CommandBarItem.is-toggled,.OneUp-detailsBar .CommandBarItem.is-toggled:hover,.OneUp-detailsBar .CommandBarItem:hover{background-color:"},{theme:"menuItemBackgroundPressed",defaultValue:"#edebe9"},{rawString:";opacity:1}.OneUp-toolbarHost{display:flex;flex-flow:column-reverse nowrap;justify-content:center;align-items:center}.OneUp-toolbar{background-color:transparent;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";height:44px;display:flex;align-items:stretch;justify-content:center;flex-flow:row nowrap}.lg .OneUp-toolbar,.xlg .OneUp-toolbar,.xxlg .OneUp-toolbar,.xxxlg .OneUp-toolbar,.xxxxlg .OneUp-toolbar{height:40px}.OneUp-commandBar{position:absolute;left:0;right:0;top:-44px;z-index:2;visibility:hidden;height:44px;transition:visibility 267ms linear,top 267ms linear;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem:hover{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Word{background-color:"},{theme:"wordColor",defaultValue:"#2b579a"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Word .ms-Icon--WordLogo:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Word .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Excel{background-color:"},{theme:"excelColor",defaultValue:"#217346"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Excel .ms-Icon--ExcelLogo:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Excel .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint{background-color:"},{theme:"powerpointColor",defaultValue:"#d24726"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint .ms-Icon--PowerPointLogo:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PDF{background-color:#c90304;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PDF .ms-Icon--PDF:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PDF .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PrimaryButton{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PrimaryButton:hover{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .ms-CommandBar{padding:0}.sm .OneUp-commandBar{top:-44px;height:44px}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar{padding-right:2px;border:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar{margin:0 4px}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.hide-label .ms-Button-label{display:none}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PrimaryButton{margin:6px 14px 6px 10px;padding:8px;border-radius:"},{theme:"roundedCorner4",defaultValue:"4px"},{rawString:"}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PrimaryButton .ms-Button-textContainer{padding-bottom:4px}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--editPhoto{width:82px;margin:6px 14px 6px 18px;background:#0078d4;color:#fff;height:auto;padding:10px 0;border-radius:4px}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--editPhoto::after{outline:#fff 1px solid}.md .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar,.sm .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar{height:auto}.md .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar .ms-Button-icon,.sm .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar .ms-Button-icon{font-size:16px}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar i[data-icon-name=More]{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.is-disabled i[data-icon-name=Next],.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.is-disabled i[data-icon-name=Previous]{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";opacity:.3}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--separator{margin:0;padding:0;min-width:29px}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar i[data-icon-name=Separator]{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--pageCount{margin:0 8px}.OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar i[data-icon-name=Cancel]{color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:"}.md .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar,.sm .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar{height:44px}.CommandBar-center{text-align:center}.OneUp-accessibleItemAnnouncement{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.OneUp-content{position:absolute;left:0;top:0;bottom:0;right:0;transition:top 267ms linear,left 367ms cubic-bezier(.1,.9,.2,1),right 367ms cubic-bezier(.1,.9,.2,1)}.OneUp-carousel{position:absolute;left:0;right:0;top:0;bottom:0;z-index:1;transition:top 267ms linear}.sm .OneUp--hasCommandBar .OneUp-paneHost{top:44px}.OneUp--hasCommandBar .ms-Button--commandBar .ms-Button-menuIcon{background-color:inherit}.OneUp--hasCommandBar .ms-Button--commandBar.is-disabled{background-color:inherit;color:inherit}.OneUp--hasCommandBar .OneUp-content,.OneUp--hasCommandBar .OneUp-paneHost{top:44px}.OneUp--hasCommandBar .OneUp-commandBar{visibility:visible;top:0}html[dir=ltr] .OneUp--hasCommandBar .OneUp-commandBar{padding-left:16px}html[dir=rtl] .OneUp--hasCommandBar .OneUp-commandBar{padding-right:16px}.OneUp-detailsBar{transition:visibility 0s linear 267ms,opacity 267ms linear,bottom 267ms linear;position:absolute;left:0;right:0;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";z-index:1}[dir=ltr] .lg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .md .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xlg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xxlg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xxxlg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xxxxlg .OneUp--hasInfoPane .OneUp-content{right:320px}[dir=rtl] .lg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .md .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xlg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xxlg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xxxlg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xxxxlg .OneUp--hasInfoPane .OneUp-content{left:320px}[dir=ltr] .OneUp--hasInfoPane .OneUp-paneHost{right:0}[dir=rtl] .OneUp--hasInfoPane .OneUp-paneHost{left:0}.sm .OneUp--hasInfoPane .OneUp-infoPane,.sm .OneUp--hasInfoPane .OneUp-paneHost{width:100%}.OneUp--slideShowOn .OneUp-commandBar{visibility:hidden}.OneUp--slideShowOn .OneUp-content{top:0}.OneUp--awake .OneUp-detailsBar{visibility:inherit;opacity:1;transition-delay:0s,0s,0s}.OneUp--awake.OneUp--slideShowOn .OneUp-commandBar{visibility:inherit}.OneUp-caption-container{display:flex;align-items:center;justify-content:center;width:100%;background-color:"},{theme:"oneUpPaneBackground",defaultValue:"rgba(255,255,255,.75)"},{rawString:"}.OneUp-caption{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";flex:1 1 auto;height:30px;border:0;padding:0;background:0 0;text-align:center;width:100%;max-width:600px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;vertical-align:middle;font-size:14px;font-weight:400}.OneUp-caption--editable{cursor:pointer}.OneUp-caption-clipper{display:table-cell;max-width:600px;height:30px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;vertical-align:middle;font-size:14px;font-weight:400}.lg .OneUp-caption-clipper{max-width:510px}.md .OneUp-caption-clipper{max-width:345px}.sm .OneUp-caption-clipper{max-width:150px}.OneUp-options{position:absolute;top:0;bottom:0;text-align:right}[dir=ltr] .OneUp-options{right:8px}[dir=rtl] .OneUp-options{left:8px}.OneUp-info{position:absolute;top:0;display:block;padding:20px 8px;height:40px}[dir=ltr] .OneUp-info{right:0}[dir=rtl] .OneUp-info{left:0}.OneUp-paneHost{position:absolute;width:320px;top:0;bottom:0;overflow:hidden;z-index:1}[dir=ltr] .OneUp-paneHost{right:-321px}[dir=rtl] .OneUp-paneHost{left:-321px}.OneUp-infoPane{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:absolute;top:0;bottom:0;right:0;width:320px}.od-userSelect--enabled .OneUp-infoPane{-webkit-touch-callout:text;-webkit-user-select:text;-ms-user-select:text;user-select:text}.OneUp .od-Panel,.OneUp .od-PanelOverlay{top:0}.isFluentVNext .OneUp-commandBar{top:-48px;height:48px}.isFluentVNext .sm .OneUp-commandBar{top:-48px;height:48px}.isFluentVNext .sm .OneUp--hasCommandBar .OneUp-paneHost{top:48px}.isFluentVNext .OneUp--hasCommandBar .OneUp-content,.isFluentVNext .OneUp--hasCommandBar .OneUp-paneHost{top:48px}.isFluentVNext .OneUp--hasCommandBar .OneUp-commandBar{top:0}.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar{background-color:"},{theme:"bodyStandoutBackground",defaultValue:"#faf9f8"},{rawString:"}.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PrimaryButton{padding:0 8px}.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PrimaryButton .ms-Button-textContainer{padding-bottom:0;height:16px}.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--editPhoto{padding:0}.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PrimaryButton,.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--editPhoto{margin-top:4px;margin-bottom:4px}.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PrimaryButton:active .ms-Button-flexContainer,.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PrimaryButton:focus .ms-Button-flexContainer,.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PrimaryButton:hover .ms-Button-flexContainer,.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--editPhoto:active .ms-Button-flexContainer,.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--editPhoto:focus .ms-Button-flexContainer,.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--editPhoto:hover .ms-Button-flexContainer{background-color:inherit}.ms-Fabric--isFocusVisible .isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PrimaryButton:focus,.ms-Fabric--isFocusVisible .isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--editPhoto:focus{box-shadow:none;outline:0}.ms-Fabric--isFocusVisible .isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--PrimaryButton:focus::after,.ms-Fabric--isFocusVisible .isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.od-Command--editPhoto:focus::after{top:0;bottom:0;left:0;right:0;outline-offset:-1px;outline:2px solid "},{theme:"focusBorder",defaultValue:"#605e5c"},{rawString:";border:2px solid "},{theme:"primaryButtonText",defaultValue:"#ffffff"},{rawString:"}.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.is-disabled i[data-icon-name=Next],.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar.is-disabled i[data-icon-name=Previous]{color:"},{theme:"buttonTextDisabled",defaultValue:"#a19f9d"},{rawString:"}.isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar .ms-Button--commandBar i[data-icon-name=Separator]{line-height:20px;width:20px;height:20px;font-size:20px}.md .isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar,.sm .isFluentVNext .OneUp--hasCommandBar.OneUp--newDesignedCommandBar .OneUp-commandBar .ms-CommandBar{height:48px}"}]);var i=n(0),s=n(2044),o=n(171),u=n(2907),a=n("knockout-lib"),f=n(2158),l=n(2163),c=n(2119),h=n(2055),p=n(68),d=n(2078),v=n(36),m=n(33),g=n(2056),y=n(2292),b=n(2332),w=n(2994),E=n(2451),S=n(2876),x=n(91),T=n(63),N=n(2052),C=n(2060),k=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="AccessibilityMode";r._accessibilityMode=t.accessibilityMode;r._itemSelectionHelper=new(r.child(C.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&!!e.officeBundle&&e.appMap===y.h};t.prototype.onExecute=function(e,t){this._accessibilityMode(!this._accessibilityMode.peek());return x.n.resolve({resultType:T.e.Success})};return t})(N.e),L=(n(2450),n(2395)),A=n(2502),O=n(18),M=n(1121),_=n(7),D=n(119),P=new _.t({name:"OneUpSharingDialog.key",loader:new D.t(function(){return n.ee([771],5380).then(function(e){return e.resourceKey.local})})}),H=n(2096),B=n(2392),j=n(340),F=n(2458),I=n(132),q=n(3136),R=n(371),U=n(82),z=n(602),W=n(52),X=n(2320),V=n(35),$=n(46),J=n(37),K=n(88),Q=n(673),G=n(4605),Y=n(3137),Z=n(10),ee=[{flightStringId:"FamilySharing",flightEnabled:Object(m.isFeatureEnabled)(m.FamilySharing)},{flightStringId:"ManageAccessRevampConsumer",flightEnabled:Object(m.isFeatureEnabled)(m.ManageAccessRevampConsumer)},{flightStringId:"ODCHideNonPremiumLinkFeatures",flightEnabled:Object(m.isFeatureEnabled)(m.ODCHideNonPremiumLinkFeatures)},{flightStringId:"ODCRequestAccess",flightEnabled:Object(m.isFeatureEnabled)(m.ODCRequestAccess)},{flightStringId:"SharingTooltipCalloutKS",flightEnabled:Object(m.isFeatureEnabled)(m.SharingTooltipCalloutKS)}],te=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this,i=r,s=i.observables,u=i.resources,a=t.renderLabel,f=void 0===a?0:a,l=t.mode,c=t.engagementName,h=t.automationId,p=t.location;r._urlDataSource=u.consume(U.ve);r._pageContext=u.consume(v.h.optional);r._itemUrlHelper=u.consume(Q.a.optional);r._automationId=h;r._mode=l;r._overrideEngagementName=c;r._isConsumer=!r._pageContext;r._actionMap=u.consume(o.e);r._itemsStore=u.consume(H.t);r._focusItemResourceKey=r._getShareItemResourceKey();r._itemBeingShared=u.consume(r._focusItemResourceKey);r._shareAuthToken=r.createObservable();r.resources.consumeAsync(U.S).then(function(e){return(r._isConsumer?e.getGraphToken({forceRefresh:!0}):e.getSharePointToken(new W.t(r._pageContext.webAbsoluteUrl).getAuthority())).then(function(e){r._shareAuthToken(e.accessToken)})});s.backgroundCompute(r._computeIsOpen);r._renderLabel=f;r._location=p;r._initializeCommand();return r}t.prototype._initializeCommand=function(){var e=this._getCommandProperties();this.command=new(this.managed(d.e))(e)};t.prototype._computeIsOpen=function(){this._itemBeingShared()&&this.command.isOpen(!0)};t.prototype._getPayload=function(){var e=this,t=this.observables,n=this.createPureComputed(this._computeShareParams),r=this.createPureComputed(function(){return!!e._itemBeingShared()}),i=t.create();t.backgroundCompute(function(){r.peek()?e.trackPromise(x.n.resolve(e.resources.consumeAsync(P.local))).done(function(e){i(e)}):r()});return this.createPureComputed(function(){var e=i(),t=n();if(e&&t)return e.toSpecification(t)})};t.prototype._computeShareParams=function(){var e,t,r,s=this,u=this._itemBeingShared(),a=u?this._itemsStore.getItem(u.items[0].key):void 0;if(a){var f=a.peek(),l=this.resources.consume(o.j).peek(),c=l&&l[z.n.idParamKey],h=l[z.n.listUrlKey]||(null===(e=this._pageContext)||void 0===e?void 0:e.listUrl),p=(null===(t=this._urlDataSource)||void 0===t?void 0:t.isItemCrossList)&&(null===(r=this._urlDataSource)||void 0===r?void 0:r.isItemCrossList(f.key)),d=function(){var e;return s._isConsumer?"odc":(null===(e=s._pageContext)||void 0===e?void 0:e.listBaseTemplate)===Z.t.mySiteDocumentLibrary?"odb":"sharepoint"},v=function(){s._itemBeingShared.peek()&&s._itemBeingShared(void 0)};return{getSharingInformation:function(){var e,t,n,r;if(s._isConsumer){var i="https://"+new W.t(location.href).getAuthority();return Promise.resolve({authToken:s._shareAuthToken(),webAbsoluteUrl:i,isODB:!s._isConsumer,itemName:f.name,itemId:f.itemId,listUrl:h||i,serverRelativeItemUrl:c})}return p?Promise.resolve({authToken:s._shareAuthToken(),webAbsoluteUrl:s._itemUrlHelper.getItemUrlParts(f.key).fullWebUrl,listUrl:h,serverRelativeItemUrl:c,isODB:!s._isConsumer,itemName:f.name,cookieAuthIframeUrlForCrossDomain:"".concat(s._pageContext.webAbsoluteUrl,"/_layouts/15/sharedialog.aspx?crossdomain=true&clickTime=").concat(Date.now(),"&policyTip=").concat(null!==(e=f.policyTip)&&void 0!==e?e:"")}):Promise.resolve({cookieAuthIframeUrl:"".concat(s._pageContext.webAbsoluteUrl,"/_layouts/15/sharedialog.aspx?listId=").concat(null!==(t=s._pageContext.listId)&&void 0!==t?t:"","&listItemId=").concat(null!==(n=f.properties.ID)&&void 0!==n?n:"","&clientId=").concat(d(),"&policyTip=").concat(null!==(r=f.policyTip)&&void 0!==r?r:"","&clickTime=").concat(Date.now())})},getClientId:d,initializeShareFrame:function(e){var t,r,o=e.parentElement,a=e.calloutProps,l=e.sharingInformation,c=l.webAbsoluteUrl,h=l.serverRelativeItemUrl,d=l.listUrl,m=l.authToken,g=a.defaultRecipients,y=a.itemName,b=a.locale,w=a.theme,E=a.getClientId,S={authToken:m||"",clientId:E(),mode:s._mode===q.e.share?G.e.share:G.e.copy,listItemId:f.itemId||"",itemName:y,itemAppmap:f.appMap,itemType:f.type,itemExtension:f.extension,correlationId:null!==(r=null===(t=s._pageContext)||void 0===t?void 0:t.CorrelationId)&&void 0!==r?r:$.e.generate(),scenarioId:u.scenarioId||"OneUp",hostOptions:{showCloseButton:!0,hideShareDialogOverflowButton:!0},hostMethod:s._isConsumer?Y.e.microservice:Y.e.sharepoint,serverRelativeItemUrl:h,listUrl:d,webAbsoluteUrl:c||"",defaultRecipients:g,theme:w||Object(J._)(),locale:b,fullScreenIframe:p,consumerFlightContexts:s._isConsumer?ee:[]},x=new K.e({name:"OneUp.LoadShare",extraData:{clientId:E(),scenarioId:S.scenarioId||"",correlationId:S.correlationId||"",mode:s._mode}});Object(i.__awaiter)(s,void 0,void 0,function(){var e;return Object(i.__generator)(this,function(t){switch(t.label){case 0:return[4,n.ee(62,3603)];case 1:return[4,new(0,t.sent().SharePrefetch)({element:o,environment:this._isConsumer?V.e.prod:null!==(e=this._pageContext.env2)&&void 0!==e?e:V.e.prod,locale:b,disableIframeDomainCheck:!0,isConsumer:this._isConsumer,context:S,styles:{minWidth:window.innerWidth>=X.t.DEFAULT_BREAKPOINTS.Medium?"480px":void 0},options:{onError:function(e){x.data=Object(i.__assign)(Object(i.__assign)({},x.data),{resultType:T.e.Failure,error:e.message,resultCode:e.resultCode+"."+e.name,extraData:Object(i.__assign)(Object(i.__assign)({},x.data.extraData),{error:e})});x.end()},onReady:function(){x.data=Object(i.__assign)(Object(i.__assign)({},x.data),{resultType:T.e.Success});x.end()},onTimeout:function(){x.data=Object(i.__assign)(Object(i.__assign)({},x.data),{resultType:T.e.Failure,error:"Timeout initializing Share in OneUp",resultCode:"TIMEOUT",extraData:Object(i.__assign)({},x.data.extraData)});x.end()},onDismiss:v}}).initializeUI()];case 2:t.sent();return[2]}})})},mode:this._mode,locale:R.e.language||"en-US",itemName:f.name,resolve:v,reject:v}}};t.prototype._getShareItemResourceKey=function(){var e=new _.t({name:"share",factory:new _.e(this.observables.create())});switch(this._mode){case q.e.share:return this._isConsumer?e:F.shareFocusItemResourceKey;case q.e.copyLink:return F.copyLinkFocusItemResourceKey;default:return this._isConsumer?e:F.shareFocusItemResourceKey}};t.prototype._getCommandProperties=function(){var e,t={text:void 0,accessibleLabel:void 0,tooltip:void 0,icon:void 0,keys:void 0,action:void 0,payload:void 0,engagementName:void 0,renderLabel:this._renderLabel,enableRecoverFocusBinding:void 0,beakColor:void 0,location:void 0,automationId:this._automationId};if(this._mode===q.e.copyLink){t.text=h.CopyLinkCommandText;e=h.CopyLinkCommandTooltipV3;t.icon=new g.e("Link")}else{t.text=h.Share;e=h.ShareCommandTooltipV3;t.icon=new g.e("Share");t.keys=["S"]}this._overrideEngagementName?t.engagementName=this._overrideEngagementName:this._mode===q.e.copyLink?t.engagementName="GetLink":t.engagementName="Share";t.action=this._isConsumer?new(this.managed(this._actionMap.ShowShareMultiItemAction))({focusItems:this._itemBeingShared}):new(this.managed(this._actionMap.ShowShareAction))({focusItemResourceKey:this._focusItemResourceKey});t.payload={control:this._getPayload(),timeout:36e5,announce:!1,autoDismiss:!1,preventDismissOnScroll:!0,preventDismissOnResize:!0,preventDismissOnLostFocus:!0};t.enableRecoverFocusBinding=!1;t.beakColor=j.e.neutralLighterAlt;t.location=Object(I.s)()?4:this._location;var n=this.resources.consume(B.e),r=this.createPureComputed(function(){return n()}),i=this.createPureComputed(function(){return n()?O.format(A.c,e):e}),s=this.createPureComputed(function(){return n()?O.format(A.c,t.text):t.text});t.isDisabled=r;t.tooltip=i;t.accessibleLabel=s;t.prependTextToAccessibleLabel=!1;return t};return t})(M.default),ne=n(19),re=["S"],ie=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=n.resources;n._actionMap=r.consume(o.e);n._selection=r.consume(o.k);n._coachmarkProvider=n.resources.consume(L.resourceKey.optional);n._focusItem=r.consume(o.m);var s=r.consume(v.h.optional),u=n.scope.attach(new(r.consume(w.e.local))({})),f=n.createPureComputed(n._computeOpenInOfficeOnlineText),l=n.createPureComputed(n._computeOpenInOfficeClientText),c=n.createPureComputed(n._computOpenInOfficeSuffixClass),y=n.createPureComputed(n._computeOfficeIcon),b=[new(n.managed(d.e))({text:f,renderLabel:1,icon:y,classSuffix:c,action:new(n.managed(n._actionMap.OpenInOfficeOnlineAction))}),new(n.managed(d.e))({text:l,renderLabel:1,icon:y,classSuffix:c,action:new(n.managed(n._actionMap.OpenInOfficeClientAction))})],x=[new(n.managed(d.e))({text:h.OpenInBrowser,renderLabel:1,icon:new g.e("PDF"),classSuffix:"PDF od-Command--PrimaryButton",action:new(n.managed(n._actionMap.OpenPdfInBrowserAction))}),new(n.managed(d.e))({text:h.OpenInTextEditor,renderLabel:1,icon:new g.e("Edit"),action:new(n.managed(n._actionMap.OpenInTextEditorAction))})];Object(m.isFeatureEnabled)(m.EnableNewStreamWebAppInStreamAspx)&&x.push(new(n.managed(d.e))({text:h.OpenInSWA,renderLabel:1,tooltip:h.StreamTooltip,icon:new g.e("StreamLogo"),action:new(n.managed(n._actionMap.OpenSWAAction))}));Object(m.isFeatureEnabled)(m.EnableOpenInImmersiveReader)&&x.push(new(n.managed(d.e))({text:h.OpenInImmersiveReader,renderLabel:1,icon:new g.e("ReadOutLoud"),action:new(n.managed(n._actionMap.OpenInImmersiveReaderAction))}));var T=n.observables.createArray([]);n.createBackgroundComputed(function(){T.splice.apply(T,Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)([0,T.peek().length],b,!1),u.openWithCommands(),!1),x,!1))});var N=!ne.e.isActivated("87A98177-29BF-4F14-87EA-D65E55C9BE0B","07/12/2022","allow to use new share dialog from oneup command bar"),C=N&&Object(m.isFeatureEnabled)(m.OneUpNewShareDialog)?new(n.managed(te))({renderLabel:2,mode:q.e.share,location:3,automationId:"share"}).command:s?Object(m.isFeatureEnabled)(m.ShareV3)?new(n.managed(E.t))({renderLabel:2,mode:0,automationId:"share"}).command:new(n.managed(d.e))({text:h.Share,tooltip:h.ShareCommandTooltipV3,renderLabel:2,icon:new g.e("Share"),automationId:"share",action:Object(m.isFeatureEnabled)(m.UseNewSharingDialog)&&"21"===s.webTemplate?new(n.managed(n._actionMap.ShareByLinkAction))({sharingMethod:2}):new(n.managed(n._actionMap.ShareAction))({activeTab:1}),keys:re}):new(n.managed(d.e))({text:h.Share,renderLabel:2,icon:new g.e("Share"),automationId:"share",action:new(n.managed(n._actionMap.ShareByLinkAction)),keys:re}),A=n.createPureComputed(function(){var e,t=n._focusItem&&n._focusItem(),r=t&&t(),i=n._computeFileIconUrl(r),s=null!==(e=null==r?void 0:r.displayName)&&void 0!==e?e:"",o=s.replace(/(.{21}).+(\..+)/,"$1...$2");return{title:s,compressedTitle:o,iconUrl:i}}),O=n.createPureComputed(function(){return A().title}),M=n.createPureComputed(function(){return A().compressedTitle}),_=n.createPureComputed(function(){return A().iconUrl}),D=r.consume(S.e);n.commands(Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)([new(n.managed(d.e))({text:h.Open,classSuffix:c,renderLabel:1,requiredChildren:1,collapseSingleChildCommands:!1,location:3,children:T}),new(n.managed(d.e))({text:h.Edit,classSuffix:"editPhoto",tooltip:h.EditPhotoTooltip,renderLabel:1,action:new(n.managed(n._actionMap.OpenInImageEditorAction)),teachingBubble:!Object(m.isFeatureEnabled)(m.EnableEditControlTeachingBubble)||Object(m.isFeatureEnabled)(m.MentionTeachingUIAA)||Object(m.isFeatureEnabled)(m.EnableExpirationSectionForTMR)?void 0:n._coachmarkProvider.getCurrentTeachingBubble()}),new(n.managed(d.e))({text:h.SaveTextFile,classSuffix:"saveTextFile",tooltip:h.SaveTextFileTooltip,icon:new g.e("Save"),automationId:"save",renderLabel:2,action:new(n.managed(n._actionMap.SaveAction))}),C,N&&Object(m.isFeatureEnabled)(m.OneUpNewShareDialog)?new(n.managed(te))({renderLabel:2,mode:q.e.copyLink,location:3,automationId:"copy-link"}).command:Object(m.isFeatureEnabled)(m.ShareV3)?new(n.managed(E.t))({renderLabel:2,mode:1,location:3,automationId:"copy-link"}).command:new(n.managed(d.e))({text:h.GetLink,renderLabel:2,icon:new g.e("Link"),location:3,automationId:"copy-link",action:new(n.managed(n._actionMap.GetLinkAction))({useOldSharingDialog:s&&"21"!==s.webTemplate})}),new(n.managed(d.e))({text:h.AddToAlbum,icon:new g.e("Photo2Add"),renderLabel:2,action:new(n.managed(n._actionMap.AddToAlbumAction))({})}),new(n.managed(d.e))({text:h.Download,icon:new g.e("Download"),renderLabel:2,action:new(n.managed(n._actionMap.DownloadAction))({}),automationId:"download"}),new(n.managed(d.e))({text:h.DeleteItem,icon:new g.e("Delete"),renderLabel:0,location:2,action:new(n.managed(n._actionMap.DeleteAction))({}),automationId:"delete"}),new(n.managed(d.e))({text:h.print,renderLabel:0,icon:new g.e("Print"),location:2,keys:["CtrlP"],action:new(n.managed(n._actionMap.PrintPdfAction))}),new(n.managed(d.e))({text:h.playSlideshow,icon:new g.e("Play"),classSuffix:"play",location:2,renderLabel:0,action:new(n.managed(n._actionMap.PlaySlideShowAction))({})}),new(n.managed(d.e))({text:h.rotate,icon:new g.e("rotate"),location:2,renderLabel:0,action:new(n.managed(n._actionMap.RotateAction))({})}),new(n.managed(d.e))({text:h.applyOfficeLens,renderLabel:0,location:2,icon:new g.e("LightningBolt"),action:new(n.managed(n._actionMap.ApplyOfficeLensAction))}),new(n.managed(d.e))({text:h.removeOfficeLens,renderLabel:0,icon:new g.e("Undo"),location:2,action:new(n.managed(n._actionMap.RemoveOfficeLensAction))}),new(n.managed(d.e))({text:h.addToSharedList,renderLabel:0,icon:new g.e("Add"),location:2,action:new(n.managed(n._actionMap.AddToSharedListAction))}),new(n.managed(d.e))({text:h.removeFromSharedList,renderLabel:0,icon:new g.e("Cancel"),location:2,action:new(n.managed(n._actionMap.RemoveFromSharedListAction))}),new(n.managed(d.e))({text:h.viewOriginal,icon:new g.e("Picture"),renderLabel:0,location:2,action:new(n.managed(n._actionMap.ViewOriginalAction))({})}),new(n.managed(d.e))({text:h.viewInFolder,icon:new g.e("Folder"),renderLabel:0,location:2,action:new(n.managed(n._actionMap.ViewInFolderAction))}),new(n.managed(d.e))({text:h.Embed,icon:new g.e("Embed"),classSuffix:"embed",renderLabel:0,location:2,action:new(n.managed(n._actionMap.EmbedAction))({})}),new(n.managed(d.e))({text:h.OrderPrints,icon:new g.e("Print"),renderLabel:0,location:2,action:new(n.managed(n._actionMap.OrderPrintsAction))({})}),new(n.managed(d.e))({text:h.editTags,icon:new g.e("Tag"),keys:["T"],renderLabel:0,location:2,action:new(n.managed(n._actionMap.EditTagsAction))}),new(n.managed(d.e))({text:h.Copy,icon:new g.e("Copy"),automationId:"copy",renderLabel:0,location:2,action:new(n.managed(n._actionMap.LaunchMoveCopyPanelAction))({isMove:!1})}),new(n.managed(d.e))({text:p._,icon:new g.e("StackIndicator"),renderLabel:0,location:2,automationId:"version-history",action:new(n.managed(n._actionMap.ShowVersionHistoryAction))})],Object(m.isFeatureEnabled)(m.EnableAnonReportConcernCommand)?[new(n.managed(d.e))({text:p.q,icon:new g.e("EditNote"),renderLabel:0,location:2,automationId:"reportConcern",action:new(n.managed(n._actionMap.ReportAbuseAction))({})})]:[],!0),[new(n.managed(d.e))({text:n.createPureComputed(function(){return D()?h.ViewMode:h.AccessibilityMode}),icon:n.createPureComputed(function(){return D()?new g.e("Page"):new g.e("EaseOfAccess")}),renderLabel:0,location:2,action:new(n.managed(k))({accessibilityMode:D})})],!1),s&&s.allowInfectedDownload?[new(n.managed(d.e))({text:h.Download,icon:new g.e("Download"),renderLabel:0,location:2,action:new(n.managed(n._actionMap.ShowMalwareDetectedAction))({})})]:[],!0),[u.actionsCommand,n.overflowHostCommand,new(n.managed(d.e))({role:"text",automationId:"fileTitle",iconUrl:_,text:M,tooltip:O,location:16,isDisabled:a.observable(!0)})],!1));return n}t.prototype._computeOpenInOfficeOnlineText=function(){return y.a(Object(b.e)(this._selection,!0))||h.Open};t.prototype._computeOpenInOfficeClientText=function(){return y.f(Object(b.e)(this._selection,!0))};t.prototype._computOpenInOfficeSuffixClass=function(){return y.s(Object(b.e)(this._selection,!0))+" od-Command--PrimaryButton"};t.prototype._computeOfficeIcon=function(){var e,t=Object(b.e)(this._selection,!0);t&&(e=y.o(t));return e||new g.e("Page")};t.prototype._computeFileIconUrl=function(e){var t=(null==e?void 0:e.iconName)||"genericfile",n=this.resources.consume(l.e.optional);return(null==e?void 0:e.iconUrl)||this.getFileHandlerIcon(n,null==e?void 0:e.extension)||c.e(this.resources,t,32)};t.prototype.getFileHandlerIcon=function(e,t){return e&&e.getFileTypeIconUrl(t,!0)};return t})(f.t),se=n(2552),oe=n(2697),ue=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="Conditional";n.isQosLogged=!1;n._action=t.action;n._condition=t.condition;return n}t.prototype.onExecute=function(e,t){return this._action.execute(e)};t.prototype.onIsAvailable=function(){return this._condition()&&this._action.isAvailable()};return t})(N.e),ae=n(3653),fe={ignoreHistory:!0,openRelation:1},le=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,fe,n)||this;r._isUsingOriginalTheme=t.isUsingOriginalTheme;r._originalTheme=t.originalTheme;r.name="ClosePreviewer";return r}t.prototype.onExecute=function(t,n){ne.e.isActivated("9b004be7-6252-434e-a687-f22bd0363ed1","11/08/2021","Move theme recover time from dispose to close action.")||this._isUsingOriginalTheme&&!this._isUsingOriginalTheme.peek()&&this._originalTheme&&Object(J.B)(this._originalTheme);if(Object(m.isFeatureEnabled)(m.RefreshOnPreviewClose)){document.body.style.display="none";return e.prototype.onExecute.call(this,t,n).then(function(e){window.location.reload();return e})}return e.prototype.onExecute.call(this,t,n)};return t})(ae.e),ce=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._legend=t.legend;var r=n.createPureComputed(function(){return!t.canNavigate()}),i=new(n.managed(ue))({action:t.previous,condition:t.canNavigate}),s=new(n.managed(ue))({action:t.next,condition:t.canNavigate});n.commands.push(new(n.managed(se.e))({renderLabel:0}).command,new(n.managed(d.e))({text:oe.previousTooltip,icon:new g.e(R.e.isRightToLeft?"Next":"Previous"),renderLabel:0,location:12,isPermanent:a.observable(!0),isInvisibleWhenDisabled:!1,automationId:"previousButton",keys:[R.e.isRightToLeft?"Right":"Left"],action:i}),new(n.managed(d.e))({text:n._legend,prependTextToAccessibleLabel:!1,location:12,automationId:"oneUpPageCount",classSuffix:"pageCount",isDisabled:a.observable(!0),isHidden:r,role:"text"}),new(n.managed(d.e))({text:oe.nextTooltip,icon:new g.e(R.e.isRightToLeft?"Previous":"Next"),renderLabel:0,location:12,positionIconRight:!0,isPermanent:a.observable(!0),isInvisibleWhenDisabled:!1,automationId:"nextButton",keys:[R.e.isRightToLeft?"Left":"Right"],action:s}),new(n.managed(d.e))({role:"text",icon:new g.e("Separator"),renderLabel:0,classSuffix:"separator",location:12,isDisabled:a.observable(!0)}),new(n.managed(d.e))({icon:new g.e("Cancel"),text:h.Close,renderLabel:0,action:new(n.managed(le))({isUsingOriginalTheme:t.isUsingOriginalTheme,originalTheme:t.originalTheme}),automationId:"close",keys:["Esc"],location:12}));return n}return t})(f.t),he=n(1286),pe=n(1824),de=n(903),ve=n(812),me=n(243),ge=n(1749),ye=n(938),be=new _.t({name:"ExpirationStore.key",loader:new D.t(function(){return n.ee([486,"deferred","deferred.odsp-common","deferred.office-ui-fabric-react"],3775).then(function(e){return e.resourceKey})})}),we=n(211),Ee=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.resources;n._actionMap=r.consume(o.e);var i=r.consume(he.e),s=r.consume(pe.resourceKey),u=r.consume(ye.e);if(Object(m.isFeatureEnabled)(m.MentionTeachingUIAA)){n._selection=r.consume(o.k);n._coachmarkProvider=n.resources.consume(L.resourceKey.optional);n._identityDataSource=n.resources.consume(U.S.optional);n._checkAndSetCommentsCampaign(n._selection.selection(),s);n._subscribeToSelectedItemEvent(s)}if(Object(m.isFeatureEnabled)(m.EnableExpirationSectionForTMR)){n._focusItem=r.consume(o.m);n._coachmarkProvider=n.resources.consume(L.resourceKey.optional);n._expirationSectionStore=n.resources.consumeAsync(be);n._checkAndSetTMRExpirationDateCampaign(n._focusItem&&n._focusItem(),s)}n.commands.push(new(n.managed(d.e))({text:u?p.g:p.h,icon:new g.e(u?"OpenPane":"Info"),location:12,action:new(n.managed(n._actionMap.ShowPropertiesAction))({useToggleBehavior:!0}),ariaControls:i,ariaExpanded:s,renderLabel:u?1:0,hasIconOnly:!u,keys:["I"],automationId:"showProperties",teachingBubble:Object(m.isFeatureEnabled)(m.MentionTeachingUIAA)||Object(m.isFeatureEnabled)(m.EnableExpirationSectionForTMR)?n._coachmarkProvider.getCurrentTeachingBubble():void 0}),new(n.managed(d.e))({role:"text",icon:new g.e("Separator"),renderLabel:0,classSuffix:"separator",location:12,isDisabled:a.observable(!0)}));return n}t.prototype._subscribeToSelectedItemEvent=function(e){var t=this;this.observables.subscribe(this._selection.selection,function(n){t._checkAndSetCommentsCampaign(n,e)})};t.prototype._checkAndSetCommentsCampaign=function(e,t){t()||(this._checkIfCommentCampaignIsApplicable(e)?de.ODC_WEB_COMMENTS!==this._coachmarkProvider.currentCampaign()&&this._coachmarkProvider.setCampaign(de.ODC_WEB_COMMENTS):de.ODC_WEB_COMMENTS===this._coachmarkProvider.currentCampaign()&&this._coachmarkProvider.hideCampaign())};t.prototype._isOfficeItem=function(e){var t=e.extension&&e.extension.replace(/^\./,"");return t&&ve.t[t]&&".pdf"!==e.extension||e.type===me.e.OneNote};t.prototype._checkIfCommentCampaignIsApplicable=function(e){var t,n;if(!e||1!==e.length||!e[0]())return!1;var r=e[0]();return void 0===r.dateDeleted&&r.graph&&!r.isRootFolder&&!this._isOfficeItem(r)&&!r.vault&&(0===r.sharingRole||2===r.sharingRole)&&!(null===(n=null===(t=r.comments)||void 0===t?void 0:t.settings)||void 0===n?void 0:n.isCommentDisabled)&&this._identityDataSource&&this._identityDataSource.getIdentity().type!==ge.e.anonymous};t.prototype._checkAndSetTMRExpirationDateCampaign=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,function(){var n=this;return Object(i.__generator)(this,function(r){t()||this._checkIfTMRExpirationIsApplicable(e).then(function(e){e?de.TMR_EXPIRATION_DATE_EDIT!==n._coachmarkProvider.currentCampaign()&&n._coachmarkProvider.setCampaign(de.TMR_EXPIRATION_DATE_EDIT):de.TMR_EXPIRATION_DATE_EDIT===n._coachmarkProvider.currentCampaign()&&n._coachmarkProvider.hideCampaign()});return[2]})})};t.prototype._checkIfTMRExpirationIsApplicable=function(e){var t;if(!e)return Promise.resolve(!1);var n=e();return!n.isRootFolder&&n.type===me.e.Media&&"Media.Meeting"===(null===(t=null==n?void 0:n.properties)||void 0===t?void 0:t.ProgId)?Object(m.isFeatureEnabled)(m.EnableCheckExpirationDateForTMR)?this._checkIfTMRHasExpirationDate(n):Promise.resolve(!0):Promise.resolve(!1)};t.prototype._checkIfTMRHasExpirationDate=function(e){var t=new K.e({name:"TMR.FRE.GetExpirationDate"});return this._expirationSectionStore.then(function(n){return n.getItemExpirationDate(e).then(function(e){t.end({resultType:T.e.Success});return e}).catch(function(e){t.end(Object(we.e)(e));return Promise.reject(e)})})};return t})(f.t),Se=["S"],xe=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=n.resources;n._actionMap=r.consume(o.e);n._selection=r.consume(o.k);n._coachmarkProvider=n.resources.consume(L.resourceKey.optional);var s=r.consume(v.h.optional),u=n.scope.attach(new(r.consume(w.e.local))({})),a=n.createPureComputed(n._computeOpenInOfficeOnlineText),f=n.createPureComputed(n._computeOpenInOfficeClientText),l=n.createPureComputed(n._computOpenInOfficeSuffixClass),c=n.createPureComputed(n._computeOfficeIcon),b=[new(n.managed(d.e))({text:a,renderLabel:2,icon:c,classSuffix:l,action:new(n.managed(n._actionMap.OpenInOfficeOnlineAction))}),new(n.managed(d.e))({text:f,renderLabel:2,icon:c,classSuffix:l,action:new(n.managed(n._actionMap.OpenInOfficeClientAction))})],x=[new(n.managed(d.e))({text:h.OpenInBrowser,renderLabel:2,icon:new g.e("PDF"),classSuffix:"PDF",action:new(n.managed(n._actionMap.OpenPdfInBrowserAction))}),new(n.managed(d.e))({text:h.OpenInTextEditor,renderLabel:2,icon:new g.e("Edit"),action:new(n.managed(n._actionMap.OpenInTextEditorAction))})];Object(m.isFeatureEnabled)(m.EnableOpenInImmersiveReader)&&x.push(new(n.managed(d.e))({text:h.OpenInImmersiveReader,renderLabel:2,icon:new g.e("ReadOutLoud"),action:new(n.managed(n._actionMap.OpenInImmersiveReaderAction))}));var T=n.observables.createArray([]);n.createBackgroundComputed(function(){T.splice.apply(T,Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)([0,T.peek().length],b,!1),u.openWithCommands(),!1),x,!1))});var N=n.createPureComputed(function(){for(var e={},t=0,n=T();t<n.length;t++){var r=n[t];if(r.isVisible()){var i=r.icon(),s=r.iconUrl(),o=i&&i.toString();if(o&&"Page"!==o||s){var u=y.t[o];e.iconSize=18;e.icon=u?new g.e(u):i;e.iconUrl=s;return e}}}e.icon=new g.e("Page");return e}),C=n.createPureComputed(function(){return N().icon}),A=n.createPureComputed(function(){return N().iconUrl}),O=n.createPureComputed(function(){return N().iconSize}),M=s?Object(m.isFeatureEnabled)(m.ShareV3)?new(n.managed(E.t))({renderLabel:2,mode:0,automationId:"share"}).command:new(n.managed(d.e))({text:h.Share,tooltip:h.ShareCommandTooltipV3,renderLabel:2,icon:new g.e("Share"),automationId:"share",action:Object(m.isFeatureEnabled)(m.UseNewSharingDialog)&&"21"===s.webTemplate?new(n.managed(n._actionMap.ShareByLinkAction))({sharingMethod:2}):new(n.managed(n._actionMap.ShareAction))({activeTab:1}),keys:Se}):new(n.managed(d.e))({text:h.Share,renderLabel:2,icon:new g.e("Share"),automationId:"share",action:new(n.managed(n._actionMap.ShareByLinkAction)),keys:Se}),_=r.consume(S.e),D=r.consume(he.e),P=r.consume(pe.resourceKey);if(Object(m.isFeatureEnabled)(m.MentionTeachingUIAA)){n._identityDataSource=n.resources.consume(U.S.optional);n._checkAndSetCommentsCampaign(n._selection.selection(),P);n._subscribeToSelectedItemEvent(P)}n.commands(Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)([new(n.managed(d.e))({text:h.Open,icon:C,iconUrl:A,iconSize:O,classSuffix:l,renderLabel:2,requiredChildren:1,collapseSingleChildCommands:!1,location:3,children:T}),M,Object(m.isFeatureEnabled)(m.ShareV3)?new(n.managed(E.t))({renderLabel:2,mode:1,automationId:"copy-link"}).command:new(n.managed(d.e))({text:h.GetLink,renderLabel:2,icon:new g.e("Link"),automationId:"copy-link",action:new(n.managed(n._actionMap.GetLinkAction))({useOldSharingDialog:s&&"21"!==s.webTemplate})}),new(n.managed(d.e))({text:h.print,renderLabel:2,icon:new g.e("Print"),keys:["CtrlP"],action:new(n.managed(n._actionMap.PrintPdfAction))}),new(n.managed(d.e))({text:h.addToSharedList,renderLabel:2,icon:new g.e("Add"),action:new(n.managed(n._actionMap.AddToSharedListAction))}),new(n.managed(d.e))({text:h.removeFromSharedList,renderLabel:2,icon:new g.e("Cancel"),action:new(n.managed(n._actionMap.RemoveFromSharedListAction))}),new(n.managed(d.e))({text:h.AddToAlbum,icon:new g.e("Photo2Add"),renderLabel:2,action:new(n.managed(n._actionMap.AddToAlbumAction))({})}),new(n.managed(d.e))({text:h.playSlideshow,icon:new g.e("Play"),renderLabel:2,action:new(n.managed(n._actionMap.PlaySlideShowAction))({})}),new(n.managed(d.e))({text:h.rotate,icon:new g.e("rotate"),renderLabel:2,action:new(n.managed(n._actionMap.RotateAction))({})}),new(n.managed(d.e))({text:h.Edit,tooltip:h.EditPhotoTooltip,renderLabel:2,icon:new g.e("EditPhoto"),action:new(n.managed(n._actionMap.OpenInImageEditorAction)),teachingBubble:!Object(m.isFeatureEnabled)(m.EnableEditControlTeachingBubble)||Object(m.isFeatureEnabled)(m.MentionTeachingUIAA)||Object(m.isFeatureEnabled)(m.EnableExpirationSectionForTMR)?void 0:n._coachmarkProvider.getCurrentTeachingBubble()}),new(n.managed(d.e))({text:h.applyOfficeLens,renderLabel:2,icon:new g.e("LightningBolt"),action:new(n.managed(n._actionMap.ApplyOfficeLensAction))}),new(n.managed(d.e))({text:h.removeOfficeLens,renderLabel:2,icon:new g.e("Undo"),action:new(n.managed(n._actionMap.RemoveOfficeLensAction))}),new(n.managed(d.e))({text:h.Download,icon:new g.e("Download"),renderLabel:2,action:new(n.managed(n._actionMap.DownloadAction))({}),automationId:"download"}),new(n.managed(d.e))({text:h.DeleteItem,icon:new g.e("Delete"),renderLabel:2,action:new(n.managed(n._actionMap.DeleteAction))({}),automationId:"delete"}),new(n.managed(d.e))({text:h.viewOriginal,icon:new g.e("Picture"),renderLabel:2,action:new(n.managed(n._actionMap.ViewOriginalAction))({})}),new(n.managed(d.e))({text:h.viewInFolder,icon:new g.e("Folder"),action:new(n.managed(n._actionMap.ViewInFolderAction)),renderLabel:2}),new(n.managed(d.e))({text:h.OrderPrints,icon:new g.e("Print"),renderLabel:2,action:new(n.managed(n._actionMap.OrderPrintsAction))({})}),new(n.managed(d.e))({text:h.Embed,icon:new g.e("Embed"),renderLabel:2,action:new(n.managed(n._actionMap.EmbedAction))({})}),new(n.managed(d.e))({text:h.editTags,renderLabel:2,icon:new g.e("Tag"),keys:["T"],action:new(n.managed(n._actionMap.EditTagsAction))}),new(n.managed(d.e))({renderLabel:2,text:n.createPureComputed(function(){return _()?h.ViewMode:h.AccessibilityMode}),icon:n.createPureComputed(function(){return _()?new g.e("Page"):new g.e("EaseOfAccess")}),action:new(n.managed(k))({accessibilityMode:_})}),new(n.managed(d.e))({text:h.Copy,renderLabel:2,icon:new g.e("Copy"),automationId:"copy",action:new(n.managed(n._actionMap.LaunchMoveCopyPanelAction))({isMove:!1})}),new(n.managed(d.e))({text:p._,renderLabel:2,icon:new g.e("StackIndicator"),automationId:"version-history",action:new(n.managed(n._actionMap.ShowVersionHistoryAction))})],Object(m.isFeatureEnabled)(m.EnableAnonReportConcernCommand)?[new(n.managed(d.e))({text:p.q,icon:new g.e("EditNote"),renderLabel:2,automationId:"reportConcern",action:new(n.managed(n._actionMap.ReportAbuseAction))({})})]:[],!0),s&&s.allowInfectedDownload?[new(n.managed(d.e))({text:h.Download,renderLabel:2,icon:new g.e("Download"),action:new(n.managed(n._actionMap.ShowMalwareDetectedAction))({})})]:[],!0),[u.actionsCommand,n.overflowHostCommand,new(n.managed(d.e))({tooltip:p.h,icon:new g.e("Info"),location:12,action:new(n.managed(n._actionMap.ShowPropertiesAction))({useToggleBehavior:!0}),ariaControls:D,ariaExpanded:P,renderLabel:0,hasIconOnly:!0,keys:["I"],automationId:"showProperties",teachingBubble:Object(m.isFeatureEnabled)(m.MentionTeachingUIAA)?n._coachmarkProvider.getCurrentTeachingBubble():void 0})],!1));return n}t.prototype._subscribeToSelectedItemEvent=function(e){var t=this;this.observables.subscribe(this._selection.selection,function(n){t._checkAndSetCommentsCampaign(n,e)})};t.prototype._checkAndSetCommentsCampaign=function(e,t){t()||(this._checkIfCommentCampaignIsApplicable(e)?de.ODC_WEB_COMMENTS!==this._coachmarkProvider.currentCampaign()&&this._coachmarkProvider.setCampaign(de.ODC_WEB_COMMENTS):de.ODC_WEB_COMMENTS===this._coachmarkProvider.currentCampaign()&&this._coachmarkProvider.hideCampaign())};t.prototype._isOfficeItem=function(e){var t=e.extension&&e.extension.replace(/^\./,"");return t&&ve.t[t]&&".pdf"!==e.extension||e.type===me.e.OneNote};t.prototype._checkIfCommentCampaignIsApplicable=function(e){var t,n;if(!e||1!==e.length||!e[0]())return!1;var r=e[0]();return void 0===r.dateDeleted&&r.graph&&!r.isRootFolder&&!this._isOfficeItem(r)&&!r.vault&&(0===r.sharingRole||2===r.sharingRole)&&!(null===(n=null===(t=r.comments)||void 0===t?void 0:t.settings)||void 0===n?void 0:n.isCommentDisabled)&&this._identityDataSource&&this._identityDataSource.getIdentity().type!==ge.e.anonymous};t.prototype._computeOpenInOfficeOnlineText=function(){return y.a(Object(b.e)(this._selection,!0))||h.Open};t.prototype._computeOpenInOfficeClientText=function(){return y.f(Object(b.e)(this._selection,!0))};t.prototype._computOpenInOfficeSuffixClass=function(){return y.s(Object(b.e)(this._selection,!0))};t.prototype._computeOfficeIcon=function(){var e,t=Object(b.e)(this._selection,!0);t&&(e=y.o(t));return e||new g.e("Page")};return t})(f.t),Te=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._legend=t.legend;var r=n.createPureComputed(function(){return!t.canNavigate()}),i=n.createPureComputed(function(){return t.canNavigate()&&t.areFlippersPermanent()}),s=new(n.managed(ue))({action:t.previous,condition:t.canNavigate}),o=new(n.managed(ue))({action:t.next,condition:t.canNavigate});n.commands.push(new(n.managed(se.e))({renderLabel:2}).command,new(n.managed(d.e))({text:oe.previousTooltip,icon:new g.e(R.e.isRightToLeft?"ChevronRight":"ChevronLeft"),renderLabel:2,location:12,isPermanent:i,isInvisibleWhenDisabled:!0,automationId:"previousButton",keys:[R.e.isRightToLeft?"Right":"Left"],action:s}),new(n.managed(d.e))({text:n._legend,location:12,automationId:"oneUpPageCount",isDisabled:a.observable(!0),isHidden:r,role:"text"}),new(n.managed(d.e))({text:oe.nextTooltip,icon:new g.e(R.e.isRightToLeft?"ChevronLeft":"ChevronRight"),renderLabel:2,location:12,positionIconRight:!0,isPermanent:i,isInvisibleWhenDisabled:!0,automationId:"nextButton",keys:[R.e.isRightToLeft?"Left":"Right"],action:o}),new(n.managed(d.e))({icon:new g.e("Cancel"),text:h.Close,hasIconOnly:!0,renderLabel:0,action:new(n.managed(le)),automationId:"close",keys:["Esc"],location:12}));return n}return t})(f.t),Ne=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._actionMap=n.resources.consume(o.e);n.commands=a.observableArray([new(n.managed(d.e))({text:h.pauseSlideshow,renderLabel:2,icon:new g.e("Pause"),action:new(n.managed(n._actionMap.StopSlideShowAction))({})})]);return n}return t})(f.t),Ce=n(3138),ke=n(2125),Le=n(2187),Ae=n(2061),Oe=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.valueAccessor();n._callback=r.callback;n._delay=r.delay||500;n.events.on(n.element,"click",n._onClick);return n}t.prototype._onClick=function(e){if(this._timerID){this.async.clearTimeout(this._timerID);this._timerID=void 0}else this._timerID=this.async.setTimeout(this._onClickTimer,this._delay)};t.prototype._onClickTimer=function(){this._timerID=void 0;this._callback&&this._callback()};return t})(n(2046).t),Me=n(2202),_e=n(3339),De=n(208),Pe=n(2109),He=n(2501),Be=n(3344),je=n(2151),Fe=n(3340),Ie=n(2592),qe=n(2743),Re=n(898),Ue=n(140),ze=n(2058),We=n(2312),Xe=n(2285),Ve=n(2232),$e=n(748),Je=n(31),Ke=Object($e.e)({eventName:"OneUpCarousel,",shortEventName:"OneUpCarousel"},{initialFileType:Je.e.String,initialFileExtension:Je.e.String,initialFileSize:Je.e.Number,pagesViewed:Je.e.Number,totalPages:Je.e.Number,isFolderShownInSession:Je.e.Boolean}),Qe=n(2049),Ge=n(3139),Ye=n(3341),Ze=n(3586),et=n(3345),tt=n(3194),nt=n(2251),rt=n(107),it=n(2618),st=n(2064),ot=n(3346),ut=n(2933),at=new _.t({name:"OneUpCommandBar.key",loader:new D.t(function(){return n.ee([762,"deferred"],5420).then(function(e){return e.resourceKey.local})})}),ft=n(2168),lt=new _.t({name:"FocusedInfoPaneSection.key",factory:{dependencies:{observablesFactoryType:M.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create(),disposable:t}}}}),ct=n(902),ht=n(1331),pt=n(3654),dt=n(3655),vt=n(2698),mt=n(13),gt=n(2363),yt=n(2246),bt=ht.n.themePrimary,wt=ht.e.themePrimary,Et=new gt.e("OneUp",gt.t.component),St=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.overlayHostTagName=We.e.tagName;r.dialogHostTagName=Xe.e.tagName;r.panelHostTagName=Ve.e.tagName;r.carouselTagName=tt.e.tagName;r.oneUpSlideTagName=Ze.e.tagName;r.addBindingHandlers({clientRect:ke.e,keyboard:Ae.e,idle:_e.e,throttledClick:Oe,control:Qe.r,childFocus:Le.e,hideWhenInactive:it.e,transclusionHost:Me.e});r._originalTheme=Object(J._)();r._darkThemeInLightMode=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},r._originalTheme||{}),ht.t||{}),{isInverted:!1});r._isUsingOriginalTheme=!0;r._isUsingOriginalThemeV2=a.observable(!0);r._isFirstLoadDarkThemeInLightMode=!0;r._carouselEvent=new Ke;r._carouselEventData={initialFileType:"",initialFileExtension:"",initialFileSize:0,pagesViewed:0,totalPages:0,isFolderShownInSession:!1};var s=n.rateLimitExtenders,f=void 0===s?{rateLimit:{timeout:0,method:"notifyWhenChangesStop"}}:s;r._rateLimitExtenders=f;var l=r,c=l.observables,h=l.resources;r.slideLoadState=c.create(0);r._onSlideLoaded=t.onSlideLoaded;var p=n.toolbarProvider;r.agentHost={name:nt.e.tagName,params:{provider:p}};r.showAgent=c.pureCompute(function(){if(Object(m.isFeatureEnabled)(m.EnableLivePhotoVideos)||Object(m.isFeatureEnabled)(m.EnableSamsungMotionPhotoVideos)){var e=r.item(),t=e&&e.peek();if(t&&t.video&&("AppleLivePhoto"===t.video.burstPhotoType||"SamsungMotionPhoto"===t.video.burstPhotoType))return!1}return p.contexts().length>0});var d=n.paneProvider;r.paneHost={name:nt.e.tagName,params:{provider:d,useCustomTemplate:!0}};mt.e.isActivated("464730AD-2EA1-49F0-BEA4-0302565B9E83","06/29/2022","Override Engagement context in OneUp")||h.expose(gt.n,r.resources.consume(gt.n).withPart(Et).withPart(yt.e,{item:r.observables.pureCompute(function(){return r.observables.unwrap(r.item())})}));h.bind(E.n);h.bind(E.e);h.expose(S.e,c.create(!1));h.bind(He.e);h.bind(Pe.e);h.bind(st.e);r.isSlideShowModeEnabled=c.create(!1);h.expose(o.D,r);r.addCaptionLabel=c.create("");r.isRotating=c.create(!1);r.isIdle=c.create(!1);r._actionMap=n.actionMap;r._initializeItem({item:n.focusItem});var v=n.currentItemSet;r._initializeItemSet({itemSet:n.focusItemSet||v});r._parent=c.pureCompute(function(){return r._itemSet().item()});h.block(o.f);r._selectionModel=h.expose(o.k,new(r.managed(u.e))({indexResolver:n.indexResolver}));r.allocationRange=t.requiredRange;r.size=c.create({width:0,height:0});h.expose(De.e.infoPane.hidePreview,c.create(!0));h.bind(he.e);var g=r.isInfoPaneExpanded=h.consume(pe.resourceKey);r._focusedInfoPaneSection=n.focusedInfoPaneSection;r.showPane=c.pureCompute(function(){return g()||d.contexts().length>0});var y={deferEvaluation:!0};r.isCommandBarVisible=c.create(!0);r.isNewDeisgnedCommandBarEnabled=r._shouldUseNewCommandBar();r.isAwake=c.pureCompute(r._computeIsAwake,y);r.oneUp={currentPriority:c.createCallback(et.e),isRotating:r.isRotating,isCommandBarVisible:r.isCommandBarVisible,isDarkThemeForMediaSenario:r._isDarkThemeForMediaSenario(),isDarkThemeForMediaEnabled:r._shouldUseDarkThemeForMedia(),isDarkMode:r._isDarkMode(),isInfoPaneExpanded:g,enableSlideControls:c.create(!1),size:r.size,slide:c.create(),shareLinkId:t.shareLinkId,isAwake:r.isAwake};r.isPhotosOnly=r._exposeIfNeeded(De.e.oneUpOverlay.isPhotosOnly,c.create(!1));r.isDarkBackgroundEnabled=c.pureCompute(function(){return r.isPhotosOnly()&&r._shouldUseDarkBackground(n.identityDataSource)});r.canNavigate=c.pureCompute(r._computeCanNavigate,y);r.accessibleItemAnnouncementText=c.pureCompute(r._computeAccessibleItemAnnouncementText);r.caption=c.pureCompute(r._computeCaption,y);r.showEditCaption=c.pureCompute(r._computeIsEditCaptionEnabled,y);r._dataManagerMapper=n.dataManagerMapper;r._areFlippersPermanent=c.pureCompute(function(){return r.items().length>1});r.legend=c.pureCompute(r._computeLegend,y);r._initializeActions();r.commandBarSpecification=r.isNewDeisgnedCommandBarEnabled?Object(Qe.i)(at.bypass,{commandSet:r._getCommandSet(n),isMobile:!1}):Object(Qe.i)(ft.e.bypass,{commandSet:r._getCommandSet(n),isMobile:!1});r._initializeOpenParentWhenEmpty();r.isIdleEnabled=c.pureCompute(r._computeIsIdleEnabled,y);r.isDetailsFocused=c.create(!1);r.isPanningEnabled=c.pureCompute(r._computeIsPanningEnabled,y);var b=ze.e.getScrollbarWidth()+"px";r.nextFlipperStyle={};r.nextFlipperStyle[R.e.safeRight]=b;r.previousFlipperStyle={};r.previousFlipperStyle[R.e.safeLeft]=b;r.detailsBarStyle=c.pureCompute(r._computeDetailsBarStyle,y);var w=c.pureCompute(function(){return r.slideLoadState()>=3});r.infoPaneSpecification=Object(Qe.i)(Ge.e,{showSections:w});t.isSlideshow&&c.compute(function(){t.isSlideshow(r.isSlideShowModeEnabled())}).extend({deferred:!0});var x=n.viewParams&&n.viewParams.peek();if(r._shouldShowActivityFeed(x)&&!r.isInfoPaneExpanded.peek()){var T=r._focusedInfoPaneSection;T&&T(9);if(x&&x.commentId){var N=x.commentId;r._navigation=r.resources.consume(Ue.e);var C=r._navigation.viewParams;if(C&&C.commentId){delete C.commentId;r._navigation.updateViewParams(C)}r.deeplinkCommentId=r.resources.consume(Ye.e);r.deeplinkCommentId({commentId:N})}r._showPropertiesAction.execute(null)}c.backgroundCompute(r._computeViewerTheme);c.backgroundCompute(r._computeSetCaptionLabel);c.backgroundCompute(r._computeClearCaptionFocus);c.backgroundCompute(r._computeSelectItem);c.backgroundCompute(r._computeTriggerClientRectUpdate);c.backgroundCompute(r._computeCommandBarShownOnIdleFullScreen);c.backgroundCompute(r._computeIsFirstSlideOpened);c.backgroundCompute(r._computePagesViewed);c.backgroundCompute(r._computeSlideLoadState);return r}t.prototype.executeAction=function(e,t){if(e.isAvailable.peek()){e.execute(t);return!1}return!0};t.prototype.enterSlideshowMode=function(){Fe.e.enterFullScreen();if(this.isSlideShowModeEnabled.peek()){this._timeOutId=this.async.setTimeout(this._startSlideshow,3e3);return!0}return!1};t.prototype.exitSlideshowMode=function(){Fe.e.exitFullScreen();this.isSlideShowModeEnabled(!1);if(this._timeOutId){this.async.clearTimeout(this._timeOutId);return!0}return!1};t.prototype.onExitInfoPane=function(e){this.async.setTimeout(function(){a.removeNode(e)},500)};t.prototype.onContentClicked=function(e){var t=this.oneUp.slide,n=t&&t.peek();return!(!n||!n.isPanningEnabled.peek()||this.isSlideShowModeEnabled.peek())};t.prototype.toggleInfoPaneExpanded=function(e){this._showPropertiesAction.execute(e);return!1};t.prototype.editCaption=function(e){if(!this.isInfoPaneExpanded.peek()){var t=this._focusedInfoPaneSection;t&&t(1);this._showPropertiesAction.execute(e)}return!1};t.prototype.dispose=function(){var t=this.peekUnwrapObservable(this._itemSet);if(t){var n=t.content.peek();this._carouselEventData.totalPages=n.items.length}this._carouselEvent.end(this._carouselEventData);Fe.e.isFullScreen()&&Fe.e.exitFullScreen();mt.e.isActivated("9b004be7-6252-434e-a687-f22bd0363ed1","11/08/2021","Move theme recover time from dispose to close action.")&&(this._isUsingOriginalTheme||Object(J.B)(this._originalTheme));e.prototype.dispose.call(this)};t.prototype._startSlideshow=function(){this.isInfoPaneExpanded.peek()&&this.toggleInfoPaneExpanded(null);if(!this.isSlideShowModeEnabled.peek())return!1;this._timeOutId=this.async.setTimeout(this._startSlideshow,3e3);return!(!this.slideLoadState.peek()||this.executeAction(this._openNext,null))||void 0};t.prototype._initializeItemSet=function(e){var t=this,n=e.itemSet;this._sourceItemSet=n;var r,i=this.observables;this.index=i.pureCompute(this._computeIndex);this._isPlaceholderItemSetRequired=i.pureCompute(function(){var e=n();return(!e.content()||e.isPlaceholder)&&-1===t.index()},{deferEvaluation:!0});var s=i.pureCompute(function(){var e;if(t._isPlaceholderItemSetRequired()){(e=new Ie.e).item=n.peek().item;r&&r.dispose();r=i.compute(function(){var n=new qe.e;n.items=[t.item()];e.content(n)})}else e=n();return e});s.equalityComparer=Re.n;var u=i.pureCompute(function(){return s().item()});u.equalityComparer=Re.n;this.resources.expose(o.o,u);this._itemSet=this.resources.expose(o.u,s);this.items=i.createArray();i.backgroundCompute(function(){t.items(t._itemSet().content().items)})};t.prototype._initializeItem=function(e){var t,n,r=this,i=e.item,s=this.observables,o=this.item=s.create();o.equalityComparer=Re.n;if(i){if(Object(m.isFeatureEnabled)(m.EngagementTelemetryEnhancement)&&i&&(null===(n=null===(t=i.peek())||void 0===t?void 0:t.peek())||void 0===n?void 0:n.isPlaceholder)){this._isFastOneUp=!0;var u=this.resources.consume(vt.e);this.scope.attach(new u({getCurrentPageName:function(){return"FastOneUp"},itemSet:this._itemSet}))}s.backgroundCompute(function(){o(i())});s.backgroundCompute(function(){if(o()!==i.peek()){var e=r._openCurrent;e.isAvailable.peek()&&e.execute(null).done()}}).extend(this._rateLimitExtenders)}};t.prototype._computeIndex=function(){var e=this.item(),t=this._sourceItemSet().content().items;return e?t.indexOf(e):-1};t.prototype._computeAccessibleItemAnnouncementText=function(){var e=this.item(),t=e&&e().displayName;return t?O.format(Be.accessibleItemAnnouncement,t):""};t.prototype._initializeActions=function(){var e=this,t=this.observables,n=t.pureCompute(function(){return t.unwrap(e.item())}),r=this._actionMap,s=this.managed(r.OpenAction),o={openRelation:2,urlType:"focus",itemSet:this._itemSet,ignoreHistory:!0};this._openCurrent=new s(Object(i.__assign)(Object(i.__assign)({},o),{item:n}));this._openPrevious=new s(Object(i.__assign)(Object(i.__assign)({},o),{item:t.pureCompute(this._computePreviousItem)}));this._openNext=new s(Object(i.__assign)(Object(i.__assign)({},o),{item:t.pureCompute(this._computeNextItem)}));this.updateCaptionAction=new(this.managed(r.UpdateCaptionAction))({item:n});this._showPropertiesAction=new(this.managed(r.ShowPropertiesAction))({useToggleBehavior:!0});this._openFastOneUp=new s(Object(i.__assign)(Object(i.__assign)({},o),{openOnly:!0,item:n}))};t.prototype._computePreviousItem=function(){var e=this.index();if(!(e<0))for(var t=this.isSlideShowModeEnabled.peek(),n=this.items(),r=e-1;r>=0;r--){var i=this.unwrapObservable(n[r]);if(!t||i&&!i.video)return i}};t.prototype._computeNextItem=function(){var e=this.index();if(!(e<0)){for(var t=this.isSlideShowModeEnabled.peek(),n=this.items(),r=e+1,i=n.length;r<i;r++){var s=this.unwrapObservable(n[r]);if(!t||s&&!s.video)return s}t&&this.exitSlideshowMode()}};t.prototype._initializeOpenParentWhenEmpty=function(){var e=this,t=new(this.managed(this._actionMap.OpenAction))({openRelation:2,item:this._parent,ignoreHistory:!0}),n=this.observables,r=n.pureCompute(function(){var t=e._itemSet();t.content();return!t.isPlaceholder&&!t.item().isPlaceholder||t.item().error?e.items().length:r.peek()});n.backgroundCompute(function(){0===r()&&t.isAvailable.peek()&&t.execute(null)}).extend(this._rateLimitExtenders)};t.prototype._computeTriggerClientRectUpdate=function(){this.isInfoPaneExpanded();this.isCommandBarVisible();a.computedContext.isInitial()||this.async.setTimeout(function(){rt.t.raise(document.body,"resize",void 0,!0)},500)};t.prototype._computeClearCaptionFocus=function(){!this.isInfoPaneExpanded()&&this._focusedInfoPaneSection&&this._focusedInfoPaneSection(null)};t.prototype._computeCommandBarShownOnIdleFullScreen=function(){Fe.e.isFullScreen()&&this.isCommandBarVisible(!this.isIdle())};t.prototype._computePagesViewed=function(){var e=this.oneUp.slide();if(e){this._carouselEventData.pagesViewed++;e.item&&e.item.peek()&&e.item.peek().folder&&(this._carouselEventData.isFolderShownInSession=!0)}};t.prototype._computeCanNavigate=function(){if(!Object(m.isFeatureEnabled)(m.RemoveOneUpSlideNavigation))return!0;var e=this.item.peek();if(!e){this.item();return!1}var t=e.peek();if(!t||t.isPlaceholder){e();return!1}return!!t.photo};t.prototype._computeIsFirstSlideOpened=function(){var e=this.oneUp.slide,t=e.peek();if(t){if(t.item){var n=t.item.peek();if(n){var r=this._carouselEventData;r.initialFileSize=n.size;r.initialFileType=n.iconName&&n.iconName.toLowerCase();r.initialFileExtension=n.extension&&n.extension.toLowerCase()}}t.isFirstSlideOpened(!0)}else e()};t.prototype._computeSlideLoadState=function(){0!==this.slideLoadState()&&this._onSlideLoaded&&this._onSlideLoaded()};t.prototype._getCommandSet=function(e){var t=e.commandSet;return void 0===t?this.isNewDeisgnedCommandBarEnabled?this._createSelectableCommandSet(e):this._createSelectableCommandSetDeprecated(e):t};t.prototype._createSelectableCommandSet=function(e){var t=this,n=e.oneUpCommandSet,r=void 0===n?new(this.managed(ie)):n,i=e.slideshowCommandSet,s=void 0===i?new(this.managed(Ne)):i,o=this.observables,u=new(this.managed(ce))({legend:this.legend,next:this._openNext,previous:this._openPrevious,areFlippersPermanent:this._areFlippersPermanent,canNavigate:this.canNavigate,parent:this._parent,isUsingOriginalTheme:this._isUsingOriginalThemeV2,originalTheme:this._originalTheme}),a=new(this.managed(Ee))({}),f=o.pureCompute(function(){var e=t.oneUp.slide();if(t.isSlideShowModeEnabled())return[s,u];var n=e&&e.commandSet();if(n)return[n,u];var i=e&&e.augmentCommandSet();return i?[r,i,u,a]:[r,u,a]});return new(this.managed(Ce.e))({commandSets:f})};t.prototype._createSelectableCommandSetDeprecated=function(e){var t=this,n=e.oneUpCommandSet,r=void 0===n?new(this.managed(xe)):n,i=e.slideshowCommandSet,s=void 0===i?new(this.managed(Ne)):i,o=this.observables,u=new(this.managed(Te))({legend:this.legend,next:this._openNext,previous:this._openPrevious,areFlippersPermanent:this._areFlippersPermanent,canNavigate:this.canNavigate,parent:this._parent}),a=o.pureCompute(function(){var e=t.oneUp.slide();if(t.isSlideShowModeEnabled())return[s,u];var n=e&&e.commandSet();if(n)return[n,u];var i=e&&e.augmentCommandSet();return i?[r,i,u]:[r,u]});return new(this.managed(Ce.e))({commandSets:a})};t.prototype._computeDetailsBarStyle=function(){var e=this.oneUp.slide(),t=ze.e.getScrollbarWidth(),n=e&&e.hasHorizontalScrollbar()?t:0,r=e&&e.hasVerticalScrollbar()?t:0,i={bottom:n+"px"};i[R.e.safeRight]=r+"px";return i};t.prototype._computeViewerTheme=function(){var e=this;if(!this._originalTheme.isInverted){var t=this.observables.unwrap(this.item());if(t&&this._shouldUseDarkThemeForMedia())if(mt.e.isActivated("9b004be7-6252-434e-a687-f22bd0363ed1","11/08/2021","Move theme recover time from dispose to close action.")){if(t.photo||t.audio||t.video){if(this._isUsingOriginalTheme)if(this._isFirstLoadDarkThemeInLightMode){this._loadThemeTimeoutId=this.async.setTimeout(function(){Object(J.B)(e._darkThemeInLightMode);e._isUsingOriginalTheme=!1},300);this._isFirstLoadDarkThemeInLightMode=!1}else{this._loadThemeTimeoutId&&this.async.clearTimeout(this._loadThemeTimeoutId);Object(J.B)(this._darkThemeInLightMode);this._isUsingOriginalTheme=!1}}else if(!this._isUsingOriginalTheme){Object(J.B)(this._originalTheme);this._isUsingOriginalTheme=!0}}else if(t.photo||t.audio||t.video){if(this._isUsingOriginalThemeV2.peek())if(this._isFirstLoadDarkThemeInLightMode){this._loadThemeTimeoutId=this.async.setTimeout(function(){Object(J.B)(e._darkThemeInLightMode);e._isUsingOriginalThemeV2(!1)},300);this._isFirstLoadDarkThemeInLightMode=!1}else{if(this._loadThemeTimeoutId){this.async.clearTimeout(this._loadThemeTimeoutId);this._loadThemeTimeoutId=null}Object(J.B)(this._darkThemeInLightMode);this._isUsingOriginalThemeV2(!1)}}else if(!this._isUsingOriginalThemeV2.peek()){Object(J.B)(this._originalTheme);this._isUsingOriginalThemeV2(!0)}}};t.prototype._computeSetCaptionLabel=function(){var e=this.item(),t=e&&e.peek(),n=t&&t.photo?je.captionAddCaption:je.captionAddDescription;this.addCaptionLabel(n)};t.prototype._computeLegend=function(){return this.isNewDeisgnedCommandBarEnabled?this._computeLegendWithFormat(Be.legendFormat):this._computeLegendWithFormat(Be.legendFormatDeprecated)};t.prototype._computeLegendWithFormat=function(e){var t=this.index(),n=this._dataManagerMapper,r=n&&n(),i=r?r.itemSet():this._itemSet(),s=r?r.getOriginalItemIndexByMappedIndex(t):t;if(s>-1)return O.format(e,s+1,i.content().items.length);var o=this.item(),u=o&&o();return u&&!u.isPlaceholder?O.format(e,1,1):""};t.prototype._computeCaption=function(){var e=this.unwrapObservable(this.item());return e&&e.caption};t.prototype._computeIsAwake=function(){return this.isDetailsFocused()||!this.isIdle()||!this.isIdleEnabled()};t.prototype._computeIsIdleEnabled=function(){var e=this.oneUp.slide();return!e||e.isIdleEnabled()};t.prototype._computeIsPanningEnabled=function(){if(!this.canNavigate())return!1;var e=this.oneUp.slide();return e&&e.isPanningEnabled()};t.prototype._computeIsEditCaptionEnabled=function(){var e=this.oneUp.slide();return e&&e.isEditCaptionEnabled()&&(this.updateCaptionAction.isAvailable()||!!this.caption())};t.prototype._computeSelectItem=function(){var e,t=this.item(),n=this._selectionModel;if(n.selection()[0]!==t){var r=n.getItemKey(t);n.setSelectedKeys([r])}else Object(m.isFeatureEnabled)(m.EngagementTelemetryEnhancement)&&this._isFastOneUp&&!(null===(e=t.peek())||void 0===e?void 0:e.isPlaceholder)&&this._openFastOneUp.execute(null).done()};t.prototype._shouldShowActivityFeed=function(e){return e&&(e.commentId||e.Nav&&e.Nav.indexOf("commentId")>=0)};t.prototype._shouldUseNewCommandBar=function(){return!!this.resources.consume(dt.e.optional)};t.prototype._shouldUseDarkThemeForMedia=function(){return this._isDarkThemeForMediaSenario()&&!!this.resources.consume(pt.e.optional)};t.prototype._isDarkThemeForMediaSenario=function(){if(!this.isNewDeisgnedCommandBarEnabled)return!1;var e=this._originalTheme.palette.themePrimary;return e===bt||e===wt};t.prototype._isDarkMode=function(){return this._originalTheme.isInverted};t.prototype._shouldUseDarkBackground=function(e){if(Object(m.isFeatureEnabled)(m.DarkBackgroundForPhotosOneUp))return!0;if(Object(m.isFeatureEnabled)(m.DarkBackgroundForPhotosOneUpExperiment)){if(e){var t=e.getIdentity();t&&ct.t.init({userLoginName:t.email})}return new ct.t({name:"DarkBackgroundForPhotosOneUpExperiment",startDate:"3/20/2020",version:ct.e.v2},m.DarkBackgroundForPhotosOneUpExperiment_ABTrigger).isOn()}return!1};t.prototype._exposeIfNeeded=function(e,t){return this.resources.isExposed(e)?this.resources.consume(e):this.resources.expose(e,t)};t.dependencies=Object(i.__assign)(Object(i.__assign)({},s.t.dependencies),{focusItem:o.m.optional,focusItemSet:o.g.optional,currentItemSet:o.u.optional,indexResolver:o._.optional,paneProvider:ot.e,toolbarProvider:ut.e,actionMap:o.e,focusedInfoPaneSection:lt.optional,dataManagerMapper:o.s.optional,viewParams:o.j,commandSet:void 0,oneUpCommandSet:void 0,slideshowCommandSet:void 0,rateLimitExtenders:void 0,identityDataSource:U.S});return t})(s.t),xt=Object(Qe.n)({automationName:"ms-one-up",name:"OneUp",template:'<div class="OneUp" data-bind="css:{\'OneUp--hasInfoPane\':showPane,\'OneUp--awake\':isAwake,\'OneUp--panningEnabled\':isPanningEnabled,\'OneUp--hasItems\':items().length,\'OneUp--hasCommandBar\':isCommandBarVisible,\'OneUp--newDesignedCommandBar\':isNewDeisgnedCommandBarEnabled,\'OneUp--slideShowOn\':isSlideShowModeEnabled,\'OneUp--darkBackground\':isDarkBackgroundEnabled}" role="presentation"><div class="OneUp-accessibleItemAnnouncement" aria-live="polite" data-bind="text:accessibleItemAnnouncementText"></div><div class="OneUp-commandBar" data-bind="hideWhenInactive,control:commandBarSpecification"></div><div class="OneUp-content" data-bind="hideWhenInactive,clientRect:{size:size}" role="presentation"><div class="OneUp-carousel" data-bind="component:{name:carouselTagName,params:{item:item,items:items,canNavigate:canNavigate,allocationRange:allocationRange,loadState:slideLoadState,isEnabled:isPanningEnabled,isRotating:isRotating}},idle:{isIdle:isIdle,isEnabled:isIdleEnabled},throttledClick:{callback:$component.onContentClicked.bind($component)},automation:\'carousel\'" role="presentation">\x3c!--ko component:{name:$component.oneUpSlideTagName,params:{slide:$host,oneUp:$component.oneUp}}--\x3e\x3c!--/ko--\x3e</div><div class="OneUp-detailsBar" data-bind="css:{\'OneUp-detailsBar--hasCaption\':showEditCaption},style:detailsBarStyle,childFocus:isDetailsFocused" role="presentation">\x3c!--ko if:showEditCaption--\x3e<div class="OneUp-caption-container">\x3c!--ko if:updateCaptionAction.isAvailable--\x3e<button class="OneUp-caption OneUp-caption--editable" data-bind="click:editCaption,css:{\'OneUp-caption--existing\':caption}"><span data-bind="text:caption()||addCaptionLabel"></span></button>\x3c!--/ko--\x3e\x3c!--ko ifnot:updateCaptionAction.isAvailable--\x3e<div class="OneUp-caption OneUp-caption--existing"><span data-bind="text:caption"></span></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:showAgent--\x3e<div class="OneUp-agent" data-bind="component:agentHost"></div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if:showPane--\x3e<div class="OneUp-paneHost" data-bind="hideWhenInactive,component:paneHost" role="presentation">\x3c!--ko with:$host.contexts()[0]--\x3e\x3c!--ko transclusionHost:$data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot:$host.contexts().length--\x3e\x3c!--ko if:$component.isInfoPaneExpanded--\x3e<div class="OneUp-infoPane" data-bind="control:infoPaneSpecification"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko component:{name:panelHostTagName}--\x3e\x3c!--/ko--\x3e\x3c!--ko component:{name:dialogHostTagName}--\x3e\x3c!--/ko--\x3e\x3c!--ko component:{name:overlayHostTagName}--\x3e\x3c!--/ko--\x3e</div>',viewModelType:St});t.default=xt}],Array(169),[function(e,t,n){"use strict";n.d(t,"e",function(){return p});var r=n(0),i=n(1121),s=n(18),o=n(2228),u=n("knockout-lib");var a={init:function(e,t,n,r,i){u.applyBindingsToNode(e,{attr:{"data-automationType":t()}},i);if(i){var s=i.$component;if(s){var o=u.utils.unwrapObservable(t());if(o){var a=s.__automationTypeBinding$elements;a||(a=s.__automationTypeBinding$elements={});var f=a[o];f||(f=a[o]=[]);f.push(e);u.utils.domNodeDisposal.addDisposeCallback(e,function(){var t=f.indexOf(e);if(-1!==t){delete f[t];f.splice(t,1)}})}}}}},f=n(2046),l=n(37),c=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.element.getAttribute("class");n.element.setAttribute("class",n._expandIconClassNames(r));return n}t.prototype._expandIconClassNames=function(e){var t={};if(e&&e.indexOf("ms-Icon--")>=0){for(var n=e.split(" "),r=[],i=0,s=n;i<s.length;i++){var o=s[i];this._lastClassesAdded&&this._lastClassesAdded[o]||r.push(o);if(0===o.indexOf("ms-Icon--")){var u=o.substring(9),a=Object(l.L)(u);if(a&&-1===n.indexOf(a)){t[a]=!0;r.push(a)}}}this._lastClassesAdded=t;return r.join(" ")}return e};t.after=["css","class"];return t})(f.e),h=n(205),p=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.bindingHandlers={};r.automationId=t&&t.automationId||void 0;r.addBindingHandlers({automation:o.e,automationType:a,icon:c});return r}t.prototype.getAutomationElement=function(e){return Object(o.t)(this,e)};t.prototype.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Object(s.format)(e,t)};t.prototype.addBindingHandlers=function(e){Object(h.e)(this.bindingHandlers,e)};return t})(i.default);t.t=p},function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n("knockout-lib"),i=n(1250);function s(e){var t=e.tagName,n=e.template,i=e.viewModel,s=e.synchronous,o=void 0!==s&&s;r.components.register(t,{viewModel:i,template:n,synchronous:o});return e}function o(e,t){var n=document.createElement("script");n.setAttribute("type","text/html");n.id=e;i.e.setText(n,t);document.head.appendChild(n)}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(1121),s=n("knockout-lib"),o=n(2252),u=n(7),a=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.element=t.element;r.valueAccessor=t.valueAccessor;r.allBindingsAccessor=t.allBindingsAccessor;r.bindingContext=t.bindingContext;r.controlsDescendantBindings=!1;return r}t.init=function(e,t,n,r,i){var a=new u.n(o.e(i)),f=new(this.supportsDependencies?a.resolved(this):a.injected(this))({element:e,allBindingsAccessor:n,valueAccessor:t,bindingContext:i});s.utils.domNodeDisposal.addDisposeCallback(e,function(){return f.dispose()});return{controlsDescendantBindings:f.controlsDescendantBindings}};t.dependencies=Object(r.__assign)({},i.default.dependencies);t.supportsVirtualElements=!1;t.supportsDependencies=!1;return t})(i.default);t.t=a},,,function(e,t,n){"use strict";n.d(t,"n",function(){return d});n.d(t,"e",function(){return v});var r=n(0),i=(n(3217),n(2046)),s=n(7);n.d(t,"t",function(){return s.t});var o=n(2174),u=n(91),a=n(3333),f=n(341),l=n(87),c=n("knockout-lib"),h=n(3013);n.d(t,"i",function(){return h.e});var p=(function(){function e(e){var t=e.viewModelType;this.dependencies=Object(r.__assign)(Object(r.__assign)({},t.dependencies||{}),e.dependencies||{});this._automationName=e.automationName;this._viewModelType=e.viewModelType;this._template=e.template}e.prototype.create=function(e){var t=this,n=e.resources,i=(function(t){Object(r.__extends)(i,t);function i(i){return t.call(this,i,Object(r.__assign)(Object(r.__assign)({},e||{}),{resources:new s.n(n)}))||this}return i})(this._viewModelType),o=function(){return t._getTemplateNodes()},u=this._automationName;return{instance:new((function(){function e(){}e.prototype.toSpecification=function(e){return{automationName:u,viewModelType:i,getTemplateNodes:o,params:e}};return e})())}};e.prototype._getTemplateNodes=function(){var e=c.utils.parseHtmlFragment(this._template);this._getTemplateNodes=function(){return e};return e};return e})();function d(e){return new s.t({name:e.name,factory:new p({template:e.template,automationName:e.automationName,viewModelType:e.viewModelType,dependencies:e.dependencies})})}var v=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.controlsDescendantBindings=!0;var i=r.element;r._transcludedTemplateNodes=Array.prototype.slice.call(c.virtualElements.childNodes(i));c.virtualElements.emptyNode(i);r._resolvedSpecification=r._getResolvedSpecification();r._initializeRenderComponent();return r}t.prototype._getResolvedSpecification=function(){var e=this,t=this.resources,n=this.observables,i=n.create();i.equalityComparer=m;var s=new o.e;n.compute(function(){var o,a,f,c=e.valueAccessor();if(g(c)){o=n.unwrap(c.specification);a=c.placeholder;f=c.error}else o=n.unwrap(c);e.observables.ignore(function(){var n;if(o)if(y(o)){var c=o.params,h=o.definitionKey.local,p=t.consume(h.optional);if(p)i(p.toSpecification(c));else{if(a)if(y(a)){var d=t.consume(a.definitionKey.optional.local);d&&i(Object(r.__assign)(Object(r.__assign)({},d.toSpecification(a.params)),{isPlaceholder:!0}))}else i(Object(r.__assign)(Object(r.__assign)({},a),{isPlaceholder:!0}));n=u.n.resolve(t.consumeAsync(h)).then(function(e){return e.toSpecification(c)})}}else i(o);else i(void 0);s.debounce(n?e.trackPromise(n.then(function(e){i(e)},function(e){if(!u.n.isCanceled(e)){l.e.log(e);if(f)if(y(f)){var n=t.consume(f.definitionKey.optional.local);n&&i(Object(r.__assign)(Object(r.__assign)({},n.toSpecification(Object(r.__assign)(Object(r.__assign)({},f.params),{error:e}))),{isError:!0}))}else i(Object(r.__assign)(Object(r.__assign)({},f),{params:Object(r.__assign)(Object(r.__assign)({},f.params),{error:e}),isError:!0}))}})):u.n.wrap())})});return i};t.prototype._initializeRenderComponent=function(){var e,t=this,n=this.element,r=this.observables,i=this._transcludedTemplateNodes;r.compute(function(){var r=t._resolvedSpecification();t.observables.ignore(function(){if(e){e.dispose();c.virtualElements.emptyNode(n)}if(r){var s=r.getTemplateNodes().map(function(e){return e.cloneNode(!0)}),o=(e=t.scope.attach(new f.e)).attach(new r.viewModelType(r.params));e.attach(new a.e({viewModel:o,element:n,bindingContext:t.bindingContext,name:r.automationName}));for(var u=t.bindingContext.createChildContext(o,void 0,function(e){e.$component=o;e.$componentTemplateNodes=i}),l=document.createDocumentFragment(),h=0,p=s;h<p.length;h++){var d=p[h];l.appendChild(d)}c.virtualElements.setDomNodeChildren(n,[l]);c.applyBindingsToDescendants(u,n);var v=t.valueAccessor();if(g(v)){var m=v.afterRender;!m||r.isPlaceholder||r.isError||m()}}})})};t.supportsVirtualElements=!0;return t})(i.t);function m(e,t){return!e&&!t||e===t||!(!e||!t)&&(e.getTemplateNodes===t.getTemplateNodes&&e.viewModelType===t.viewModelType&&e.params===t.params)}function g(e){return!!e&&"object"==typeof e&&"specification"in e}function y(e){return!!e.definitionKey}t.r=v},,,function(e,t,n){"use strict";var r=n(0),i=n(1368),s=n(801),o=n(1121),u=n(82),a=n(91),f=n(87),l=n(92),c=n(43),h=n(63),p=n(181),d=n(370),v=n(70),m=n(1886),g=n(211),y=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="BaseAction";var i=r,s=i.resources,o=i.observables,a=n.urlDataSource,f=void 0===a?s.consume(u.ve.optional):a,l=n.instrumentationProvider,c=void 0===l?s.consume(p.a.optional):l;r._BaseAction_urlDataSource=f;r._BaseAction_instrumentationProvider=c;r.isQosLogged=!0;r.logStartEnd=!1;r.enableCustomerPromiseLogging=!1;r._executingInstanceCount=o.create(0);var h={deferEvaluation:!0};r.isAvailable=o.pureCompute(r._computeIsAvailable,h);r.isToggled=o.pureCompute(r._computeIsToggled,h);r.isExecuting=o.pureCompute(r._computeIsExecuting,h);return r}t.prototype.execute=function(e){var t,n,r=this,i=this.isQosLogged?this.onCreateQosEvent(e):void 0,s=i?this.getEngagement():void 0;try{if(i){this._logEngagementEvent(i.data.extraData,s);this.trackUserAction(this.name)}if(!(t=this.instrumentOnExecutionWithCustomerPromise(this.onExecute(e,i))))throw new Error("Action did not return a promise")}catch(e){f.e.log(e);n=e}if(t){this._executingInstanceCount(this._executingInstanceCount.peek()+1);t.then(function(e){r._executingInstanceCount(r._executingInstanceCount.peek()-1);i&&i.end(e)},function(t){r._executingInstanceCount(r._executingInstanceCount.peek()-1);t&&!a.n.isCanceled(t)&&f.e.log(t);i&&i.end(r.onCreateErrorEventArg(e,t,!1))})}else{i&&i.end(this.onCreateErrorEventArg(e,n,!0));t=a.n.reject(n)}return t};t.prototype.onCreateQosEvent=function(e){var t=this._BaseAction_urlDataSource;return new i.e({name:this.name,pageType:t&&l.e[t.getPageType()]||"",queryType:t&&c.e[t.getQueryType()]||"",logStartEnd:this.logStartEnd})};t.prototype.onCreateErrorEventArg=function(e,t,n){return t&&a.n.isCanceled(t)?{resultType:h.e.ExpectedFailure,resultCode:"Canceled"}:t instanceof v.e?{resultType:t.isExpected?h.e.ExpectedFailure:h.e.Failure,resultCode:t.code,error:t.message,extraData:{CorrelationId:t.correlationId}}:{resultType:h.e.Failure,resultCode:n?"NoPromiseReturned":"PromiseFailed",error:t?"".concat(t.message||""):void 0}};t.prototype.onExecute=function(e,t){var n={resultType:h.e.Failure};return a.n.resolve(n)};t.prototype.instrumentOnExecutionWithCustomerPromise=function(e){var t=e;if(this.enableCustomerPromiseLogging){var n=this._BaseAction_urlDataSource,i=new m.e({scenario:this.name,extraData:{pageType:n&&l.e[n.getPageType()]||"",queryType:n&&c.e[n.getQueryType()]||""}});t=e.then(function(e){var t=e.resultCode,n=e.resultType,s=e.error,o=e.extraData;i.end({resultType:n,errorCode:t,extraData:Object(r.__assign)(Object(r.__assign)({},o),{error:s})});return e}).catch(function(e){var t;if(a.n.isCanceled(e))t={resultType:h.e.ExpectedFailure,errorCode:"Canceled"};else{var n=Object(g.e)(e),s=n.resultType,o=n.resultCode,u=n.error,f=n.extraData;t={resultType:s,errorCode:o,extraData:Object(r.__assign)(Object(r.__assign)({},f),{error:u})}}i.end(t);throw e})}return t};t.prototype.onIsAvailable=function(){return!0};t.prototype.onIsToggled=function(){return!1};t.prototype.getEngagement=function(){return this.resources.consume(d.e)};t.prototype.trackUserAction=function(e){var t=this._BaseAction_instrumentationProvider;if(t){var n=this.getEngagement();t.userExecuteAction({name:e,engagement:n})}};t.prototype._computeIsAvailable=function(){return!!this.onIsAvailable()};t.prototype._computeIsToggled=function(){return!!this.onIsToggled()};t.prototype._computeIsExecuting=function(){return this._executingInstanceCount()>0};t.prototype._logEngagementEvent=function(e,t){void 0===t&&(t=this.isQosLogged?this.getEngagement():void 0);if(t){var n=this._BaseAction_instrumentationProvider;t.logData({name:this.name,isIntentional:this.isExecutionIntentional,location:"NA",usageType:s.e[s.e.Click],currentPage:n&&n.currentPageName()||"NA",previousPage:n&&n.previousPageName()||"NA",extraData:Object(r.__assign)(Object(r.__assign)({},e||{}),n&&n.getEngagementData()||{})})}};t.dependencies=Object(r.__assign)(Object(r.__assign)({},o.default.dependencies),{urlDataSource:u.ve,instrumentationProvider:p.a.optional});return t})(o.default);t.e=y},,,,function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t,n){return e.call(this,t,n)||this}return t})(n(3335).e);t.e=i},,function(e,t,n){"use strict";n.d(t,"t",function(){return c});var r=n(0),i=n(1121),s=n(7),o=n(119),u={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},a={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0},f=new s.t({name:"".concat("ResponsiveUI",".breakpoints"),factory:new s.e(a)}),l=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._containerElement=t.containerElement||window;var i=r.observables;r._breakpoints=i.wrap(n.breakpoints);r.events.on(r._containerElement,"resize, orientationchange",r._onContainerResize);r.windowWidth=i.create(0);r.windowHeight=i.create(0);r.formFactorSize=i.pureCompute(r._computeFormFactorSize);r.isHamburgerVisible=i.pureCompute(r._computeIsHamburgerVisible);r.showLabels=i.pureCompute(r._computeShowLabels);r.cssClass=i.pureCompute(r._computeCssClass);r._onContainerResize();return r}t.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}};t.determineWindowSize=function(e,t){void 0===t&&(t=a);if(0===e)return"Medium";for(var n in a)if(e<t[n])return n};t.determineCssClass=function(e){return u[e]};t.getScrollbarWidth=function(){var e=document.createElement("div"),t=e.style;t.visibility="hidden";t.width="100px";t.msOverflowStyle="scrollbar";document.body.appendChild(e);var n=e.offsetWidth;t.overflow="scroll";var r=document.createElement("div");r.style.width="100%";e.appendChild(r);var i=r.offsetWidth;e.parentNode.removeChild(e);var s=n-i;this.getScrollbarWidth=function(){return s};return s};t.prototype.compareSize=function(e,t){var n=this._breakpoints();return n[e]-n[t]};t.prototype._onContainerResize=function(e){var t=this._containerElement,n=document.body,r=document.documentElement,i=t.clientWidth||r.clientWidth||t.innerWidth||n.clientWidth,s=t.clientHeight||r.clientHeight||t.innerHeight||n.clientHeight;this.windowWidth(i);this.windowHeight(s)};t.prototype._computeFormFactorSize=function(){var e=this._breakpoints(),n=this.windowWidth();return this._containerElement===window?t.determineWindowSize(n,e):"Medium"};t.prototype._computeCssClass=function(){return t.determineCssClass(this.formFactorSize())};t.prototype._computeShowLabels=function(){return this.compareSize(this.formFactorSize(),"Medium")>0};t.prototype._computeIsHamburgerVisible=function(){return this.windowWidth()<a.Large};t.dependencies={breakpoints:f};t.DEFAULT_BREAKPOINTS=a;t.MAC_SCROLL_BAR_WIDTH=8;return t})(i.default);t.e=l;var c=Object(o.s)("ResponsiveUI",l)},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(2096),i=n(119),s=(function(){function e(e,t){this._itemsStore=t.itemsStore}e.prototype.getParent=function(e){if(e){var t=this._itemsStore.getItem(e.key),n=t&&t.peek(),r=n&&(n.parentKey||n.UNSAFE_parent&&n.UNSAFE_parent.key);return r?this._itemsStore.getItem(r):void 0}};e.prototype.getFacetedAncestorOrSelf=function(e,t,n){void 0===n&&(n="");return this.getAncestorOrSelf(e,function(e){return n?e[t]&&e[t][n]:!!e[t]})};e.prototype.getAncestorOrSelf=function(e,t){for(var n,r=e&&e.key;r;){var i=this._itemsStore.getItem(r),s=i&&i.peek();if(!s)break;if(t(s)){n=i;break}r=s&&(s.parentKey||s.UNSAFE_parent&&s.UNSAFE_parent.key)}return n};e.dependencies={itemsStore:r.t};return e})(),o=Object(i.s)("ItemParentHelper",s)},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(91),s=n(1121),o=n(171),u=n(2332),a=n(119),f=n(2319),l=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=r,s=i.resources,a=i.observables,l=n.getCurrentItem,c=void 0===l?s.consume(o.o.lazy.optional):l,h=n.getItemSetSelectionModel,p=void 0===h?s.consume(o.k.lazy.optional):h,d=n.getSelectionHelper,v=void 0===d?s.consume(u.t.lazy.optional):d,m=t.allowMultiSelect,g=void 0!==m&&m,y=t.canFallback,b=void 0!==y&&y,w=t.ignoreSelection,E=void 0!==w&&w,S=t.overrideItem,x=t.useCurrentSelectionGroup,T=void 0!==x&&x;r._allowMultiSelect=g;r._overrideItem=S;r._ignoreSelection=E;r._useCurrentSelectionGroup=T;r._placeholder=r.observables.create(new f.e);r._getSelectionModel=p;S||(r._selectionHelper=v&&v());b&&c&&(r._fallback=c());r.selection=a.pureCompute(r._computeSelection);r.firstItem=a.pureCompute(r._computeFirstItem);r.currentItem=a.pureCompute(function(){return(c&&c()||r._placeholder)()});return r}t.prototype.filterItems=function(e){var t=this.selection();if(!t.length)return!1;for(var n=this.observables,r=0,i=t;r<i.length;r++){var s=i[r],o=n.unwrap(s);if(!o)return!0;if(!e(o))return!1}return!0};t.prototype.resolveSelection=function(){var e=this;return this._resolveSelection().then(function(t){if(t&&t.length)return t;if(e._fallback){var n=e._fallback.peek();if(n)return[n]}return[]})};t.prototype.resolveFirst=function(){var e=this;return this._resolveSelection().then(function(t){return t&&t.length?t[0]:e._fallback?e._fallback.peek():void 0})};t.prototype.selectItems=function(e){var t=this._getSelectionModel();t&&t.setSelectedKeys(e.map(function(e){return e.key}))};t.prototype.clearSelection=function(){var e=this._getSelectionModel();e&&e.clear()};t.prototype.selectAll=function(){var e=this._getSelectionModel();e&&e.selectAll()};t.prototype._computeSelection=function(){var e=this._getCurrentSelection();return!this._allowMultiSelect&&e.length>1?[]:e||[]};t.prototype._computeFirstItem=function(){var e=this.selection();return e&&e[0]&&e[0]()};t.prototype._getCurrentSelection=function(){if(this._overrideItem)return[this._overrideItem];var e,t=this._getSelectionModel();if(t){if(this._useCurrentSelectionGroup&&t.getSelectionModelGroup()){var n=t.getSelectionModelGroup().currentSelection();n&&(t=n)}e=t.selection()}else e=[];(0===e.length||this._ignoreSelection)&&this._fallback&&(e=[this._fallback]);return e};t.prototype._resolveSelection=function(){var e=this;if(this._overrideItem)return i.n.resolve([this._overrideItem.peek()]);var t=this.observables.ignore(function(){return e._computeSelection()});if(this._ignoreSelection||!t.length)return i.n.resolve([]);var n=this._selectionHelper;return n?n.resolveSelection():i.n.reject(new Error("Unable to resolve selection."))};return t})(s.default),c=Object(a.o)("ItemSelectionHelper",l,Object(r.__assign)(Object(r.__assign)({},s.default.dependencies),{currentItem:o.o.lazy.optional,itemSetSelectionModel:o.k.lazy.optional,selectionHelper:u.t.lazy.optional}))},function(e,t,n){"use strict";var r=n(0),i=n(2046),s=n(107),o=n(2110),u=n(371),a=n(2459),f={Left:"Right",Right:"Left"},l={Esc:!0},c=(function(e){Object(r.__extends)(t,e);function t(n){var r=e.call(this,n)||this,i=r.valueAccessor();if(i instanceof Array)for(var s=function(e){return function(){return e}},u=function(e){new(r.managed(t))({element:r.element,valueAccessor:s(e),bindingContext:r.bindingContext,allBindingsAccessor:r.allBindingsAccessor})},a=0,f=i;a<f.length;a++){u(f[a])}else{if("object"!=typeof i)throw new Error("KeyboardBinding only accepts an object for input. See documentation.");var l=i.mappings&&i||{mappings:i},c=l.target||r.element,h=l.useCapture,p=void 0!==h&&h;r._options=l;r.events.on(c,"keydown",r._onKeyDown,p);r._isActive=l.isActive||r.observables.create(!1);new(r.managed(o.t))({element:r.element,bindingContext:r.bindingContext,allBindingsAccessor:r.allBindingsAccessor,valueAccessor:function(){return{isActive:r._isActive}}})}return r}t.prototype._onKeyDown=function(e){var t=this._options,n=t.allowInputEvents,r=t.allowButtonEvents,i=t.context,o=void 0===i?this.bindingContext.$data:i,c=t.preventDefault,h=t.eventFilter,p=e.target,d=(function(e){var t;t=(function(e){var t;if(e>=65&&e<=91)t=String.fromCharCode(e);else switch(e){case 8:t="Backspace";break;case 9:t="Tab";break;case 13:t="Enter";break;case 27:t="Esc";break;case 32:t="Space";break;case 37:t="Left";break;case 38:t="Up";break;case 39:t="Right";break;case 40:t="Down";break;case 46:t="Delete";break;case 113:t="F2";break;case 117:t="F6";break;case 191:t="/";break;case 121:t="F10";break;default:t=""}return t})(e.keyCode);e.metaKey&&(t="Meta"+t);e.ctrlKey&&(t="Ctrl"+t);e.altKey&&(t="Alt"+t);e.shiftKey&&(t="Shift"+t);return t})(e),v=!r&&p!==this.element&&a.e(p),m=!l[d]&&!n&&p!==this.element&&a.t(p),g=t.target===document&&!this._isActive.peek(),y=(function(e,t){for(;e!==t&&t;){if(t.hasAttribute("data-suppresskeyboardbinding"))return!0;t=t.parentElement}return!1})(this.element,p);if(v||m||g||y)return!0;var b=(function(e,t){var n=!!e.useRtlMappings&&u.e.isRightToLeft&&f[t]||t;return e.mappings[n]})(t,d);if(b){c&&e.preventDefault&&e.preventDefault();if(h&&!h(d,o,e))return!0;for(var w=0,E=b instanceof Array?b:[b];w<E.length;w++){if(!1===E[w].call(o,o,e)){s.t.stopPropagation(e);return!1}}}return!0};return t})(i.t);t.e=c},function(e,t,n){"use strict";var r=(function(){function e(){}e.init=function(e,t,n,r,i){t()(e)};return e})();t.e=r},function(e,t,n){"use strict";n.r(t);n.d(t,"encodeItemSetParentKeyKey",function(){return O});n.d(t,"resourceKey",function(){return _});var r=n(0),i=(n(1735),n(1121)),s=n(2108),o=n(2319),u=n(2096),a=n(91),f=n(171),l=n(82),c=n(788),h=n(2094),p=n(2236),d=n(2084),v=n(2180),m=n(2592);function g(e,t){for(var n=t.start,r=Math.min(t.end,e.length),i=n;i<r;i++)if(!e[i])return!1;return!0}var y=n(1624),b=n(7),w=n(119),E=n(2115),S=n(334),x=n(2406),T=n("knockout-lib"),N=(function(){function e(e,t,n,r){this._context=e;this._store=t;this._isTokenBaseApi=n;this._tokenBasedExtraItemCount=r}e.prototype.initialize=function(e,t){this._skipDataFetch=!1;if(!this._context.group&&this._context.noIndexBasedDataFetch){var n=e&&e.content.peek().groupings,r=n&&n.length&&n[0].itemGroups;this._context.group=this._getGroupStartingOnIndex(t,r)}e&&e.isExpired&&(this._context.group=null);this._isExpandingGroup=this._context.noIndexBasedDataFetch&&this._context.group&&"__next__"!==this._context.group.groupingId&&!this._context.groupReplace;this._isFetchingNextGroup=this._context.group&&this._isTokenBaseApi&&"__next__"===this._context.group.groupingId;var i=e&&e.content.peek().groupings;this._isAllCollapsedQuery=i&&i.length>0&&i[0].isAllCollapsed&&i[0].isAllCollapsed.peek()&&!this._isExpandingGroup};e.prototype.isResultSetValid=function(e,t){var n=this._skipDataFetch;n||(n=this._isAllCollapsedQuery?!this._isExpandingGroup&&!this._context.requestToken:(this._isTokenBaseApi||!this._context.skipInMemoryCache)&&g(e,t)&&!(this._isFetchingNextGroup&&this._context.endIndex>e.length));return n};e.prototype.computeNewChildren=function(e,t,n,r,i){var s,o=!1;this._context.groupReplace&&(this._isFetchingNextGroup=!!e.nextRequestToken);s=i&&!n.isExpired?n.content.peek().items:[];if(e.nextRequestToken){!t.requestToken&&s.length>e.totalChildren&&(s[e.totalChildren]=null);e.totalChildren+=this._tokenBasedExtraItemCount;this._store.setNextRequestToken(t.parentKey,r,e.nextRequestToken);o=!0;n&&(n.isTokenBasedApi=o)}else this._store.setNextRequestToken(t.parentKey,r,"end");if(t.requestToken){t.startIndex=s.length-this._tokenBasedExtraItemCount;e.totalChildren+=s.length-this._tokenBasedExtraItemCount}if(this._isFetchingNextGroup||this._isAllCollapsedQuery){var u=e.children.length,a=e.startIndex+u;e.nextRequestToken&&(a+=this._tokenBasedExtraItemCount);e.totalChildren=Math.max(e.totalChildren,Math.max(s.length,a))}if(e.item&&e.totalChildren>=0){this._isExpandingGroup||(s.length>0&&0===e.totalChildren?s=[]:s.length=e.totalChildren);var f=void 0;f=t.groupReplace?t.startIndex:void 0!==e.startIndex?e.startIndex:this._isExpandingGroup?t.group.startIndex:t.startIndex;for(var l=0,c=0;l<s.length;l++)if(l>=f&&c<e.children.length){s[l]=this._store.getItem(e.children[c].key);if(t.remoteItem||t.isMountPointFolder){s[l].peek().isMountPointFolder=!0;s[l].peek().remoteWebUrl=t.isMountPointFolder?t.remoteWebUrl:t.remoteItem.SiteUrl}c++}}return{allChildren:s,hasNextRequestToken:o}};e.prototype.computeNewGroupings=function(e,t,n,r,i){var s=this._isExpandingGroup?r.group:null,o=r.itemsPerGroup,u=e&&e.length>0?e[0].itemGroups:null,a=null;u&&u.length>0&&u[u.length-1].isPlaceholder&&(a=u.pop());var f=this._mergeGroupings(e,t,i,n);if(s&&f){f[0].isAllCollapsed(!1);s.state({isCollapsed:!1})}if(n&&n.length>0&&!n[n.length-1]&&(u=f&&f.length>0?f[0].itemGroups:null)&&u.length>0){var l=u[u.length-1];this._context.groupReplace&&this._isFetchingNextGroup&&(l.hasMoreData=!0);var c=n[l.startIndex+(-1!==o?Math.min(l.count,o):l.count)-1]&&!(this._context.groupReplace&&l.count<o),h=f[0].isAllCollapsed.peek();if(c||this._isFetchingNextGroup||h){var p=l.startIndex+l.count;a?a.startIndex=p:a={groupingId:"__next__",startIndex:p,count:1,isPlaceholder:!0,state:T.observable({isCollapsed:!1})};n.length<p&&(n.length=p+1);u.push(a)}}return f};e.prototype._mergeGroupings=function(e,t,n,r){var i=e;if(i&&i.length>0){if(t&&t.length>0)for(var s=0;s<t.length;s++){var o=i[s].isAllCollapsed.peek();i[s].itemGroups=n?this._retainItemGroupState(i[s].itemGroups,t[s].itemGroups):this._mergeItemGroups(i[s].itemGroups,t[s].itemGroups,o,null,r)}}else i=t;return i};e.prototype._mergeItemGroups=function(e,t,n,r,i){var s=e;if(e&&e.length>0){if(t&&t.length>0)for(var o=function(e){var t=!1;n&&e.state({isCollapsed:!0});for(var o=function(i){var o=s[i];if(e.groupingId===o.groupingId){if(u._context.noIndexBasedDataFetch||!u._context.isTokenBasedApi){if(u._context.groupReplace){o.count+=e.count;o.hasMoreData&&i<s.length-1&&(o.hasMoreData=!1)}else o.count=e.count;o.children=u._mergeItemGroups(o.children,e.children,n,o);if(0===i)o.startIndex=r?r.startIndex:0;else{var a=s[i-1],f=a.startIndex+a.count-o.startIndex;o.startIndex+=f;o.children&&o.children.forEach(function(e){e.startIndex+=f})}}else{var l=e.startIndex+u._context.startIndex,c=e.startIndex+u._context.startIndex+e.count;o.startIndex=Math.min(o.startIndex,l);o.count=Math.max(c,o.startIndex+o.count)-o.startIndex}t=!0;return"break"}},a=0;a<s.length;a++){if("break"===o(a))break}if(!t){var f=s[s.length-1],l=f.startIndex+f.count-e.startIndex;e.startIndex+=l;e.children&&e.children.forEach(function(e){e.startIndex+=l});var c=Math.min(e.count,30),h=0;if(i)for(var p=e.startIndex;p<e.startIndex+c;p++)i[p]||h++;h&&(e.emptyItemCount=h);s.push(e)}},u=this,a=0,f=t;a<f.length;a++){o(f[a])}}else s=t;return s};e.prototype._retainItemGroupState=function(e,t,n){var r=t;if(t&&t.length>0&&e&&e.length>0){for(var i={},s=0,o=e;s<o.length;s++){var u=o[s];i[u.groupingId]=u}for(var a=0,f=r;a<f.length;a++){var l=f[a],c=i[l.groupingId];if(c){l.state(c.state.peek());l.children=this._retainItemGroupState(c.children,l.children,c)}}}return r};e.prototype._getGroupStartingOnIndex=function(e,t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var r=t[n];if(!(r&&r.startIndex<=e))break;var i=r.startIndex+r.count-1;if(r.children){if(i>=e)return this._getGroupStartingOnIndex(e,r.children)}else{if(r.startIndex===e)return r.state.peek().isCollapsed?null:r;if(i>=e){var s=n<t.length-1?t[n+1]:null;if(s&&!s.state.peek().isCollapsed){this._skipDataFetch=!0;return null}}}}return null};return e})(),C=n(79),k=n(4),L=n(1389),A=n(19),O=new b.t({name:"".concat("ItemProvider",".encodeItemSetParentKey"),factory:new b.e(Object(k.ks)(k.as))}),M=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._registeredProjections={};r._pendingGetItemRequests={};r._store=n.itemsStore;r._operationProvider=n.operationProvider;r._schemaDataSource=n.schemaDataSource;r._updateQuota=n.updateQuota;r._groupThrottle=n.groupThrottle;r._encodeItemSetParentKey=n.encodeItemSetParentKey||!1;r._smartFiltersStore=n.smartFiltersStore;return r}t.prototype.getItem=function(e){return this._getItem(e)};t.prototype.getItemSetKey=function(e,t){var n="parentKey="+(this._encodeItemSetParentKey?encodeURIComponent(e.parentKey):e.parentKey);function r(e,t){t&&(n+="&".concat(e,"=").concat(t))}r("ownerId",e.ownerId);r("groupingType",e.groupingType);n+="&sortField="+(e.sortField||"");n+="&isAscending="+("boolean"==typeof e.isAscending?e.isAscending:"");var i=e.filters;if(i)for(var s in i)n+="&"+s+"="+i[s];r("groupBy",e.groupBy);r("viewId",e.baseViewId);r("viewXml",e.viewXml);r("additionalFiltersXml",e.additionalFiltersXml);var o=!t&&e.itemSetProjections;if(o){var u="";for(var a in o)u+=a+"_"+o[a];n+="&projection="+u}e.supportsNestedGroups&&(n+="&ng=1");return n};t.prototype.getSpecifiedItems=function(e){e&&e.needToClearParentSmartFiltersInfo&&e.parentKey&&this._smartFiltersStore&&this._smartFiltersStore.invalidate(e.parentKey);return this._getItemDataSource().then(function(t){return t.getSpecifiedItems(e)})};t.prototype.getItemSync=function(e){var t=this.getItemSetKey(e),n=e.parentKey,r=this._store.getItem(n),i=this._getItemSet(t,e);if(!r){var s=new o.e(n),u=e.queryType,a=void 0===u?s.queryType:u;s.queryType=a;this._store.setItem(s);r=this._store.getItem(n)}if(!i){var f=r.peek(),l=f&&f.folder,c=l&&l.childCount||0;(i=new m.e(t,e,c)).item=r;var h=e.needSchema;if(void 0===h||h){var p=this._schemaDataSource,d=p&&p.getColumns(f);d&&d.length>0&&i.schema(d)}this._store.setItemSet(t,i)}return i};t.prototype.invalidateItem=function(e,t){var n=void 0===t?{}:t,i=n.triggerFetch,s=void 0!==i&&i,o=n.emptyAllOtherSets,u=void 0!==o&&o,a=n.refreshSchema,f=void 0!==a&&a,l=n.updateGrouping,c=void 0!==l&&l,h=n.purgeCache,p=void 0!==h&&h;u&&this._store.emptyAllOtherSets([e]);if(f){(d=this._store.getItemSetFromItemKey(e))&&d.schema([])}c||this._store.invalidateItem(e,{purgeCache:p});this._smartFiltersStore&&this._smartFiltersStore.invalidate(e);if(s){var d=this._store.getItemSetFromItemKey(e);this._getItem(Object(r.__assign)(Object(r.__assign)({parentKey:e},d&&d.context||{}),{skipCache:!0,updateGrouping:c}))}};t.prototype.removeFromRecent=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromRecent(e)}).then(function(n){n&&t.invalidateItem(e.parentKey);return n})};t.prototype.removeMountPoint=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeMountPoint(e)}).then(function(n){n&&t.invalidateItem(e.parentKey);return n})};t.prototype.createMountPoint=function(e){return this._getItemDataSource().then(function(t){return t.createMountPoint(e)}).then(function(e){return e},function(e){return a.n.wrapError(e)})};t.prototype.createDocument=function(e,t,n,r,i){var s=this;return this._getItemDataSource().then(function(o){return o.createDocument(e,t,n,r).then(function(t){if(i&&o.updateContentType){var n=t.match(/{(.*)}/),r=n&&n[1];return r?o.updateContentType(e,r,i).then(function(){s.invalidateItem(e);s._updateQuota(!0);return t}):t}s.invalidateItem(e);s._updateQuota(!0);return t})})};t.prototype.createCustomDocument=function(e,t,n){var r=this;return this._getItemDataSource().then(function(r){return r.createCustomDocument(e,t,n)}).then(function(t){if(!t)return a.n.wrapError();r.invalidateItem(e);r._updateQuota(!0);return r.getItem({parentKey:e}).then(function(e){return r.peekUnwrapObservable(r._store.getItem(t))})})};t.prototype.updateBundle=function(e,t){var n=this,r=[new E.e(e.item.key,e.item)];t.update(r);return this._getItemDataSource().then(function(t){return t.updateBundle(e)}).then(function(){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key);r=r.map(function(e){return e.succeed()});t.update(r)},function(i){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key);var s=new Error(i);r=r.map(function(e){return e.fail(s)});t.update(r);return a.n.wrapError(s)})};t.prototype.removeFromSharedList=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromSharedList(e)}).then(function(n){t.invalidateItem(e.parentKey);t.resources.consume(L.e)&&t.resources.consumeAsync(l.D).then(function(t){t.invalidateItems(e.parentKey)});return n})};t.prototype.updateViewCount=function(e){return this._getItemDataSource().then(function(t){return t.updateViewCount(e)})};t.prototype.reportAbuse=function(e){var t=new p.e,n=this._operationProvider.register({name:e.item.name||"",type:d.e.reportAbuse,payloads:{reportAbuse:{item:e.item}},iconName:e.item.iconName,batch:t}),r=this._getItemDataSource().then(function(t){return t.reportAbuse(e)});n.state(h.e.started);n.progress.maximum(1);return r.then(function(e){n.state(h.e.completed);n.progress.current(1);return e},function(e){n.state(h.e.failed);n.error(new v.e({message:e}));return a.n.wrapError(e)})};t.prototype.requestReview=function(e){for(var t=this,n=new p.e,r=e.items.map(function(e){var r=t._operationProvider.register({name:e.name||"",type:d.e.requestReview,payloads:{requestReview:{item:e}},iconName:e.iconName,batch:n});r.progress.maximum(1);r.progress.current(0);return r}),i=this._getItemDataSource().then(function(t){return t.requestReview(e)}),s=0,o=r;s<o.length;s++){o[s].state(h.e.started)}return i.then(function(n){for(var i=0,s=r;i<s.length;i++){var o=s[i];o.progress.current(1);o.state(h.e.completed)}var u=e.items[0].UNSAFE_parent;u&&t.invalidateItem(u.key);return n},function(e){for(var t=0,n=r;t<n.length;t++){var i=n[t];i.error(new v.e({message:e}));i.state(h.e.failed)}return a.n.wrapError(e)})};t.prototype.saveSortOrder=function(e){return this._getItemDataSource().then(function(t){return t.saveSortOrder(e)}).then(function(e){return e},function(e){})};t.prototype.addCoverPhotos=function(e){return this._updateCoverPhotos(e,d.e.addCoverPhotos,this._addCoverPhotos)};t.prototype.removeCoverPhotos=function(e){return this._updateCoverPhotos(e,d.e.removeCoverPhotos,this._removeCoverPhotos)};t.prototype.changeFolderType=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.changeFolderType(e)}).then(function(n){t.invalidateItem(e.item.key,{triggerFetch:!0});return n})};t.prototype.updateItemProperty=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.updateItemProperty(e)}).then(function(n){t.invalidateItem(e.item.key,{triggerFetch:!0});return n})};t.prototype.getOpenInClientDetails=function(e){return this._getItemDataSource().then(function(t){return t.getOpenInClientDetails(e)}).then(function(e){return e},function(e){})};t.prototype.getWorkProgress=function(e){return this._getItemDataSource().then(function(t){return t.getWorkProgress(e)})};t.prototype.processReferral=function(e,t){return this._getItemDataSource().then(function(n){return n.processReferral(e,t)})};t.prototype.getItemOcrTextContent=function(e){return this._getItemDataSource().then(function(t){return t.getItemOcrTextContent(e)})};t.prototype.updateItemOcrInfo=function(e,t,n){var r=this;return this._getItemDataSource().then(function(r){return r.updateItemOcrInfo(e,t,n)}).then(function(t){r.invalidateItem(e.key,{triggerFetch:!0});return t},function(e){return e})};t.prototype.rotateItems=function(e,t){var n=this,r={},i=e.items.map(function(e){return r[e.key]=new E.e(e.key,e)});t.update(i);return this._getItemDataSource().then(function(t){return t.rotateItems(e)}).then(function(){i=i.map(function(e){return e.succeed()});t.update(i)},function(e){var s=e.data||[];i=[];for(var o=0,u=s;o<u.length;o++){var a=u[o],f=r[a.key];n._store.setItem(f.input);delete r[a.key];i.push(f.fail(a.error))}for(var l in r){f=r[l];delete r[l];i.push(f.succeed())}t.update(i)})};t.prototype.registerProjection=function(e,t){this._registeredProjections[e]=t};t.prototype.computeProjectedItemSet=function(e,t,n,r){var i=n.itemSetProjections,s=r?null:this._store.getItemSet(e),o=!s||s.isPlaceholder||s.isExpired||s.version!==t.version;if(!s||o){if(!s){(s=new m.e(e,n)).item=t.item;s.isTokenBasedApi=t.isTokenBasedApi;s.isPlaceholder=t.isPlaceholder;s.isExpired=t.isExpired;s.version=t.version}for(var u in i){var a=this._registeredProjections[u];a&&a.projectItemSet(s,t,i[u])}r||this._store.setItemSet(e,s)}return s};t.prototype.redeemPermissionToken=function(e){return this._getItemDataSource().then(function(t){return t.redeemPermissionToken(e)})};t.prototype._getItem=function(e){var n,i=this,s=y.e(e),o=this._store;if(e.keyAlias){n=this.getItemSync({parentKey:e.keyAlias}).item;e.parentKey=n.peek().key}else n=this.getItemSync(e).item;var u=e.skipCache,f=void 0!==u&&u,c=this.getItemSetKey(e),h=e.itemSetProjections?this.getItemSetKey(e,!0):c,p=this._getItemSet(c,e),d=p&&p.content.peek().items,v=e.isTokenBasedApi||!!p&&!!p.isTokenBasedApi,b=!f&&n&&!n.peek().revision&&p&&!p.isExpired&&!p.isPlaceholder&&(!e.requestAllChildren||g(d,{start:0,end:d.length})),w=e.startIndex,E=void 0===w?0:w,x=e.pageSize,T=void 0===x?100:x,k=e.endIndex||E+T;k=d&&d.length>0&&!v?Math.min(d.length,k):k;E=Math.max(0,Math.min(k,E));var L=!A.e.isActivated("73b2b18a-27b0-433f-95cf-c7f77326ff37","11/09/2021","Not set requestToken if itemSet is expired")?p&&!p.isExpired?o.getNextRequestToken(h):void 0:o.getNextRequestToken(h);e.requestToken="end"===L?"":L;var O=new N(e,o,v,t.TOKEN_BASED_API_EXTRA_ITEMS);O.initialize(p,E);var M=!1,_=p&&p.content.peek();if(_&&(1===_.partialResultStatus||2===_.partialResultStatus)){M=!0;1===_.partialResultStatus&&p.content({items:_.items,groupings:_.groupings,partialResultRequestCount:0,partialResultStatus:2})}if(b&&!M&&O.isResultSetValid(d,{start:E,end:k}))return a.n.wrap(p);if(n&&n.peek().isStub){var D=e.startKey;if(D){if(o.getItem(D)){p.content.peek().items=[o.getItem(D)];p.isPlaceholder=!0;p.isExpired=!1;var P=this._schemaDataSource,H=P&&P.getColumns(n.peek());H&&H.length>0&&p.schema(H);p.content.valueHasMutated&&p.content.valueHasMutated()}}return a.n.wrap(p)}var B=p&&!p.isExpired&&p.content.peek().groupings;B&&B.length>0&&(e.isGrouped=!0);this._normalizeContext(e,d,E,k,!b);var j=this._getRequestKey(e),F=this._pendingGetItemRequests[j];if(F)return e.itemSetProjections?F.getPromise().then(function(t){return i.computeProjectedItemSet(c,t,e)}):F.getPromise();v&&!L&&(e.startIndex=0);this._pendingGetItemRequests[j]=F=new S.e;this.resources.consumeAsync(l.b.bypass).then(function(t){return t.getItem(Object(r.__assign)(Object(r.__assign)({},e),{itemSetKey:c}))}).then(function(t){if(s.updateContextBasedOnResult&&e.updateContextBasedOnResult){s.updateContextBasedOnResult(s,t);e.updateContextBasedOnResult(e,t);c=i.getItemSetKey(s)}var r=e.itemSetProjections?i.getItemSetKey(e,!0):c;n=o.getItem(e.parentKey);var u=o.getItemSet(r);b=!(!n||!u);var a=O.computeNewChildren(t,e,u,r,!!b),f=a.allChildren,l=a.hasNextRequestToken;l&&(v=l);if(t.item&&!e.ignoreChildren&&!e.skipStoreResults){if(!b){(u=new m.e(r,e)).item=o.getItem(e.parentKey);u.isTokenBasedApi=v;o.setItemSet(r,u)}var h=!!u.isExpired;u.sortField=t.sortField;u.isAscending=t.isAscending;u.isPlaceholder=!1;u.isExpired=!1;var p=e.needSchema;if(void 0===p||p){var d=t.schema;u.schema(d&&d.length>0&&d||[]);t.customViewRenderer?u.customViewRenderer=i.observables.create(t.customViewRenderer):u.customViewRenderer=i.observables.create(void 0)}var w=t.groupings;v&&e.mergeGroupings&&(w=O.computeNewGroupings(u.content.peek().groupings,t.groupings,f,e,h));t.contentTypes&&u.contentTypes&&u.contentTypes(t.contentTypes);var E=u.content.peek(),S=E.partialResultStatus,x=E.partialResultRequestCount,T=void 0===x?0:x;if(!(w&&w.length&&!!w[0])){if(l&&(t.children&&t.children.length<30||!t.children)){var N=T+1;N<=5?T=N:S=1}else void 0===S||0===S||l?2===S&&t.children&&30===t.children.length&&(S=0):S=3}u.content({items:f,groupings:w,partialResultRequestCount:T,partialResultStatus:S});var C=u.version,k=void 0===C?0:C;u.version=k+1}delete i._pendingGetItemRequests[j];if(e.requestAllChildren&&!g(f,{start:0,end:t.totalChildren})){var L=y.e(e),A=L.startIndex,M=void 0===A?0:A;L.startIndex=M+100;return i._getItem(L)}if(t.isFromBrowserCache){s.skipCache=!0;return i._getItem(s)}e.itemSetProjections&&(u=i.computeProjectedItemSet(c,u,e));return u},function(e){delete i._pendingGetItemRequests[j];return a.n.wrapError(e)}).then(function(e){F.complete(e)},function(t){i._groupThrottle&&!i._groupThrottle()&&t&&t.errorCode===Number(C.t.queryThrottled)&&!e.noGroupReplace?i._groupThrottle(!0):F.error(t)});return F.getPromise()};t.prototype._normalizeContext=function(e,t,n,r,i){var s=e.pageSize||100;if(!e.avoidSeamSnapping){if(!i&&!(n-n%s==r-r%s)&&t)for(;n<r&&t[n];)n++;e.startIndex=n-n%s}"number"!=typeof e.pageSize&&(e.pageSize=100);for(var o=e.startIndex,u=void 0===o?0:o;r-u>e.pageSize;)e.pageSize+=100};t.prototype._getRequestKey=function(e){var t=this.getItemSetKey(e,!0);e.requestToken?t+=e.requestToken:t+="&startIndex="+e.startIndex;return t+="&pageSize="+e.pageSize};t.prototype._getItemSet=function(e,t){var n=this._store,r=n.getItemSet(e);if(t.itemSetProjections){var i=this.getItemSetKey(t,!0),s=n.getItemSet(i);s&&(r=this.computeProjectedItemSet(e,s,t))}return r};t.prototype._updateCoverPhotos=function(e,t,n){for(var r=this,i=new p.e,s=e.target,o=e.items.map(function(e){var n=r._operationProvider.register({name:e.name||"",type:t,payloads:{coverPhotos:{parent:s,item:e}},iconName:e.iconName,batch:i});n.progress.maximum(1);n.progress.current(0);return n}),u=n.call(this,e),a=0,f=o;a<f.length;a++){f[a].state(h.e.started)}return u.then(function(t){r.invalidateItem(s.key);(null==e?void 0:e.itemsScopeInvalidate)&&r.resources.consumeAsync(l.D).then(function(e){e.invalidateItems(null==s?void 0:s.key)});for(var n=0,i=o;n<i.length;n++){var u=i[n];u.progress.current(1);u.state(h.e.completed)}return t},function(){for(var e=0,t=o;e<t.length;e++){t[e].state(h.e.failed)}})};t.prototype._addCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.addCoverPhotos(e)})};t.prototype._removeCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.removeCoverPhotos(e)})};t.prototype._getItemDataSource=function(){return a.n.resolve(this.resources.consumeAsync(l.B))};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.default.dependencies),{groupThrottle:f.y.optional,schemaDataSource:l.Z.optional,itemsStore:u.t,operationProvider:s.resourceKey,smartFiltersStore:c.e.optional,updateQuota:x.e,encodeItemSetParentKey:O.optional});t.TOKEN_BASED_API_EXTRA_ITEMS=2;return t})(i.default),_=(t.default=M,Object(w.s)("ItemProvider",M))},function(e,t,n){"use strict";n.d(t,"e",function(){return v});var r=n(0),i=n(1121),s=n(119),o=n("knockout-lib"),u=n(91),a=n(334),f=n(127),l=n(2500),c=function(){this.icon=null;this.isAvailable=o.observable(!0);this.isVisible=o.observable(!0);this.isDefault=!1;this.automationId="";this.instrumentationId="";this.isExecuting=o.observable(!1);this.isLink=!1;this.execute=function(){return u.n.wrap(1)}},h=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.state=o.observable(1);var r=t.title,i=t.titleAction,s=t.titleIcon,u=t.titleIconAriaLabel,f=t.customCssClasses,h=t.actions,p=void 0===h?[]:h,d=t.component,v=t.control,m=t.isDismissable,g=void 0===m||m,y=t.isSoftDismissable,b=void 0===y||y,w=t.isDismissableOnResize,E=void 0!==w&&w,S=t.isDismissableOnScroll,x=void 0!==S&&S,T=t.size,N=void 0===T?"Small":T,C=t.automationId,k=t.executeDefaultAction,L=void 0===k||k,A=t.isCallout,O=t.isOverlayHidden,M=void 0!==O&&O,_=t.overlayColor,D=void 0===_?"rgba(255,255,255,.4)":_,P=t.invokerEvent,H=t.calloutHeight,B=t.instrumentationId,j=void 0===B?"":B,F=t.shouldPreserveFocus,I=void 0===F||F,q=t.stayAsPopup,R=void 0!==q&&q,U=t.template,z=void 0===U?1:U,W=t.style,X=void 0===W?l.e.normal:W,V=t.focusOnPrimaryAction,$=void 0!==V&&V,J=t.dismissOnEsc,K=void 0!==J&&J;n.title=o.isObservable(r)?r:o.observable(r);n.titleAction=i;n.titleIcon=s;n.titleIconAriaLabel=u;n.customCssClasses=f;n.actions=p;n.component=d;n.control=v;n.isDismissable=g;n.isSoftDismissable=b;n.isDismissableOnResize=E;n.isDismissableOnScroll=x;n.size=N;n.automationId=C||"";n.executeDefaultAction=L;n.isCallout=!!A&&!!P;n.isOverlayHidden=M;n.overlayColor=D;n.invokerEvent=P;n.calloutHeight=H;n.instrumentationId=j;n.shouldPreserveFocus=o.isObservable(I)?I:o.observable(I);n.stayAsPopup=R;n.template=z;n.style=X;n.focusOnPrimaryAction=$;n.dismissOnEsc=K;n.actions=n.actions.map(function(e){return o.utils.extend(new c,e)});n.actionsVisible=n.createComputed(function(){for(var e=!1,t=0,r=n.actions;t<r.length;t++){r[t].isVisible()&&(e=!0)}return e},{disposeWhen:function(){return 1!==n.state()}});var Q=new a.e;n.createComputed(function(){var e=n.state();1!==e&&(2===e?Q.complete():Q.cancel())});n._promise=Q.getPromise();n.events.on(document,"keydown",n._keyDownEvent);return n}t.prototype.complete=function(){this.state(2)};t.prototype.dismiss=function(){this.state(3)};t.prototype.wait=function(){return this._promise};t.prototype._keyDownEvent=function(e){e.keyCode===f.e.escape&&this.dismissOnEsc&&this.state(3)};return t})(i.default),p=n(2200),d=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._dialogs=[];r.currentDialog=r.observables.create();r._needsOverlayContent=n.needsOverlayContent;return r}t.prototype.requestDialog=function(e){this._needsOverlayContent.needsOverlayContent.set(!0);var t=this._dialogs;if(e.maxOneDialog&&t.length>0)return t[0];var n=this.currentDialog,r=new h(e);if(e.queueDialog){t.push(r);1===t.length&&n(r)}else{t.unshift(r);n(r)}var i=function(){var e=t.indexOf(r);if(e>=0){t.splice(e,1);n(t[0])}r.dispose()};r.wait().then(i,i);return r};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.default.dependencies),{needsOverlayContent:p.e});return t})(i.default),v=Object(s.s)("DialogProvider",d)},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return s});var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;!1!==t.valueAccessor()&&n.element.setAttribute("data-is-scrollable","true");return n}return t})(n(2046).t);t.e=i;function s(e){for(var t=e;t&&t!==document.body;){if(t.getAttribute&&"true"===t.getAttribute("data-is-scrollable"))return t;t=t.parentElement}t&&t!==document.body||(t=window);return t}},function(e,t,n){"use strict";var r=n(0),i=n(2046),s=n(224),o=n(2061),u=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.valueAccessor(),i=(function(e){return"object"==typeof e})(r)?r:{close:r},s=i.timeout,u=void 0===s?1e3:s,a=i.close,f=i.isAutomatic,l=void 0!==f&&f,c=i.isOpen,h=i.isEnabled,p=void 0===h||h,d=i.dismissOnResize,v=void 0!==d&&d,m=i.dismissOnScroll,g=void 0!==m&&m,y=i.useLocalEvents,b=void 0!==y&&y,w=i.disableEscape,E=void 0!==w&&w;n._options={timeout:u,close:a,isAutomatic:l,isOpen:c,dismissOnResize:v,dismissOnScroll:g,useLocalEvents:b,disableEscape:E};var S=n.observables;n._isAutomatic=S.wrap(l);n._isEnabled=S.wrap(p);n._isActive=S.create(!0);n._isOpenAndNotActive=S.pureCompute(n._computeIsOpenAndNotActive);S.backgroundCompute(n._computeDismissIfOpenAndNotActive).extend({rateLimit:{timeout:n._options.timeout,method:"notifyWhenChangesStop"}});n._options.isOpen&&S.backgroundCompute(n._computeDeactivateIfOpen);n.events.on(document,"click, mousemove, touchmove, pointermove, MSPointerMove, keydown",n._onEvent,!0);n.events.on(document,"click",n._onClick,!0);new(n.managed(o.e))({element:n.element,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return{mappings:{Esc:function(e,t){return!!n._options.disableEscape||n._onEscape(t)}},target:n._options.useLocalEvents?void 0:document,useCapture:!n._options.useLocalEvents,allowInputEvents:!0,allowButtonEvents:!0,context:n.bindingContext.$data}}});n._options.dismissOnResize&&n.events.on(window,"resize",n._onResizeOrScroll,!0);n._options.dismissOnScroll&&n.events.on(window,"scroll",n._onResizeOrScroll,!0);return n}t.prototype._dismiss=function(){var e=this._options,t=e.isOpen,n=e.close;t&&t(!1);if(n){var r=this.bindingContext.$data;if(!1===n.call(r,r))return!1}return!0};t.prototype._onClick=function(e){if(!a(this.element,e)&&!(function(e){var t,n=e.target;return"none"===(null===(t=null==n?void 0:n.style)||void 0===t?void 0:t.display)})(e)){this._isActive(!1);this._isOpenAndNotActive.peek()&&this._isEnabled.peek()&&this._dismiss()}return!0};t.prototype._onEscape=function(e){if(a(this.element,e)){this._isActive(!1);if(this._isOpenAndNotActive.peek()&&this._isEnabled.peek()){e.stopImmediatePropagation();e.stopPropagation();this._dismiss();return!1}}return!0};t.prototype._onEvent=function(e){a(this.element,e)?this._isActive(!0):this._isActive(!1);return!0};t.prototype._onResizeOrScroll=function(e){if(!a(this.element,e)){this._isActive(!1);this._isOpenAndNotActive.peek()&&this._isEnabled.peek()&&this._dismiss()}return!0};t.prototype._computeDismissIfOpenAndNotActive=function(){this._isAutomatic()&&this._isOpenAndNotActive()&&this._isEnabled.peek()&&this._dismiss()};t.prototype._computeIsOpenAndNotActive=function(){var e=this._isActive(),t=this._options.isOpen;return(!t||t())&&!e};t.prototype._computeDeactivateIfOpen=function(){this._options.isOpen()&&this._isActive(!1)};return t})(i.t);t.e=u;function a(e,t){try{for(var n=t.target;n!==e&&Object(s.e)(n);)n=Object(s.e)(n);return n===e}catch(e){return!1}}},,,function(e,t,n){"use strict";n.d(t,"t",function(){return s});var r=n(2079);n.d(t,"e",function(){return r.e});var i=n(119),s=Object(i.o)("Command",r.e)},function(e,t,n){"use strict";var r=n(0),i=(n(1735),n(2116)),s=n(2044),o=n(2112),u=n(2075),a=n(2062),f=n(2046),l=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.valueAccessor();n._callback=r.callback;n._delay=r.delay||400;n.events.on(n.element,"mouseenter",n._onMouseEnter);n.events.on(n.element,"mouseleave",n._onMouseLeave);return n}t.prototype._clearTimer=function(){if(this._timerID){this.async.clearTimeout(this._timerID);this._timerID=void 0}};t.prototype._onMouseEnter=function(e){this._clearTimer();this._timerID=this.async.setTimeout(this._onHoverTimer,this._delay)};t.prototype._onMouseLeave=function(e){this._clearTimer()};t.prototype._onHoverTimer=function(){this._timerID=void 0;this._callback&&this._callback()};return t})(f.t),c=n(2113),h=n(2100),p=n("knockout-lib"),d=n(107),v=(function(){function e(){}e.init=function(e,t){var n=p.utils.unwrapObservable(t()),r=n.eventName||"dataChange",i=n.eventArgs,s=p.isObservable(n.data)?n.data:p.observable(),o=n.bubbleEvent||!1;s.subscribe(function(){d.t.raise(e,r,i,o)})};return e})(),m=n(2209),g=n(371),y=n(109),b=n(370),w=n(2210),E=n(265),S=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._insertNewElement();n.controlsDescendantBindings=!0;return n}t.prototype.dispose=function(){if(this._previousElement){p.cleanNode(this._previousElement);delete this._previousElement}e.prototype.dispose.call(this)};t.prototype._insertNewElement=function(){var e=this.valueAccessor(),t=this._createInputElement(e.isFolderUpload);this._applyBindings(t,e);p.virtualElements.setDomNodeChildren(this.element,[t]);this._previousElement=t};t.prototype._createInputElement=function(e){var t=document.createElement("input");t.type="file";t.tabIndex=-1;if(e){t.webkitdirectory=!0;t.directory=!0}else t.multiple=!0;return t};t.prototype._applyBindings=function(e,t){var n=this;p.applyBindingsToNode(e,{class:t.class,css:t.css,style:t.style,event:{change:function(e,r){t.onInputChange.call(e,r);n._insertNewElement()}}},this.bindingContext)};t.supportsVirtualElements=!0;return t})(f.t),x=n(2190),T=n(2216),N=n(2049),C=n(2058),k=n(340),L=n(37),A=0;var O=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,(function(e){e.id=e.id||"".concat(A++);return e})(t),n)||this;r.ActionInputType=x.e;r._defaultMenuOffset=new E.e(0,o.e.size/2+4);r.addBindingHandlers({dismiss:u.e,raiseEventOnChange:v,measure:c.e,longHover:l,element:a.e,teachingBubble:m.e,fileInput:S,tooltip:h.e,control:N.r});var s=r,f=s.observables,p=s.resources,d=n.engagement,g=void 0===d?p&&p.consume(b.e.optional):d,y=n.responsiveUI,w=void 0===y?p&&p.consume(C.t.optional):y;r._isOpenRequested=r.createObservable(!1);r.isActive=r.createObservable(!1);r.isToggled=r.createObservable(!1);r.focused=r.createObservable(!1);r.menuFocus=r.createObservable(!1);r.fileInputElement=r.createObservable();var T=t.text,L=void 0===T?"":T,O=t.automateExperimentText,M=t.subtext,_=void 0===M?"":M,D=t.classSuffix,P=void 0===D?r.createObservable():D,H=t.collapsedText,B=void 0===H?r.createObservable():H,j=t.location,F=void 0===j?11:j,I=t.renderLabel,q=void 0===I?1:I,R=t.isCurrentView,U=void 0===R?null:R,z=t.hasIconOnly,W=void 0!==z&&z,X=t.positionIconRight,V=void 0!==X&&X,$=t.icon,J=t.iconUrl,K=t.iconSize,Q=void 0===K?16:K,G=t.appIconName,Y=t.ariaControls,Z=t.ariaExpanded,ee=t.ariaHasPopup,te=t.keys,ne=void 0===te?[]:te,re=t.isToggleable,ie=void 0!==re&&re,se=t.isHidden,oe=void 0===se?r.createObservable():se,ue=t.isDisabled,ae=t.isInvisibleWhenDisabled,fe=void 0!==ae&&ae,le=t.tooltip,ce=void 0===le?null:le,he=t.accessibleLabel,pe=void 0===he?"":he,de=t.prependTextToAccessibleLabel,ve=void 0===de||de,me=t.sectionAccessibleLabel,ge=void 0===me?"":me,ye=t.role,be=void 0===ye?"":ye,we=t.teachingBubble,Ee=t.iconBadge,Se=t.isPermanent,xe=void 0!==Se&&Se,Te=t.state,Ne=void 0===Te?r.createObservable(i.e.initialized):Te,Ce=t.requiredChildren,ke=void 0===Ce?0:Ce,Le=t.collapseSingleChildCommands,Ae=void 0===Le||Le,Oe=t.hasLineBreakBefore,Me=void 0!==Oe&&Oe,_e=t.hasLineBreakAfter,De=void 0!==_e&&_e,Pe=t.action,He=t.callback,Be=t.onCoachmarkOpen,je=t.menuAlignment,Fe=void 0===je?r.createObservable(0):je,Ie=t.menuOffset,qe=void 0===Ie?r.createObservable(r._defaultMenuOffset):Ie,Re=t.isMenuBeakVisible,Ue=void 0===Re?r.createObservable(!0):Re,ze=t.payload,We=t.enableRecoverFocusBinding,Xe=void 0!==We&&We,Ve=t.engagementName,$e=t.source,Je=t.experiment,Ke=t.isLastPivot,Qe=void 0!==Ke&&Ke,Ge=t.hasAnimation,Ye=void 0!==Ge&&Ge,Ze=t.hidesMenuChevron,et=void 0!==Ze&&Ze,tt=t.children,nt=void 0===tt?r.observables.createArray():tt,rt=t.isStrong,it=void 0===rt?r.createObservable(!1):rt,st=t.hasDeferredChildren,ot=void 0!==st&&st,ut=t.hasDynamicText,at=void 0!==ut&&ut,ft=t.reportClickingTime,lt=t.beakColor,ct=void 0===lt?k.e.white:lt,ht=t.isContentType,pt=t.isIconOnly,dt=t.onRenderIcon,vt=t.overrideTabIndex;r.text=r.wrapObservable(L);r.automateExperimentText=r.wrapObservable(O);r.subtext=r.wrapObservable(_);r.commandClass=r.wrapObservable(P);r.collapsedText=B;0;r.isLabelVisible=2===q?w.showLabels:f.create(1===q);r.isToggleable=ie;r.location=F;r.isPermanent=r.wrapObservable(xe);r.requiredChildren=ke;r.collapseSingleChildCommands=Ae;r.hasLineBreakAfter=r.wrapObservable(De);r.hasLineBreakBefore=r.wrapObservable(Me);r.action=Pe;r.ariaControls=Y;r.ariaExpanded=Z;r.ariaHasPopup=ee;r.callback=He;r.onCoachmarkOpen=Be;r.hidesMenuChevron=et;r.isStrong=it;r.isClipped=r.createObservable(!1);r.hasDynamicText=at;r._reportClickingTime=ft;r.beakColor=ct;r.isContentType=ht;r.isIconOnly=!!pt;r.onRenderIcon=dt;r._engagement=g;r.action&&r.action.inputType?r.inputType=r.createPureComputed(r._computeInputType):r.inputType=r.createObservable(x.e.none);r._initializeIcons($,J,Q,Ee,G);r.tooltip=r.wrapObservable(ce);r.accessibleLabel=r.wrapObservable(pe);r.prependTextToAccessibleLabel=ve;r.sectionAccessibleLabel=r.wrapObservable(ge);r.role=be||(ie?"menuitemcheckbox":"menuitem");we&&(r.teachingBubble=r.wrapObservable(we));ue&&(r.isDisabled=ue);r.isInvisibleWhenDisabled=fe;r._isHidden=r.wrapObservable(oe);r.bounds=r.createObservable();r.measurementReady=function(e){r.onMeasurementReady(e)};r.payload=ze;r.enableRecoverFocusBinding=Xe;r.keys=ne;r.children=nt instanceof Array?r.observables.createArray(nt):nt;r.addDisposable(r.children.map({mappingWithDisposeCallback:function(e){e.parentCommand=r;return{mappedValue:e,dispose:function(){e.parentCommand=null}}}}));r.visibleChildren=r.addDisposable(r.children.filter(function(e){return e.isVisible()}));r.hasDeferredChildren=ot;r.isToggled=r.createComputed(r._computeIsToggled);r.hasAnimation=Ye;r.isVisible=r.createComputed(r._computeIsVisible);r.state=r.wrapObservable(Ne);r.isCurrentView=U;r.isLastPivot=Qe;r.isCollapsed=r.createComputed(function(){return r.collapseSingleChildCommands&&1===r.visibleChildren().length});r.menuAlignment=r.wrapObservable(Fe);r.menuOffset=r.wrapObservable(qe);r.isMenuBeakVisible=r.wrapObservable(Ue);r.targetCommand=r.createComputed(function(){if(r.isCollapsed()){return r.visibleChildren()[0]}return r});r.label=r.createComputed(r._computeLabel);r.computedAccessibleLabel=r.createPureComputed(function(){return r._computeAccessibleLabel()});r.hasIconOnly=r.wrapObservable(W);r.positionIconRight=V;r.isOpen=r.createComputed({read:function(){return r._isOpenRequested()&&(r.visibleChildren().length>0||!(!r.payload||!r.payload.control()))},write:function(e){r._isOpenRequested(e)},pure:!0});r.subscribe(r.isOpen,function(e){e||r.children().forEach(function(e){e.children().length>0&&e.isOpen(!1)})});var mt=r.addDisposable(r.visibleChildren.filter(function(e){return e.isOpen()})),gt=r.createComputed(function(){return mt().length>0});r.subscribe(gt,function(e){e||r.async.setImmediate(function(){document.activeElement&&document.activeElement!==document.body||r.focused(!0)})});r.tabindex=r.createObservable(0);r.createComputed(function(){if(!r.isOpen()&&r.focused()){r.tabindex(0);r.isActive(!0)}else r.isActive()||r.tabindex(vt?0:-1)});r.isDisabled||(r.isDisabled=r.createComputed(function(){return r.targetCommand()!==r?r.targetCommand().isDisabled():r.requiredChildren>0?r.visibleChildren().length<r.requiredChildren:!(r.visibleChildren().length||r.action&&(r.action.isAvailable()||r.isToggleable&&r.action.isToggled())||r.callback)}));r.layoutChanged=r.createObservable();r.createComputed(function(){r.isLabelVisible();r.text();r.layoutChanged.notifySubscribers()});r.engagementName=Ve;r.source=r.wrapObservable($e);r.experiment=Je;return r}t.prototype.getKey=function(){return this.id};t.prototype.hasVisibleChildren=function(){return this.visibleChildren().length>0};t.prototype.hasVisibleOrDeferredChildren=function(){return this.hasVisibleChildren()||this.hasDeferredChildren};t.prototype.onMeasurementReady=function(e){this.bounds(e)};t.prototype.onClick=function(e,t){var n,s=this,o=t&&t.type||"unknown",u=["CommandView",w.t(o)],a=!1;this._reportClickingTime&&this._reportClickingTime();if((0===this.location||this.isVisible.peek())&&!this.isDisabled.peek()){var f=this.isCollapsed.peek()?this.visibleChildren.peek()[0]:this,l=f.visibleChildren.peek().length&&(f.icon||f.text),c=f.action&&f.action.isAvailable.peek(),h=e.engagementName,p=e.source;if(h){u=[h,w.e];p&&p.peek()&&(u[0]+=p.peek());n=u.join(".")}else if(l){var d=f.icon&&f.icon.peek(),v=d?d.toString():f.visibleChildren.peek()[0]&&f.visibleChildren.peek()[0].engagementName?f.visibleChildren.peek()[0].engagementName:"Unknown";u.splice(1,0,"Parent"+w.t(v));n=u.join(".")}else if(c){u.splice(1,0,w.t(f.action.name));n=u.join(".")}f.payload&&f.payload.control.peek()&&f.isOpen.peek()&&f.isOpen(!1);if(n){var m=this._engagement,g={name:n,isIntentional:!0,experiment:e.experiment,extraData:Object(r.__assign)({action:w.t(o)},T.t.getLoggingContextData(this.resources))};m?m.logData(g):y.e.logData(g)}if(l){f.closeSiblingCommands();f.parentCommand?f.isOpen(!0):f.isOpen(!f.isOpen.peek());f.isOpen.peek()&&f.focused(!0);f.callback&&f.callback();a=!0}else if(c){if(!e.isDisabled||!e.isDisabled.peek()){if(f.fileInputElement.peek()&&f.action.isAvailable.peek()){f.fileInputElement.peek().click()}else{this.state(i.e.executed);f.action.execute(t).done(function(){s.state(i.e.initialized)},function(e){s.state(i.e.failed)})}"MoveCopy"===f.action.name&&e.isDisabled(!0)}a=!0}else if(f.callback){f.callback();a=!0}}this.isDisabled.peek()&&t.preventDefault();a&&t&&t.stopPropagation();return!a};t.prototype.onDismiss=function(){var e=this.visibleChildren.peek();(this.payload&&this.payload.control.peek()||e&&e.length)&&this.isOpen(!1)};t.prototype.onInputChange=function(e){var t=this.targetCommand();if(t&&t.action){t.action.execute(e);this.closeParentCommands()}};t.prototype.openMenu=function(){var e=this.visibleChildren();if(e&&e.length){this.isOpen(!0);return!0}return!1};t.prototype.getIcon=function(e){var t=e;this.icon&&this.icon()&&(t+=" "+this.icon().getClass());return t};t.prototype.getChevron=function(){var e=g.e.isRightToLeft?"ChevronLeft":"ChevronRight";return Object(L.L)(e)};t.prototype.getChevronDown=function(e){return Object(L.L)("ChevronDown")};t.prototype.closeParentCommands=function(){for(var e=this.parentCommand;e;){e.isOpen(!1);e=e.parentCommand}};t.prototype.closeSiblingCommands=function(){var e=this;this.parentCommand&&this.parentCommand.children().forEach(function(t){t!==e&&t.isOpen(!1)})};t.prototype._initializeIcons=function(e,t,n,r,i){var s=this,o=this.createPureComputed(function(){return s.isCollapsed()?s.targetCommand().icon():void 0}),u=this.createPureComputed(function(){return s.isCollapsed()?s.targetCommand().iconUrl():void 0}),a=this.wrapObservable(e);this.icon=this.createPureComputed(function(){if(s.isCollapsed()){var e=o();if(e)return e;if(u())return}return a()});var f=this.wrapObservable(t);this.iconUrl=this.createPureComputed(function(){if(s.isCollapsed()){if(o())return;return u()||f()}return f()});this.iconSize=this.wrapObservable(n);var l=this.wrapObservable(r);this.iconBadge=this.createPureComputed(function(){return s.isCollapsed()&&s.targetCommand().iconBadge()||l()});this.appIconName=i};t.prototype._computeIsToggled=function(){return this.isCurrentView?this.isCurrentView():!!this.action&&this.action.isToggled()};t.prototype._computeIsVisible=function(){return 0!==this.location&&(!this._isHidden()&&(this.requiredChildren>0?this.visibleChildren().length>=this.requiredChildren:!this.action||(this.isPermanent()||this.action.isAvailable()||this.isToggleable&&this.action.isToggled())))};t.prototype._computeLabel=function(){return this.isCollapsed()?this.targetCommand().collapsedText()||this.targetCommand().text():this.text()};t.prototype._computeAccessibleLabel=function(){var e,t=this.accessibleLabel(),n=this.sectionAccessibleLabel()||"",r=this.label(),i=t;e=i&&r&&i!==r&&this.prependTextToAccessibleLabel?r+". "+i:i||r||"";return n&&e?n+". "+e:e||n};t.prototype._computeInputType=function(){return this.action&&this.action.inputType&&this.action.inputType()||x.e.none};t.dependencies=Object(r.__assign)(Object(r.__assign)({},s.t.dependencies),{engagement:b.e,responsiveUI:C.t.optional});return t})(s.t);t.e=O},,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(224),i=n(1250);function s(e,t,n){void 0===n&&(n=!0);for(;e&&e!==document.body;){if(i.e.hasClass(e,t))return e;e=Object(r.e)(e,n)}return null}},function(e,t,n){"use strict";var r=n(0),i=n("knockout-lib"),s=n(2101),o=n(2046);function u(e){var t=document.createElement("div");t.tabIndex=0;t.className="ms-accessible";t.setAttribute("role","presentation");t.setAttribute("aria-hidden","true");t.setAttribute("data-focus-trap",e);return t}var a=s.focusNextTabStop,f=s.focusPreviousTabStop,l=i.virtualElements,c=i.applyBindingsToNode,h=i.applyBindingsToDescendants,p=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;var r=n,i=r.events,s=r.observables,o=r.bindingContext,a=r.element,f=t.valueAccessor()||{},p=f,d=p.isEnabled,v=p.invert,m=n._beforeHook=u("begin"),g=n._afterHook=u("end");n._invert=v;if(d){c(m,{visible:d},o);c(g,{visible:d},o)}var y=l.childNodes(a);l.prepend(a,m);l.insertAfter(a,g,y[y.length-1]);h(o,a);var b=f,w=b.before,E=void 0===w?s.create(g):w,S=b.after,x=void 0===S?s.create(m):S;n._before=s.wrap(E);n._after=s.wrap(x);i.on(m,"focus",n._onFocusBeforeHook);i.on(g,"focus",n._onFocusAfterHook);!v&&f.after&&n._initializeBeforeAndAfter();return n}t.prototype._onFocusBeforeHook=function(){this._invert?a(this._afterHook):f(this._before.peek())};t.prototype._onFocusAfterHook=function(){this._invert?f(this._beforeHook):a(this._after.peek())};t.prototype._onFocusBefore=function(){a(this._beforeHook)};t.prototype._onFocusAfter=function(){f(this._afterHook)};t.prototype._initializeBeforeAndAfter=function(){var e,t,n=this,r=this.events;this.observables.backgroundCompute(function(){var i=n._before(),s=n._after();if(i!==e){e&&r.off(e);i&&r.on(i,"focus",n._onFocusBefore);e=i}if(s!==t){t&&r.off(t);s&&r.on(s,"focus",n._onFocusAfter);t=s}})};t.supportsVirtualElements=!0;return t})(o.t);t.e=p},function(e,t,n){"use strict";var r;(function(e){e[e.multiple=0]="multiple";e[e.renameItems=1]="renameItems";e[e.deleteItems=2]="deleteItems";e[e.pointInTimeRestore=3]="pointInTimeRestore";e[e.restoreItems=4]="restoreItems";e[e.uploadItems=5]="uploadItems";e[e.moveItems=6]="moveItems";e[e.copyItems=7]="copyItems";e[e.rotateItems=8]="rotateItems";e[e.addItemsToAlbum=9]="addItemsToAlbum";e[e.addCoverPhotos=10]="addCoverPhotos";e[e.removeCoverPhotos=11]="removeCoverPhotos";e[e.createAlbumFromFolder=12]="createAlbumFromFolder";e[e.createColumn=13]="createColumn";e[e.editColumn=14]="editColumn";e[e.deleteColumn=15]="deleteColumn";e[e.checkInItem=16]="checkInItem";e[e.checkOutItem=17]="checkOutItem";e[e.undoCheckOutItem=18]="undoCheckOutItem";e[e.createFolder=19]="createFolder";e[e.updateBundle=20]="updateBundle";e[e.shareItem=21]="shareItem";e[e.reportAbuse=22]="reportAbuse";e[e.requestReview=23]="requestReview";e[e.setAlbumCoverPhoto=24]="setAlbumCoverPhoto";e[e.createAlbum=25]="createAlbum";e[e.uploadVideos=26]="uploadVideos";e[e.saveItem=27]="saveItem";e[e.createItem=28]="createItem";e[e.publishItem=29]="publishItem";e[e.unPublishItem=30]="unPublishItem";e[e.applyOfficeLens=31]="applyOfficeLens";e[e.removeOfficeLens=32]="removeOfficeLens";e[e.updateMetadata=33]="updateMetadata";e[e.makeHomepage=34]="makeHomepage";e[e.triggerFlow=35]="triggerFlow";e[e.downloadAsZip=36]="downloadAsZip";e[e.saveAutoAlbum=37]="saveAutoAlbum";e[e.discardAutoAlbum=38]="discardAutoAlbum";e[e.addToOneDrive=39]="addToOneDrive";e[e.removeFromSharedList=40]="removeFromSharedList";e[e.setupApprovalFlow=41]="setupApprovalFlow";e[e.setupReminderFlow=42]="setupReminderFlow";e[e.sharepointPointInTimeRestore=43]="sharepointPointInTimeRestore";e[e.sharingReport=44]="sharingReport";e[e.editViewColumns=45]="editViewColumns";e[e.runModelOnItems=46]="runModelOnItems";e[e.importModel=47]="importModel";e[e.downloadItem=48]="downloadItem";e[e.deleteSmartTemplate=49]="deleteSmartTemplate";e[e.publishSmartTemplate=50]="publishSmartTemplate";e[e.unpublishSmartTemplate=51]="unpublishSmartTemplate"})(r||(r={}));t.e=r},function(e,t,n){"use strict";var r=n(0),i=n(2046),s=n(3338),o=n("knockout-lib"),u=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;new(n.managed(s.e))({element:n.element,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return n._onReceiveComponentParentContext.bind(n)}});var r=n._componentParentContent,i=n.valueAccessor(),u=(function(e){return"object"==typeof e})(i)?i:{},a=u.data,f=void 0===a?n.bindingContext.$data:a,l=u.afterRender;o.applyBindingsToNode(n.element,{template:{nodes:r.templateNodes,afterRender:l}},r.bindingContext.extend({$host:f,$hostContext:n.bindingContext}));n.controlsDescendantBindings=!0;return n}t.prototype._onReceiveComponentParentContext=function(e){this._componentParentContent=e};t.supportsVirtualElements=!0;return t})(i.t);t.e=u},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return x});var r=n(0),i=n(2046),s=n(91),o=n(334),u=n(809),a=n(318),f=n("react-lib"),l=n("react-dom-lib"),c=n(72),h=n("knockout-lib"),p=n(298),d=n(2174),v=n(59),m=n(3014),g=n(87),y=n(754),b=n(511),w=n(2595),E=n(3334),S=new((function(){function e(){this._promises={}}e.prototype.load=function(e){var t=e.path,n=e.getModule,r=window.require.toUrl("".concat(t,"_unmapped")),i=this._promises,a=i[r];a||(a=i[r]=s.n.as(Object(u.e)({path:t,getModule:n}))).done(void 0,function(e){delete i[r]});var f=new o.e;a.done(function(e){return f.complete(e)},function(e){return f.error(e)});return f.getPromise()};e.prototype._loadSync=function(e,t){var n;if(t.defined&&t.defined(e)){var r=t(e);if(r)if("object"==typeof r){if(Object.keys(r).length>0){var i=Object(a.e)(r);i&&(n=i)}}else n=r}return n};return e})());function x(e){var t=e.applyBindings,n=e.bindingContext,i=e.children,s=Object(r.__rest)(e,["applyBindings","bindingContext","children"]),o=f.useRef(null),u=Object(E.e)(),a=u[0],l=u[1],c=Object(w.t)({children:i}),p=f.useCallback(function(e){return f.createElement(f.Fragment,null,e.children)},[]);f.useEffect(function(){if(o.current&&t){if(i){var e=document.createElement("div");e.setAttribute("data-bind","react: Children");o.current.appendChild(e)}var s=n||(function(){var e=document.createElement("div");h.applyBindings({},e);var t=h.contextFor(e);h.removeNode(e);return t})(),u=t(o.current,s.extend(Object(r.__assign)({$react:a},i?{$data:{bindingHandlers:{react:T},Children:{componentType:p,props:c}}}:{})));return function(){u&&u.dispose();o.current&&h.cleanNode(o.current)}}},[]);var d=Object(b.e)(function(){return f.createElement("div",Object(r.__assign)({key:"root",ref:o,role:"presentation","data-is-ko-react-root":"true"},s))},s);return f.createElement(f.Fragment,null,d,l)}var T=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;var r,i=n.observables;n._value=i.pureCompute(function(){return i.unwrap(n.valueAccessor())});if(n._value.peek().useDOMContext){var o=Object(y.e)(n.element,function(e){return"true"===e.getAttribute("data-is-ko-react-root")});o&&(r=h.contextFor(o))}else r=n.bindingContext;n._context=r&&r.$react;n._transcludedTemplateNodes=Array.prototype.slice.call(h.virtualElements.childNodes(n.element));h.virtualElements.emptyNode(n.element);n._renderDependencies=n.createObservable();n._componentProps=i.pureCompute(function(){return i.unwrap(n._value().props)});n._componentProps.equalityComparer=p.t;n._rootProps=i.pureCompute(function(){return i.unwrap(n._value().rootProps)});n._rootProps.equalityComparer=p.t;var u=n.scope.attach(new d.e);n.createComputed(function(){var e,t=n._value();if((function(e){return!!e.componentType})(t)){var r=n.observables.unwrap(t.componentType);n._componentNameForLogging=r.displayName||"";c.n.mark("EUPL.ReactBinding.LoadStart.".concat(n._componentNameForLogging));e=s.n.wrap(r)}else{t.getModule||console.error("ReactBinding instantiated with componentPath ".concat(t.componentPath," but missing getModule"));n._componentNameForLogging=t.componentPath;c.n.mark("EUPL.ReactBinding.LoadStart.".concat(n._componentNameForLogging));e=S.load({path:t.componentPath,getModule:t.getModule})}n.trackPromise(u.debounce(s.n.all({componentType:e}).then(function(e){c.n.mark("EUPL.ReactBinding.Loaded.".concat(n._componentNameForLogging));var t=n._context;n.addDisposable({dispose:t?function(){t.unmount(n.element)}:function(){l.unmountComponentAtNode(n.element)}});n._renderDependencies(e)})))});n.createComputed(n._computeRenderComponent);return n}t.prototype._computeRenderComponent=function(){var e=this,t=this._renderDependencies();if(t){var n=t.componentType,i=this._componentProps(),s=this._rootProps(),o=this._transcludedTemplateNodes;c.n.mark("EUPL.ReactBinding.AsyncRender.".concat(this._componentNameForLogging));try{this.observables.ignore(function(){var t=o.length>0?function(e,t){h.applyBindingsToNode(e,{template:{nodes:o}},t)}:void 0,u=f.createElement(v.e,{resources:e.resources},f.createElement(m.e,{onError:function(t){var n=e._value.peek().error;n&&n(t)},componentName:e._componentNameForLogging},f.createElement(n,Object(r.__assign)({},Object(r.__assign)(Object(r.__assign)({},i),t?{children:f.createElement(x,Object(r.__assign)({bindingContext:e.bindingContext,applyBindings:t},s||{}))}:{})))));e._context?e._context.render(u,e.element):l.render(u,e.element)})}catch(e){g.e.logError(e)}}};return t})(i.t);t.t=T},,function(e,t,n){"use strict";var r=n(0),i=n("knockout-lib"),s=n(2046),o=n(2187),u=n(2215),a=n(2074),f=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r._focusTracker=r.resources.consume(u.e);r._hasFocus=r.createObservable(!1);r._hasChildFocus=r.createObservable(!1);r._isBodyActive=r.createObservable(!1);r._value=r.createPureComputed(r._computeValue);r._isEnabled=r.createPureComputed(r._computeIsEnabled);r._onlyRecoverFromBody=r.createPureComputed(r._computeOnlyRecoverFromBody);r._shouldRecoverFocus=r.createPureComputed(r._computeShouldRecoverFocus);var s=n.ChildFocusBinding,f=void 0===s?o.e:s,l=n.applyBindingsToNode,c=void 0===l?i.applyBindingsToNode:l,h=n.recoverFocusExtenders,p=void 0===h?{rateLimit:{timeout:300,method:"notifyWhenChangesStop"}}:h;new(r.managed(f))({element:r.element,bindingContext:r.bindingContext,allBindingsAccessor:r.allBindingsAccessor,valueAccessor:function(){return{isDescendantOrSelfActive:r._hasChildFocus,isBodyActive:r._isBodyActive}}});c(r.element,{hasFocus:r._hasFocus},r.bindingContext);r._scrollContainer=Object(a.t)(r.element);r.createBackgroundComputed(r._computeRecoverFocus).extend(p);return r}t.prototype._computeValue=function(){return this.valueAccessor()||{}};t.prototype._computeIsEnabled=function(){var e=this._value().isEnabled,t=void 0===e||e;return this.unwrapObservable(t)};t.prototype._computeOnlyRecoverFromBody=function(){var e=this._value().onlyRecoverFromBody,t=void 0!==e&&e;return this.unwrapObservable(t)};t.prototype._computeShouldRecoverFocus=function(){return this._isEnabled()&&!this._hasChildFocus()&&(!this._onlyRecoverFromBody()||this._isBodyActive())&&this._focusTracker.isWindowActive.peek()};t.prototype._computeRecoverFocus=function(){this._shouldRecoverFocus()&&this._recoverFocus()};t.prototype._recoverFocus=function(){var e=this._scrollContainer,t=e.scrollTop,n=e.scrollLeft;this._hasFocus(!0);e.scrollTop!==t&&(e.scrollTop=t);e.scrollLeft!==n&&(e.scrollLeft=n)};return t})(s.t);t.e=f},,function(e,t,n){"use strict";var r;(function(e){e[e.created=0]="created";e[e.started=1]="started";e[e.completed=2]="completed";e[e.failed=3]="failed";e[e.canceled=4]="canceled";e[e.expired=5]="expired"})(r||(r={}));t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(2044),s=n(2090),o=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this,o=Object(r.__assign)(Object(r.__assign)({},t.props||{}),{hostViewModel:i});i.addBindingHandlers({react:s.t});i.reactBindingParams=Object(r.__assign)({props:o,error:t.error},(function(e){return"string"==typeof e.component})(t)?{componentPath:t.component,getModule:t.getComponentModule}:{componentType:t.component});return i}return t})(i.t);function u(e,t,n,i){return{tagName:e,template:'<div data-bind="react:reactBindingParams"></div>',viewModel:{createViewModel:function(e,s){return new(e.resources.injected(o))(Object(r.__assign)(Object(r.__assign)({},"string"==typeof t?{component:t,getComponentModule:n}:{component:t}),{error:e.reactRenderError,props:Object(r.__assign)(Object(r.__assign)({},i||{}),e)}),s)}},synchronous:!0}}},function(e,t,n){"use strict";n.d(t,"t",function(){return b});var r=n(0),i=n(2319),s=n(183),o=n(598),u=n(7),a=n(119),f=n(595),l=n(898),c=n(243),h=n(3214),p=n(1256),d=n(33),v=Object(d.isFeatureEnabled)(d.ReadOnlyItemsStore);function m(e){return e&&e.item&&e.item.peek().key}function g(e){e.isExpired=!0;var t=e.content,n=t.peek();n.groupings=null;n.items=[];t.valueHasMutated()}var y=(function(e){Object(r.__extends)(t,e);function t(){var t=e.call(this,"ItemsStore")||this;t._itemSetsKeys={};t._observables=new o.e({owner:t});t._vaultItemsToPurge=[];window.odstore=t;return t}t.prototype.dispose=function(){this._observables.dispose()};t.prototype.setItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this._handleSetItem.apply(this,Object(r.__spreadArray)([e],t,!1))};t.prototype.getItem=function(e){return this.getValue("item="+e)};t.prototype.setItemSet=function(e,t){var n="result="+e;this.setValue(n,t);this._itemSetsKeys[n]=1};t.prototype.getItemSetFromItemKey=function(e){var t;for(var n in this._itemSetsKeys){var r=(t=this.getValue(n)).content&&t.content.peek(),i=r&&r.items;if(i)for(var s=0,o=i;s<o.length;s++){var u=o[s];if(u&&u.peek().parentKey===e)return t}}};t.prototype.getItemSet=function(e){return this.getValue("result="+e)};t.prototype.getAllItemSetKeys=function(){var e=[];for(var t in this._itemSetsKeys)e.push(t.slice("result=".length));return e};t.prototype.setNextRequestToken=function(e,t,n){var r="token="+t;n?this.setValue(r,n):this.remove(r)};t.prototype.getNextRequestToken=function(e){return this.getValue("token="+e)};t.prototype.invalidateItem=function(e,t){var n=(void 0===t?{}:t).purgeCache,r=void 0!==n&&n;return this._handleItemInvalidation(e,this.getItem(e),r)};t.prototype.invalidateItemSet=function(e){var t=this.getValue("result="+e);t&&g(t)};t.prototype.emptyAllOtherSets=function(e){var t;for(var n in this._itemSetsKeys)(t=this.getValue(n)).item&&(0===e.length||e.indexOf(t.item.peek().key)<0)&&g(t)};t.prototype.invalidateLocation=function(e){var t;for(var n in this._itemSetsKeys){var r=m(t=this.getValue(n));if(r){var i=f.e(r),s=i&&i.locationFilter;s&&s.indexOf(e)>=0&&(t.isExpired=!0)}}};t.prototype.invalidateTag=function(e){var t;for(var n in this._itemSetsKeys){var r=m(t=this.getValue(n));if(r){var i=f.e(r);i&&i.tagFilter===e&&(t.isExpired=!0)}}};t.prototype.invalidateAllPhotos=function(){var e;for(var t in this._itemSetsKeys){var n=(e=this.getValue(t)).item&&e.item.peek();if(n&&n.key&&n.key.indexOf("allmyphotos")>=0){e.isExpired=!0;this._invalidateItem(n)}}};t.prototype.invalidateAllVault=function(){for(var e=0,t=Object(r.__spreadArray)([],this._vaultItemsToPurge,!0);e<t.length;e++){var n=t[e],s=void 0;if(n.vault&&n.vault.root){(s=new i.e(n.key)).name=n.name;s.displayName=n.displayName;s.dateModified=" ";s.folder={};s.vault={isLocked:!0,root:{}}}this._purgeItem(n,s)}this._vaultItemsToPurge=[]};t.prototype._handleItemInvalidation=function(e,t,n){var r=this;if(t){var i=t.peek(),s=!1,o=[];if(i){o.push(i);switch(i.type){case c.e.Folder:case c.e.Media:s=!0}}for(var u in this._itemSetsKeys){var a=this.getValue(u),f=a.item&&a.item.peek(),l=f&&f.key;if(l&&(l===e||s&&l.indexOf("allmyphotos")>-1)){l===e?this.setNextRequestToken(e,a.key,""):o.push(f);a.isExpired=!0}}o.forEach(n?function(e){return r._purgeItem(e)}:function(e){return r._invalidateItem(e)})}};t.prototype._purgeItem=function(e,t){var n=t||new i.e(e.key);this.setItem(n)};t.prototype._invalidateItem=function(e){var t=new i.e(e.key);Object(p.default)(t,e);Object(p.default)(t,{revision:e.revision+1});this.setItem(t)};t.prototype._handleSetItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=[];v&&!Object.isFrozen(e)&&Object.freeze(e);e.vault&&this._vaultItemsToPurge.push(e);for(var s=function(t){var n="".concat("item=").concat(t),r=v?"".concat("item_write=").concat(t):n,s=o.getValue(n),u=o.getValue(r);if(u)u(e);else{(u=o._observables.create(e)).equalityComparer=l.n;o.setValue(r,u);s=v?o._observables.pureCompute(function(){return u()}):u;o.setValue(n,s)}i.push(s)},o=this,u=0,a=Object(h.e)(Object(r.__spreadArray)([e.key],t,!0));u<a.length;u++){var f=a[u];s(f)}return i[0]};return t})(s.e),b=new u.t({name:"ItemsStore",factory:new a.i(y)});t.e=y},,,function(e,t,n){"use strict";var r=n(2575),i=n(2045),s=n(0),o=n(2044),u=n(2501),a=n(2062),f=n(2085),l=n(1121),c=n("knockout-lib"),h=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,{})||this,r=t.topTab,i=t.bottomTab,s=t.animation,o=void 0===s?{}:s,u=t.alignToParent,a=void 0===u?c.observable(!0):u,f=t.parentElement,l=t.isOpen;n.topTab=r;n.bottomTab=i;n.animation=o;n.alignToParent=a;n.parentElement=f;n.isOpen=l;return n}return t})(l.default),p=(function(e){Object(s.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var i=e.call(this,t,n)||this;i.transclusionContentTagName=r.e.tagName;var s=n.overlayProvider,o=void 0===s?i.resources.consume(u.e):s,l=t.animation,c=t.alignToParent,p=void 0!==c&&c,d=t.parentElement,v=t.virtualParentElement;i.addBindingHandlers({host:f.e,element:a.e});i.overlayProvider=o;i.topTab=i.createObservable(null);i.bottomTab=i.createObservable(null);i.isOpen=i.createObservable(!1);i.virtualParentElement=v;i.overlay=new h({alignToParent:i.wrapObservable(p),parentElement:d,animation:l,topTab:i.topTab,bottomTab:i.bottomTab,isOpen:i.isOpen});return i}return t})(o.t),d=i.e({tagName:"od-overlay",template:'<a href="javascript:;" class="ms-accessible" role="presentation" data-bind="element:topTab"></a><div class="od-Overlay ms-accessible" role="presentation" data-bind="component:{name:transclusionContentTagName,params:{provider:overlayProvider,parentElement:virtualParentElement||$element.parentElement,options:overlay}}">\x3c!--ko host:{}--\x3e\x3c!--/ko--\x3e</div><a href="javascript:;" class="ms-accessible" role="presentation" data-bind="element:bottomTab"></a>',viewModel:p,synchronous:!0});t.e=d},function(e,t,n){"use strict";var r=n(0),i=n("knockout-lib"),s=n(2046),o=n(91),u=n(2095),a=Object(u.e)("ms-react-tooltip","./TooltipContainer",function(){return o.n.resolve(n.ee([411],5117))},{calloutProps:{gapSpace:0},styles:{content:{fontSize:"0.75rem"}}});i.components.isRegistered(a.tagName)||i.components.register(a.tagName,a);var f,l=a,c=n(127),h=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.valueAccessor();n.createComputed(function(){n.unwrapObservable(r.isTooltipDisabled);n._removeTooltip()});n.events.onAll(n.element,{mouseenter:n._insertTooltip,mouseleave:n._removeTooltip,focusin:n._insertTooltip,focusout:n._removeTooltip,click:n._removeTooltip,keydown:n._onKeyDown});n.addDisposable({dispose:function(){n._removeTooltip()}});return n}t.prototype._insertTooltip=function(e){var t=this;if(!(e&&e.relatedTarget&&this.element.contains(e.relatedTarget))){this._removeTooltip();var n=this.valueAccessor();if(n&&n.content&&!this.peekUnwrapObservable(n.isTooltipDisabled)&&this.peekUnwrapObservable(n.content)){var r=f=this._createTooltip(n);i.tasks.schedule(function(){f===r&&t.element.appendChild(f)})}}};t.prototype._createTooltip=function(e){var t=document.createElement("span"),n={content:this.peekUnwrapObservable(e.content),targetElement:this.element},r={component:{name:l.tagName,params:n}};i.applyBindingsToNode(t,r);return t};t.prototype._removeTooltip=function(e){if(!(e&&e.relatedTarget&&this.element.contains(e.relatedTarget))&&f){i.removeNode(f);f=null}};t.prototype._onKeyDown=function(e){if(e&&("Escape"===e.code||e.keyCode===c.e.escape)){this._removeTooltip(e);e.stopPropagation()}};return t})(s.t);t.e=h},function(e,t,n){"use strict";n.r(t);n.d(t,"focusFirstTabStop",function(){return i});n.d(t,"focusLastTabStop",function(){return s});n.d(t,"focusNextTabStop",function(){return o});n.d(t,"focusPreviousTabStop",function(){return u});n.d(t,"getFirstTabStop",function(){return a});n.d(t,"getLastTabStop",function(){return f});n.d(t,"getNextTabStop",function(){return l});n.d(t,"getPreviousTabStop",function(){return c});n.d(t,"isTabStop",function(){return h});var r=n(224);function i(e,t){p(e,a,t)}function s(e,t){p(e,f,t)}function o(e,t){p(e,l,t)}function u(e,t){p(e,c,t)}function a(e,t){return e&&g(e,t)}function f(e,t){return e&&y(e,t)}function l(e,t){return e&&(m(e.firstElementChild,d,g,t)||b(e,d,g,t))}function c(e,t){return e&&b(e,v,y,t)}function h(e,t){return!(!e||!E(e,t))}function p(e,t,n){var r=t(e,n);r&&r.focus()}function d(e){return e.nextElementSibling}function v(e){return e.previousElementSibling}function m(e,t,n,r){for(;e;e=t(e)){var i=n(e);if(i)return i}}function g(e,t){return E(e,t)||m(e.firstElementChild,d,g)}function y(e,t){return m(e.lastElementChild,v,y)||E(e,t)}function b(e,t,n,i){for(;e;e=Object(r.e)(e)){var s=m(t(e),t,n);if(s)return s}}var w={a:1,input:1,area:1,button:1,select:1,textarea:1,object:1};function E(e,t){var n=e.tagName.toLowerCase();if((n in w||void 0!==e.attributes.tabindex)&&(-1!==e.tabIndex||t)&&"true"!==e.getAttribute("aria-hidden")&&"none"!==e.style.display.toLowerCase()&&"hidden"!==e.style.visibility.toLowerCase()&&!(0===e.offsetWidth&&0===e.offsetHeight||e.disabled||"input"===n&&"hidden"===e.type.toLowerCase()))return e}},,,function(e,t,n){"use strict";var r=n(0),i=n(2101),s=n(2046),o=n(224),u=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.valueAccessor(),i=n.wrapObservable(void 0===r||r);n._shouldRestoreFocus=i;var s=null;try{s=document.activeElement}catch(e){}n._activeElement=s;n._preserveActiveElementAncestors=[];for(;s&&s!==document.body;){n._preserveActiveElementAncestors.push(s);s=Object(o.e)(s)}return n}t.prototype.dispose=function(){if(this._shouldRestoreFocus.peek()){var t=null;try{t=document.activeElement}catch(e){}if(!t||t===document.body||this._isAncestorOrSelf(t,this.element))for(var n=0,r=this._preserveActiveElementAncestors;n<r.length;n++){var s=r[n];if(s&&s.focus&&(Object(i.isTabStop)(s,!0)||s===this._activeElement)&&document.body.contains(s)){s.focus();break}}}this._preserveActiveElementAncestors=[];delete this._activeElement;e.prototype.dispose.call(this)};t.prototype._isAncestorOrSelf=function(e,t){for(;e;){if(e===t)return!0;e=Object(o.e)(e)}return!1};return t})(s.t);t.e=u},,function(e,t,n){"use strict";var r=n(0),i=n(423),s=n(265),o=n(1118),u=n(1121),a=n(1250),f=n(2058),l=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._responsiveUI=n.resources.consume(f.t);return n}t.calculateParentRect=function(e,t){var n=e,r=[];do{if("none"===n.style.display){r.push(n);n.style.display=""}else n=n.parentElement;t=a.e.calculateRect(e)}while(0===t.x&&n!==document.body);r.forEach(function(e){e.style.display="none"});return t};t.prototype.assignAlignment=function(e){var t=e.alignment;return t?"string"==typeof t?this.createObservable(i.e[t]):this.wrapObservable(t):this.createObservable(i.e.Left|i.e.Top)};t.prototype.computePositioningStyles=function(e){var t=this,n=e.renderedTemplate,r=e.clientRect,i=e.style,u=e.contentStyle,a=e.trigger,f=e.hasExplicitAlignment,l=e.alignment,c=e.allowMenuNudging,h=e.left,p=e.top,d=e.beak,v=e.isScrollable,m=e.userOffset;this.createComputed(function(){var e=new s.e(h(),p()),g=new o.e(0,0,t._responsiveUI.windowWidth(),t._responsiveUI.windowHeight()),y="",b="";g=g.inflate(-4,-4);if(n()&&r()){var w=-parseFloat(""+Number(!!i().marginLeft)),E=-parseFloat(""+Number(!!i().marginRight)),S=r().translate(w,E);a();e=e.add(m());var x=l();f||(x=t._determineBestFitAlignment(S,x));e=t._transformMenuCoordinate(e,S,x);var T=void 0;if(0===Object.keys(i()).length){i({left:Math.floor(e.x)+"px",top:Math.floor(e.y)+"px"});T=new o.e(S.x+e.x,S.y+e.y,S.width,S.height)}else T=new o.e(S.x+parseInt(i().left,10),S.y+parseInt(i().top,10),S.width,S.height);var N=g.contains(new s.e(T.x,T.y)),C=g.contains(new s.e(T.x+T.width,T.y));if(!N||!C){var k=c?T.nudge(g):T;if(!g.contains(k)){y=(k=k.clip(g)).width+"px";b=k.height+"px";v(!0)}e=e.add(new s.e(k.x-T.x,k.y-T.y));i({left:Math.floor(e.x)+"px",top:Math.floor(e.y)+"px"})}v(!1);t.async.setTimeout(function(){d({})},200)}u({width:y,height:b})}).extend({deferred:!0})};t.prototype._determineBestFitAlignment=function(e,t){var n=t,r=e.getPoint();if(e.width<=document.body.clientWidth&&e.height<=document.body.clientHeight){var s=this._transformMenuCoordinate(r,e,n);(s.x<0||s.x+e.width>document.body.clientWidth)&&(n^=i.e.Right);(s.y<0||s.y+e.height>document.body.clientHeight)&&(n^=i.e.Bottom)}return n};t.prototype._transformMenuCoordinate=function(e,t,n){var r=new s.e(e.x,e.y);if(n){(n&i.e.Right)===i.e.Right?r.x-=t.width:(n&i.e.Center)===i.e.Center&&(r.x-=t.width/2);(n&i.e.Bottom)===i.e.Bottom?r.y-=t.height:(n&i.e.VerticalCenter)===i.e.VerticalCenter&&(r.y-=t.height/2)}return r};return t})(u.default);t.e=l},function(e,t,n){"use strict";var r=n(0),i=n(2052),s=n(2059),o=n(2060),u=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=t.item,u=n.getItemSelectionHelperType,a=void 0===u?r.resources.consume(o.e.lazy):u,f=n.itemParentHelper,l=void 0===f?r.resources.consume(s.e):f;r.isItemSpecified=!!i;r.item=i||new(r.scope.attached(a()))({canFallback:!0,ignoreSelection:!0}).currentItem;r.itemParentHelper=l;return r}t.prototype.onIsAvailable=function(){return!!this.item()};t.prototype.getParent=function(e,t,n){var r=this.itemParentHelper.getFacetedAncestorOrSelf(e,t);return n?this.peekUnwrapObservable(r):this.unwrapObservable(r)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.e.dependencies),{getItemSelectionHelperType:o.e.lazy,itemParentHelper:s.e});return t})(i.e);t.e=u},function(e,t,n){"use strict";n.r(t);n.d(t,"OperationProvider",function(){return p});n.d(t,"resourceKey",function(){return d});var r=n(0),i=n(1121),s=n(2094),o=n(2236),u=n(2084),a=n(3212),f=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{})||this,i=n.observables;n.name=t.name;n.iconName=t.iconName;n.state=i.create(s.e.created);n.warning=i.create("");n.error=i.create();n.count=i.create(1);var a=Object(r.__assign)({minimum:0,maximum:0,current:0},t.progress||{});n.progress={minimum:i.create(a.minimum),maximum:i.create(a.maximum),current:i.create(a.current)};n.type=i.create(t.type||u.e.multiple);n.batch=t.batch||new o.e;n._initializeActions(t.actions);n.payloads=i.create(t.payloads||{});n.visibility=i.create(t.visibility||0);return n}t.prototype.dispose=function(){this.actions({});this.payloads({});e.prototype.dispose.call(this)};t.prototype._initializeActions=function(e){void 0===e&&(e={});var t={};for(var n in e){var r=e[n];t[n]=this.scope.attach(new a.e({key:n,operation:this,isAvailable:r.isAvailable,onExecute:r.execute}))}this.actions=this.observables.create(t)};return t})(i.default),l=n(3647),c=n(3213),h=n(119),p=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this,i=r.observables,s=new o.e;r._observers=i.createArray();var u=r.operations=i.createArray(),a=r.scope.attached(l.e),f=r.groups=r.addDisposable(c.e.group(u,function(e){return e.batch}).map({mappingWithDisposeCallback:function(e){var t=new a({batch:e.key,operations:e.values});return{mappedValue:t,dispose:function(){t.dispose()}}}}));r.overall=new(r.managed(l.e))({batch:s,operations:f});r.isLocked=r.createPureComputed(r._computeIsLocked);r.createBackgroundComputed(r._computeRemoveAllWhenUnlocked).extend({deferred:!0});return r}t.prototype.lock=function(){var e=this,t={};this._observers.push(t);return{dispose:function(){e._observers.remove(t)}}};t.prototype.register=function(e){var t=new f(e);2!==t.visibility.peek()&&this.operations.push(t);return t};t.prototype.deleteGroupOperation=function(e){var t=Object(r.__spreadArray)([],e.operations.peek(),!0);this.operations.removeAll(t);t.forEach(function(e){e.dispose()})};t.prototype.cleanup=function(e){void 0===e&&(e=!1);for(var t=[],n=0,r=this.groups.peek();n<r.length;n++){var i=r[n],o=i.state.peek();if(o===s.e.completed||!e&&(o===s.e.expired||o===s.e.canceled||o===s.e.failed))for(var u=i.operations.peek(),a=void 0,f=0;f<u.length;f++){a=!0;var l=u[f];if(o===s.e.failed&&l.actions)for(var c=l.actions.peek(),h=Object.keys(c),p=0;p<h.length;p++)if("cancel"!==h[p]&&c[h[p]].isAvailable.peek()){a=!1;break}a&&t.push(u[f])}}this.operations.removeAll(t);t.forEach(function(e){e.dispose()})};t.prototype._computeRemoveAllWhenUnlocked=function(){this.isLocked()||this.cleanup()};t.prototype._computeIsLocked=function(){return this._observers().length>0};return t})(i.default),d=Object(h.s)("OperationProvider",p);t.default=p},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(1121),s=n(119),o=n(91),u=n("knockout-lib"),a=(function(){function e(e){var t=this,n=e.noTitle,r=void 0!==n&&n,i=e.title,s=void 0===i?u.observable(""):i,a=e.elementDescribedBy,f=void 0===a?"":a,l=e.hasCommandBar,c=void 0!==l&&l,h=e.size,p=void 0===h?"Small":h,d=e.scrollMode,v=void 0===d?"auto":d,m=e.showCloseButton,g=void 0===m||m,y=e.includePadding,b=void 0===y||y,w=e.preserveLightDismiss,E=void 0!==w&&w,S=e.stickyCloseButton,x=void 0!==S&&S,T=e.component,N=void 0===T?null:T,C=e.maximizePanelContent,k=void 0!==C&&C,L=e.panelContentSize,A=void 0===L?u.observable({width:0,height:0}):L,O=e.isBlocking,M=e.disableEscape,_=void 0!==M&&M,D=e.overridePanelStyle;this.size=p;this.title=u.isObservable(s)?s:u.observable(s);this.elementDescribedBy=f;this.maximizePanelContent=k;this.panelContentSize=A;this.noTitle=r;this.hasCommandBar=c;this.component=N;this.scrollMode=v;this.showCloseButton=g;this.includePadding=b;this.preserveLightDismiss=E;this.stickyCloseButton=x;this.isBlocking=O;this.disableEscape=_;this.overridePanelStyle=D;this.state=u.observable(0);this._promise=new o.n(function(e){var n=u.computed(function(){if(1===t.state()){e(!0);n.dispose()}},t)})}e.prototype.wait=function(){return this._promise};return e})(),f=n(2200),l=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.currentPanels=r.observables.createArray();r._needsOverlayContent=n.needsOverlayContent;return r}t.prototype.requestPanel=function(e){this._needsOverlayContent.needsOverlayContent.set(!0);var t=new a(e),n=this.currentPanels;n.push(t);var r=function(){return n.remove(t)};t.wait().then(r,r);return t};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.default.dependencies),{needsOverlayContent:f.e});return t})(i.default),c=Object(s.s)("PanelProvider",l)},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(2046),s=n(2187),o=n("knockout-lib"),u=n(224),a="InteractionScopeBinding_scope",f=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t)||this;r._parentScope=(function(e){var t,n=e;for(;!(t=o.utils.domData.get(n,a))&&n!==document.body&&Object(u.e)(n);)n=Object(u.e)(n);return n!==document.body&&t||void 0})(r.element);var i=r.valueAccessor(),f=i.isScope,l=void 0!==f&&f,c=i.isRoot,h=void 0!==c&&c;if(l){r._childScopes=o.observableArray();r._hasFocus=o.observable(!1);r._isRoot=h;r._isActive=r.createPureComputed(r._computeIsActive,{deferEvaluation:!0});r._isDescendantActive=r.createPureComputed(r._computeIsDescendantActive,{deferEvaluation:!0});r._scope={isActive:r._isActive,isDescendantActive:r._isDescendantActive,isDescendantOrSelfActive:r.createComputed(r._computeIsDescendantOrSelfActive),register:function(e){return r._registerScope(e)},_owner:r};o.utils.domData.set(r.element,a,r._scope);var p=n.ChildFocusBinding,d=void 0===p?s.e:p;new(r.managed(d))({element:r.element,bindingContext:r.bindingContext,allBindingsAccessor:r.allBindingsAccessor,valueAccessor:function(){return r._hasFocus}});r._parentScope&&r.addDisposable(r._parentScope.register(r._scope))}else if(r._parentScope){r._isActive=r._parentScope.isActive;r._isDescendantActive=r._parentScope.isDescendantActive}else{r._isActive=o.observable(!0);r._isDescendantActive=o.observable(!1)}i.isActive&&r.createComputed(function(){return i.isActive(r._isActive())});i.isDescendantActive&&r.createComputed(function(){return i.isDescendantActive(r._isDescendantActive())});return r}t.prototype._registerScope=function(e){var t=this;this._childScopes.push(e);return{dispose:function(){t._childScopes.remove(e)}}};t.prototype._computeIsDescendantOrSelfActive=function(){var e=this._hasFocus(),t=this._isDescendantActive();return e||t};t.prototype._computeIsActive=function(){var e=this._hasFocus(),t=this._isDescendantActive();return(this._isRoot||e)&&!t};t.prototype._computeIsDescendantActive=function(){for(var e=!1,t=0,n=this._childScopes();t<n.length;t++){n[t].isDescendantOrSelfActive()&&(e=!0)}return e};return t})(i.t);t.t=f},,function(e,t,n){"use strict";var r=n(170);Object(r.n)([{rawString:".Beak-container{position:absolute;width:100%;height:100%}.Beak-container .Beak-arrow.Beak--themePrimary{background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.Beak-container .Beak-arrow.Beak--white{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.Beak-container .Beak-arrow.Beak--neutralLighterAlt{background:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.Beak-container .Beak-arrow.Beak--themeTertiary{background:"},{theme:"themeTertiary",defaultValue:"#71afe5"},{rawString:"}.Beak-arrow{box-shadow:0 0 5px 0 "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";width:16px;position:relative;transform:rotate(45deg);height:16px;transition:left 1s ease-in-out,right 1s ease-in-out}.Beak-arrow--centered{transform:translateX(-50%) rotate(45deg)!important}html[dir=ltr] .Beak-arrow--centered{left:50%}html[dir=rtl] .Beak-arrow--centered{right:50%}html[dir=rtl] .Beak-arrow--centered{transform:translateX(50%) rotate(45deg)!important}"}]);var i=n("knockout-lib"),s=n(1250),o=n(2082),u=n(371),a=n(340),f=n(2106),l=n(779),c=(function(){function e(){}e.init=function(t,n){var r,l=i.utils.unwrapObservable(n())||{},c=i.utils.unwrapObservable(l.anchorElement),h=l.isVisible,p=void 0===h?i.observable(!0):h,d=l.beakColorVariation,v=l.isBeakCenterAligned,m=void 0===v?i.observable(!1):v,g=l.beakSize,y=void 0===g?e.size:g;(c||(c=Object(o.e)(t,"beak-anchor")))&&i.computed(function(){i.utils.unwrapObservable(l.trigger);r&&i.removeNode(r);(r=document.createElement("div")).className="Beak-container";var n=document.createElement("div");n.className="Beak-arrow";var o=s.e.calculateRect(t),h=s.e.calculateRect(c);0===h.x&&(h=f.e.calculateParentRect(c,h));var v,g,b=y/2,w=e.determineBeakDirection(o,h),E=0;if(0===w||1===w){E=h.getCenter().y-o.getTop();E=e.clamp(E,2*y,o.height-2*y)}else{E=u.e.isRightToLeft?o.getRight()-h.getCenter().x:h.getCenter().x-o.getLeft();o.width>2&&(E=e.clamp(E,2*y,o.width-2*y))}switch(w){case 0:g=-b;v=E-y;break;case 1:g=o.width-y-b;v=E-y;break;case 2:g=E-y;v=-b;break;case 3:g=E-y;v=o.height-y-b}i.utils.unwrapObservable(m)?n.className+=" Beak-arrow--centered":u.e.isRightToLeft?n.style.right=g+"px":n.style.left=g+"px";n.style.top=v+"px";switch(d){case a.e.themePrimary:n.className+=" Beak--themePrimary";break;case a.e.neutralLighterAlt:n.className+=" Beak--neutralLighterAlt";break;case a.e.themeTertiary:n.className+=" Beak--themeTertiary";break;default:n.className+=" Beak--white"}r.appendChild(n);t.insertBefore(r,t.firstChild);r.style.display=p()?"":"none"},null,{disposeWhenNodeIsRemoved:t})};e.clamp=function(e,t,n){return Math.max(Math.min(e,n),t)};e.determineBeakDirection=function(e,t){var n=e.getCenter(),r=t.getCenter();return r.y>=e.getTop()&&r.y<e.getBottom()?r.x<n.x?0:1:r.y<n.y?2:3};e.after=["component"];e.size=l.e;return e})();t.e=c},function(e,t,n){"use strict";var r=n(0),i=n("knockout-lib"),s=n(1250),o=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.valueAccessor();if(r){n._measureCallback=r.measure||r;n._parentRelative=r.parentRelative}n.createComputed(function(){if(n._measureCallback){i.utils.unwrapObservable(r.trigger);r.async?n.async.setImmediate(function(){n._updateMeasurement()}):n._updateMeasurement()}});return n}t.prototype._updateMeasurement=function(){var e=s.e.calculateRect(this.element);if(this._parentRelative&&this.element.parentElement){var t=s.e.calculateRect(this.element.parentElement);e=e.translate(t.getPoint().negate())}this._measureCallback(e)};return t})(n(2046).t);t.e=o},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r,i;(function(e){e[e.queued=0]="queued";e[e.started=1]="started";e[e.completed=2]="completed";e[e.aborted=3]="aborted";e[e.failed=4]="failed";e[e.none=5]="none"})(r||(r={}));(function(e){e[e.none=0]="none";e[e.other=1]="other";e[e.general=2]="general";e[e.conflict=3]="conflict";e[e.similarNameExists=4]="similarNameExists";e[e.invalidName=5]="invalidName";e[e.fileSize=6]="fileSize";e[e.emptyFileOrFolder=7]="emptyFileOrFolder";e[e.emptyFileOrFolderForDocLib=8]="emptyFileOrFolderForDocLib";e[e.overQuota=9]="overQuota";e[e.accessDenied=10]="accessDenied";e[e.lockMismatch=11]="lockMismatch";e[e.overQuotaSharedFolder=12]="overQuotaSharedFolder";e[e.folderUploadNotSupported=13]="folderUploadNotSupported";e[e.versionMismatch=14]="versionMismatch";e[e.authFailure=15]="authFailure";e[e.targetFolderMissing=16]="targetFolderMissing";e[e.itemNotFound=17]="itemNotFound";e[e.malwareDetected=18]="malwareDetected";e[e.throttled=19]="throttled";e[e.pathTooLong=20]="pathTooLong";e[e.disconnected=21]="disconnected";e[e.unlockRequired=22]="unlockRequired";e[e.insufficientVaultQuota=23]="insufficientVaultQuota"})(i||(i={}))},function(e,t,n){"use strict";var r=(function(){function e(e,t){if((function(e){return!!e&&"object"==typeof e})(e)){this.key=e.key;this.input=e.input;this.output=e.output;this.status=e.status;this.error=e.error}else{this.key=e;this.input=t;this.status=0}}e.prototype.succeed=function(t){var n=new e(this);n.output=t;n.status=1;delete n.error;return n};e.prototype.fail=function(t){var n=new e(this);n.error=t;n.status=2;return n};e.prototype.cancel=function(){var t=new e(this);delete t.error;t.status=3;return t};e.prototype.restart=function(){return new e(this.key,this.input)};e.prototype.changeInput=function(t){var n=t(this.input),r=new e(this.key,n);r.output=this.output;r.status=this.status;r.error=this.error;return r};e.prototype.changeOutput=function(t){var n=t(this.output),r=new e(this.key,this.input);r.output=n;r.status=this.status;r.error=this.error;return r};e.prototype.compare=function(e){return!e||this.input!==e.input||this.output!==e.output||this.error!==e.error||this.status!==e.status?{previous:e,current:this}:null};return e})();t.e=r},function(e,t,n){"use strict";var r;(function(e){e[e.initialized=0]="initialized";e[e.executed=1]="executed";e[e.failed=2]="failed"})(r||(r={}));t.e=r},,,function(e,t,n){"use strict";n.d(t,"n",function(){return a});n.d(t,"e",function(){return f});n.d(t,"t",function(){return l});n.d(t,"r",function(){return c});var r,i=n(899),s=n(840),o=n(182),u=n(954);(function(e){e.vaultOpen="vaultopen";e.vaultClosed="vaultclosed"})(r||(r={}));function a(e,t,n){var r=s.e[t]&&s.e[t].iconType||"png",i=e&&"png"===r;return"".concat(u.n).concat(n).concat(i?"_2x":"","/").concat(t,".").concat(r)}function f(e,t,n){return a(e.consume(o.e).isRetinaSupported,t,n)}function l(e,t,n){return f(e,i.n(t),n)}function c(e,t,n){if(n&&n.vault&&n.vault.root){return f(e,n.vault.isLocked?r.vaultClosed:r.vaultOpen,t)}if(n&&n.folder&&"SamsungGallery"===n.specialFolderCanonicalName)return f(e,"samsunggallery",t)}},,,,,function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.text=t.text;return n}return t})(n(2044).t),s=n(2045).e({tagName:"ms-text-container",template:'<div class="TextContainer" data-bind="text:text"></div>',viewModel:i});t.e=s},function(e,t,n){"use strict";var r=n(0),i=n(2046),s=n(172),o=n(107),u=new s.e,a=new o.t(window),f=0,l=[],c={};a.onAll(window,{resize:u.debounce(h,50),scroll:u.throttle(h,50,{leading:!1})});a.on(document,"transitionend",u.debounce(h,300),!0);function h(){for(var e in c)d(c[e])}function p(){for(;l.length;){var e=l.pop();if(!e.isDisposed){c[e.id]=e;d(e)}}}function d(e){if(void 0!==e.element.getBoundingClientRect){var t=e.element.getBoundingClientRect(),n=t.top<window.innerHeight&&t.bottom>=0;(e.allowHiddenSizeUpdates||n)&&e.size&&e.size(e.includePosition?{bottom:t.bottom,left:t.left,right:t.right,top:t.top,height:t.height,width:t.width}:{height:t.height,width:t.width});e.isOnScreen&&e.isOnScreen(n)}}var v=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.valueAccessor(),i={id:f++,element:n.element,isDisposed:!1,size:r.size,isOnScreen:r.isOnScreen,allowHiddenSizeUpdates:r.allowHiddenSizeUpdates,includePosition:!!r.includePosition};r.trigger&&n.createComputed(function(){r.trigger();d(i)});l.push(i);u.setTimeout(p,0);n.addDisposable({dispose:function(){i.isDisposed=!0;delete c[i.id]}});return n}return t})(i.t);t.e=v},,,,,,function(e,t,n){"use strict";var r=n(0),i=n("knockout-lib"),s=n(2044),o=n(2493),u=n(3220),a=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;t&&void 0!==t.loadingText?n.loadingText=t.loadingText:n.loadingText=u.e;n.addBindingHandlers({imageLoader:o.e});n.isVisible=i.observable(!0);n.isImageLoaded=i.observable(!1);n.loadingImageUrl=window.require.toUrl("odsp-media/images/loading/loadingspinner.gif");return n}t.prototype.hideSpinner=function(){this.isVisible(!1)};return t})(s.t),f=n(2045).e({tagName:"ms-loadingSpinner",template:'<div class="od-LoadingSpinner" data-automationid="ms-loadingSpinner"><img class="od-LoadingSpinner-loadingGif" role="presentation" data-bind="click:hideSpinner,visible:isVisible,imageLoader:{src:loadingImageUrl,isLoaded:isImageLoaded}"><span class="od-LoadingSpinner-loadingText" data-bind="text:loadingText"></span></div>',viewModel:a,synchronous:!0});t.e=f},,,,,,function(e,t,n){"use strict";n(2147);var r=n(2164),i=n(2045),s={tagName:"ms-file-type-icon",template:'<span class="FileTypeIcon" data-bind="attr:{title:hoverText},click:onClick,css:{\'FileTypeIcon--clickable\':!!onClick}" tabindex="-1"><img class="FileTypeIcon-icon" data-bind="attr:{src:iconUrl,alt:iconFieldAriaLabel},style:{width:size,height:size,\'font-size\':size}">\x3c!--ko if:overlayUrl--\x3e<img class="FileTypeIcon-overlay" data-bind="attr:{src:overlayUrl}">\x3c!--/ko--\x3e</span>',viewModel:r.e,synchronous:!0};i.e(s);t.e=s},,,,,,,,,,function(e,t,n){"use strict";var r=n(170);Object(r.n)([{rawString:".FileTypeIcon{position:relative;display:inline-block}.FileTypeIcon--clickable{cursor:pointer}.FileTypeIcon-icon{display:inline-block;vertical-align:middle;position:relative;overflow:hidden}.FileTypeIcon-icon::before{display:block}.FileTypeIcon-overlay{display:block;border:0;position:relative;left:9px;bottom:9px;height:9px;width:9px}"}])},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(0),i=n(1121),s=n(2078),o=n(2055),u=n(2058),a=n(2056),f=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.responsiveUI=n.resources.consume(u.t);n.commands=n.observables.createArray();t.disableOverflowHost||(n.overflowHostCommand=new(n.managed(s.e))({text:o.OverflowCommandLabel,tooltip:o.OverflowCommandTooltip,accessibleLabel:o.OverflowCommandTooltip,renderLabel:0,requiredChildren:1,hidesMenuChevron:!0,collapseSingleChildCommands:!1,icon:new a.e("More"),hasIconOnly:!0,children:n.observables.createArray(),location:3}));return n}return t})(i.default);t.t=f},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return E});var r=n(0),i=n(1121),s=n(183),o=n(100),u=n(119),a=n(82),f=n(87),l=n(2292),c=n(33),h=n(1761),p=n(19),d=n(91);function v(e,t){return e.preferences[(t||"").toLowerCase()]}function m(e){return!!(e=e&&e.toLowerCase().replace(".",""))&&!l.e[e]||"pdf"===e}function g(e,t,n,i){var s=v(e,t);if(s)for(var o=0,u=Object(r.__spreadArray)(Object(r.__spreadArray)([],s.preview,!0),s.open,!0).filter(y);o<u.length;o++){var a=u[o],f=n&&a[n]||i&&a.handler[i];if(f)return f}}function y(e){return!e.handler.isPromoted}function b(e){return e.filter(y)[0]}var w=(function(e){Object(r.__extends)(t,e);function t(t,n){var r,i=e.call(this,t,n)||this,u=Object(c.isFeatureEnabled)(c.FileHandlersV2),l=new s.e("FileHandlers",o.e.session);if(u)try{var v=l.getValue("data");r=v&&JSON.parse(v)}catch(e){}var m=i.observables,g=i.data=m.create(r);g.equalityComparer=h.e;if(!r||4!==r.version||!u){g({actions:{custom:[],create:[],open:[],preview:[]},preferences:{},version:4});l.setValue("data",JSON.stringify(g.peek()))}u&&m.backgroundCompute(function(){i.trackPromise(d.n.resolve(i.resources.consumeAsync(a.d.optional)).then(function(e){if(e)return e.getFileHandlerData({includePromotedApp:!0})}).then(function(e){return e||i.resources.consumeAsync(a.p.optional).then(function(e){if(e)return p.t.isActivated("a9c8b4cd-bc43-466c-aeeb-106eec05d057","07/07/2021","Will try to use cookie to get filehandler instead of tokens.")?e.getFileHandlerData({includePromotedApp:!0}):e.getFileHandlerData({includePromotedApp:!0,allowCookies:!0})})}).then(function(e){if(e){l.setValue("data",JSON.stringify(e));g(e)}},function(e){f.e.logError(e)}))});return i}t.prototype.getFileTypeIconUrl=function(e,t){return m(e)?this.getIconUrl(g(this._getData(t),e||"","icon","fileTypeIcon")):void 0};t.prototype.getFileTypeName=function(e,t){return m(e)?g(this._getData(t),e||"",void 0,"fileTypeDisplayName"):void 0};t.prototype.getIconUrl=function(e){var t=window.devicePixelRatio||1;return e&&(e.svg||t>=1.75&&e.png2x||t>=1.25&&e.png1_5x||e.png1x)};t.prototype.getDefaultOpenHandler=function(e,t){var n=v(this._getData(t),e||"");return n&&b(n.open)};t.prototype.getDefaultPreviewHandler=function(e,t){var n=v(this._getData(t),e||"");return n&&b(n.preview)};t.prototype.isActionForExtension=function(e,t){var n=e.availableOn.file,r=n&&n.extensions;return!!n&&(!r||r.indexOf(t.toLowerCase())>=0||r.indexOf(".*")>=0)};t.prototype._getData=function(e){return e?this.data.peek():this.data()};return t})(i.default),E=Object(u.s)("FileHandlerProvider",w)},function(e,t,n){"use strict";var r=n(0),i=n(2044),s=n(2119),o=n(2163),u=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.iconFieldAriaLabel,i=void 0===r?"":r,u=t.iconName,a=t.extension,f=t.item,l=t.desiredSize||16;n.hoverText=t.hoverText;n.onClick=t.onClick;var c=n,h=c.observables,p=c.resources,d=h.create(""),v=h.create(i);if(t.iconUrl)d(t.iconUrl);else if(u){var m=t.iconSize||l,g=s.e(p,u,m);d(g);if(a){var y=p.consume(o.e.optional);y&&h.backgroundCompute(function(){d(y.getFileTypeIconUrl(a)||g);v(y.getFileTypeName(a)||i)})}var b=s.r(p,m,f);b&&d(b)}var w=t.desiredSizeRem?"rem":"px",E=t.desiredSizeRem?t.desiredSizeRem:l;n.size="".concat(d.peek()?E:0).concat(w);n.iconUrl=d;n.iconFieldAriaLabel=v;t.overlayType?n.overlayUrl=window.require.toUrl("odsp-media/images/overlays/".concat(t.overlayType.toLowerCase())):n.overlayUrl="";return n}return t})(i.t);t.e=u},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(7),i=n(119),s=new r.t({name:"CommandBar.key",loader:new i.t(function(){return n.ee([713,"deferred","deferred.odsp-common"],2439).then(function(e){return e.resourceKey.local})})})},,,,,,function(e,t,n){"use strict";var r=n(334),i=(function(){function e(){}e.prototype.debounce=function(e){var t=this;this.clear();this._originalPromise=e;var n=new r.e(function(){return t._originalPromise.cancel()});this._originalPromise.done(function(e){t._clear(!1);n.complete(e)},function(e){t._clear(!1);n.error(e)});return n.getPromise()};e.prototype.clear=function(){this._clear(!0)};e.prototype.isExecuting=function(){return Boolean(this._originalPromise)};e.prototype._clear=function(e){if(this.isExecuting()){e&&this._originalPromise.cancel();this._originalPromise=null}};return e})();t.e=i},,,,,,function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.errorType=t.errorType||0;n.payloads=t.payloads||{};return n}return t})(n(70).e);t.e=i},,function(e,t,n){"use strict";var r=n(170);Object(r.n)([{rawString:".od-PanelHost{display:none}.SPPageChrome .od-Panel{top:0}.od-Panel{outline:1px solid transparent;position:absolute;top:48px;bottom:0;width:100%;max-width:100%;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-sizing:border-box;transition:width .3s ease-out;box-shadow:-30px 0 30px -30px "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";box-shadow:0 25.6px 57.6px 0 rgba(0,0,0,.22),0 4.8px 14.4px 0 rgba(0,0,0,.18)}[dir=ltr] .od-Panel{right:0}[dir=rtl] .od-Panel{left:0}.od-Panel.od-Panel--reactSuiteNav{top:48px}html[dir=rtl] .od-Panel{box-shadow:30px 0 30px -30px "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:"}.od-BasePage--noSuiteNav .od-Panel{top:0}.od-Panel.od-Panel--sm{width:100%}.lg .od-Panel.od-Panel--sm,.md .od-Panel.od-Panel--sm,.xlg .od-Panel.od-Panel--sm,.xxlg .od-Panel.od-Panel--sm,.xxxlg .od-Panel.od-Panel--sm,.xxxxlg .od-Panel.od-Panel--sm{width:340px}.lg .od-Panel.od-Panel--lg,.lg .od-Panel.od-Panel--xlg,.xlg .od-Panel.od-Panel--lg,.xlg .od-Panel.od-Panel--xlg,.xxlg .od-Panel.od-Panel--lg,.xxlg .od-Panel.od-Panel--xlg,.xxxlg .od-Panel.od-Panel--lg,.xxxlg .od-Panel.od-Panel--xlg,.xxxxlg .od-Panel.od-Panel--lg,.xxxxlg .od-Panel.od-Panel--xlg{width:auto}[dir=ltr] .lg .od-Panel.od-Panel--lg,[dir=ltr] .lg .od-Panel.od-Panel--xlg,[dir=ltr] .xlg .od-Panel.od-Panel--lg,[dir=ltr] .xlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--xlg{left:48px}[dir=rtl] .lg .od-Panel.od-Panel--lg,[dir=rtl] .lg .od-Panel.od-Panel--xlg,[dir=rtl] .xlg .od-Panel.od-Panel--lg,[dir=rtl] .xlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--xlg{right:48px}.lg .od-Panel.od-Panel--md,.xlg .od-Panel.od-Panel--md,.xxlg .od-Panel.od-Panel--md,.xxxlg .od-Panel.od-Panel--md,.xxxxlg .od-Panel.od-Panel--md{width:643px}[dir=ltr] .lg .od-Panel.od-Panel--md,[dir=ltr] .xlg .od-Panel.od-Panel--md,[dir=ltr] .xxlg .od-Panel.od-Panel--md,[dir=ltr] .xxxlg .od-Panel.od-Panel--md,[dir=ltr] .xxxxlg .od-Panel.od-Panel--md{left:auto}[dir=rtl] .lg .od-Panel.od-Panel--md,[dir=rtl] .xlg .od-Panel.od-Panel--md,[dir=rtl] .xxlg .od-Panel.od-Panel--md,[dir=rtl] .xxxlg .od-Panel.od-Panel--md,[dir=rtl] .xxxxlg .od-Panel.od-Panel--md{right:auto}.lg .od-Panel.od-panel-md-listform,.xlg .od-Panel.od-panel-md-listform,.xxlg .od-Panel.od-panel-md-listform,.xxxlg .od-Panel.od-panel-md-listform,.xxxxlg .od-Panel.od-panel-md-listform{width:800px}[dir=ltr] .lg .od-Panel.od-panel-md-listform,[dir=ltr] .xlg .od-Panel.od-panel-md-listform,[dir=ltr] .xxlg .od-Panel.od-panel-md-listform,[dir=ltr] .xxxlg .od-Panel.od-panel-md-listform,[dir=ltr] .xxxxlg .od-Panel.od-panel-md-listform{left:auto}[dir=rtl] .lg .od-Panel.od-panel-md-listform,[dir=rtl] .xlg .od-Panel.od-panel-md-listform,[dir=rtl] .xxlg .od-Panel.od-panel-md-listform,[dir=rtl] .xxxlg .od-Panel.od-panel-md-listform,[dir=rtl] .xxxxlg .od-Panel.od-panel-md-listform{right:auto}[dir=ltr] .xxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--lg{left:428px}[dir=rtl] .xxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--lg{right:428px}[dir=ltr] .xxxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--lg{left:980px}[dir=rtl] .xxxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--lg{right:980px}[dir=ltr] .xxxxlg .od-Panel.od-Panel--lg{left:1620px}[dir=rtl] .xxxxlg .od-Panel.od-Panel--lg{right:1620px}[dir=ltr] .xxlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxxlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--xlg{left:176px}[dir=rtl] .xxlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxxlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--xlg{right:176px}.lg .od-Panel.od-Panel--fullScreen,.md .od-Panel.od-Panel--fullScreen,.xlg .od-Panel.od-Panel--fullScreen,.xxlg .od-Panel.od-Panel--fullScreen,.xxxlg .od-Panel.od-Panel--fullScreen,.xxxxlg .od-Panel.od-Panel--fullScreen{width:100%}.sm .od-Panel.od-Panel--lightDismiss{width:272px}.od-Panel--FullPagePanel{top:0;width:100%;height:100%}.od-Panel--hasPadding{padding:74px 16px 20px}.lg .od-Panel--hasPadding,.xlg .od-Panel--hasPadding,.xxlg .od-Panel--hasPadding,.xxxlg .od-Panel--hasPadding,.xxxxlg .od-Panel--hasPadding{padding:74px 24px 20px}.xlg .od-Panel--hasPadding,.xxlg .od-Panel--hasPadding,.xxxlg .od-Panel--hasPadding,.xxxxlg .od-Panel--hasPadding{padding-top:74px}.xxlg .od-Panel--hasPadding,.xxxlg .od-Panel--hasPadding,.xxxxlg .od-Panel--hasPadding{padding:74px 24px 20px}.od-Panel--autoScroll{overflow:auto}.od-Panel--hiddenScroll{overflow:hidden}.od-Panel--alwaysScroll{overflow-y:scroll}.od-Panel-title{margin-bottom:19px;font-size:"},{theme:"xLargeFontSize",defaultValue:"20px"},{rawString:";font-weight:"},{theme:"xLargeFontWeight",defaultValue:"600"},{rawString:";max-width:240px}html[dir=ltr] .od-Panel-title{margin-right:26px}html[dir=rtl] .od-Panel-title{margin-left:26px}.lg .od-Panel-title,.md .od-Panel-title,.sm .od-Panel-title{line-height:normal}.od-Panel--hidden{visibility:hidden}.od-Panel-content--titleFill{width:100%;height:calc(100% - 48px - 8px)}.od-Panel-content--noTitleFill{width:100%;height:100%}.od-Panel-button--close{position:absolute;outline:0;margin:0;border:0;background:0 0;cursor:pointer;height:32px;width:32px;line-height:32px;padding:0;top:16px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:"}[dir=ltr] .od-Panel-button--close{right:16px}[dir=rtl] .od-Panel-button--close{left:16px}.od-Panel-button--close:hover{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.isFluentVNext .od-Panel-button--close:hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Panel-button--close:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-Panel-button--close .ms-Icon--Cancel{font-size:16px;margin-top:0;color:inherit}.md .od-Panel-button--close .ms-Icon--Cancel,.sm .od-Panel-button--close .ms-Icon--Cancel{font-size:16px}.od-Panel--hasCommandBar .od-Panel-button--close{z-index:600;padding:0;top:6px}[dir=ltr] .od-Panel--hasCommandBar .od-Panel-button--close{right:8px}[dir=rtl] .od-Panel--hasCommandBar .od-Panel-button--close{left:8px}[dir=ltr] .od-Panel--stickyCloseButton .od-Panel-button--close{right:20px}[dir=rtl] .od-Panel--stickyCloseButton .od-Panel-button--close{left:20px}[dir=ltr] .md .od-Panel-button--close,[dir=ltr] .sm .od-Panel-button--close{right:20px}[dir=rtl] .md .od-Panel-button--close,[dir=rtl] .sm .od-Panel-button--close{left:20px}[dir=ltr] .sm .od-Panel-button--close{right:12px}[dir=rtl] .sm .od-Panel-button--close{left:12px}.od-Panel-button--close:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Panel--stickyCloseButton .od-Panel-content{position:absolute;top:0;bottom:0;left:0;right:0;overflow:auto}[dir=ltr] .od-Panel--stickyCloseButton .od-Panel-content{padding-right:40px}[dir=rtl] .od-Panel--stickyCloseButton .od-Panel-content{padding-left:40px}.od-OverlayHost-overlay .od-Panel{opacity:0}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-Panel{opacity:1}[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-Panel{animation-name:ms-fadeIn,ms-slideLeftIn40;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-Panel{animation:none}}[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-Panel{animation-name:ms-fadeIn,ms-slideRightIn40;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-Panel{animation:none}}[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Panel{animation-name:ms-fadeOut,ms-slideRightOut40;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Panel{animation:none}}[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Panel{animation-name:ms-fadeOut,ms-slideLeftOut40;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Panel{animation:none}}.od-PanelOverlay.ms-ModalOverlay{top:48px}.od-BasePage--noSuiteNav .od-PanelOverlay.ms-ModalOverlay{top:0}.SPPageChrome .od-PanelOverlay.ms-ModalOverlay{top:0}[dir=ltr] .od--hasFlexPane .od-Panel{right:320px}[dir=rtl] .od--hasFlexPane .od-Panel{left:320px}"}])},,,,,function(e,t,n){"use strict";var r=n(0),i=n(395),s=n(2046),o=n(2215),u=(function(e){Object(r.__extends)(t,e);function t(t){var n,r,i,s=e.call(this,t)||this,u=t.valueAccessor();if((function(e){return"object"==typeof e})(u)){n=u.isBodyActive;r=u.activeElement;i=u.isDescendantOrSelfActive}else i=u;s._focusTracker=s.resources.consume(o.e);var a=s.observables;if(i){var f=a.pureCompute(s._computeIsDescendantOrSelfActive);a.compute(function(){i(f())}).extend({deferred:!0})}if(n){var l=a.pureCompute(s._computeIsBodyActive);a.compute(function(){n(l())}).extend({deferred:!0})}if(r){var c=a.pureCompute(s._computeActiveElement);a.compute(function(){r(c())}).extend({deferred:!0})}return s}t.prototype._computeIsDescendantOrSelfActive=function(){var e=this.element,t=this._focusTracker.activeElement();return!!t&&(e===t||Object(i.e)(e,t))};t.prototype._computeIsBodyActive=function(){var e=this._focusTracker.activeElement();return!e||e===document.body};t.prototype._computeActiveElement=function(){return this._focusTracker.activeElement()};return t})(s.t);t.e=u},,,function(e,t,n){"use strict";var r;(function(e){e[e.none=0]="none";e[e.htmlFileUpload=1]="htmlFileUpload";e[e.folderUpload=2]="folderUpload";e[e.downlevelUpload=3]="downlevelUpload";e[e.silverlightUpload=4]="silverlightUpload"})(r||(r={}));t.e=r},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(7),i=n(914),s=new r.t({name:"NeedsOverlayContent.key",factory:{dependencies:{},create:function(){return{instance:{needsOverlayContent:new i.e(!1)}}}}})},,function(e,t,n){"use strict";var r=n(0),i=n(2046),s=n("knockout-lib"),o=n(2006),u=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.valueAccessor(),i=(function(e){return!!e.context})(r)?r:{context:r},u=i.context,a=i.virtualChildElement,f=void 0===a?n.element:a;n._context=u;u.parentElement&&Object(o.e)(f,u.parentElement);s.applyBindingsToNode(n.element,{template:{nodes:u.templateNodes}},u.bindingContext);u.renderCount(u.renderCount.peek()+1);n.controlsDescendantBindings=!0;return n}t.prototype.dispose=function(){this._context.renderCount(this._context.renderCount.peek()-1);e.prototype.dispose.call(this)};t.supportsVirtualElements=!0;return t})(i.t);t.e=u},,,,,,,function(e,t,n){"use strict";var r=n(0),i=n(181),s=n(2046),o=n(2431),u=n(2394),a=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.resources.consume(i.C.optional);if(!r)return n;n.teachingBubbleProvider=r;n._value=n.valueAccessor();n._firstRunExperienceStatus=n.resources.consume(o.e);n._firstRunExperienceStatusKO=n.observables.create(n._firstRunExperienceStatus.get());n._firstRunExperienceStatus.subscribe(function(){n._firstRunExperienceStatusKO(n._firstRunExperienceStatus.get())});n.createBackgroundComputed(n._computeAddTeachingBubble);return n}t.prototype._computeAddTeachingBubble=function(){var e=this.unwrapObservable(this._value);if(e){var t=this.unwrapObservable(e.campaign);if(this._firstRunExperienceStatusKO()===u.e.notVisible&&t){this._campaign&&t.campaignGuid!==this._campaign.campaignGuid&&this.teachingBubbleProvider.currentBubble.get()&&this.teachingBubbleProvider.currentBubble.get().campaign===this._campaign&&this.teachingBubbleProvider.clearCurrentBubble();this._campaign=t;this.teachingBubbleProvider.addBubble({bubble:t,element:this.element})}}};return t})(s.t);t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});var r="Click";function i(e){return e.charAt(0).toUpperCase()+e.slice(1)}},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(0),i=n(1121),s=n(898),o=n(119),u=n(182),a=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=r.observables;r._activeElement=i.create({});r.activeElement=i.pureCompute(r._computeActiveElement);r.activeElement.equalityComparer=s.n;r.isWindowActive=i.create(!0);r._isWithinWindowBlur=!1;r._platform=n.platFormDetection;var o=r.async.throttle(function(){r._activeElement({})},350),u=r._platform&&r._platform.isEdge,a=r._platform&&r._platform.isIE;if(u||a){var f=new MutationObserver(o);f.observe(document.body,{childList:!0,subtree:!0});r.scope.attach({dispose:function(){f&&f.disconnect()}})}r.events.onAll(window,{focus:r._onWindowFocus,blur:r._onWindowBlur},!1);r.events.onAll(document.body,{focus:r._onDocumentFocus,blur:r._onDocumentBlur},!0);return r}t.prototype._computeActiveElement=function(){this._activeElement();return document.activeElement};t.prototype._onWindowFocus=function(e){this.async.clearTimeout(this._windowBlurTimeout);this._isWithinWindowBlur=!1;this.isWindowActive(!0)};t.prototype._onDocumentFocus=function(e){if(!this._isWithinWindowBlur){this.isWindowActive(!0);var t=document.activeElement;this.async.clearTimeout(this._blurTimeout);window.__debugFocus&&console.log("[focus] active:",t);this._activeElement({})}};t.prototype._onWindowBlur=function(e){var t=this;this._isWithinWindowBlur=!0;this.isWindowActive(!1);this._windowBlurTimeout=this.async.setTimeout(function(){t._isWithinWindowBlur=!1},10)};t.prototype._onDocumentBlur=function(e){var t=this;if(!this._isWithinWindowBlur){this.isWindowActive(!0);var n=document.activeElement;this.async.clearTimeout(this._blurTimeout);if(n&&n!==document.body){window.__debugFocus&&console.log("[focus] blur:",n);this._activeElement({})}else{window.__debugFocus&&console.log("[focus] wait:",n);this._blurTimeout=this.async.setTimeout(function(){window.__debugFocus&&console.log("[focus] blur:",n);t._activeElement({})},0)}}};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.default.dependencies),{platFormDetection:u.e});return t})(i.default),f=Object(o.s)("FocusTracker",a,Object(r.__assign)(Object(r.__assign)({},i.default.dependencies),{platFormDetection:u.e}))},function(e,t,n){"use strict";n.d(t,"e",function(){return u});n.d(t,"t",function(){return a});var r=n(0),i=n("knockout-lib"),s=n(36),o=n(1121),u=(function(){function e(){}e.Search="Search";return e})(),a=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getBuckets=function(){return t.getBuckets(this.resources)};t.getBuckets=function(e){return e&&e.isExposed(s.f)?e.consume(s.f):i.observable([])};t.prototype.getLoggingContextData=function(){return t.getLoggingContextData(this.resources)};t.getLoggingContextData=function(e){var n=null;e&&e.isExposed(s.a)&&(n=e.consume(s.a));return n?n.get(t.getBuckets(e).peek()):{}};t.prototype.addBuckets=function(e){return t.addBuckets(this.resources,e)};t.addBuckets=function(e,t){if(e){var n=[];e.isExposed(s.f)&&(n=e.consume(s.f).peek());t.forEach(function(e){n.indexOf(e)<0&&n.push(e)});e.isExposed(s.f)||e.expose(s.f,i.observable(n))}};return t})(o.default)},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return i});var r=n("knockout-lib");function i(e,t){var n=e.__automationBinding$elements;return n&&n[t]}t.e={init:function(e,t,n,i,s){r.applyBindingsToNode(e,{attr:{"data-automationId":t()}},s);if(s){var o=s.$component;if(o){var u=r.utils.unwrapObservable(t());if(u){var a=o.__automationBinding$elements;a||(a=o.__automationBinding$elements={});a[u]=e;r.utils.domNodeDisposal.addDisposeCallback(e,function(){a[u]&&delete a[u]})}}}}}},,,function(e,t,n){"use strict";var r=n(2045),i=n(0),s=n(2044),o=n(2452),u=n(18),a=n(3134),f=n(2381),l=n(1761);function c(e,t){return e===t||(!e&&!t||!(!e||!t)&&e.url===t.url)}n(1735);var h=n(1121),p=n(3761),d=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.hasAnimated,i=t.fadeIn,s=t.image,o=t.referenceImage,u=t.referenceRotation;n._fadeIn=i;n._image=s;n._referenceImage=o;n._referenceRotation=u;n.isLoaded=n.createObservable(!1);n._hasAnimated=n._getHasAnimated();n.rotation=n.createPureComputed(n._computeRotation);n.createBackgroundComputed(function(){return r(n._hasAnimated())});return n}t.prototype._getHasAnimated=function(){var e=this,t=this.createObservable(!1);return this.createPureComputed(function(){var n;if(e.isLoaded.peek())(n=t())||e.async.setTimeout(function(){return t(!0)},e._fadeIn.peek()?2e3:50);else{e.isLoaded();n=!1}return n})};t.prototype._computeRotation=function(){var e=this.rotation.peek();(c(this._image,this._referenceImage())||void 0===e)&&(e=this._referenceRotation());return e};return t})(h.default),v=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.imageTileTagName=p.e.tagName;var i=t.image,s=t.rotation,o=t.desiredSize,u=t.scale,a=void 0===u?1:u,f=t.fadeIn,h=void 0===f||f,v=t.allowLoading,m=void 0===v||v,g=t.isLoaded,y=t.isCurrent,b=t.alignment,w=t.position,E=t.loadedImage,S=t.error,x=t.loadImageScenarioName,T=n.outputExtenders,N=void 0===T?{deferred:!0}:T,C=n.AnimationTracker,k=void 0===C?d:C;r._animationTrackerType=k;r._image=r.wrapObservable(i);r._rotation=r.wrapObservable(s);r._desiredSize=o;r._scale=a;r.fadeIn=r.wrapObservable(h);r._allowLoading=r.wrapObservable(m);r._alignment=b;r._scenarioName=x;r._tileDefinitions=r.createPureComputed(r._computeTileDefinitions);r._position=r.createPureComputed(r._computePosition);r._position.equalityComparer=l.e;r._loadedImage=r.createPureComputed(r._computeLoadedImage);r._loadedImage.equalityComparer=c;r._error=r.createPureComputed(r._computeError);r._error.equalityComparer=l.e;r.tiles=r._getTiles();w&&r.createBackgroundComputed(function(){return w(r._position())}).extend(N);E&&r.createBackgroundComputed(function(){return E(r._loadedImage())}).extend(N);g&&r.createBackgroundComputed(function(){return g(!!r._loadedImage())}).extend(N);y&&r.createBackgroundComputed(function(){return y(c(r._loadedImage(),r._image()))}).extend(N);S&&r.createBackgroundComputed(function(){return S(r._error())}).extend(N);return r}t.prototype._computeError=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var r=t[n],i=r.isLoaded,s=r.error;if(i())break;if(s()){e=s();break}}return e};t.prototype._computePosition=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var r=t[n],i=r.isLoaded,s=r.position;if(i()){e=s();break}}return e};t.prototype._computeLoadedImage=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var r=t[n],i=r.isLoaded,s=r.image;if(i()){e=this.unwrapObservable(s);break}}return e};t.prototype._computeTileDefinitions=function(){var e=this._image(),t=this._tileDefinitions.peek(),n=void 0===t?[]:t;if(e){if(this._allowLoading()){var r=void 0,s=void 0,o=void 0,u=n[n.length-1];if(u){r=c(u.image,e);s=u.hasAnimated.peek();o=!!u.error.peek()}else{r=!1;s=!1}if(r)s?n=[u]:u.hasAnimated();else{if(!u||s||o){u={image:e,error:this.createObservable(),hasAnimated:this.createObservable(!1)};n=Object(i.__spreadArray)(Object(i.__spreadArray)([],n,!0),[u],!1)}u.hasAnimated();u.error()}}}else n=[];return n};t.prototype._getTiles=function(){var e=this,t=this.observables.createArray(),n=this.addDisposable(t.map({mappingWithDisposeCallback:function(t){var n=t.image,r=t.error,i=t.hasAnimated,s=new(e.managed(e._animationTrackerType))({hasAnimated:i,image:n,referenceRotation:e._rotation,referenceImage:e._image,fadeIn:e.fadeIn});return{mappedValue:{image:n,rotation:s.rotation,isLoaded:s.isLoaded,error:r,scale:e._scale,desiredSize:e._desiredSize,alignment:e._alignment,position:e.createObservable(),loadImageScenarioName:e._scenarioName},dispose:function(){s.dispose()}}}}));this.createBackgroundComputed(function(){t.splice.apply(t,Object(i.__spreadArray)([0,t.peek().length],e._tileDefinitions(),!1))});return n};return t})(s.t),m=Object(r.e)({tagName:"od-image-stack",template:'<span class="od-ImageStack" data-bind="css:{\'od-ImageStack--fade\':fadeIn},template:{foreach:tiles}"><span class="od-ImageStack-tile" data-bind="css:{\'od-ImageStack-tile--isLoaded\':$data.isLoaded},component:{name:$component.imageTileTagName,params:$data}"></span></span>',viewModel:v,synchronous:!0}),g=n(19),y=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.imageStackTagName=m.tagName;var i=t.image,s=t.rotation,u=void 0===s?o.e.none:s,h=t.alignment,p=t.desiredSize,d=t.isLoaded,v=t.isCurrent,y=t.error,b=t.coverage,w=void 0===b?{minimum:1,maximum:1}:b,E=t.scale,S=t.fadeIn,x=t.allowLoading,T=t.position,N=t.loadImageScenarioName,C=n.thumbnailCache,k=void 0===C?r.resources.consume(a.e):C,L=n.outputExtenders,A=void 0===L?{deferred:!0}:L;r._thumbnailCache=k;r._image=r.wrapObservable(i);r._rotation=r.wrapObservable(u);r._alignment=f.n(h);r._desiredSize=r.wrapObservable(p);r._isLoaded=d;r._coverage=r.wrapObservable(w);r._loadedImage=r.createObservable();r._blobImage=r.createObservable();r._isNoCacheTriggered=!1;r._effectiveDesiredSize=r.createPureComputed(r._computeEffectiveDesiredSize);r._effectiveDesiredSize.equalityComparer=l.e;r._idealSize=r.createPureComputed(r._computeIdealSize);r._idealSize.equalityComparer=l.e;r._idealImage=r.createPureComputed(r._computeIdealImage);r._idealImage.equalityComparer=c;r._fallbackImage=r.createPureComputed(r._computeFallbackImage);r._fallbackImage.equalityComparer=c;r._cachedImage=r.createPureComputed(r._computeCachedImage);r._cachedImage.equalityComparer=c;r._currentImage=r.createPureComputed(r._computeCurrentImage);r._currentImage.equalityComparer=c;r._isCurrent=r.createPureComputed(r._computeIsCurrent);r.imageStackParams={image:r._currentImage,rotation:r._rotation,desiredSize:r._desiredSize,loadedImage:r._loadedImage,isLoaded:r._isLoaded,error:y,scale:E,alignment:r._alignment,fadeIn:S,allowLoading:x,position:T,loadImageScenarioName:N};v&&r.createBackgroundComputed(function(){return v(r._isCurrent())}).extend(A);g.t.isActivated("f4bfd21f-f2f1-4d89-94f9-242765ec8a9a","07/16/2021","one up thumbnail link not secure (pre auth)")||r.addDisposable({dispose:function(){r._blobImage.peek()&&r._blobImage.peek().url&&URL.revokeObjectURL(r._blobImage.peek().url)}});return r}t.prototype._computeIsCurrent=function(){return c(this._loadedImage(),this._idealImage())};t.prototype._computeCurrentImage=function(){var e=this._loadedImage(),t=this._idealImage(),n=this._cachedImage(),r=this._fallbackImage();return e?c(e,t)?this._currentImage.peek():t:n||r||t};t.prototype._computeEffectiveDesiredSize=function(){var e,t=this._desiredSize(),n=window.devicePixelRatio||1;t&&(e={width:t.width*n,height:t.height*n});return e};t.prototype._computeIdealSize=function(){var e,t=this._image();if(t){var n=t.width,r=t.height,i=this._effectiveDesiredSize();if(i&&i.width&&i.height){if(n&&r){var s=this._alignment.getTransform(t,i);e={width:s.scale*t.width,height:s.scale*t.height}}}else e={width:n,height:r}}return e};t.prototype._computeIdealImage=function(){var e,t=this._image(),n=this._idealSize();if(!g.t.isActivated("f4bfd21f-f2f1-4d89-94f9-242765ec8a9a","07/16/2021","one up thumbnail link not secure (pre auth)")&&this._blobImage())return this._blobImage.peek();if(t){n?(e=this._getDerivedImage(t,n))!==this._idealImage.peek()&&this._thumbnailCache.register(t,e,n,!1):e=t.getAligned?t.getAligned(this._effectiveDesiredSize(),this._alignment):t;g.t.isActivated("f4bfd21f-f2f1-4d89-94f9-242765ec8a9a","07/16/2021","one up thumbnail link not secure (pre auth)")||this._convertImageUrlToBlobUrlViaXhttp(e)}return e};t.prototype._convertImageUrlToBlobUrlViaXhttp=function(e){var t=this;if(e&&e.url&&-1!==e.url.indexOf("access_token")){var n=new XMLHttpRequest;n.onload=function(){if(n.status>=200&&n.status<300&&n.response){var r=URL.createObjectURL(n.response);t._blobImage(Object(i.__assign)(Object(i.__assign)({},e),{url:r}));t._isNoCacheTriggered=!1}};n.onerror=function(){if(!t._isNoCacheTriggered){t._isNoCacheTriggered=!0;t._convertImageUrlToBlobUrlViaXhttp(e)}};n.open("GET",e.url,!0);n.responseType="blob";if(this._isNoCacheTriggered){n.setRequestHeader("cache-control","no-cache");n.setRequestHeader("pragma","no-cache")}n.send()}};t.prototype._computeFallbackImage=function(){var e,t=this._image(),n=this._idealSize();if(n&&t&&t.width){var r=(this._coverage()||{}).fallback,i=void 0===r?0:r;if(i){var s={width:n.width*i,height:n.height*i};(e=this._getDerivedImage(t,s))!==this._fallbackImage.peek()&&this._thumbnailCache.register(t,e,s,!1)}}return e};t.prototype._computeCachedImage=function(){var e,t=this._image(),n=this._idealSize();if(n&&t&&t.width){var r=this._thumbnailCache.getCoveragePercent(t,n),i=this._coverage()||{},s=i.minimum,o=void 0===s?1:s,u=i.maximum,a=o*r,f=(void 0===u?1:u)*r;e=this._thumbnailCache.retrieve(t,f,a)}return e};t.prototype._getDerivedImage=function(e,t){return{url:e.getAligned?e.getAligned(t,this._alignment).url:u.format(e.url,Math.ceil(t.width),Math.ceil(t.height)),width:e.width,height:e.height}};return t})(s.t),b=Object(r.e)({tagName:"od-image-frame",template:'<span class="od-ImageFrame" data-bind="component:{name:$component.imageStackTagName,params:$component.imageStackParams}"></span>',viewModel:y,synchronous:!0});t.e=b},function(e,t,n){"use strict";var r='<div class="od-PanelHost" data-bind="foreach:panels">\x3c!--ko component:{name:$parent.overlayTagName,params:{animation:{afterAdd:1,beforeRemove:500},alignToParent:false}}--\x3e\x3c!--ko focusTrap:{}--\x3e<div class="ms-ModalOverlay od-PanelOverlay"></div><div class="od-Panel" role="dialog" tabindex="-1" data-bind="interactionScope:{isScope:true},preserveFocus,recoverFocus:{isEnabled:$host.isOpen},scrollContainer,dismiss:{close:$component.closePanel.bind($component),disableEscape:disableEscape},class:$component.determinePanelCssClass($data)+\' \'+$component.getScrollBarMode($data),css:{\'od-Panel--hasCommandBar\':hasCommandBar,\'od-Panel--hasPadding\':includePadding,\'od-Panel--lightDismiss\':preserveLightDismiss,\'od-Panel--stickyCloseButton\':stickyCloseButton,\'od-Panel--reactSuiteNav\':$component.isReactSuiteNav},attr:{\'aria-label\':title,\'aria-describedby\':elementDescribedBy},element:$parent.contentRoot">\x3c!--ko ifnot:noTitle--\x3e<div class="od-Panel-title" data-bind="text:title"></div>\x3c!--/ko--\x3e<div class="od-Panel-content" data-bind="component:component,css:{\'od-Panel--hasPadding\':stickyCloseButton&&includePadding,\'od-Panel-content--noTitleFill\':maximizePanelContent&&noTitle,\'od-Panel-content--titleFill\':maximizePanelContent&&!noTitle},clientRect:{size:panelContentSize}"></div>\x3c!--ko if:showCloseButton--\x3e<button class="od-Panel-button od-Panel-button--close" tabindex="0" data-bind="click:$component.closePanel.bind($component),attr:{\'aria-label\':$component.closePanelLabel,title:$component.closePanelLabel},keyboard:{mappings:{Enter:$component.onEnter.bind($component)}}"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>',i=(n(2182),n(2045)),s=n(0),o=n("knockout-lib"),u=n(2044),a=n(2109),f=n(2075),l=n(2058),c=n(33),h=n(2062),p=n(2083),d=n(2061),v=n(2104),m=n(2092),g=n(2125),y=n(2074),b=n(2293),w=n(2110),E=n(2099),S=n(132),x=(function(e){Object(s.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.closePanelLabel=b.e;r.overlayTagName=E.e.tagName;r.addBindingHandlers({scrollContainer:y.e,dismiss:f.e,element:h.e,focusTrap:p.e,keyboard:d.e,interactionScope:w.t,preserveFocus:v.e,recoverFocus:m.e,clientRect:g.e});r.contentRoot=o.observable();r._panelProvider=r.resources.consume(a.e);r.panels=r._panelProvider.currentPanels;r.isReactSuiteNav=Object(c.isFeatureEnabled)(c.UseReactConsumerShell);return r}t.prototype.onEnter=function(e,t){this.closePanel(e,!0);t.stopPropagation();return!1};t.prototype.closePanel=function(e,t){e.isBlocking&&!t||e.state(1);return!1};t.prototype.determinePanelCssClass=function(e){var t="od-Panel--"+l.e.determineCssClass(e.size);return Object(S.s)()?t+" od-Panel--FullPagePanel":e.overridePanelStyle?t+" "+e.overridePanelStyle:t};t.prototype.getScrollBarMode=function(e){return"od-Panel--"+e.scrollMode+"Scroll"};t.prototype.getClass=function(e){return"od-Panel--"+l.e.determineCssClass(e.size)};return t})(u.t),T=n(2049),N=i.e({tagName:"ms-panel-host",template:r,viewModel:x,synchronous:!0});t.e=N,Object(T.n)({name:"PanelHost",template:r,automationName:"od-panel-host",viewModelType:x})},,,,function(e,t,n){"use strict";var r=(function(){function e(){this.id=++e._lastBatchId}e._lastBatchId=0;return e})();t.e=r},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(2363),i=new r.e("Item",r.t.subject)},,,,,function(e,t,n){"use strict";var r=n(2045),i=n(0),s=n(2044),o=n(2085),u=n(2202),a="od-transclusion-host-default",f="od-transclusion-host-custom",l=n(898),c=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r,i=e.call(this,t,n)||this;i.addBindingHandlers({host:o.e,transclusionHost:u.e});i._provider=t.provider;i._renderCount=t.renderCount;i.contexts=i._provider.contexts;i.currentContext=i.createPureComputed(i._computeCurrentContext);i.currentContext.equalityComparer=l.n;r=t.useCustomTemplate?f:a;i.templateName=r;i._renderCount&&i.createComputed(i._computeSetRenderCount);return i}t.prototype._computeCurrentContext=function(){return this.contexts()[this.contexts().length-1]||null};t.prototype._computeSetRenderCount=function(){this._renderCount(this.contexts().length)};return t})(s.t),h=n(2049),p=r.e({tagName:"od-transclusion-host",template:"\x3c!--ko template:templateName--\x3e\x3c!--/ko--\x3e",viewModel:c,synchronous:!0});r.t(a,"\x3c!--ko with:currentContext--\x3e\x3c!--ko transclusionHost:$data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e");r.t(f,"\x3c!--ko host:{data:{contexts:contexts}}--\x3e\x3c!--/ko--\x3e");Object(h.n)({name:"TransclusionHost",template:"\x3c!--ko template:templateName--\x3e\x3c!--/ko--\x3e",automationName:"od-transclusion-host",viewModelType:c}),t.e=p},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n("knockout-lib");"boolean"==typeof i.options.preferJQueryEvents?i.options.preferJQueryEvents=!1:"boolean"==typeof i.options.useOnlyNativeEvents&&(i.options.useOnlyNativeEvents=!0);var s=n(7),o=n(640),u=n(3333);function a(e){var t,n;if(e&&e.$data&&e.$data.resources)return e.$data.resources;for(;(!(n=e.$data)||"object"!=typeof n||!(t=n.resources))&&e.$parentContext;)e=e.$parentContext;return t}var f={loadViewModel:function(e,t,n){n(function(n,f){void 0===n&&(n={});var l,c=i.contextFor(f.element),h=i.utils.unwrapObservable(n.resources)||a(c),p={owner:e,useFactoriesOnKeys:!0},d=h?new s.n(h,p):new s.n(p);n=Object(r.__assign)(Object(r.__assign)({},n),{resources:d});l=(function(e){return"function"==typeof e.createViewModel})(t)?t.createViewModel(n,f):new(d.injected(t))(n);var v=new u.e({name:e,viewModel:l,element:f.element,bindingContext:c});return Object(o.e)(l,function(){v.dispose();d.dispose()})})}};i.components.loaders.unshift(f)},,,,,,,,function(e,t,n){"use strict";var r=n(170);Object(r.n)([{rawString:".od-DialogOverlay{display:none}.od-Dialog{background-color:transparent;position:absolute;top:48px;bottom:0;width:100%;display:block;font-size:0;line-height:100vh;text-align:center;display:flex;align-items:center}[dir=ltr] .od-Dialog{left:0}[dir=rtl] .od-Dialog{right:0}.od-Dialog::before{vertical-align:middle;display:inline-block;content:'';height:100%;width:0}.sm .od-Dialog{align-items:flex-start;box-sizing:border-box;padding:0}.od-Dialog-main{vertical-align:middle;display:inline-block;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-sizing:border-box;line-height:normal;width:100%;min-height:100px;outline:0;visibility:hidden;box-shadow:0 25.6px 57.6px 0 rgba(0,0,0,.22),0 4.8px 14.4px 0 rgba(0,0,0,.18);border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";overflow:hidden}.sm .od-Dialog-main{height:100%}html[dir=ltr] .od-Dialog-main{text-align:left}html[dir=rtl] .od-Dialog-main{text-align:right}@media screen and (-ms-high-contrast:active){.od-Dialog-main{box-shadow:0 0 0 3px "},{theme:"white",defaultValue:"#ffffff"},{rawString:" inset}}@media screen and (-ms-high-contrast:black-on-white){.od-Dialog-main{box-shadow:0 0 0 3px "},{theme:"black",defaultValue:"#000000"},{rawString:" inset}}.od-Dialog-main:focus{outline:0}.od-Dialog-main--dialog{margin:auto;position:relative}.od-Dialog-main--callout{position:absolute}.od-Dialog-main--visible{visibility:visible}.od-Dialog-main--sm{width:360px}.od-Dialog-main--sm.od-Dialog-main-style--blocker{width:340px}.od-Dialog-main--sm.od-Dialog-main-style--vaultBlocker{width:620px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel{top:0;width:auto;position:absolute;bottom:0;left:0;right:0}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button{display:inline-flex;align-items:center}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button--primary,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button--primary{border:none}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button--primary:disabled,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button--primary:disabled{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button--primary:disabled:before,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button--primary:disabled:before{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button--primary .od-Button-label,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button--primary .od-Button-label{display:inline-block;font-size:14px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel.od-Dialog--close .od-Dialog-button.od-Dialog-button--close,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{top:8px}.od-Dialog-main--md{max-width:480px}.od-Dialog-main--lg{max-width:640px}.od-Dialog-main--xlg{max-width:1024px}.od-Dialog-main--xxlg{max-width:1366px}.od-Dialog-main--xxxlg{max-width:1920px}.isFluentVNext .od-Dialog-main{border-radius:4px;box-shadow:0 6.4px 14.4px 0 rgba(0,0,0,.132),0 1.2px 3.6px 0 rgba(0,0,0,.108)}.od-Dialog-button.od-Dialog-button--close{display:none}.sm .od-Dialog-button.od-Dialog-button--close{top:8px}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{display:block;position:absolute;margin:0;border:0;background:0 0;cursor:pointer;top:5px;border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";line-height:32px;height:32px;width:32px;padding:0;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}[dir=ltr] .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{right:5px}[dir=rtl] .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{left:5px}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close:hover{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close .ms-Icon.ms-Icon--Cancel{font-size:16px;color:inherit}.sm .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{top:8px;line-height:20px}.sm .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close .ms-Icon.ms-Icon--Cancel{font-size:20px}.od-Dialog-subText{margin:0 0 20px 0;font-weight:300;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-Dialog-subText.od-Dialog-subText--s{font-size:12px}.od-Dialog-subText.od-Dialog-subText--m{font-size:14px}.od-Dialog-subText.od-Dialog-subText--l{font-size:17px}.od-Dialog-content{position:relative;width:100%}.sm .od-Dialog-content{height:100%}.od-Dialog-content .od-Button.od-Button--compound:not(:last-child){margin-bottom:20px}.ms-ModalOverlay{display:block;position:absolute;cursor:pointer;left:0;right:0;top:0;bottom:0;background-color:"},{theme:"whiteTranslucent40",defaultValue:"rgba(255,255,255,.4)"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-ModalOverlay{display:none}}.od-Dialog--multiline{width:95%}[dir=ltr] .od-Dialog-button--close{right:14px}[dir=rtl] .od-Dialog-button--close{left:14px}[dir=ltr] .od-Dialog-button--close{left:auto}[dir=rtl] .od-Dialog-button--close{right:auto}.od-Dialog-content{font-size:14px;line-height:20px}.od-OverlayHost-overlay .ms-ModalOverlay{animation-name:ms-fadeIn;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay .ms-ModalOverlay{animation:none}}.od-OverlayHost-overlay .od-Dialog-main{animation-name:ms-fadeIn,ms-slideDownIn10;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay .od-Dialog-main{animation:none}}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .ms-ModalOverlay{animation-name:ms-fadeOut;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .ms-ModalOverlay{animation:none}}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Dialog-main{animation-name:ms-fadeOut,ms-slideUpOut10;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Dialog-main{animation:none}}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Dialog{visibility:hidden;transition:visibility 0s linear 267ms}"}])}],Array(24),[function(e,t,n){"use strict";var r='<div class="od-DialogHost">\x3c!--ko with:dialog--\x3e\x3c!--ko component:{name:$component.dialogOverlayTagName,params:{dialog:$component.dialog}}--\x3e\x3c!--ko if:$component.isStandard--\x3e\x3c!--ko component:{name:$component.standardDialogTagName,params:{}}--\x3e\x3c!--ko if:!!component--\x3e\x3c!--ko with:component--\x3e\x3c!--ko component:$data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:!!control--\x3e\x3c!--ko control:control--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot:$component.isStandard--\x3e\x3c!--ko with:component--\x3e\x3c!--ko component:$data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>',i=n(170);Object(i.n)([{rawString:".od-DialogHost{display:none}"}]);var s=n(2099),o=n(0),u=n(2044),a=(n(2260),n("knockout-lib")),f=n(265),l=n(371),c=n(1118),h=n(2500),p=n(2085),d=n(2075),v=n(2058),m=n(2083),g=n(2062),y=n(2092),b=n(2104),w=n(2228),E=n(2110),S=(function(e){Object(o.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({dismiss:d.e,automation:w.e,element:g.e,focusTrap:m.e,interactionScope:E.t,preserveFocus:b.e,recoverFocus:y.e,host:p.e});n.dialog=t.dialog;n.overlayComponent=n.createPureComputed(n._computeOverlayComponent);n.contentRoot=a.observable();n._launchPoint=new f.e(-1,-1);n.isVisible=a.observable(!1);n.title=n.createObservable(n.dialog().title());n.dialogStyle=n.createComputed(n._computeDialogStyle);n.sizeClass=n.createComputed(n._computeSizeClass);n.styleClass=n.createComputed(n._computeStyleClass);return n}t.prototype.dismiss=function(){var e=this.dialog();if(e&&e.isDismissable){e.dismiss();return!1}return!0};t.prototype._computeOverlayComponent=function(){var e=this.dialog();return{name:s.e.tagName,params:{animation:{beforeRemove:500},alignToParent:e.isCallout}}};t.prototype._computeDialogStyle=function(){var e=this.dialog(),t={};if(e){if(this.unwrapObservable(e.calloutHeight)&&e.isCallout){this.ensureLaunchPointCalculated();t.left=this._launchPoint.x+"px";t.top=this._launchPoint.y+"px"}}else{t.left="-1000px";t.top="-1000px"}e.isCallout&&!this.unwrapObservable(e.calloutHeight)||this.isVisible(!0);return t};t.prototype.ensureLaunchPointCalculated=function(){var e=this.dialog.peek().invokerEvent;if(e&&this.contentRoot()){var t=this.contentRoot().getBoundingClientRect(),n=e.clientX,r=e.clientY;if(n<=0&&r<=0||!n&&!r){var i=e.target.getBoundingClientRect();n=i.left;r=i.bottom}var s=l.e.isRightToLeft?n-t.width:n,o=r,u=new c.e(s,o,t.width,t.height),a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,f=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,h=new c.e(0,0,a,f),p=u.nudge(h);this._launchPoint.x=p.getLeft();this._launchPoint.y=p.getTop()}};t.prototype._computeSizeClass=function(){return v.e.determineCssClass(this.dialog().size)};t.prototype._computeStyleClass=function(){return h.e[this.dialog().style]};return t})(u.t),x=n(2045),T=x.e({tagName:"od-dialog-overlay",template:"<div class=\"od-DialogOverlay\" data-bind=\"css:{'is-active':dialog}\">\x3c!--ko with:dialog--\x3e\x3c!--ko component:$component.overlayComponent--\x3e<div class=\"od-Dialog\" data-bind=\"css:{'od-Dialog--close':isDismissable},focusTrap:{}\"><div class=\"ms-ModalOverlay\" data-bind=\"visible:!isCallout&&!isOverlayHidden,style:{backgroundColor:overlayColor}\"></div><div class=\"od-Dialog-main\" tabindex=\"-1\" role=\"dialog\" data-bind=\"interactionScope:{isScope:true},preserveFocus:shouldPreserveFocus,recoverFocus:{isEnabled:$host.isOpen},dismiss:{isEnabled:isSoftDismissable,close:isDismissable&&$component.dismiss.bind($component),dismissOnScroll:isDismissableOnScroll,dismissOnResize:isDismissableOnResize},class:'od-Dialog-main--'+$component.sizeClass()+' '+'od-Dialog-main-style--'+$component.styleClass()+(customCssClasses?' '+customCssClasses:''),css:{'od-Dialog-main--allowPanel':!stayAsPopup,'od-Dialog-main--callout':isCallout,'od-Dialog-main--dialog':!isCallout,'od-Dialog-main--visible':$component.isVisible()},automation:automationId,style:$component.dialogStyle,attr:{'aria-labelledby':'od-Dialog-title','aria-describedby':'od-Dialog-content'},element:$parent.contentRoot\"><div class=\"od-Dialog-content\" data-bind=\"host:{}\"></div></div></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>",viewModel:S,synchronous:!0}),N=n(2064);Object(i.n)([{rawString:".od-Link{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none;cursor:pointer;outline:0}.od-Link:focus,.od-Link:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.od-Link:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Link[disabled]{cursor:default;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-Dialog-actionsLoading{display:inline-block;padding-bottom:7px;vertical-align:bottom}[dir=ltr] .od-Dialog-actionsLoading{padding-right:5px}[dir=rtl] .od-Dialog-actionsLoading{padding-left:5px}.od-Dialog-main--callout .od-Dialog-inner{padding:0}.od-Dialog-main--callout .od-Dialog-header{padding:0}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions{position:absolute;top:0;left:0;right:0;margin-top:0;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";padding:0 10px 0 0;height:44px}html[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions,html[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions{padding:0 0 0 10px}html[dir=ltr] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions .od-Dialog-actionsRight,html[dir=ltr] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions .od-Dialog-actionsRight{float:left}html[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions .od-Dialog-actionsRight,html[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions .od-Dialog-actionsRight{float:right}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions .ms-Icon--Save,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions .ms-Icon--Save{font-size:20px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{background:0 0;height:44px}[dir=ltr] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,[dir=ltr] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{padding-right:16px}[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{padding-left:16px}[dir=ltr] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,[dir=ltr] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{padding-left:16px}[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{padding-right:16px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action .od-Button-icon,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action .od-Button-icon{display:inline-block;margin-top:5px;margin-right:6px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action .od-Button-label,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action .od-Button-label{font-weight:400;font-size:14px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action:hover,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action:hover{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-header,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-header{padding:48px 16px 0 16px}html[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-header,html[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-header{padding:48px 16px 0 16px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-inner,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-inner{padding:16px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button:disabled .od-Button-icon,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button:disabled .od-Button-icon{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button:disabled .od-Button-label,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button:disabled .od-Button-label{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--back{padding:5px 10px 5px 0;background:0 0;border:0;cursor:pointer}html[dir=rtl] .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--back{padding:5px 0 5px 10px}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--back .ms-Icon.ms-Icon--Back{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:16px}.ms-Dialog-button--close{position:absolute;top:12px;background:0 0;border:none;cursor:pointer}[dir=ltr] .ms-Dialog-button--close{right:8px}[dir=rtl] .ms-Dialog-button--close{left:8px}.ms-Dialog-button--close .ms-Icon{font-size:16px}.od-Dialog-header{position:relative;width:100%;box-sizing:border-box;word-wrap:break-word;padding:24px 40px 0 24px}.od-Dialog-header .od-Dialog-title{margin:0;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";display:inline;font-size:"},{theme:"xLargeFontSize",defaultValue:"20px"},{rawString:";font-weight:"},{theme:"xLargeFontWeight",defaultValue:"600"},{rawString:"}.od-Dialog-header .od-Dialog-title .od-Dialog-titleIcon::after{content:''}[dir=ltr] .od-Dialog-header .od-Dialog-title .od-Dialog-titleIcon::after{margin-right:16px}[dir=rtl] .od-Dialog-header .od-Dialog-title .od-Dialog-titleIcon::after{margin-left:16px}.od-Dialog-header .od-Dialog-title .od-Dialog-titleIcon .od-IconGlyph{display:inline-block;top:8px;font-size:28px}.od-Dialog-header.od-Dialog-header--large{padding:30px 20px;margin-bottom:10px;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Dialog-header.od-Dialog-header--large .od-Dialog-title{font-weight:100;font-size:28px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-Dialog-inner{height:100%;padding:18px 24px 24px}.od-Dialog-actions{position:relative;width:100%;height:32px;margin-top:24px;zoom:1}.od-Dialog-actions::after,.od-Dialog-actions::before{display:table;content:'';line-height:0}.od-Dialog-actions::after{clear:both}.od-Dialog-action .od-Button-icon{display:none}.od-Dialog-action.od-Dialog-action--link{border:0;cursor:pointer;box-sizing:border-box;box-shadow:none;margin:0;padding:0;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none;cursor:pointer;outline:0;padding:0 0 0 4px;background:0 0}.od-Dialog-action.od-Dialog-action--link:focus,.od-Dialog-action.od-Dialog-action--link:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.od-Dialog-action.od-Dialog-action--link:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Dialog-action.od-Dialog-action--link[disabled]{cursor:default;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}html[dir=rtl] .od-Dialog-action.od-Dialog-action--link{padding:0 4px 0 0}.od-Dialog-action.od-Dialog-action--link .od-Button-label{font-weight:400;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Dialog-action.od-Dialog-action--link:hover .od-Button-label{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.sm .od-Dialog-action .od-Button-label{font-size:12px}html[dir=ltr] .od-Dialog-actionsRight{float:right}html[dir=rtl] .od-Dialog-actionsRight{float:left}[dir=ltr] .od-Dialog-actionsRight .od-Dialog-action:not(:last-child){margin-right:8px}[dir=rtl] .od-Dialog-actionsRight .od-Dialog-action:not(:last-child){margin-left:8px}html[dir=ltr] .od-Dialog.od-Dialog--lgHeader .od-Dialog-actionsRight{float:right}html[dir=rtl] .od-Dialog.od-Dialog--lgHeader .od-Dialog-actionsRight{float:left}[dir=ltr] .od-Dialog.od-Dialog--lgHeader .od-Dialog-actionsRight .od-Dialog-action:not(:last-child){margin-right:15px}[dir=rtl] .od-Dialog.od-Dialog--lgHeader .od-Dialog-actionsRight .od-Dialog-action:not(:last-child){margin-left:15px}"}]);var C=n(2061),k=n(259),L=n(31),A=Object(k.e)({eventName:"DialogAction,",shortEventName:"DialogAction"},{dialogName:L.e.String,actionName:L.e.String}),O=n(2539),M=n(2131),_=n(2356),D=(function(e){Object(o.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.loadingSpinnerTagName=M.e.tagName;n.iconGlyphTagName=_.e.tagName;n.addBindingHandlers({keyboard:C.e,automation:w.e,host:p.e,element:g.e});n.closeLabel=O.e;n.dialog=n.resources.consume(N.e).currentDialog;n.actionButton=n.observables.create(null);n.createComputed(function(){var e=n.actionButton();e&&n.dialog.peek().focusOnPrimaryAction&&e.focus()});return n}t.prototype.dismiss=function(){var e=this.dialog();if(e&&e.isDismissable){e.dismiss();return!1}return!0};t.prototype.executeDefaultAction=function(){var e=this.dialog();if(e&&e.executeDefaultAction){var t=a.utils.arrayFirst(e.actions,function(e){return e.isDefault});if(t){this._logEvent(t);return this.execute(t)}}return!0};t.prototype.execute=function(e){var t=this.dialog();if(t&&e.isAvailable()){e.isExecuting(!0);this._logEvent(e);e.execute().done(function(n){e.isExecuting(!1);t.state(n)});return!1}return!0};t.prototype._logEvent=function(e){var t=this.dialog.peek();e.instrumentationId&&t.instrumentationId&&A.logData({actionName:e.instrumentationId,dialogName:t.instrumentationId})};return t})(u.t),P=x.e({tagName:"od-standard-dialog",template:'\x3c!--ko with:dialog--\x3e<div data-bind="keyboard:{allowInputEvents:true,allowButtonEvents:false,mappings:{Enter:$component.executeDefaultAction.bind($component)}},css:\'od-StandardDialog\'"><div class="od-Dialog-header od-Dialog-header--s"><p class="od-Dialog-title" id="od-Dialog-title" data-bind="attr:{\'aria-label\':title}" role="heading" aria-level="1">\x3c!--ko if:titleAction&&titleAction.isVisible()--\x3e<button class="od-Dialog-button od-Dialog-button--back" data-bind="attr:{\'aria-label\':titleAction.name,title:titleAction.name},click:titleAction.execute">\x3c!--ko if:titleAction.icon--\x3e<span data-bind="component:{name:$component.iconGlyphTagName,params:{icon:titleAction.icon}}"></span>\x3c!--/ko--\x3e</button>\x3c!--/ko--\x3e\x3c!--ko if:titleIcon&&!titleAction--\x3e<span class="od-Dialog-titleIcon" data-bind="component:{name:$component.iconGlyphTagName,params:{icon:titleIcon}},attr:{\'aria-label\':titleIconAriaLabel}"></span>\x3c!--/ko--\x3e\x3c!--ko text:title--\x3e\x3c!--/ko--\x3e</p></div><div class="od-Dialog-inner"><div class="od-Dialog-content" id="od-Dialog-content" data-bind="host:{}"></div>\x3c!--ko if:actions.length&&actionsVisible--\x3e<div class="od-Dialog-actions" data-bind="automation:\'actionsSection\'"><div class="od-Dialog-actionsRight" data-bind="foreach:actions">\x3c!--ko if:isVisible--\x3e<button class="od-Dialog-action" data-bind="css:{\'od-Button--primary\':isDefault,\'od-Button\':!isLink,\'od-Dialog-action--link\':isLink},click:$component.execute.bind($component),enable:isAvailable,automation:automationId,element:$component.actionButton">\x3c!--ko if:icon--\x3e<span class="od-Button-icon" data-bind="component:{name:$component.iconGlyphTagName,params:{icon:icon}}"></span>\x3c!--/ko--\x3e<span class="od-Button-label" data-bind="text:name"></span></button>\x3c!--/ko--\x3e\x3c!--ko if:isVisible()&&isExecuting()--\x3e<div class="od-Dialog-actionsLoading" data-bind="component:{name:$component.loadingSpinnerTagName,params:{loadingText:\'\'}}"></div>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e</div><button class="od-Dialog-button od-Dialog-button--close" data-bind="attr:{\'aria-label\':$component.closeLabel,title:$component.closeLabel},click:isDismissable&&$component.dismiss.bind($component)"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button></div>\x3c!--/ko--\x3e',viewModel:D}),H=n(2049),B=(function(e){Object(o.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.addBindingHandlers({control:H.r});r.dialog=r.resources.consume(N.e).currentDialog;r.dialogOverlayTagName=T.tagName;r.standardDialogTagName=P.tagName;r.isStandard=r.createPureComputed(r._computeIsStandard);r.hasDialog=r.createPureComputed(r._computeHasDialog);return r}t.prototype._computeIsStandard=function(){var e=this.dialog();return e&&1===e.template};t.prototype._computeHasDialog=function(){return!!this.dialog()};return t})(u.t),j=x.e({tagName:"od-dialog-host",template:r,viewModel:B,synchronous:!0});t.e=j,Object(H.n)({name:"DialogHost",template:r,automationName:"od-dialog-host",viewModelType:B})},,,,,,,function(e,t,n){"use strict";n.d(t,"a",function(){return w});n.d(t,"f",function(){return S});n.d(t,"r",function(){return T});n.d(t,"i",function(){return N});n.d(t,"t",function(){return k});n.d(t,"o",function(){return L});n.d(t,"u",function(){return A});var r,i,s,o,u,a=n(812),f=n(2056),l=n(2055),c=n(1822);n.d(t,"e",function(){return c.e});n.d(t,"n",function(){return c.t});n.d(t,"s",function(){return c.n});n.d(t,"l",function(){return c.r});n.d(t,"c",function(){return c.i});n.d(t,"h",function(){return c.s});var h="ms-word",p="onenote|UsePlain",d="ms-powerpoint",v="ms-excel",m="ms-visio",g="ms-publisher",y="ms-project",b=((r={})[h]=l.OpenInWordOnline,r[p]=l.OpenInOneNoteOnline,r[d]=l.OpenInPowerPointOnline,r[v]=l.OpenInExcelOnline,r[m]=l.OpenInVisioOnline,r);function w(e){return b[e]||""}var E=((i={})[h]=l.OpenInWord,i[p]=l.OpenInOneNote,i[d]=l.OpenInPowerPoint,i[v]=l.OpenInExcel,i[m]=l.OpenInVisio,i[g]=l.OpenInPublisher,i[y]=l.OpenInProject,i["ms-infopath"]=l.OpenInInfoPath,i);function S(e){return E[e]}var x=((s={})[h]="Word",s[p]="OneNote",s[d]="PowerPoint",s[y]="Project",s[m]="Visio",s[v]="Excel",s);function T(e){var t=e.extension;return t&&".pdf"===t.toLowerCase()?"WordPdf":x[e.appMap]||"Word"}function N(e){return x[e]}(o={})[h]="WordLogo",o[p]="OneNoteLogo",o[d]="PowerPointLogo",o[v]="ExcelLogo",o[m]="VisioLogo",o[g]="Page";var C=((u={})[h]="svg/word_16x1.svg",u[p]="svg/onenote_16x1.svg",u[d]="svg/powerpoint_16x1.svg",u[v]="svg/excel_16x1.svg",u[m]="svg/visio_16x1.svg",u[g]="Page",u),k={"svg/word_16x1.svg":"svg/word_white_stroke_18x1.svg","svg/onenote_16x1.svg":"svg/onenote_white_stroke_18x1.svg","svg/powerpoint_16x1.svg":"svg/powerpoint_white_stroke_18x1.svg","svg/excel_16x1.svg":"svg/excel_white_stroke_18x1.svg","svg/visio_16x1.svg":"svg/visio_white_stroke_18x1.svg"};function L(e){var t=C[e];return t&&new f.e(t)}function A(e){var t=a.e;return-1!==t["ms-word"].lastIndexOf(e)?"ms-word":-1!==t["ms-powerpoint"].lastIndexOf(e)?"ms-powerpoint":-1!==t["ms-excel"].lastIndexOf(e)?"ms-excel":-1!==t["ms-visio"].lastIndexOf(e)?"ms-visio":-1!==t["onenote|UsePlain"].lastIndexOf(e)?"onenote|UsePlain":-1!==t["ms-access"].lastIndexOf(e)?"ms-access":-1!==t["ms-project"].lastIndexOf(e)?"ms-project":-1!==t["ms-publisher"].lastIndexOf(e)?"ms-publisher":void 0}}],Array(19),[function(e,t,n){"use strict";var r=n(170);Object(r.n)([{rawString:".od-OverlayHost{position:absolute;z-index:600;top:0;left:0;bottom:0;right:0;visibility:hidden;overflow:hidden}.od-OverlayHost-content{visibility:visible}.od-OverlayHost-overlay--positioned{position:absolute}"}]);var i='\x3c!--ko focusTrap:{invert:true,isEnabled:hasOverlays}--\x3e<div class="od-OverlayHost" data-bind="clientRect:{size:clientRect,includePosition:true},component:{name:\'od-transclusion-host\',params:{provider:overlayProvider,useCustomTemplate:true}}">\x3c!--ko template:{foreach:getOverlaysInDomOrder.call($component,$host.contexts()),if:isReady,afterAdd:$component.onAddOverlayElement.bind($component),beforeRemove:$component.onRemoveOverlayElement.bind($component)}--\x3e<div class="od-OverlayHost-overlay" data-bind="css:{\'od-OverlayHost-overlay--positioned\':$component.isPositioned(options),\'od-OverlayHost-overlay--initial\':$component.isInitial.peek(),\'od-OverlayHost-overlay--opened\':options.animation&&options.animation.isOpen&&options.animation.isOpen(),\'od-OverlayHost-overlay--closed\':options.animation&&options.animation.isOpen&&!options.animation.isOpen()},style:$component.getOverlayStyle(options,parentElement)"><div class="od-OverlayHost-content" data-bind="focusTrap:{before:options.topTab,after:options.bottomTab}">\x3c!--ko transclusionHost:{context:$data,virtualChildElement:$element.parentNode}--\x3e\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e',s=(n(2251),n(2045)),o=n(0),u=n("knockout-lib"),a=n(2044),f=n(2501),l=n(1250),c=n(2202),h=n(2083),p=n(2125),d=n(2106),v=n(224),m=u.utils.toggleDomNodeCssClass,g=u.removeNode;function y(e){for(var t,n=[];(t=Object(v.e)(e))&&t.children;){var r=Array.prototype.indexOf.call(t.children,e);n.unshift(r);e=t}return n}function b(e,t){return(function(e,t){for(var n=0;n<e.length&&n<t.length;n++){if(e[n]<t[n])return-1;if(e[n]>t[n])return 1}return e.length<t.length?-1:e.length>t.length?1:0})(e.shadowPosition,t.shadowPosition)}var w=(function(e){Object(o.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.addBindingHandlers({transclusionHost:c.e,focusTrap:h.e,clientRect:p.e});r._onAddOverlay=t.onAddOverlay;r._onRemoveOverlay=t.onRemoveOverlay;var i=r.observables;r.overlayProvider=r.resources.consume(f.e);r.hasOverlays=i.pureCompute(r._computeHasOverlays);r.topTab=i.create();r.bottomTab=i.create();r.isReady=i.create(!1);r.isInitial=i.create(!0);r.clientRect=i.create();r.async.requestAnimationFrame(r._onIsReadyTimeoutCompleted);return r}t.prototype.onAddOverlayElement=function(e,t,n){var r=this,i=n.options.animation,s=i&&i.afterAdd;if(void 0===(i&&i.isOpen))if(s)this.async.setTimeout(function(){if(e.nodeType===Node.ELEMENT_NODE){m(e,"od-OverlayHost-overlay--opened",!0);m(e,"od-OverlayHost-overlay--initial",!1)}n.options.isOpen(!0);r._onAddOverlay&&r._onAddOverlay()},s);else{if(e.nodeType===Node.ELEMENT_NODE){m(e,"od-OverlayHost-overlay--opened",!0);m(e,"od-OverlayHost-overlay--initial",!1)}n.options.isOpen(!0);this._onAddOverlay&&this._onAddOverlay()}else this._onAddOverlay&&this._onAddOverlay()};t.prototype.onRemoveOverlayElement=function(e,t,n){var r=this,i=n.options.animation,s=i&&i.beforeRemove;if(void 0===(i&&i.isOpen))if(s){if(e.nodeType===Node.ELEMENT_NODE){m(e,"od-OverlayHost-overlay--initial",!1);m(e,"od-OverlayHost-overlay--opened",!1);m(e,"od-OverlayHost-overlay--closed",!0)}n.options.isOpen(!1);this.async.setTimeout(function(){g(e);r._onRemoveOverlay&&r._onRemoveOverlay()},s)}else{n.options.isOpen(!1);g(e);this._onRemoveOverlay&&this._onRemoveOverlay()}else this._onRemoveOverlay&&this._onRemoveOverlay()};t.prototype.getOverlaysInDomOrder=function(e){var t=e.map(function(e){return{overlay:e,shadowPosition:y(e.parentElement)}});t.sort(b);return t.map(function(e){return e.overlay})};t.prototype.isPositioned=function(e){return e.alignToParent()};t.prototype.getOverlayStyle=function(e,t){if(!this.isPositioned(e))return{};var n=this.clientRect(),r=l.e.calculateRect(e.parentElement||t);e.parentElement||0!==r.x||(r=d.e.calculateParentRect(t,r));return n?{top:"".concat(r.getTop()-n.top,"px"),left:"".concat(r.getLeft()-n.left,"px"),right:"".concat(n.width-r.getRight(),"px"),bottom:"".concat(n.height-r.height,"px")}:void 0};t.prototype._onIsReadyTimeoutCompleted=function(){this.isReady(!0);this.isInitial(!1)};t.prototype._computeHasOverlays=function(){return this.overlayProvider.contexts().length>0};return t})(a.t),E=n(2049),S=s.e({tagName:"od-overlay-host",template:i,viewModel:w,synchronous:!0});t.e=S,Object(E.n)({name:"OverlayHost",template:i,automationName:"od-overlay-host",viewModelType:w})},,,,,,,function(e,t,n){"use strict";var r=n(43),i=function(e){void 0===e&&(e="");this.isDropEnabled=!1;this.permissions={High:0,Low:0};this.key=e;this.revision=0;this.queryType=r.e.Files;this.displayType=r.e.Files;this.isPlaceholder=!0;this.properties={};this.recycleBinProperties={};this.reputationProperties={};this.statistics={views:0,viewsUnique:0,viewsLast2Weeks:0,viewsLast2WeeksUnique:0,viewsLastWeek:0,viewsLastWeekUnique:0,viewsLastMonth:0,viewsLastMonthUnique:0};this.urls={};this.state={upload:{status:5},removing:!1}};t.e=i},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(107),i=n(341),s="formFactorChange",o="hamburgerVisibilityChange",u="showCommandLabelsChange",a={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},f={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0},l=(function(){function e(e,t){this._scope=new i.e;this._events=new(this._scope.attached(r.t))(this);this._events.on(window,"resize, orientationchange",this._onContainerResize.bind(this));var n=t.breakpoints;this._breakpoints="function"==typeof n?n:function(){return n};this._windowWidth=0;this._windowHeight=0;this._onContainerResize()}e.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}};e.determineWindowSize=function(e,t){void 0===t&&(t=f);if(0===e)return"Medium";for(var n in f)if(e<t[n])return n};e.determineCssClass=function(e){return a[e]};e.getScrollbarWidth=function(){var e=document.createElement("div"),t=document.createElement("div"),n=e.style;n.visibility="hidden";n.width="100px";n.msOverflowStyle="scrollbar";n.overflow="scroll";t.style.width="100%";document.body.appendChild(e);e.appendChild(t);var r=e.offsetWidth,i=t.offsetWidth;e.parentNode.removeChild(e);var s=r-i;this.getScrollbarWidth=function(){return s};return s};Object.defineProperty(e.prototype,"windowWidth",{get:function(){return this._windowWidth},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"windowHeight",{get:function(){return this._windowHeight},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"formFactorSize",{get:function(){return this._formFactorSize},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"isHamburgerVisible",{get:function(){return this._isHamburgerVisible},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"showLabels",{get:function(){return this._showLabels},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"cssClass",{get:function(){return this._cssClass},enumerable:!1,configurable:!0});e.prototype.dispose=function(){this._scope.dispose()};e.prototype.compareSize=function(e,t){var n=this._breakpoints();return n[e]-n[t]};e.prototype._afterContainerResize=function(){};e.prototype._onContainerResize=function(){var t=document.body,n=document.documentElement,r=this._windowHeight=n.clientWidth||t.clientWidth;this._windowWidth=n.clientHeight||t.clientHeight;var i=this._formFactorSize,a=this._formFactorSize=e.determineWindowSize(r,this._breakpoints());this._cssClass=e.determineCssClass(a);var l=this._isHamburgerVisible;this._isHamburgerVisible=r<f.Large;var c=this._showLabels;this._showLabels=this.compareSize(a,"Medium")>0;i&&a!==i&&this._events.raise(s);"boolean"==typeof l&&l!==this._isHamburgerVisible&&this._events.raise(o);"boolean"==typeof c&&c!==this._showLabels&&this._events.raise(u);this._afterContainerResize()};e.DEFAULT_BREAKPOINTS=f;e.MAC_SCROLL_BAR_WIDTH=8;return e})();t.t=l},function(e,t,n){"use strict";n.d(t,"t",function(){return o});var r=n(0),i=n(2044),s=n(63);function o(e){if(!e)return{resultCode:"unknown",resultType:s.e.Failure};var t=e.correlationId;return{resultCode:e.code||e.name,resultType:e.isExpected?s.e.ExpectedFailure:s.e.Failure,error:e.message||"".concat(e),extraData:t?{CorrelationId:t}:{}}}var u=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.slide=t.slide;r.oneUp=t.oneUp;return r}return t})(i.t);t.e=u},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return v});n.d(t,"t",function(){return m});var r=n(0),i=n(1121),s=n(2064),o=n(2124),u=n(91),a=n(2055),f=n(3651),l=n(2056),c=n(171),h=n(598),p=n(119),d=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._dialogProvider=n.dialogProvider;r._promiseTracker=n.promiseTracker;r._itemSetSelectionModel=n.itemSetSelectionModel;return r}t.prototype.resolveSelection=function(){var e,t,n=this.createObservable(f.e),r=this.createObservable(!0),i=this.createObservable(!1),s=this._shouldShowDialog();if(this._itemSetSelectionModel){t=this._itemSetSelectionModel.resolveSelection().then(function(t){s=!1;e&&e.state(2);return t},function(t){if(e){n(f.t);r(!1);i(!0)}return u.n.wrapError(t)});s&&(e=this._createDialog(n,r,i)).wait().done(void 0,function(){t.cancel()});this._promiseTracker&&this._promiseTracker.registerPromise(t)}else t=u.n.wrap([]);return t};t.prototype._createDialog=function(e,t,n){return this._dialogProvider.requestDialog({title:f.n,isDismissable:!1,component:{name:o.e.tagName,params:{text:e}},actions:[{name:a.cancelActionText,execute:function(){return u.n.wrap(3)},isVisible:t,icon:new l.e("Cancel"),isDefault:!0},{name:a.ok,execute:function(){return u.n.wrap(3)},isVisible:n,icon:new l.e("Cancel"),isDefault:!0}]})};t.prototype._shouldShowDialog=function(){for(var e=0,t=this._itemSetSelectionModel.selection.peek();e<t.length;e++){var n=t[e];if(!this.peekUnwrapObservable(n))return!0}return!1};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.default.dependencies),{dialogProvider:s.e,promiseTracker:c.M.optional,itemSetSelectionModel:c.k});return t})(i.default);function v(e,t){void 0===t&&(t=!1);var n=e.selection();if(1===n.length){var r=Object(h.i)(n[0]);return t&&r.video?r.appMap?r.appMap:"Stream":r.appMap?r.appMap:"nonOfficeApp"}}var m=Object(p.s)("SelectionHelper",d)},function(e,t,n){"use strict";n.d(t,"r",function(){return r});n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});n.d(t,"n",function(){return o});var r;(function(e){e[e.NotCreated=-1]="NotCreated";e[e.Created=0]="Created";e[e.BubbleShown=1]="BubbleShown";e[e.FreShown=2]="FreShown"})(r||(r={}));var i="oneDriveVault",s="canary",o=3}],Array(13),[function(e,t,n){"use strict";var r=n(2045),i=n(0),s=n(2044),o=n(171),u=n(2191),a=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._item=n.wrapObservable(t.item);n.name=n.createPureComputed(n._computeName);var r=n.resources.consume(o.e);n.open=new(n.managed(r.OpenAction))({openRelation:2,item:n._item});return n}t.prototype.execute=function(e,t){if(e.isAvailable()){e.execute(t).done();return!1}};t.prototype._computeName=function(){var e=this._item();return e&&(e.displayName||e.name)||u.fileTypeFolder.toLocaleLowerCase()};return t})(s.t),f=r.e({tagName:"od-item-link",template:'\x3c!--ko with:open--\x3e\x3c!--ko if:isAvailable--\x3e<a class="od-ItemLink" href="#" data-bind="click:$component.execute.bind($component),text:$component.name"></a>\x3c!--/ko--\x3e\x3c!--ko ifnot:isAvailable--\x3e<span class="od-ItemLink" data-bind="text:$component.name"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e',viewModel:a,synchronous:!0});t.e=f},,,,,,,,,function(e,t,n){"use strict";var r=n(0),i=n(2044),s=n("knockout-lib"),o=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.icon=s.isObservable(t.icon)?t.icon:s.observable(t.icon);n.badge=s.isObservable(t.badge)?t.badge:s.observable(t.badge);n.iconClasses=n.createComputed(function(){return n.icon()&&n.icon().getClass()||""});n.badgeClasses=n.createComputed(function(){return n.badge()&&n.badge().getClass()||""});return n}return t})(i.t),u=n(2045).e({tagName:"od-icon-glyph",template:"<i class=\"od-IconGlyph\" data-bind=\"class:iconClasses,attr:{'data-icon-name':icon},css:{'od-IconGlyph--badged':badge,'od-IconGlyph--visible':icon},with:badge\"><i class=\"od-IconGlyph-badge\" data-bind=\"class:$component.badgeClasses,attr:{'data-icon-name':$component.badge}\"></i></i>",viewModel:o,synchronous:!0});t.e=u},,,,,,,function(e,t,n){"use strict";var r=n(1356);n.d(t,"e",function(){return r.e});n.d(t,"t",function(){return r.t});n.d(t,"n",function(){return r.n})}],Array(17),[function(e,t,n){"use strict";var r=n(968);n.d(t,"e",function(){return r.e});n.d(t,"t",function(){return r.t});n.d(t,"n",function(){return r.r})},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(7),i=n(1121),s=n(1274),o=n(912),u=new r.t({name:"".concat("isOfflineStateLegacyKOObservable.key",".isOfflineStateLegacyKOObservable"),factory:{dependencies:{observablesFactoryTypeKey:i.observablesFactoryTypeResourceKey,isOfflineStateObservable:s.e},create:function(e){var t=e.isOfflineStateObservable,n=new o.e,r=n.attach(new e.observablesFactoryTypeKey).create(t.get());n.attach({dispose:t.subscribe(function(){r(t.get())})});return{instance:r,disposable:n}}}})},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.notConfigured=0]="notConfigured";e[e.visible=1]="visible";e[e.notVisible=2]="notVisible"})(r||(r={}))},function(e,t,n){"use strict";n.r(t);n.d(t,"disabledCampaign",function(){return d});n.d(t,"resourceKey",function(){return m});var r=n(0),i=n(33),s=n(1121),o=n(119),u=n(183),a=n(100),f=n(140),l=n(181),c=n(2431),h=n(2394),p=n(60),d={campaignGuid:"00000000-0000-0000-0000-000000000000",endDate:new Date(1970,1,1),flag:i.Off,isCoachmark:!0},v=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._dataStore=new u.e("CoachmarkProvider",a.e.session);r._currentCampaign=r.createObservable(d);r._isVisible=r.createObservable(!1);r._navigation=n.navigation;r._firstRunExperienceStatus=n.firstRunExperienceStatus;r._currentTeachingBubble=r.createObservable({campaign:r._currentCampaign,isVisible:r._isVisible});r._navigation.viewParams.resetAllBubbles&&r._dataStore.remove("CoachmarkTearDropSeen");var i=r.resources.consume(p.e);r._teachingBubbleProviderPromise=i.waitForPLT().then(function(){return r.resources.consume(l.C)});return r}Object.defineProperty(t.prototype,"isVisible",{get:function(){return this._isVisible},enumerable:!1,configurable:!0});Object.defineProperty(t.prototype,"currentCampaign",{get:function(){return this._currentCampaign},enumerable:!1,configurable:!0});t.prototype.hideCampaign=function(){this._isVisible(!1);this._currentCampaign(d)};t.prototype.setCampaign=function(e){var t=this;if(e){if(this._firstRunExperienceStatus.get()!==h.e.visible){var n="".concat(e.name).concat("CoachmarkTearDropSeen");this._dataStore.getValue("CoachmarkTearDropSeen")||this._teachingBubbleProviderPromise.then(function(r){r&&r.shouldBubbleBeAdded(e,!1).then(function(r){if(r){t._currentCampaign(e);t._isVisible(!0);t._dataStore.setValue(n,!0)}})})}}else{this._currentCampaign(d);this._isVisible(!1)}};t.prototype.getCurrentTeachingBubble=function(){return this._currentTeachingBubble};t.dependencies=Object(r.__assign)(Object(r.__assign)({},s.default.dependencies),{navigation:f.e,firstRunExperienceStatus:c.e});return t})(s.default);t.default=v;var m=Object(o.s)("CoachmarkProvider",v)},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(1121),i=new(n(7).t)({name:"".concat("UserStateProvider.key",".updateQuota"),factory:{dependencies:{observablesFactoryType:r.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},,function(e,t,n){"use strict";var r=n(91),i=n(334),s=(function(){function e(e){this.concurrency=e||1;this._running=0;this._queue=[];this._promiseComplete=this._promiseComplete.bind(this)}e.prototype.enqueue=function(e){var t;if(this._running<this.concurrency){this._running++;(t=e()).then(this._promiseComplete,this._promiseComplete)}else{var n={callback:e,signal:null,canceled:!1,result:null};n.signal=new i.e(function(){n.canceled=!0;r.n.is(n.result)&&n.result.cancel()});this._queue.push(n);t=n.signal.getPromise()}return r.n.resolve(t)};e.prototype._promiseComplete=function(){var e=this;this._running--;if(this._running<this.concurrency&&this._queue.length){for(var t=this._queue.shift();t&&t.canceled;)t=this._queue.length?this._queue.shift():null;if(t){this._running++;t.result=t.callback();t.result.then(function(n){t.signal.complete(n);e._promiseComplete()},function(n){t.signal.error(n);e._promiseComplete()})}}};return e})();t.e=s}],Array(17),[function(e,t,n){"use strict";n.d(t,"n",function(){return x});n.d(t,"t",function(){return K});var r=n(1257),i=n(2522),s=n(18),o=n(2114),u=n(2056),a=n(2347),f=n(775),l=n(2333),c=n(13),h=n(0),p=n("react-lib"),d=n(2480);var v=s.format,m=s.pluralSelect;function g(e){return v(i.yr,Math.round(e.progress.current()/e.progress.maximum()*100))}function y(e){return v(i.Er,r.e.getDisplayString(e.progress.current()),r.e.getDisplayString(e.progress.maximum()))}var b=i.Je,w=i.ie;function E(e){return e.error()&&e.error().message||i.Ct}var S=i.M;function x(e,t){return"function"==typeof e?e(t):e}function T(e){return function(t){var n=t.error(),r=n&&n.payloads.upload&&n.payloads.upload.error;return x(r&&e[o.e[r.errorType]],r)||x(E,t)}}function N(e){return function(t){return v(e,r.e.getDisplayString(t.maxSizeInBytes),i.wr)}}var C,k=T({general:i.cn,fileSize:N(i.on),emptyFileOrFolder:i.ut,emptyFileOrFolderForDocLib:(C=i.at,function(e){return v(C,e.libraryName)}),overQuota:i.cr,overQuotaSharedFolder:i.dr,lockMismatch:i.En,accessDenied:i.y,unlockRequired:i.vs,insufficientVaultQuota:s.format(i.gn,l.n),invalidName:i.bn,pathTooLong:i.gr,conflict:function(e){return e.supportsVersioning?e.allowRename?i.ar:i.fr:e.allowRename?i.Be:i.Fe},folderUploadNotSupported:i.un,versionMismatch:i.cn,targetFolderMissing:i.os,authFailure:i.k,malwareDetected:i.Sn,throttled:i.us,disconnected:i.it}),L={general:i.ln,fileSize:N(i.sn),emptyFileOrFolder:i.ft,overQuota:i.cr,overQuotaSharedFolder:i.pr,lockMismatch:i.ln,accessDenied:i.g,invalidName:i.bn,pathTooLong:i.gr,conflict:i.ln,folderUploadNotSupported:i.ln,versionMismatch:i.jr},A={general:i.an,fileSize:N(i.rn),emptyFileOrFolder:i.an,overQuota:i.cr,overQuotaSharedFolder:i.hr,lockMismatch:i.an,accessDenied:i.m,invalidName:i.bn,pathTooLong:i.gr,conflict:i.an,folderUploadNotSupported:i.an,versionMismatch:i.Br},O=["","",i.zn];function M(e){return"<span data-bind=\"component: { name: '".concat(a.e.tagName,"', params: { item: ").concat(e,' } }"></span>')}function _(e){var t=e.payloads().shareItem;switch(t&&t.result){case 0:return i.ie;case 1:return i.ui;case-2:case-1:return i.oi;case void 0:return"";default:return E(e)}}function D(e){return e.states().completed?1===e.payloads().shareItem.result?i.ui:e.payloads().shareItem.items.length>1?v(i.li,e.payloads().shareItem.items.length):v(i.ci,f.e.encodeText(e.payloads().shareItem.items[0].name)):e.states().failed?H(e.payloads().shareItem.items.length,i.ai,i.fi):H(e.payloads().shareItem.items.length,i.Ns,i.Ts)}function P(e){var t=e.states();return t.completed+t.created+t.started}function H(e,t,n,r){return v(m(e,t,n),e,r)}function B(e,t,n){return function(r){return H(P(r),e,t,n)}}function j(e){return function(t){var n;return v(e,null===(n=t.payloads().modifySmartTemplate)||void 0===n?void 0:n.contentTypeName)}}function F(e,t,n){return function(r){return H(r.states().completed,e,t,n)}}function I(e,t,n){return function(r){var o=r.payloads().runModelOnItems,u=o.fileCount,a=o.folderCount;if(o.isKillSwitchActive)return H(P(r),e,t,n);var f=0===u?"":1===u?i.Zr:s.format(i.zr,u),l=0===a?"":1===a?i.Qr:s.format(i.Ur,a);return a>0?l:f}}function q(e,t,n){return function(r){return H(r.states().failed,e,t,n)}}function R(e,t,n){return function(r){return H(r.states().canceled,e,t,n)}}function U(e){return function(t){return v(e,f.e.encodeText(t.payloads().uploadItems.name))}}function z(e,t){return c.e.isActivated("36574CF5-480D-47E8-BF76-8C449F1CE451","09/22/2021","Allow unidentified flow instances to run in the widget")?function(t){return v(e,f.e.encodeText(t.payloads().triggerFlow.flowDisplayName))}:function(n){var r=n.payloads().triggerFlow.flowDisplayName;return t&&!r?t:v(e,f.e.encodeText(r))}}function W(e){return function(t){return v(e,f.e.encodeText(t.payloads().createColumn.name))}}function X(e){return function(t){return v(e,f.e.encodeText(t.payloads().editColumn.name))}}function V(e){return function(t){return v(e,f.e.encodeText(t.payloads().deleteColumn.name))}}function $(e){return function(t){return v(e,f.e.encodeText(t.payloads().downloadAsZip.fileName))}}function J(e,t){return function(n){return m(n.count(),e,t)}}function K(e){return e?O[e]:""}var Q,G,Y,Z=B(i.Ns,i.Ts),ee=F(i.He,i.Pe),te=q(i.nn,i.tn),ne=R(i.nn,i.tn),re={types:{multiple:{title:Z,shortTitle:Z,states:{created:{description:b},started:{description:function(e){var t=e.progress.current();return v(i.Er,t%1!=0?t.toFixed(2):t,e.progress.maximum())}},completed:{title:ee,shortTitle:ee,description:w},failed:{title:te,shortTitle:te,description:E},canceled:{title:ne,shortTitle:ne,description:S},expired:{description:""}}},renameItems:{title:B(i.Ji,i.$i),shortTitle:B(i.Ji,i.$i),states:{completed:{title:F(i.be,i.ye)},failed:{title:q(i.qt,i.It)},canceled:{title:R(i.qt,i.It)}}},requestReview:{title:B(i.Gi,i.Qi),shortTitle:B(i.Gi,i.Qi),states:{completed:{title:F(i.Se,i.Ee)},failed:{title:q(i.zt,i.Ut)},canceled:{title:R(i.zt,i.Ut)}}},reportAbuse:{title:function(e){return v(i.Ki,f.e.encodeText(e.payloads().reportAbuse.item.name))},shortTitle:i.Ki,states:{completed:{title:v(i.we,M("context.payloads().reportAbuse.item"))},failed:{title:v(i.Rt,M("context.payloads().reportAbuse.item"))},canceled:{title:v(i.Rt,M("context.payloads().reportAbuse.item"))}}},deleteItems:{title:B(i.Ze,i.Ge,M("context.payloads().deleteItems.parent")),shortTitle:B(i.Pi,i.Di),states:{completed:{title:F(i.re,i.ne,M("context.payloads().deleteItems.parent"))},failed:{title:q(i.Nt,i.Tt)},canceled:{title:R(i.Nt,i.Tt)}},actions:{undo:{mode:1},deleteLocked:{mode:1}}},deleteSmartTemplate:{title:j(i.nt),shortTitle:j(i.nt),states:{completed:{title:j(i.et)},failed:{title:j(i.tt)}}},publishSmartTemplate:{title:j(i.Nr),shortTitle:j(i.Nr),states:{completed:{title:j(i.xr)},failed:{title:j(i.Tr)}}},unpublishSmartTemplate:{title:j(i.ys),shortTitle:j(i.ys),states:{completed:{title:j(i.ms)},failed:{title:j(i.gs)}}},pointInTimeRestore:{title:i.br,shortTitle:i.br,states:{created:{description:b},started:{description:g},completed:{title:i.ce},failed:{title:i._t},canceled:{title:i.H}}},sharepointPointInTimeRestore:{title:i.di,shortTitle:i.gi,states:{created:{description:i.mi},started:{description:g},completed:{title:i.pi},failed:{title:i._t},canceled:{title:i.hi}}},downloadItem:{title:i.st,states:{failed:{title:i.fn}}},restoreItems:{title:B(i.Hr,i.Pr),shortTitle:B(i.Zi,i.Yi),states:{completed:{title:F(i.Te,i.xe)},failed:{title:q(i.Xt,i.Wt)},canceled:{title:R(i.Xt,i.Wt)}}},importModel:{title:i.Cn,shortTitle:i.Cn,states:{started:{description:y},completed:{title:i.Tn},failed:{title:i.Nn,description:k},canceled:{title:i.xn}}},runModelOnItems:{title:I(i.ei,i.$r),shortTitle:I(i.ei,i.$r),states:{started:{description:y},completed:{title:(Q=i.Gr,G=i.Xr,function(e){var t=e.payloads().runModelOnItems,n=t.fileCount,r=t.folderCount;if(t.isKillSwitchActive)return H(e.states().completed,Q,G,Y);var o=0===n?"":1===n?i.Jr:s.format(i.qr,n),u=0===r?"":1===r?i.Kr:s.format(i.Rr,r);return r>0?u:o})},failed:{title:q(i.Yr,i.Vr),description:k},canceled:{title:i.Wr}}},uploadItems:{title:B(i.xs,i.Ss,M("context.payloads().uploadItems.parent")),shortTitle:B(i.ss,i.is),states:{started:{description:y},completed:{title:F(i.De,i._e,M("context.payloads().uploadItems.parent"))},failed:{title:q(i.en,i.Zt),description:k},canceled:{title:R(i.en,i.Zt)}},actions:{cancel:{mode:3}}},moveItems:{title:B(i.sr,i.tr,M("context.payloads().moveItems.destination")),shortTitle:B(i.qi,i.Ii),states:{started:{description:g},completed:{title:F(i.le,i.fe,M("context.payloads().moveItems.destination"))},failed:{title:q(i.Mt,i.Ot)},canceled:{title:R(i.P,i.D)}},actions:{cancel:{mode:1}}},copyItems:{title:B(i.Xe,i.ze,M("context.payloads().copyItems.destination")),shortTitle:B(i.ki,i.Ci),states:{started:{description:g},completed:{title:F(i.K,i.J,M("context.payloads().copyItems.destination"))},failed:{title:q(i.bt,i.yt)},canceled:{title:R(i.O,i.A)}},actions:{cancel:{mode:1}}},rotateItems:{title:B(i.Ir,i.Fr),shortTitle:B(i.ts,i.es),states:{completed:{title:F(i.Ce,i.Ne)},failed:{title:q(i.$t,i.Vt)},canceled:{title:R(i.$t,i.Vt)}}},downloadAsZip:{title:i.ot,shortTitle:i.ot,states:{started:{title:$(i.Hi)},completed:{title:$(i.oe)},canceled:{title:$(i._)}}},applyOfficeLens:{title:B(i.C,i.N),shortTitle:B(i.Ni,i.Ti),states:{completed:{title:F(i.$,i.V)},failed:{title:q(i.gt,i.mt)},canceled:{title:R(i.gt,i.mt)}}},removeOfficeLens:{title:B(i.Ar,i.Lr),shortTitle:B(i.Vi,i.Xi),states:{completed:{title:F(i.ge,i.me)},failed:{title:q(i.Ft,i.jt)},canceled:{title:R(i.Ft,i.jt)}}},addItemsToAlbum:{title:B(i.T,i.x,M("context.payloads().addItemsToAlbum.album")),shortTitle:B(i.Ei,i.wi),states:{completed:{title:F(i.z,i.U,M("context.payloads().addItemsToAlbum.album"))},failed:{title:q(i.pt,i.ht)},canceled:{title:R(i.pt,i.ht)}}},addCoverPhotos:{title:B(i.w,i.b,M("context.payloads().coverPhotos.parent")),shortTitle:B(i.bi,i.yi),states:{completed:{title:F(i.R,i.q,M("context.payloads().coverPhotos.parent"))},failed:{title:q(i.ct,i.lt)},canceled:{title:R(i.ct,i.lt)}}},removeCoverPhotos:{title:B(i.kr,i.Cr,M("context.payloads().coverPhotos.parent")),shortTitle:B(i.Wi,i.zi),states:{completed:{title:F(i.ve,i.de,M("context.payloads().coverPhotos.parent"))},failed:{title:q(i.Bt,i.Ht)},canceled:{title:R(i.Bt,i.Ht)}}},createAlbumFromFolder:{title:v(i.Li,M("context.payloads().createAlbumFromFolder.folder")),states:{completed:{title:v(i.Q,M("context.payloads().createAlbumFromFolder.album"))},failed:{title:v(i.wt,M("context.payloads().createAlbumFromFolder.folder"))}}},createColumn:{title:W(i.Oi),shortTitle:i.Ai,states:{completed:{title:W(i.Z)},failed:{title:W(i.Et)}}},editColumn:{title:X(i.ji),shortTitle:i.Bi,states:{completed:{title:X(i.ue)},failed:{title:X(i.Lt)}}},deleteColumn:{title:V(i._i),shortTitle:i.Mi,states:{completed:{title:V(i.te)},failed:{title:V(i.xt)}}},createAlbum:{title:B(i.T,i.x,M("context.payloads().createAlbum.album")),shortTitle:B(i.Ei,i.wi),states:{completed:{title:function(e){return H(e.payloads().createAlbum.album().childCount,i.Y,i.G,M("context.payloads().createAlbum.album"))}},failed:{title:q(i.pt,i.ht)},canceled:{title:R(i.pt,i.ht)}}},checkInItem:{title:v(i.B,M("context.payloads().checkInItem.parent")),states:{}},checkOutItem:{title:v(i.j,M("context.payloads().checkOutItem.parent")),states:{}},undoCheckOutItem:{title:v(i.ls,M("context.payloads().undoCheckOutItem.parent")),states:{}},publishItem:{title:v(i.Sr,M("context.payloads().publishItem.parent")),states:{}},makeHomepage:{title:i.n,states:{completed:{title:i.e},failed:{title:i.t}}},setupApprovalFlow:{title:i.o,states:{completed:{title:i.u},failed:{title:i.a}}},setupReminderFlow:{title:function(e){return v(i.i,f.e.encodeText(e.payloads().createReminderFlow.dateColumnName))},states:{completed:{title:function(e){return v(i.s,f.e.encodeText(e.payloads().createReminderFlow.dateColumnName))}},failed:{title:function(e){return v(i.r,f.e.encodeText(e.payloads().createReminderFlow.dateColumnName))}}}},unPublishItem:{title:v(i.fs,M("context.payloads().unPublishItem.parent")),states:{}},shareItem:{title:D,states:{started:{title:D},completed:{description:_,title:D},failed:{description:_}}},createFolder:{title:v(i.Ve,M("context.payloads().createFolder.parent")),states:{}},updateBundle:{title:v(i.bs,M("context.payloads().updateBundle.item")),states:{}},setAlbumCoverPhoto:{title:v(i.si,M("context.payloads().setAlbumCoverPhoto.album")),states:{completed:{title:v(i.Ae,M("context.payloads().setAlbumCoverPhoto.album"))},failed:{title:v(i.Qt,M("context.payloads().setAlbumCoverPhoto.album"))}}},uploadVideos:{title:function(e){return H(P(e),i.xs,i.Ss,f.e.encodeText(e.payloads().uploadItems.parent.name))},states:{started:{description:y},completed:{title:function(e){return H(e.states().completed,i.De,i._e,f.e.encodeText(e.payloads().uploadItems.parent.name))}},failed:{title:q(i.en,i.Zt),description:k},canceled:{title:R(i.pt,i.ht)}}},saveItem:{title:U(i.ii),shortTitle:U(i.ii),states:{started:{description:y},completed:{title:U(i.Le)},failed:{title:U(i.Kt),description:T(L)},canceled:{title:U(i.Kt)}},actions:{cancel:{mode:3}}},createItem:{title:U(i.$e),shortTitle:U(i.$e),states:{started:{description:y},completed:{title:U(i.ee)},failed:{title:U(i.St),description:T(A)},canceled:{title:U(i.St)}},actions:{cancel:{mode:3},learnMore:{mode:2},close:{mode:1}}},updateMetadata:{title:B(i.Es,i.ws),shortTitle:B(i.rs,i.ns),states:{completed:{title:F(i.Me,i.Oe)},failed:{title:q(i.Yt,i.Gt)},canceled:{title:R(i.Yt,i.Gt)}}},triggerFlow:{title:z(i.d,i.v),shortTitle:z(i.d,i.v),states:{created:{title:z(i.c)},started:{title:z(i.d,i.v)},completed:{title:z(i.h,i.p)},failed:{title:z(i.f,i.l)}}},saveAutoAlbum:{title:v(i.ri,M("context.payloads().saveAutoAlbum.album")),states:{completed:{title:v(i.ke,M("context.payloads().saveAutoAlbum.album"))},failed:{title:v(i.Jt,M("context.payloads().saveAutoAlbum.album"))}}},discardAutoAlbum:{title:v(i.rt,M("context.payloads().discardAutoAlbum.album")),states:{completed:{title:v(i.se,M("context.payloads().discardAutoAlbum.album"))},failed:{title:v(i.kt,M("context.payloads().discardAutoAlbum.album"))}}},editViewColumns:{title:i.Fi,shortTitle:i.Fi,states:{completed:{title:i.ae},failed:{title:i.At}}},addToOneDrive:{title:B(i.xi,i.Si),states:{completed:{title:F(i.X,i.W)},failed:{title:q(i.vt,i.dt)},canceled:{title:R(i.vt,i.dt)}}},removeFromSharedList:{title:B(i.Ui,i.Ri),states:{completed:{title:F(i.pe,i.he)},failed:{title:q(i.Pt,i.Dt)}}},sharingReport:{title:i.ti,states:{completed:{title:i.ti,description:(function(e){return function(t){return v(e,f.e.encodeText(t.payloads().sharingReport.folderUrl))}})(i.Ke)},failed:{title:i._r}}}},actions:{cancel:{name:i.L,icon:new u.e("Cancel")},close:{name:i.F,icon:new u.e("Cancel"),mode:1},overwrite:{name:J(i.mr,i.vr)},addNewVersion:{name:J(i.E,i.S)},restart:{name:i.Dr},undo:{name:J(i.hs,i.cs)},rename:{name:J(i.Mr,i.Or)},unlockVault:{name:i.ps},vaultFileLimit:{name:i.mn},moveSharedFileVault:{name:i.nr},moveAnyway:{name:i.kn},moveAnywaySchemaMismatch:{name:J(i.An,i.Ln)},moveAnywayVersionLimit:{name:J(i.An,i.Ln)},deleteLocked:{name:J(i.Ye,i.Qe)},moveLockedFile:{name:i.kn},compare:{name:i.I},hipCheck:{name:i.pn},verifyAccount:{name:i.Cs},learnMore:{name:i.wn},getMoreStorage:{name:i.hn,commandBarButtonAs:function(e){var t=e.defaultRender,n=Object(h.__rest)(e,["defaultRender"]);return t?p.createElement(t,Object(h.__assign)({},n,{className:d.e})):null}}}};t.e=re},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(7),i=n(914),s=n(2394),o=new r.t({name:"".concat("FirstRunExperienceStatus.key",".FirstRunExperienceStatus"),factory:{dependencies:{},create:function(e){return{instance:new i.e(s.e.notConfigured)}}}})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(1121),s=n(119),o=n(2200),u=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.contexts=r.observables.createArray();r._additions=[];r._removals=[];r._needsOverlayContent=n.needsOverlayContent;return r}t.prototype.transclude=function(e){var t=this;this._needsOverlayContent.needsOverlayContent.set(!0);this._transclude(e);return{dispose:function(){t._dispose(e)}}};t.prototype._transclude=function(e){this._additions.push(e);this._updateContextsTimeoutId||this._updateContexts()};t.prototype._dispose=function(e){this._removals.push(e);this._updateContextsTimeoutId||this._updateContexts()};t.prototype._updateContexts=function(){this._updateContextsTimeoutId=this.async.requestAnimationFrame(this._onUpdateContextsTimeout);var e=this.contexts.peek(),t=this._additions.splice(0),n=this._removals.splice(0);this.contexts.valueWillMutate();e.push.apply(e,t);for(var r=0,i=n;r<i.length;r++){var s=i[r],o=e.indexOf(s);o>-1&&e.splice(o,1)}this.contexts.valueHasMutated()};t.prototype._onUpdateContextsTimeout=function(){this.contexts.valueHasMutated();this._updateContextsTimeoutId=void 0;(this._additions.length||this._removals.length)&&this._updateContexts()};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.default.dependencies),{needsOverlayContent:o.e});return t})(i.default),a=new s.n(u,i.default.dependencies)},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n("knockout-lib");function i(e,t){var n=document.createElement("div");n.innerHTML=t;r.applyBindings(e,n);var i=n.textContent;r.cleanNode(n);return i}}],Array(16),[function(e,t,n){"use strict";var r=n(536),i=n(175),s=Object(i.t)(r.r),o=s?window.require.toUrl("odsp-media/fluenthybridfont/"):window.require.toUrl("odsp-media/fonts/");(s?function(){return n.ee([654],5257)}:function(){return n.ee([651],5258)})().then(function(e){(0,e.initializeIcons)(o,{disableWarnings:!0},!0)}).catch(function(e){console.error("Icons error",e)})},function(e,t,n){"use strict";n.d(t,"n",function(){return S});n.d(t,"e",function(){return x});var r=n(0),i=n(2078),s=n(2055),o=n(2502),u=n(18),a=n(171),f=n(33),l=n(1121),c=n(2056),h=n(7),p=n(119),d=new h.t({name:"Share.key",loader:new p.t(function(){return n.ee([706,"deferred","deferred.odsp-common","deferred.odsp-datasources","deferred.office-ui-fabric-react","deferred.resx-deferred","odsp.react.lib"],5431).then(function(e){return e.resourceKey.local})})}),v=n(2096),m=n(2392),g=n(340),y=n(2458),b=n(4605),w=n(132),E=n(91),S=y.shareFocusItemResourceKey,x=y.copyLinkFocusItemResourceKey,T=y.copyFormLinkFocusItemResourceKey,N=y.shareFromDetailPaneFocusItemResourceKey,C=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this,i=r,s=i.observables,o=i.resources,u=t.renderLabel,l=void 0===u?0:u,c=t.mode,h=t.item,p=t.engagementName,d=t.automationId,m=t.location;r._automationId=d;r._mode=c;r._overrideSelectedItem=h&&h.peek();r._overrideEngagementName=p;r._copyLinkShortcut=1===r._mode||3===r._mode;r._hideShareDialogOverflowButton=2===r._mode;r._actionMap=o.consume(a.e);r._itemsStore=o.consume(v.t);if(Object(f.isFeatureEnabled)(f.ShareV3)){r._focusItemResourceKey=r._getShareItemResourceKey();r._itemBeingShared=o.consume(r._focusItemResourceKey);s.backgroundCompute(r._computeIsOpen)}r._renderLabel=l;r._location=m;r._initializeCommand();return r}t.prototype._initializeCommand=function(){var e=this._getCommandProperties();this.command=new(this.managed(i.e))(e)};t.prototype._computeIsOpen=function(){this._itemBeingShared()&&this.command.isOpen(!0)};t.prototype._computeShouldClearItem=function(){this.command.isOpen()||this._itemBeingShared(void 0)};t.prototype._resizeShare=function(){if(!this._registeredClear){this._registeredClear=!0;this.observables.backgroundCompute(this._computeShouldClearItem)}};t.prototype._dismissShare=function(){this._itemBeingShared(void 0)};t.prototype._getPayload=function(){var e=this,t=this.observables,n=this.createPureComputed(this._computeShareParams),r=this.createPureComputed(function(){return!!e._itemBeingShared()}),i=t.create();t.backgroundCompute(function(){r.peek()?e.trackPromise(E.n.resolve(e.resources.consumeAsync(d.local))).done(function(e){i(e)}):r()});return this.createPureComputed(function(){var e=i(),t=n();if(e&&t)return e.toSpecification(t)})};t.prototype._computeShareParams=function(){var e=this._itemBeingShared(),t=e?this._itemsStore.getItem(e.items[0].key):void 0;if(t)return{item:t,copyLinkShortcut:this._copyLinkShortcut,onDismiss:this._dismissShare.bind(this),onResize:this._resizeShare.bind(this),hideShareDialogOverflowButton:this._hideShareDialogOverflowButton,mode:4===this._mode?b.e.addPeople:void 0,scenarioId:e.scenarioId,defaultRecipients:e.defaultRecipients,isEdit:e.isEdit,isSecureShare:e.isSecureShare,clickTime:Date.now()}};t.prototype._getShareItemResourceKey=function(){switch(this._mode){case 0:return S;case 1:return x;case 2:return N;case 3:return T;case 4:return y.shareFromGrantAccessItemResourceKey;default:return S}};t.prototype._getCommandProperties=function(){var e,t={text:void 0,accessibleLabel:void 0,tooltip:void 0,icon:void 0,keys:void 0,action:void 0,payload:void 0,engagementName:void 0,renderLabel:this._renderLabel,enableRecoverFocusBinding:void 0,beakColor:void 0,location:void 0,automationId:this._automationId},n=Object(f.isFeatureEnabled)(f.ShareV3);if(4===this._mode){t.text=s.grantAccess;t.icon=new c.e("PlayerSettings");e=s.grantAccessCommandLabel}else if(this._copyLinkShortcut){t.text=n?s.CopyLinkCommandText:s.GetLink;e=s.CopyLinkCommandTooltipV3;t.icon=new c.e("Link")}else{t.text=s.Share;e=s.ShareCommandTooltipV3;t.icon=new c.e("Share");t.keys=["S"]}this._overrideEngagementName?t.engagementName=this._overrideEngagementName:this._copyLinkShortcut?t.engagementName="GetLink":t.engagementName="Share";if(n){t.action=new(this.managed(this._actionMap.ShowShareAction))({focusItemResourceKey:this._focusItemResourceKey,overrideItem:this._overrideSelectedItem});t.payload={control:this._getPayload(),timeout:36e5,announce:!1,autoDismiss:!0,preventDismissOnScroll:!0,preventDismissOnResize:!0};t.enableRecoverFocusBinding=!1;t.beakColor=g.e.neutralLighterAlt}else this._copyLinkShortcut?t.action=new(this.managed(this._actionMap.GetLinkAction)):t.action=new(this.managed(this._actionMap.ShareByLinkAction))({sharingMethod:2});t.location=Object(w.s)()?4:this._location;var r=this.resources.consume(m.e),i=this.createPureComputed(function(){return r()}),a=this.createPureComputed(function(){return r()?u.format(o.c,e):e}),l=this.createPureComputed(function(){return r()?u.format(o.c,t.text):t.text});t.isDisabled=i;t.tooltip=a;t.accessibleLabel=l;t.prependTextToAccessibleLabel=!1;return t};return t})(l.default);t.t=C},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r;(function(e){e[e.none=0]="none";e[e.right=1]="right";e[e.flip=2]="flip";e[e.left=3]="left"})(r||(r={}));var i=r},,,,,,function(e,t,n){"use strict";n.r(t);n.d(t,"shareFocusItemResourceKey",function(){return u});n.d(t,"copyLinkFocusItemResourceKey",function(){return a});n.d(t,"copyFormLinkFocusItemResourceKey",function(){return f});n.d(t,"shareFromDetailPaneFocusItemResourceKey",function(){return l});n.d(t,"shareFromGrantAccessItemResourceKey",function(){return c});n.d(t,"hasFollowedAnItemKey",function(){return h});var r=n(1121),i=n(898),s=n(7),o=function(e){return{dependencies:{observablesFactoryType:r.observablesFactoryTypeResourceKey},create:function(t){var n=new(0,t.observablesFactoryType)({}),r=n.create();e&&(r.equalityComparer=i.n);return{instance:r,disposable:n}}}},u=new s.t({name:"".concat("ShareCommandKeys",".shareFocusItem"),factory:o(!0)}),a=new s.t({name:"".concat("ShareCommandKeys",".copyLinkFocusItem"),factory:o()}),f=new s.t({name:"".concat("ShareCommandKeys",".copyFormLinkFocusItem"),factory:o()}),l=new s.t({name:"".concat("ShareCommandKeys",".copyLinkFocusItem"),factory:o()}),c=new s.t({name:"".concat("ShareCommandKeys",".shareFromGrantAccess"),factory:o()}),h=new s.t({name:"".concat("ShareCommandKeys",".hasFollowedAnItemKey"),factory:{dependencies:{observablesFactoryType:r.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r={INPUT:!0,TEXTAREA:!0},i={A:!0,BUTTON:!0};function s(e){var t=e;return!!(t&&(t.tagName in r||t.isContentEditable))}function o(e){return!!(e&&e.tagName in i)}}],Array(19),[function(e,t,n){"use strict";n.d(t,"t",function(){return c});n.d(t,"n",function(){return h});n.d(t,"e",function(){return p});var r=n(2),i=n(131),s=n(27),o=n(975),u=n(23),a=n(14),f=n(500),l=n(4),c=new i.e("knockoutStoreItem",function(e,t){var n=t.itemKey,r=e.demandItemFacet(f.t,n);if(void 0!==r){Object(l.ks)(l.as)||e.demandItemFacet(p,n&&h.serialize({itemKey:n}));var i=e.demandItemFacet(o.e,s.a),u=o.e.evaluate(i)(e,{}).getItem;if(u)return u(r.key)}}),h=new u.e("odspNextStoreKey",{itemKey:a.e}),p=new r.e("createdStoreItem")},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(170);Object(r.n)([{rawString:".GetMoreStoragePrimaryButton_4fdd5424{background-color:"},{theme:"orange",defaultValue:"#d83b01"},{rawString:";border:none;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";width:auto}.GetMoreStoragePrimaryButton_4fdd5424:hover{background-color:"},{theme:"orange",defaultValue:"#d83b01"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";cursor:pointer}"}]);var i="GetMoreStoragePrimaryButton_4fdd5424"},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return g});var r='\x3c!--ko component:{name:overlayTagName,params:{animation:{afterAdd:1,beforeRemove:500},alignToParent:false}}--\x3e\x3c!--ko focusTrap:{}--\x3e<div class="od-OneUpOverlay" data-overlay-parent="true" role="presentation" tabindex="-1" data-bind="interactionScope:{isScope:true},preserveFocus,recoverFocus:{isEnabled:$host.isOpen},host"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e',i=n(170);Object(i.n)([{rawString:".od-OneUpOverlay{position:absolute;top:0;left:0;right:0;bottom:0;z-index:0}.od-OverlayHost-overlay .od-OneUpOverlay{transition:opacity 367ms linear,visibility 0s linear 367ms,transform 367ms linear;opacity:0;visibility:hidden;transform:none}.od-OverlayHost-overlay.od-OverlayHost-overlay--initial .od-OneUpOverlay,.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-OneUpOverlay{transition-delay:0s,0s,0s;opacity:1;visibility:inherit}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-OneUpOverlay{transform:scale(.8,.8);opacity:0;visibility:hidden}"}]);var s=n(2045),o=n(0),u=n(2044),a=n(2085),f=n(2110),l=n(2104),c=n(2092),h=n(2083),p=n(2099),d=(function(e){Object(o.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.overlayTagName=p.e.tagName;r.addBindingHandlers({host:a.e,interactionScope:f.t,preserveFocus:l.e,recoverFocus:c.e,focusTrap:h.e});return r}return t})(u.t),v=n(2049),m=s.e({tagName:"od-one-up-overlay",template:r,viewModel:d,synchronous:!0}),g=Object(v.n)({automationName:"od-one-up-overlay",name:"OneUpOverlay",template:r,viewModelType:d});t.e=m},function(e,t,n){"use strict";var r,i=n(0),s=n(2046),o=n(1121),u=n(334),a=n(119),f=n(1338),l=n(2408),c=n(748),h=n(31),p=n(88);(function(e){e[e.none=0]="none";e[e.queue=1]="queue";e[e.server=2]="server"})(r||(r={}));var d=r,v=Object(c.e)({eventName:"ImageLoad,Qos,",shortEventName:"ImageLoad"},{loadType:{typeRef:r,type:h.e.Enum}},p.e),m=n(63),g=n(3134),y=n(70),b=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._semaphore=new l.e(16);r._thumbnailCache=n.thumbnailCache;return r}t.prototype.loadImage=function(e){var t=this,n=e.url,r=e.imageElement,i=void 0===r?document.createElement("img"):r,s=e.scenarioName,o={url:n,width:0,height:0},u=this._thumbnailCache,a=function(){return f.e.authenticate(n).then(function(){return t._waitForImageLoad(i,n,s)}).then(function(e){u.record(o);if(i.complete&&!e)return t._waitForTimeout(300)}).then(function(){var e=i.naturalWidth||i.width,t=i.naturalHeight||i.height;return{url:n,width:e,height:t}})};return u.isLoaded(o)?a():this._semaphore.enqueue(a)};t.prototype._waitForImageLoad=function(e,t,n){var r,i,s,o=this.async,a=this.events,f=function(){s&&o.clearTimeout(s);a.off(e)},l=new u.e(function(){f();e.setAttribute("src","")}),c=t&&t.indexOf("&encodeFailures=1")>=0;a.onAll(e,{load:function(){f();if(c&&1===e.naturalWidth&&e.naturalHeight>6e4){var t=e.naturalHeight-6e4,n=406===t||412===t;i&&i.end({resultType:n?m.e.ExpectedFailure:m.e.Failure,resultCode:"".concat(t),error:"Encoded failure"});l.error(new y.e({code:"".concat(t),isExpected:n,message:"Server returned encoded failure ".concat(t)}))}else{i&&i.end({resultType:m.e.Success});l.complete(r)}},error:function(){f();i&&i.end({resultType:m.e.Failure});l.error(new Error("Image '".concat(t,"' failed to load")))}});s=o.setTimeout(function(){l.cancel()},3e4);n&&(i=new v({name:n,loadType:d.server}));e.setAttribute("src",t);r=!!e.complete;return this.trackPromise(l.getPromise())};t.prototype._waitForTimeout=function(e){var t,n=this.async,r=new u.e(function(){t&&n.clearTimeout(t)});t=n.setTimeout(function(){r.complete()},e);return r.getPromise()};t.dependencies=Object(i.__assign)(Object(i.__assign)({},o.default.dependencies),{thumbnailCache:g.e});return t})(o.default),w=Object(a.s)("ImageLoader",b),E=n(2174),S=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t)||this;r._debouncer=new E.e;r._imageLoader=r.resources.consume(w);var i=r.valueAccessor(),s=i.src,o=i.image,u=i.error,a=i.isLoaded,f=i.isError,l=i.actualSize,c=i.scenarioName;r._src=r.wrapObservable(s);r._image=r.wrapObservable(o);r._error=r.wrapObservable(u);r._scenarioName=c;var h=n.outputExtenders,p=void 0===h?{deferred:!0}:h;r.createComputed(r._computeLoadImage);r.createBackgroundComputed(function(){var e=r._image();a&&a(!!e);if(l){var t=void 0;if(e){t={width:e.width,height:e.height}}l(t)}o&&o(e)}).extend(p);r.createBackgroundComputed(function(){var e=r._error();u&&u(e);f&&f(!!e)}).extend(p);return r}t.prototype._computeLoadImage=function(){var e,t=this,n=this.unwrapObservable(this._src);this._image(void 0);this._scenarioName&&(e=new v({name:this._scenarioName,loadType:d.queue}));this._debouncer.debounce(this.trackPromise(this._imageLoader.loadImage({url:n,imageElement:this.element,scenarioName:this._scenarioName}))).then(function(n){t._image(n);t._error(void 0);e&&e.end({resultType:m.e.Success})},function(n){t._error(n);e&&e.end({resultType:n.isExpected?m.e.ExpectedFailure:m.e.Failure})})};return t})(s.t);t.e=S},,,,,,,function(e,t,n){"use strict";var r;(function(e){e[e.normal=0]="normal";e[e.blocker=1]="blocker";e[e.vaultBlocker=2]="vaultBlocker"})(r||(r={}));t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(7),i=n(2432),s=new r.t({name:"OverlayProvider.key",factory:i.e})},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){var t=e.document;t.body||t.createElement("body");var n=t.createElement("form");n.action=e.url;n.method="POST";n.style.visibility="hidden";n.target="_self";var r=e.postdata;for(var i in r){var s=t.createElement("input");s.type="hidden";s.name=i;s.value=r[i];n.appendChild(s)}t.body.appendChild(n);n.submit()}}],Array(13),[function(e,t,n){"use strict";var r=n(0),i=n(63),s=n(18),o=n(3135),u=n(2049),a=n(2321),f=n(3344),l=n(2137),c=n(3224),h=n(3342),p=n(101),d=n(43),v=n(243),m=n(3343),g=n(33),y=n(19),b='<a href="https://go.microsoft.com/fwlink/?linkid=862871" target="_blank">',w=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.strings=f;r.addBindingHandlers({activate:o.e,control:u.r});var i=t.slide.renderOptions,a=t.showActions,h=void 0===a?!i||!i.hideDownload:a;r._isOneDriveWinApp=Object(p.e)();r.showActions=r._isOneDriveWinApp?r.showActionInOneDriveWinApp(t.slide.item().queryType,t.slide.item().type):h;r._allowInfectedDownload=n.allowInfectedDownload;r.malwareDetectedSvgUrl=window.require.toUrl("odsp-media/images/atp/malware_icon_208x208.svg");r.malwareDetectedIconAlt=f.malwareDetectedIconAriaLabel;r.itemMalwareDetected=r.createPureComputed(function(){var e=t.slide.item();return e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected},{deferEvaluation:!0});r.fileTypeIconTagName=l.e.tagName;r.fileName=r.createPureComputed(function(){var e=t.slide.item();return e.displayName||e.name},{deferEvaluation:!0});r.fileTypeIconViewModelParams=r.createPureComputed(function(){var e=t.slide.item();return{iconName:e.iconName,iconUrl:e.iconUrl,extension:e.extension,desiredSize:96}},{deferEvaluation:!0});r.actionBarControl=Object(u.i)(c.e,{forceExternal:!!i,item:t.slide.item,hideOpenCommand:r.itemMalwareDetected});r._m365GroupsBlockDownloadsExperienceEnabled=n.m365GroupsBlockDownloadsExperienceEnabled;r.message=r.createPureComputed(function(){var e=t.slide.item();return r.itemMalwareDetected()?r._allowInfectedDownload?s.format(f.malwareDetectedAllowDownloadMessage,b,"</a>"):s.format(f.malwareDetectedMessage,b,"</a>"):3===e.itemStatus?Object(g.isFeatureEnabled)(g.AuthZenBlockDownloadPolicyBanner)&&r._m365GroupsBlockDownloadsExperienceEnabled?f.blockDownloadPolicyActive:f.blockedByPolicy:f.notPreviewAvaible});return r}t.prototype.activate=function(){var e=this.slide,t=3!==e.item().itemStatus||y.e.isActivated("3E947568-412A-4953-9D24-E87CB8F77760","08/01/2022","Add currentUserRole check for textviewer in itemoverride scenario due to download issue")?this.observables.create({resultType:i.e.ExpectedFailure,resultCode:"Fallback",error:"Fallback viewer loaded"}):this.observables.create({resultType:i.e.ExpectedFailure,resultCode:"BlockedFallback",error:"Fallback viewer loaded due to block policy"});this.scope.attach(e.loadResult.register(t));e.loadState(3)};t.prototype.showActionInOneDriveWinApp=function(e,t){return e===d.e.SharedWithMe||t===v.e.Folder||t===v.e.Unknown||t===v.e.OneNote||t===v.e.File||t===v.e.Media};t.dependencies=Object(r.__assign)(Object(r.__assign)({},a.e.dependencies),{allowInfectedDownload:h.e,m365GroupsBlockDownloadsExperienceEnabled:m.e});return t})(a.e),E=Object(u.n)({automationName:"od-one-up-other",name:"OneUpOther",template:'<div class="OneUp-other" data-bind="activate:$component.activate.bind($component)"><div class="OneUp-other-content">\x3c!--ko if:itemMalwareDetected()--\x3e<div><img class="OneUp-other-malwareDetectedIcon" data-bind="attr:{src:malwareDetectedSvgUrl,alt:malwareDetectedIconAlt}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:itemMalwareDetected()--\x3e<div class="OneUp-other-fileIcon" data-bind="component:{name:fileTypeIconTagName,params:fileTypeIconViewModelParams}"></div>\x3c!--/ko--\x3e<div class="OneUp-other-fileName" data-bind="text:fileName"></div><div class="OneUp-other-message" data-bind="html:message"></div>\x3c!--ko if:showActions--\x3e<div class="OneUp-other-actions" data-bind="control:actionBarControl"></div>\x3c!--/ko--\x3e</div></div>',viewModelType:w});t.e=E},function(e,t,n){"use strict";n.d(t,"e",function(){return h});var r=n(247),i=n(119),s=n(1121),o=n(776),u=n(341),a=n(898),f=n(640),l={itemCacheStore:o.e,observablesFactoryType:s.observablesFactoryTypeResourceKey,asyncType:s.asyncTypeResourceKey},c=(function(){function e(e,t){void 0===e&&(e={});var n=this._scope=new u.e,i=t.itemCacheStore;this._observables=n.attach(new t.observablesFactoryType({owner:this}));this._async=n.attach(new t.asyncType(this));this._itemCacheEvaluator=i.dispatch(r.t)}e.prototype.dispose=function(){this._scope.dispose()};e.prototype.pureCompute=function(e,t){void 0===t&&(t={});var n=t.suppressGetItems,r=void 0!==n&&n,i=t.evaluationContext,s=this._observables,o=this._itemCacheEvaluator,l=this._scope.attach(new u.e),c=l.attach(s.create()),h=!0,p=function(t){return h?s.ignore(function(){return e(t,{})}):e(t,{})};p.selector=e;var d=o.createItemCacheSelector(p,{suppressGetItems:r,evaluationContext:i}),v=l.attach(s.pureCompute(function(){d.markAsChanged();h=!1;var e=d.get();h=!0;return e}));v.equalityComparer=a.n;c(d.get());d.subscribe(function(){c(d.get());d.registerDemands()});var m=l.attach(s.pureCompute(function(){v();c();return d.get()}));m.equalityComparer=a.n;this._async.setImmediate(function(){d.registerDemands()});l.attach({dispose:function(){d.dispose()}});return Object(f.e)(m,function(){l.dispose()})};return e})(),h=Object(i.s)("ItemCacheObservable.new",c,l)}],Array(19),[function(e,t,n){"use strict";var r=n(0),i=(n(3217),n("react-lib")),s=n(2049),o=n(7),u=n(2595),a=n(2090),f=n(120),l=n(59);function c(e){var t=e.specification,n=e.placeholder,r=Object(l.n)(),o=Object(u.t)(t),c=Object(f.e)(function(t,i){e.onApplyBindings&&e.onApplyBindings(t);return new(r.resolved(s.r))({element:t,valueAccessor:function(){return{specification:o,placeholder:n}},bindingContext:i})});return i.createElement(a.e,{applyBindings:c},e.children)}function h(e){var t=e.resources,n=Object(r.__rest)(e,["resources"]),s=i.createElement(c,Object(r.__assign)({},n));return t?i.createElement(l.e,{resources:t},s):s}t.e=h;new o.t({name:"Knockout",factory:new o.e(h)})}],Array(13),[function(e,t,n){"use strict";var r=n(0),i=(n(1735),n(1121)),s=n(2078),o=n(7),u=n(119),a=new o.t({name:"OperationMonitor.key",loader:new u.t(function(){return n.ee([387,"deferred","deferred.odsp-common","deferred.odsp-datasources","deferred.office-ui-fabric-react","deferred.resx-deferred","odsp.react.lib"],4456).then(function(e){return e.resourceKey.local})})}),f=n(2108),l=n(2094),c=n(2084),h=n(2056),p=n(2426),d=n(2433),v=n(171),m=n(2055),g=n("knockout-lib"),y=new o.t({name:"".concat("SuppressOperationUI.key",".OperationPanel"),factory:{dependencies:{observablesFactoryType:i.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create(!1),disposable:t}}}}),b=n(91),w=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=r,s=i.resources,o=i.observables;r._operationProvider=s.consume(f.resourceKey);r._actionMap=s.consume(v.e);r._completedOperations=o.createArray();r._currentOperations=o.createArray();r._autoDismissPayload=o.pureCompute(r._computeAutoDismissPayload);var u=t.suppressNotifications,a=void 0!==u&&u;r._suppressNotifications=a;r._operationHidden=r.resources.consume(y.optional);r._initializeCurrentOperation();r._showOperationsAction=new(r.managed(r._actionMap.ShowOperationsAction));r._initializeCommand(t);var l=n.openCommandExtenders,c=void 0===l?{rateLimit:{timeout:0,method:"notifyWhenChangesStop"}}:l,h=n.cleanupOperationsExtenders,p=void 0===h?{rateLimit:{timeout:0,method:"notifyWhenChangesStop"}}:h;o.backgroundCompute(r._computeOpenCommand).extend(c);o.backgroundCompute(r._computeCleanupOperationsOnClose).extend(p);return r}t.prototype._computeOpenCommand=function(){this._completedOperations().length&&this.command.isOpen(!0)};t.prototype._computeCleanupOperationsOnClose=function(){this.command.isOpen()||this.command.action.isToggled()||this.command.action.isExecuting()||g.computedContext.isInitial()||this._operationProvider.cleanup(!0)};t.prototype._initializeCurrentOperation=function(){var e=this,t=this._completedOperations,n=this._currentOperations;this._operationProvider.groups.map({mappingWithDisposeCallback:function(i){var s=e.createComputed(function(){var s=i.state(),o=!e._suppressNotifications&&!i.visibility.peek();switch(s){case l.e.completed:case l.e.failed:case l.e.created:case l.e.started:n.remove(i)}switch(s){case l.e.completed:case l.e.failed:var u=[];o&&u.push(i);t.splice.apply(t,Object(r.__spreadArray)([0,1/0],u,!1));break;case l.e.started:e.async.setTimeout(function(){(function(e){var t=e.state.peek()===l.e.started,n=e.progress.current.peek()<(e.progress.maximum.peek()-e.progress.minimum.peek())/2;return t&&n})(i)&&o&&t.splice(0,1/0,i)},500)}switch(s){case l.e.created:case l.e.started:n.unshift(i)}});return{mappedValue:i.batch.id,dispose:function(){s.dispose();t.remove(i);n.remove(i)}}}})};t.prototype._initializeCommand=function(e){var t=e.renderLabel,n=void 0===t?0:t,r=e.isDisabled,i=void 0!==r&&r,o=this.observables,u=this._suppressNotifications?void 0:{control:this._getPayload(),autoDismiss:this._autoDismissPayload,announce:!0,timeout:4e3};this.command=new(this.managed(s.e))({action:this._showOperationsAction,renderLabel:n,isDisabled:o.create(i),icon:o.pureCompute(this._computeIcon),iconBadge:o.pureCompute(this._computeIconBadge),hasIconOnly:o.pureCompute(this._computeHasIconOnly),accessibleLabel:o.pureCompute(this._computeAccessibilityLabel),prependTextToAccessibleLabel:!0,text:o.pureCompute(this._computeText).extend({rateLimit:{timeout:10,method:"notifyWhenChangesStop"}}),payload:u,isHidden:this._operationHidden,hasDynamicText:!0,hasAnimation:!0,location:4,keys:["G"]})};t.prototype._computeText=function(){var e,t=this._currentOperations()[0];if(t&&t.visibility.peek()<1){var n=l.e[t.state()],r=c.e[t.type()],i=c.e[c.e.multiple],s=p.e.types[r],o=p.e.types[i],u=s.states[n],a=o.states[n],f=u&&(u.shortTitle||u.title)||a&&(a.shortTitle||a.title)||s.shortTitle||o.shortTitle,h={count:t.count,states:t.states,error:t.error,payloads:t.payloads,progress:t.progress};e=d.e({context:h,resources:this.resources},Object(p.n)(f,h))}else e="";return e};t.prototype._computeIcon=function(){var e=this._operationProvider.overall.state();return e===l.e.created||e===l.e.started?new h.e("Sync","is-active"):new h.e("Sync")};t.prototype._computeIconBadge=function(){return this._operationProvider.overall.states().failed?new h.e("StatusErrorFull"):null};t.prototype._computeAccessibilityLabel=function(){return this._operationProvider.overall.states().failed?m.ViewActivitiesFailure:m.ViewActivities};t.prototype._getPayload=function(){var e=this,t=this.observables,n=t.create(),r=t.pureCompute(function(){return!!e._completedOperations().length});t.backgroundCompute(function(){r.peek()?e.trackPromise(b.n.resolve(e.resources.consumeAsync(a.local))).done(function(t){n(t.toSpecification({groups:e._completedOperations,expandGroups:!1,onViewAll:function(){return e._onViewAll()},showCloseAction:!1,onExecuteAction:function(){e.command.isOpen(!1)}}))}):r()});return n};t.prototype._onViewAll=function(){this._showOperationsAction.isAvailable.peek()&&this._showOperationsAction.execute(void 0).done()};t.prototype._computeAutoDismissPayload=function(){return this._completedOperations().every(function(e){return e.state.peek()!==l.e.failed})};t.prototype._computeHasIconOnly=function(){var e=this._currentOperations()[0];return!(e&&e.visibility.peek()<1)};return t})(i.default);t.e=w},,,,,,function(e,t,n){"use strict";var r=n(170);Object(r.n)([{rawString:".od-Error{text-align:center}.od-Error-image{padding-top:52px;height:208px;width:auto;margin:0 auto}.od-Error-image .od-Error-imageTag{height:208px;width:auto}.od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:113px}.md .od-Error-image,.sm .od-Error-image{padding-top:20px;height:168px;width:auto}.md .od-Error-image .od-Error-imageTag,.sm .od-Error-image .od-Error-imageTag{height:168px;width:auto}.md .od-Error-image .od-Error-vaultImage,.sm .od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:80px}.od-Error-title{padding:16px 16px 0 16px;font-size:21px;font-weight:100;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-title{padding:16px 16px 0 16px}.md .od-Error-title,.sm .od-Error-title{font-size:17px;font-weight:300}.od-Error-subText{padding:6px 16px 0 16px;font-size:14px;font-weight:400;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-subText{padding:6px 16px 0 16px}.od-Error-subtext--accessremoved{max-width:410px}.od-Error-code{padding-top:8px;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";-webkit-touch-callout:text;-webkit-user-select:text;-ms-user-select:text;user-select:text;font-size:12px;font-weight:400}.od-Error-button{padding-top:16px;font-size:14px;font-weight:400}"}])}],Array(16),[function(e,t,n){"use strict";var r=n(2045),i=n(0),s=n(2044),o=n(2046),u=n("knockout-lib"),a=function(e){this.templateNodes=e.templateNodes;this.bindingContext=e.bindingContext;this.renderCount=e.renderCount||u.observable(0);this.parentElement=e.parentElement||null;this.options=e.options||null},f=n(3338),l=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;new(n.managed(f.e))({element:n.element,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return n._onReceiveComponentParentContext.bind(n)}});n.controlsDescendantBindings=!0;return n}t.prototype._onReceiveComponentParentContext=function(e){var t=this.valueAccessor(),n=new a({parentElement:t.parentElement,templateNodes:e.templateNodes,bindingContext:e.bindingContext,renderCount:t.renderCount,options:t.options});t.context(n)};t.supportsVirtualElements=!0;return t})(o.t),c=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({transclusionContent:l});n._provider=t.provider;n.bindingParams={context:u.observable(),parentElement:t.parentElement,renderCount:t.renderCount,options:t.options};n.createComputed(function(){var e=n.bindingParams.context();if(n._transclusion){n._transclusion.dispose();n._transclusion=null}e&&(n._transclusion=n.addDisposable(n._provider.transclude(e)))});return n}return t})(s.t),h=r.e({tagName:"od-transclusion-content",template:"\x3c!--ko transclusionContent:bindingParams--\x3e\x3c!--/ko--\x3e",viewModel:c,synchronous:!0});t.e=h}],Array(16),[function(e,t,n){"use strict";var r=n(2743),i=n("knockout-lib"),s=n(898),o=function(e,t,n){this.key=e||"";this.content=i.observable(new r.e(n));this.content.equalityComparer=s.n;this.schema=i.observableArray([]);this.schema.equalityComparer=s.e;this.context=i.utils.extend({},t);this.contentTypes=i.observableArray([]);this.isPlaceholder=!0;this.version=0};t.e=o},,function(e,t,n){"use strict";var r=n("knockout-lib"),i=(function(){function e(){this._originalProvider=new r.bindingProvider;this._bindingHandlers={};this._bindingContexts=[]}e.getInstance=function(){return e._instance};e.prototype.nodeHasBindings=function(e){return this._originalProvider.nodeHasBindings(e)};e.prototype.getBindings=function(e,t){try{this._bindingContexts.push(t);var n=this._originalProvider.getBindings(e,t);return n&&this._remapKeys(n,t)}finally{this._bindingContexts.pop()}};e.prototype.getBindingAccessors=function(e,t){try{this._bindingContexts.push(t);var n=this._originalProvider.getBindingAccessors(e,t);return n&&this._remapKeys(n,t)}finally{this._bindingContexts.pop()}};e.prototype.getBindingHandler=function(e){var t=this._bindingContexts.slice(-1)[0];if(t){var n=this._getLocalBindingHandlers(t);if(n){var i=n[e];e=i&&this.getUniqueKeyForBindingHandler(i,e)||e}}return this._bindingHandlers[e]||r.bindingHandlers[e]};e.prototype.getUniqueKeyForBindingHandler=function(t,n){var i=e._BINDING_PROVIDER_UNIQUE_KEY,s=t[i]=t[i]||n+"-local-"+ ++e._lastUniqueKeyOrdinal;this._bindingHandlers[s]={init:t.init&&t.init.bind(t),update:t.update&&t.update.bind(t),options:t.options,preprocess:t.preprocess&&t.preprocess.bind(t)};this._bindingHandlers[s].after=t.after;t.supportsVirtualElements&&(r.virtualElements.allowedBindings[s]=!0);return s};e.prototype._remapKeys=function(e,t){var n=e,r=this._getLocalBindingHandlers(t);if(r){n={};for(var i in e){var s=r[i];n[s&&this.getUniqueKeyForBindingHandler(s,i)||i]=e[i]}}return n};e.prototype._getLocalBindingHandlers=function(e){for(var t;!(t="object"==typeof e.$data&&e.$data.bindingHandlers)&&e.$parentContext;)e=e.$parentContext;return t};e._instance=new e;e._BINDING_PROVIDER_UNIQUE_KEY="__localBindingProvider__uniqueKey";e._lastUniqueKeyOrdinal=0;return e})(),s=i.getInstance();r.getBindingHandler=s.getBindingHandler.bind(s);r.bindingProvider.instance=s},function(e,t,n){"use strict";n.d(t,"e",function(){return f});n.d(t,"n",function(){return l});n.d(t,"t",function(){return c});n.d(t,"r",function(){return h});n(0);var r=n("react-lib"),i=n(59),s=n(598),o=n(1121),u=n(205),a=n(306);function f(e,t){return l((function(e,t){var n=h(),i=c(r.useMemo(function(){return e},t)),s=r.useRef();return s.current||(s.current=Object(u.e)(n.pureCompute(function(){return i()()}),{equalityComparer:a.e}))})(e,t))}function l(e){var t=h(),n=t.peekUnwrap(e),i=r.useState(function(){return n})[1];r.useEffect(function(){if(t.isObservable(e)){i(function(){return e.peek()});var n=t.subscribe(e,function(e){i(function(){return e})});return function(){n.dispose()}}},[e]);return n}function c(e,t){var n,i=null!==(n=null==t?void 0:t.inline)&&void 0!==n&&n,s=h(),o=r.useRef(),f=o.current||(o.current=Object(u.e)(s.create(e),{equalityComparer:a.e}));(i?r.useMemo:r.useEffect)(function(){f(e)},[e]);return f}function h(){var e=Object(i.n)(),t=r.useRef(),n=t.current||(t.current=new(e.consume(o.observablesFactoryTypeResourceKey.optional)||s.e));r.useLayoutEffect(function(){return function(){n.dispose()}},[]);return n}},function(e,t,n){"use strict";var r;(function(e){e[e.Lock=1]="Lock";e[e.Unlock=2]="Unlock";e[e.Manage=3]="Manage";e[e.FreDialog=4]="FreDialog";e[e.ShowFiles=5]="ShowFiles";e[e.Reset=6]="Reset";e[e.Debug=7]="Debug";e[e.FilesRemaining=8]="FilesRemaining"})(r||(r={}));t.e=r}],Array(21),[function(e,t,n){"use strict";var r=n(0),i=n(2046),s=n(2110),o=n("knockout-lib"),u=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r._isActive=r.observables.create(!0);new(r.managed(s.t))({element:r.element,allBindingsAccessor:r.allBindingsAccessor,bindingContext:r.bindingContext,valueAccessor:function(){return{isActive:r._isActive}}});o.applyBindingsToNode(r.element,{attr:{"aria-hidden":r.observables.pureCompute(function(){return r._isActive()?void 0:"true"})}},r.bindingContext);return r}return t})(i.t);t.e=u}],Array(16),[function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return T});var r='<div class="od-Error"><div class="od-Error-image"><img data-bind="attr:{src:imageUrl,alt:errorTitle,class:errorClassName}"></div><div class="od-Error-title" data-bind="text:errorTitle"></div>\x3c!--ko if:errorDetailedText--\x3e<div class="od-Error-subText" data-bind="text:errorDetailedText,css:{\'od-Error-subtext--accessremoved\':isAccessRemoved}"></div>\x3c!--/ko--\x3e\x3c!--ko if:errorHtml--\x3e<div class="od-Error-subText" data-bind="html:errorHtml"></div>\x3c!--/ko--\x3e\x3c!--ko if:showAction--\x3e<form class="od-Error-button" data-bind="attr:{action:actionUrl}" method="get"><button class="od-Button" data-bind="click:onButtonClick" type="submit"><span class="od-Button-label" data-bind="text:actionText"></span></button></form>\x3c!--/ko--\x3e<div class="od-Error-code" data-bind="visible:correlationIdText,text:correlationIdText"></div><div class="od-Error-code" data-bind="visible:showErrorCode,text:errorCodeText"></div></div>',i=(n(2558),n(0)),s=n(2044),o=n(2396),u=n(87),a=n(109),f=n(18),l=n(1824),c=n(140),h=n(119),p=n(82),d=(function(){function e(e,t){this._errorDataSource=t.errorDataSource;this._defaultErrorAction={text:o.e,url:t.urlDataSource.getRootUrl()}}e.prototype.getAction=function(e){return this._errorDataSource?this._errorDataSource.getAction(e):this._defaultErrorAction};return e})(),v=Object(h.s)("ErrorProvider",d,{errorDataSource:p.h.optional,urlDataSource:p.ve}),m=n(171),g=n(2596),y=n(33),b=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this,i=t.error;r._navigation=r.resources.consume(c.e);r._actionMap=r.resources.consume(m.e.optional);var s,h,p,d,g,b,E=r.resources.consume(v);r.errorClassName="od-Error-imageTag";if(w(i)){s=i.errorTitle;h=i.errorCode;p=i.errorDetailedText;d=i.errorDetailedHtml;g=i.correlationId;b=E.getAction(i)}else i.message&&(p=i.message);s||(s=o.n);r.errorTitle=s;r.errorDetailedText=p;r.errorHtml=d;r.errorCode=h;Object(y.isFeatureEnabled)(y.EmbedAccessOnEmbedAspx)&&Object(y.isFeatureEnabled)(y.EmbedLinkSupportOnEmbedAspx)&&"403"===h||p||d||(p=o.t);r.errorDetailedText=p;r.showAction=!!b&&!b.hideButton&&!t.hideAction;if(b){r.actionText=b.text;r.actionUrl=b.url}r.showErrorCode=h&&r.errorTitle===o.n;if(r.showErrorCode){u.e.log(i,"ServerError","".concat(h));r.errorCodeText=f.format(o.y,h)}else r.errorCodeText="";r.correlationIdText=g?f.format(o.b,g):"";if("accessremoved"===h){r.isAccessRemoved=!0;r.imageUrl=window.require.toUrl("odsp-media/images/error/error2.svg")}else{r.isAccessRemoved=!1;r.imageUrl=r._getRandomImage()}if(w(i)&&i.actionUrl&&161===i.errorCode){r.resources.consume(l.resourceKey)(!1);r.actionText=o.v;r.errorDetailedText=o.m;r.errorCodeText="";r.errorTitle=o.g;r.imageUrl=window.require.toUrl("odsp-media/images/error/vault/vaultclosed.svg");r.errorClassName="od-Error-vaultImage";a.e.logData({name:"Vault.Bookmarked.Loaded"})}return r}t.prototype.onButtonClick=function(){if(this.showAction)if(161===this.errorCode&&this._actionMap){a.e.logData({name:"Vault.Bookmarked.Unlock"});new(this.managed(this._actionMap.VaultAction))({actionType:g.e.Unlock}).execute(null)}else if(Object(y.isFeatureEnabled)(y.EmbedAccessOnEmbedAspx)&&Object(y.isFeatureEnabled)(y.EmbedLinkSupportOnEmbedAspx)&&self!==top&&this.actionUrl){a.e.logData({name:"Error.RequesAccess.Click"});this._popupCenter(this.actionUrl,"",860,500)}else{this._navigation.navigateTo(this.actionUrl)}return!1};t.prototype._getRandomImage=function(){var e=Math.ceil(3*Math.random());return window.require.toUrl("odsp-media/images/error/error".concat(e,".svg"))};t.prototype._popupCenter=function(e,t,n,r){var i=void 0!==window.screenLeft?window.screenLeft:screen.left,s=void 0!==window.screenTop?window.screenTop:screen.top,o=(window.outerWidth?window.outerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width)/2-n/2+i,u=(window.outerHeight?window.outerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-r/2+s,a=window.open(e,t,"scrollbars=yes, width="+n+", height="+r+", top="+u+", left="+o);window.focus&&a&&a.focus();return a};return t})(s.t);function w(e){return!(!e||!e.errorTitle&&void 0===e.errorCode)}var E=n(2045),S=n(2049),x=E.e({tagName:"ms-error",template:r,viewModel:b,synchronous:!0}),T=Object(S.n)({name:"Error",automationName:"ms-error",template:r,viewModelType:b});t.default=x},,function(e,t,n){"use strict";var r=n(2231),i=n(0),s=n(2452),o=n(598),u=n(2381),a=n(2654),f=n(63),l=n(2049),c=n(2517),h=n(2321),p=n(70),d=n(33),v=n(298),m=(function(e){Object(i.__extends)(t,e);function t(t,n){var s=e.call(this,t,n)||this;s.addBindingHandlers({control:l.r});s.thumbnailTagName=r.e.tagName;var u=s,f=u.observables,h=u.slide,p=t.slide.renderOptions,m=t.scale,g=void 0===m?f.create(1):m,y=t.size,b=void 0===y?s.oneUp.size:y,w=t.allowLoading,E=void 0===w?f.create(!0):w,S=t.fallbackThumbnail,x=t.showErrorActions,T=void 0===x?!p||!p.hideDownload:x,N=t.allowError,C=void 0===N||N,k=t.item,L=void 0===k?h.item:k,A=t.isPreview,O=t.expectLoadingFailure,M=void 0===O||O;s._item=L;s._scale=g;s._size=b;s._fallbackThumbnail=S;s._allowError=f.wrap(C);s._expectLoadingFailure=!!M;s._isLoaded=f.create(!1);s._isRendered=f.create(!1);f.backgroundCompute(s._updateSlideLoadState);var _=s._getImageAndRotation(),D=_.image,P=_.rotation;s._image=D;s._desiredSize=f.pureCompute(s._computeDesiredSize);s._desiredSize.equalityComparer=v.t;s._rotation=P;s._markAccess=Object(d.isFeatureEnabled)(d.ReportOneUpFileAccess)&&f.pureCompute(function(){return!A&&!h.offset()});s._error=f.create();s._fadeIn=f.pureCompute(function(){return Math.abs(s.slide.offset())<2});s._allowLoading=f.pureCompute(function(){var e=E(),t=s.oneUp.isRotating();return e&&!t});s._coverage=a.t(f.pureCompute(s._computeImageFrameCoverage),v.t);s.hasThumbnail=f.pureCompute(s._computeHasThumbnail);s.thumbnailParams=f.pureCompute(s._computeThumbnailParams);s.hasError=f.pureCompute(s._computeHasError);var H=Object(i.__assign)(Object(i.__assign)({},t),{showActions:T,slide:Object(i.__assign)(Object(i.__assign)({},t.slide),{loadResult:f.createCallback(Object(o.t)())})});s.fallbackControl=Object(l.i)(c.e,H);var B=s._result=f.pureCompute(s._computeResult);s.scope.attach(t.slide.loadResult.register(B));return s}t.prototype._getImageAndRotation=function(){var e=this.observables.pureCompute(this._computeImage);e.equalityComparer=v.t;var t=this.observables.pureCompute(this._computeRotation),n=this.observables.create(e.peek());n.equalityComparer=v.t;var r=this.observables.create(t.peek());this.observables.backgroundCompute(function(){var i=e(),s=t();n(i);r(s)});return{image:n,rotation:r}};t.prototype._computeImage=function(){var e=this._item(),t=(e.orientedThumbnail||e).thumbnail||this.unwrapObservable(this._fallbackThumbnail),n=this._markAccess;if(n){var r=t&&t.url;if(r&&r.indexOf("provider=spo")>=0){var s=r.replace(/&(width|height)=[^&]*/g,""),o=n()?"Access":"Preview";return Object(i.__assign)(Object(i.__assign)({},t),{action:o,getAligned:function(e){return{width:e.width,height:e.height,url:"".concat(s,"&width=").concat(0|e.width,"&height=").concat(0|e.height,"&action=").concat(o)}}})}}return t};t.prototype._computeRotation=function(){var e=this._item().orientedThumbnail;return e?e.rotation:s.e.none};t.prototype._computeImageFrameCoverage=function(){var e,t=this._image(),n=this._size();t.width&&t.height&&(t.width>n.width||t.height>n.height)&&(e=.25);return{minimum:0,maximum:1,fallback:e}};t.prototype._computeHasThumbnail=function(){return!(!this._size().width||!this._image()||!this.slide.loadState()&&this.hasError())};t.prototype._computeResult=function(){var e=this._result.peek();if(e)return e;var t=this._error();if(t){var n=void 0,r=!("personal"!==(this._item().graph||{}).driveType),i=this._expectLoadingFailure&&r;if(t instanceof p.e){n=t.code;i=t.isExpected}return{resultType:i?f.e.ExpectedFailure:f.e.Failure,resultCode:n||"LoadFailure",error:"Unable to load image"}}return this._isLoaded()?{resultType:f.e.Success}:void 0};t.prototype._computeHasError=function(){var e=this.hasError.peek();if(!e){e=this._allowError()&&!!this._error();var t=this._error();if(t&&t instanceof Array)for(var n=0;n<t.length;n++)if(t[n]&&"NeedAccessToken"===t[n].message)return!1}return e};t.prototype._computeDesiredSize=function(){var e=this._size(),t=this._image();if("Preview"!==(t&&t.action))return e;var n=Math.max(e.width,e.height),r=t&&Math.max(t.width,t.height)||0;if(r&&n>r)return g(r);for(var i=0,s=[400,960,1600,2560];i<s.length;i++){var o=s[i];if(r&&o>r)return g(r);if(o>n)return g(o)}return g(2560)};t.prototype._computeThumbnailParams=function(){var e;this.hasThumbnail()&&(e={image:this._image,rotation:this._rotation,desiredSize:this._desiredSize,scale:this._scale,error:this._error,alignment:u.e.fit,fadeIn:this._fadeIn,isCurrent:this._isLoaded,isLoaded:this._isRendered,coverage:this._coverage,allowLoading:this._allowLoading});return e};t.prototype._updateSlideLoadState=function(){var e=this.slide.loadState;this._isLoaded()?e(3):this._isRendered()&&e(2)};return t})(h.e);function g(e){return{width:e,height:e}}var y=Object(l.n)({automationName:"od-one-up-thumbnail",name:"OneUpThumbnail",template:"\x3c!--ko if:hasError--\x3e\x3c!--ko control:fallbackControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:!hasError()&&hasThumbnail()--\x3e\x3c!--ko component:{name:thumbnailTagName,params:thumbnailParams}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e",viewModelType:m});t.e=y}],Array(16),[function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r=n(640);function i(e,t){e.extend({rateLimit:{timeout:1,method:"notifyWhenChangesStop"}});var n,i=e.subscribe(function(r){t.cancelAnimationFrame(n);n=t.requestAnimationFrame(function(){n=t.requestAnimationFrame(function(){n=void 0;e()})})},null,"beforeChange");return e=Object(r.e)(e,function(){i.dispose()})}function s(e,t){e.equalityComparer=t;return e}}],Array(41),[function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(1121),i=new(n(7).t)({name:"".concat("UseItemCacheData.key",".useItemCacheData"),factory:{dependencies:{observablesFactoryType:r.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},,function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n(1121),s=n(171),o=n(181),u=n(119),a=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._getCurrentPageName=t.getCurrentPageName;r._getFocusPageName=t.getFocusPageName||f;r._itemSet=t.itemSet;r._focusItem=t.focusItem;r._isOneUp=r.observables.wrap(t.isOneUp);r._instrumentationProvider=n.instrumentationProvider;r._viewParams=n.viewParams;r._initializeReportPageView();return r}t.prototype._initializeReportPageView=function(){var e=this;this.observables.backgroundCompute(function(){if(e._itemSet){var t=e._viewParams.peek();if(e._isOneUp()&&e._focusItem){i=(r=e._itemSet.peek()).item.peek();var n=e._focusItem();n&&(n.peek().isPlaceholder?n():e._instrumentationProvider.userViewPage({viewParams:t,item:n.peek(),name:"".concat(e._getCurrentPageName({currentItem:i,viewParams:t}),"-").concat(e._getFocusPageName({currentItem:i,focusItem:n.peek(),viewParams:t}))}))}else{var r,i;(i=(r=e._itemSet()).item.peek()).isPlaceholder?r.item():r.isPlaceholder?r.content():e._instrumentationProvider.userViewPage({viewParams:t,item:i,name:e._getCurrentPageName({currentItem:i,viewParams:t})})}}else{t=e._viewParams.peek();e._instrumentationProvider.userViewPage({viewParams:t,name:e._getCurrentPageName({viewParams:t})})}}).extend({rateLimit:{timeout:300,method:"notifyWhenChangesStop"}})};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.default.dependencies),{instrumentationProvider:o.a,viewParams:s.j});return t})(i.default);function f(){return"OneUp"}var l=Object(u.o)("PageViewReporter",a)}],Array(44),[function(e,t,n){"use strict";var r=function(e){this.items=new Array(e||0);this.groupings=null;this.partialResultRequestCount=0;this.partialResultStatus=0};t.e=r},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r;function i(){"boolean"!=typeof r&&(r="srcdoc"in document.createElement("iframe"));return r}},function(e,t,n){"use strict";n.d(t,"e",function(){return p});var r=n(0),i=n(265),s=n(667),o=n(2046),u={0:function(e){return e},1:function(e){return 18*e},2:function(e){return.5*window.innerHeight}},a="function"==typeof PointerEvent,f=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.valueAccessor(),i=n.observables,o=r.allowedModes,u=void 0===o?15:o;n._transformV=r.transform||i.create(s.e.IDENTITY);n._isActive=r.isActive||i.create(!1);n._isEnabled=r.isEnabled||i.create(!0);n._mayStartPan=r.mayStartPan||l;n._constrainScale=r.constrainScale||c;n._allowedModes=u;n._useNativePan=!!r.useNativePan;n._gestureMode=i.create(0);n._touchCount=0;n._pointers={};n._pointerCount=0;n._initialTransformV=i.create(s.e.IDENTITY);n._initialTransformV.equalityComparer=p;n._incrementTransformPx=i.create(s.e.IDENTITY);n._incrementTransformPx.equalityComparer=p;n._initialCenterPx=i.create();n._initialCenterPx.equalityComparer=h;n._initialRadius=i.create();n._incrementTransformV=i.compute(n._computeIncrementTransformV);n._incrementTransformV.equalityComparer=p;i.compute(n._computeResetTransform);i.compute(n._computeTransform);var f={};if(a&&7&u)f.pointerdown=n._onPointerDown;else{1&u&&(f.touchstart=n._onTouchStart);6&u&&(f.mousedown=n._onMouseDown)}if(8&u){n._isWheeling=i.compute(n._computeIsWheeling);i.compute(n._computeStopWheeling).extend({rateLimit:{timeout:300,method:"notifyWhenChangesStop"}});i.compute(n._computeEndWheel);f.wheel=n._onWheel}f.contextmenu=function(e){if(n._isEnabled.peek())return 0!=(4&u)};n.events.onAll(n.element,f);return n}t.prototype._computeIncrementTransformV=function(){var e=this._size||i.e.ORIGIN,t=this._incrementTransformPx();return new s.e(new i.e(t.translate.x/e.x,t.translate.y/e.y),t.scale)};t.prototype._computeResetTransform=function(){if(!this._initialCenterPx()){this._initialTransformV(this._transformV());this._incrementTransformPx(s.e.IDENTITY)}};t.prototype._computeTransform=function(){this._isActive()&&this._transformV(this._incrementTransformV().multiply(this._initialTransformV.peek()))};t.prototype._computeIsWheeling=function(){return 8===this._gestureMode()};t.prototype._computeStopWheeling=function(){var e=this._isWheeling();this._transformV();e&&this._gestureMode(0)};t.prototype._computeEndWheel=function(){if(!this._isWheeling()){this._clearGesture();this._isActive(!1)}};t.prototype._onWheel=function(e){if(this._isEnabled.peek()){e.preventDefault();this._updateSize();var t=this._transformToElement(e),n=u[e.deltaMode](e.deltaY);this._handleWheel(t,n)}};t.prototype._handleWheel=function(e,t){var n=Math.pow(2,-t/300);if(!this._initialCenterPx.peek()){this._gestureMode(8);this._resetGesture([e.add(this._size.scale(-.5)),e.add(this._size.scale(.5))])}var r=s.e.zoom(e.subtract(this._initialCenterPx.peek()),e,n);8===this._gestureMode.peek()&&this._continueGesture(this._gesturePoints.map(function(e){return r.apply(e)}))};t.prototype._onMouseDown=function(e){if(this._isEnabled.peek()&&0===e.button){this._updateSize();var t=this._transformToElement(e);this._gestureMode(4);var n=e.ctrlKey?[this._size.subtract(t),t]:[t];this._resetGesture(n);this.events.off(this.element,"mousedown",this._onMouseDown);this.events.onAll(document,{mousedown:this._onMouseDown,mouseup:this._onMouseUp,click:this._onClick,mousemove:this._onMouseMove},!0)}};t.prototype._onMouseMove=function(e){e.preventDefault();this._updateSize(!1);var t=this._transformToElement(e),n=e.ctrlKey?[this._size.subtract(t),t]:[t];4===this._gestureMode.peek()&&this._continueGesture(n)};t.prototype._onClick=function(e){Date.now()-this._lastActiveMouseUp<100&&e.stopPropagation()};t.prototype._onMouseUp=function(e){if(0===e.button){if(this._isActive()){this._lastActiveMouseUp=Date.now();e.preventDefault()}this._updateSize(!1);if(4===this._gestureMode.peek()){this._clearGesture();this._gestureMode(0)}this._isActive(!1);this.events.off(document,"mousedown",this._onMouseDown,!0);this.events.off(document,"mouseup",this._onMouseUp,!0);this.events.off(document,"mousemove",this._onMouseMove,!0);this.events.on(this.element,"mousedown",this._onMouseDown)}};t.prototype._onTouchStart=function(e){if(this._isEnabled.peek()){this._isActive.peek()&&(!this._useNativePan||e.touches.length>1)&&e.preventDefault();this._updateSize(0===this._touchCount);var t=this._touchCount;this._touchCount+=e.changedTouches.length;if(!t&&this._touchCount){this._gestureMode(1);this.events.off(this.element,"touchstart",this._onTouchStart);this.events.onAll(document,{touchstart:this._onTouchStart,touchmove:this._onTouchMove,touchend:this._onTouchEnd,touchcancel:this._onTouchCancel},!0)}else 1===this._gestureMode.peek()&&this._clearGesture();1===this._gestureMode.peek()&&this._resetGesture(this._getPointsFromTouches(e.touches))}};t.prototype._onTouchMove=function(e){(!this._useNativePan||e.touches.length>1)&&e.preventDefault();this._updateSize(!1);this._continueGesture(this._getPointsFromTouches(e.touches))};t.prototype._onTouchEnd=function(e){this._isActive.peek()&&e.preventDefault();this._updateSize(!1);this._removeTouches(e)};t.prototype._onTouchCancel=function(e){this._updateSize(!1);this._removeTouches(e)};t.prototype._removeTouches=function(e){var t=this._touchCount;this._touchCount-=e.changedTouches.length;1===this._gestureMode.peek()&&this._clearGesture();if(t&&!this._touchCount){1===this._gestureMode.peek()&&this._gestureMode(0);this._isActive(!1);this.events.off(document,"touchstart",this._onTouchStart,!0);this.events.off(document,"touchmove",this._onTouchMove,!0);this.events.off(document,"touchend",this._onTouchEnd,!0);this.events.off(document,"touchcancel",this._onTouchCancel,!0);this.events.on(this.element,"touchstart",this._onTouchStart)}else 1===this._gestureMode.peek()&&this._resetGesture(this._getPointsFromTouches(e.touches))};t.prototype._onPointerDown=function(e){if(this._isEnabled.peek()){var t=this._allowedModes,n=e.pointerType,r="mouse"===n?4:"pen"===n?2:1;if(t&r&&!this._pointers[e.pointerId]){var i=0===this._pointerCount;!this._isActive.peek()||this._useNativePan&&i||e.preventDefault();this._updateSize(i);this._pointers[e.pointerId]=this._transformToElement(e);this._pointerCount++;if(i){this._gestureMode(r);this.events.off(this.element,"pointerdown",this._onPointerDown);this.events.onAll(document,{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerup:this._onPointerUp,pointercancel:this._onPointerCancelOrLost,lostpointercapture:this._onPointerCancelOrLost},!0)}else this._isPointerGesture()&&this._clearGesture();this._isPointerGesture()&&this._resetGesture(this._getPointsFromPointers())}}};t.prototype._onPointerMove=function(e){if(this._pointers[e.pointerId]){(!this._useNativePan||this._pointerCount>1)&&e.preventDefault();this._updateSize(!1);this._pointers[e.pointerId]=this._transformToElement(e);this._isPointerGesture()&&this._continueGesture(this._getPointsFromPointers())}};t.prototype._onPointerUp=function(e){this._isActive()&&e.preventDefault();this._onPointerCancelOrLost(e)};t.prototype._onPointerCancelOrLost=function(e){this._updateSize(!1);this._removePointers(e)};t.prototype._removePointers=function(e){if(this._pointers[e.pointerId]){delete this._pointers[e.pointerId];this._pointerCount--;this._isPointerGesture()&&this._clearGesture();if(0===this._pointerCount){this._isPointerGesture()&&this._gestureMode(0);this._isActive(!1);this.events.off(document,"pointerdown",this._onPointerDown,!0);this.events.off(document,"pointermove",this._onPointerMove,!0);this.events.off(document,"pointerup",this._onPointerUp,!0);this.events.off(document,"pointercancel",this._onPointerCancelOrLost,!0);this.events.off(document,"lostpointercapture",this._onPointerCancelOrLost,!0);this.events.on(this.element,"pointerdown",this._onPointerDown)}else this._isPointerGesture()&&this._resetGesture(this._getPointsFromPointers())}};t.prototype._clearGesture=function(){this._gesturePoints=null;this._initialCenterPx(null)};t.prototype._continueGesture=function(e){this._gesturePoints=e;this._initialCenterPx.peek()||this._resetGesture(e);var t,n=i.e.getCenter(e),r=this._getRadius(e,n),o=this._initialRadius.peek();t=0!==r&&0!==o?r/o:1;var u=this._initialTransformV.peek().scale*t,a=this._constrainScale(u)/u,f=this._initialCenterPx.peek(),l=s.e.zoom(i.e.ORIGIN,f,t*a),c=new s.e(n.subtract(f));this._incrementTransformPx(c.multiply(l));!this._isActive.peek()&&this._mayStartPan(this._incrementTransformPx.peek(),r-o,e)&&this._isActive(!0)};t.prototype._resetGesture=function(e){this._gesturePoints=e;var t=i.e.getCenter(e),n=this._getRadius(e,t);this._initialCenterPx(t);this._initialRadius(n)};t.prototype._getRadius=function(e,t){for(var n=0,r=0,i=e;r<i.length;r++){n+=i[r].distance(t)}return n/e.length};t.prototype._getPointsFromTouches=function(e){for(var t=[],n=0;n<e.length;n++)t.push(this._transformToElement(e[n]));return t};t.prototype._getPointsFromPointers=function(){var e=[];for(var t in this._pointers)e.push(this._pointers[t]);return e};t.prototype._updateSize=function(e){void 0===e&&(e=!0);if(!this._size||e){var t=this.element.getBoundingClientRect();this._size=new i.e(t.width,t.height);this._clientToElementTransform=new s.e(new i.e(-t.left,-t.top))}};t.prototype._transformToElement=function(e){return this._clientToElementTransform.apply(new i.e(e.clientX,e.clientY))};t.prototype._isPointerGesture=function(){return 7&this._gestureMode.peek()};return t})(o.t);t.t=f;function l(e,t,n){return e.translate.abs()>=10||Math.abs(t)>=10}function c(e){return e}function h(e,t){return e===t||!(!e||!t)&&(e.x===t.x&&e.y===t.y)}function p(e,t){return e===t||!(!e||!t)&&(h(e.translate,t.translate)&&e.scale===t.scale)}}],Array(56),[function(e,t,n){"use strict";var r=n(0),i=n(2046),s=n("knockout-lib"),o=n(2503),u=n(2745),a=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;n.createComputed(n._computeUpdate);return n}t.prototype._computeUpdate=function(){var e=this,t=this.unwrapObservable(this.valueAccessor());if(t){var n,r,i;switch(t.type){case"get":if(t.url){i=!0;r=function(e){e.src=t.url}}break;case"content":i=!0;r=function(n){if(Object(u.e)())n.srcdoc=t.content;else{var r=new Blob([t.content],{type:"text/html"}),i=window.URL.createObjectURL(r);e.scope.attach({dispose:function(){window.URL.revokeObjectURL(i)}});n.src=i}};break;case"post":if(t.url){i=!0;n=function(e){Object(o.e)({url:t.url,postdata:t.postdata,document:e.contentDocument})}}}var a=i&&(this._iframe||document.createElement("iframe"));(function(e,t){if(e){t.className&&(e.className=t.className);t.title&&(e.title=t.title);t.role&&e.setAttribute("role",t.role);"string"==typeof t.sandbox&&e.setAttribute("sandbox",t.sandbox);e.frameBorder="0"}})(a,t);r&&r(a);if(a&&!this._iframe){this._iframe=a;this.events.on(a,"load",this._onLoad);s.virtualElements.setDomNodeChildren(this.element,[a]);s.utils.domNodeDisposal.addDisposeCallback(a,function(){e.events.off(a,"load",e._onLoad);(function(e){e.src="";e.srcdoc=""})(a)})}n&&n(a);if(a);else{s.virtualElements.emptyNode(this.element);this._iframe=void 0}}else{s.virtualElements.emptyNode(this.element);this._iframe=void 0}};t.prototype._onLoad=function(e){var t=this.peekUnwrapObservable(this.valueAccessor());t.onLoad&&t.onLoad(e)};t.supportsVirtualElements=!0;return t})(i.t);t.e=a}],Array(72),[function(e,t,n){"use strict";var r=new(n(7).t)({name:"AccessibilityMode.key"});t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r=n(7),i=new r.t({name:"".concat("OneUpOnePlayerFlightResourceKeys",".isOnePlayerEnabled"),factory:new r.e(!1)}),s=new r.t({name:"".concat("OneUpOnePlayerFlightResourceKeys",".isOnePlayerVroomTranscriptsEnabled"),factory:new r.e(function(){return!1})})}],Array(29),[function(e,t,n){"use strict";var r=n(0),i=n(3221),s=n(2063),o=n(91),u=n(171),a=n(334),f=n(63),l=n("knockout-lib"),c=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.itemSet,i=void 0===r?n.resources.consume(u.u):r,s=t.indexResolver;n._itemSet=i;n._indexResolver=s;return n}t.prototype.resolveSelection=function(e){var t=this._getUnresolvedIndices(e);return t.length?this._resolveIndices(t):o.n.wrap()};t.prototype._isItemResolved=function(e){return this._indexResolver.isItemResolved(e)};t.prototype._resolveIndices=function(e){return this._indexResolver.resolveIndices(e)};t.prototype._getUnresolvedIndices=function(e){for(var t=this._itemSet.peek().content.peek().items,n=[],r=0,i=e;r<i.length;r++){var s=i[r],o=t[s];this._isItemResolved(o)||n.push(s)}return n};return t})(n(1121).default),h=n(2059),p=n(3222),d=n(2696),v=n(2096),m=n(1322),g=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=this,r={getItemKey:b};l.utils.extend(r,t||{});n=e.call(this,r)||this;var i=t.itemSet,o=void 0===i?n.resources.consume(u.u):i,a=t.indexResolver,f=t.enableSelectionResolution,m=void 0===f||f;n.itemSet=o;n.itemProvider=n.resources.consume(s.resourceKey);n._enableSelectionResolution=m;n._itemParentHelper=n.resources.consume(h.e);n._refreshMessageHelper=n.resources.consume(p.e);n._currentItems=n.createPureComputed(n.computeCurrentItems);n._itemKey=n.createPureComputed(n._computeItemKey);n._useItemCacheData=n.resources.consume(d.e);n._itemsStore=n.resources.consume(v.t);n.createComputed(function(){n._onItemSetChanged(n._currentItems())});n.createComputed(n._computeResetSelectionOnKeyChange);a&&(n._selectionResolver=new(n.managed(c))({itemSet:n.itemSet,indexResolver:a}));n._itemCacheToKOStoreDataSource=n._getItemCacheToKOStoreDataSource();n.observables.backgroundCompute(n._computeOnItemCacheSelectionUpdate);return n}t.prototype.resolveSelection=function(){var e=this,t=this.itemSet.peek();if(!t)return o.n.wrap([]);if(this._enableSelectionResolution){if(this._selectionResolver){for(var n=[],r=this.getItems(),i=0;i<r.length;i++)(this.isIndexSelected(i)||!r[i]&&this.isAllSelected.peek())&&n.push(i);return this._selectionResolver.resolveSelection(n).then(function(){return e._unwrapSelection(e.selection.peek())})}var s={resolveAttempt:0,itemSet:t,missingRanges:null,pendingRanges:0,signal:new a.e,getItemPromises:[]};this.validateResolvedSelection(s);return s.signal.getPromise()}return o.n.wrap(this._unwrapSelection(this.selection.peek(),!0))};t.prototype.validateResolvedSelection=function(e){e.resolveAttempt++;if(e.resolveAttempt>4)e.signal.error({resultType:f.e.Failure,resultCode:"TooManyAttempts"});else{var t=this.getMissingRanges();e.getItemPromises=[];e.missingRanges=t;e.pendingCount=t.length;if(0===e.missingRanges.length)e.signal.complete(this._unwrapSelection(this.selection.peek()));else for(var n=0;n<5;n++)this.resolveNextRange(e)}};t.prototype.resolveNextRange=function(e){var t=this;if(e.missingRanges.length>0){var n=e.missingRanges.pop(),r=l.utils.extend({},e.itemSet.context);r.avoidSeamSnapping=!0;r.startIndex=n.start;r.endIndex=n.end;r.pageSize=n.end-n.start+1;e.getItemPromises.push(this.itemProvider.getItem(r).then(function(){e.pendingCount--;e.pendingCount?t.resolveNextRange(e):t.validateResolvedSelection(e)},function(n){t.cancelResolve(e,n)}))}};t.prototype.cancelResolve=function(e,t){for(var n=0;n<e.getItemPromises.length;n++)e.getItemPromises[n].cancel();t?e.signal.error(t):e.signal.cancel()};t.prototype.getMissingRanges=function(){var e=[],t=-1,n=-1,r=this.getMissingIndicies();if(r.length){t=r[0];n=r[r.length-1];for(;t>-1;){var i=Math.min(n,t+1e3-1),s={start:t,end:i};e.push(s);t=i===n?-1:i+1}}return e};t.prototype.computeCurrentItems=function(){var e=this.itemSet(),t=e&&e.content();return t&&t.items||[]};t.prototype._onItemSetChanged=function(e){var t=this,n=this.itemSet.peek(),r=n&&n.item&&this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(n.item.peek(),"list"));r&&r.list?this.getItemKey=y.bind(void 0,r.list.isDocumentLibrary):this.getItemKey=b;var i=n&&n.item&&n.item.peek()&&n.item.peek().key,s=!!i&&this._refreshMessageHelper.hasItemRefreshedRecently(i);this.onAddItem=s?function(e){return!t.isSelectedDefaultState||-1!==t.selection.indexOf(e)}:void 0;this.setItems(e,!1);this._refreshMessageHelper.clearRecentlyRefreshedItems()};t.prototype._computeResetSelectionOnKeyChange=function(){this._itemKey();this.clear(!0)};t.prototype._unwrapSelection=function(e,t){void 0===t&&(t=!1);for(var n=[],r=0,i=e;r<i.length;r++){var s=i[r],o=this.peekUnwrapObservable(s);!o&&t||n.push(o)}return n};t.prototype._computeItemKey=function(){var e=this.itemSet(),t=e&&e.item();return t&&t.key};t.prototype._computeOnItemCacheSelectionUpdate=function(){var e=this._itemCacheToKOStoreDataSource();if(e){for(var t=[],n=0,r=e.selectedKOItemKeys();n<r.length;n++){var i=r[n];if(i){var s=this._itemsStore.getItem(i);t.push(this.getItemKey(s))}}0===t.length?this.clear():this.setSelectedKeys(t)}};t.prototype._getItemCacheToKOStoreDataSource=function(){var e=this,t=this.observables.create();this.observables.backgroundCompute(function(){e._useItemCacheData.peek()?e.resources.consumeAsync(m.e.optional).then(function(e){e&&t(e)}):e._useItemCacheData()});return this.observables.pureCompute(function(){return e._useItemCacheData()?t():void 0})};return t})(i.e);function y(e,t){var n=t&&t.peek&&t.peek();return n&&n.properties&&(e?n.properties.uniqueId:n.properties.ID)||n&&n.key||null}function b(e){var t=e&&e.peek&&e.peek();return t&&t.key||null}t.e=g}],Array(24),[function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});var r=n(334),i=n(91),s=n(70);function o(e,t,n){return i.n.all([f(e),f(e,n)]).then(function(e){var n=e[0],r=e[1],i=r.length>n.length;return{text:i?n:r,mimeType:t,isSafeText:i||a(r)}},function(e){return e.filter(function(e){return!i.n.isCanceled(e)})[0]||e[0]})}function u(e,t){return f(e).then(function(e){return{text:e,mimeType:t,isSafeText:!0}})}function a(e){for(var t=0;t<e.length;t++)if(!(n=e.charCodeAt(t),n<127||l[n]))return!1;var n;return!0}function f(e,t){var n=new r.e,i=new FileReader;i.onload=function(){n.complete(i.result||"")};i.onerror=function(e){var t=i.error;n.error(new s.e({code:t&&(t.name||"Parse.".concat(t.code))||"Parse",isExpected:!1,message:t&&t.message||"Parsing error"}))};i.readAsText(e,t);return n.getPromise()}var l={130:1,132:1,133:1,134:1,135:1,137:1,139:1,145:1,146:1,147:1,148:1,149:1,150:1,151:1,153:1,155:1,160:1,166:1,167:1,169:1,171:1,172:1,173:1,174:1,176:1,177:1,181:1,182:1,183:1,187:1}},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(7),i=n(2432),s=new r.t({name:"ToolbarProvider.key",factory:i.e})}],Array(60),[function(e,t,n){"use strict";n.d(t,"e",function(){return k});var r=n(0),i=n(1121),s=n(2078),o=n(2056),u=n(2163),a=n(2107),f=n(2063),l=n(63),c=n(91),h=n(82),p=n(344),d=n(43),v=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="FileHandlerCreate";var r=n._fileHandlerAction=t.fileHandlerAction;n._itemProvider=n.resources.consume(f.resourceKey);n._urlDataSource=n.resources.consume(h.ve);r&&r.handler&&r.handler.isPromoted&&(n.name="PromotedFileHandlerCreate");return n}t.prototype.onIsAvailable=function(){if(!this._fileHandlerAction)return!1;var e=this._urlDataSource.getKeyParams(this.item().key);return this._urlDataSource.isCurrentQuery(d.e.Files,e)};t.prototype.onExecute=function(e,t){var n=this,r=this._fileHandlerAction;if(!r)return c.n.reject(new Error("No action registered for file handler"));var i=r.availableOn.file,s=i&&i.extensions&&i.extensions[0].replace(".","");if(!r.handler.isPromoted){var o=window.open("","_blank");o&&(o.opener=null)}var u=this.item.peek().key;return this._itemProvider.createCustomDocument(u,s).then(function(e){return e?n.resources.consumeAsync(p.t).then(function(t){return t.invokeAction({items:[e],action:r})}):c.n.wrapError()}).then(function(){return c.n.wrap({resultType:l.e.Success})},function(e){return c.n.wrap({resultType:c.n.isCanceled(e)?l.e.ExpectedFailure:l.e.Failure})})};return t})(a.e),m=n(2052),g=n(2060),y=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="FileHandlerCustom";var r=n._fileHandlerAction=t.fileHandlerAction;n._fileHandlerProvider=n.resources.consume(u.e);var i=r.availableOn;n._itemSelectionHelper=new(n.child(g.e))({overrideItem:t.item,allowMultiSelect:!!i.allowMultiSelect,canFallback:!!i.folder});r&&r.handler&&r.handler.isPromoted&&(n.name="PromotedFileHandlerCustom");return n}t.prototype.onIsAvailable=function(){if(!this._fileHandlerAction)return!1;var e=this._itemSelectionHelper.selection();return!!e&&!!e.length&&e.every(this._acceptItemObservable,this)};t.prototype.onExecute=function(e){var t,n=this,r=this._fileHandlerAction;if(!r)return c.n.reject("No action registered for file handler");if(!r.handler.isPromoted){if(!(t=window.open("","_blank")))return c.n.reject({resultType:l.e.ExpectedFailure,resultCode:"window.open"});t.opener=null}return this._itemSelectionHelper.resolveSelection().then(function(e){n.resources.consumeAsync(p.t).then(function(n){return n.invokeAction({items:e,action:r,target:t})})}).then(function(){return c.n.wrap({resultType:l.e.Success})},function(e){return c.n.wrap({resultType:c.n.isCanceled(e)?l.e.ExpectedFailure:l.e.Failure})})};t.prototype._acceptItemObservable=function(e){var t=e.peek(),n=this._fileHandlerAction;return!(!n||!t.graph)&&(t.folder?!!n.availableOn.folder&&!t.isRootFolder:this._fileHandlerProvider.isActionForExtension(n,t.extension))};return t})(m.e),b=n(3223),w=n(171),E=n(181),S=n(2055),x=n(18),T=n(7),N=n(119),C=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t,n)||this,u=t.sourceEngagementName,a=t.item,f=t.includeLegacyActions;i._sourceEngagementName=u;i._overrideItem=a;var l=i.observables;i._legacyCommandMap=l.create({});i._commandViewModelType=i.managed(s.e);i._actionMap=n.actionMap;i._customActionProvider=n.customActionProvider;i._fileHandlerProvider=n.fileHandlerProvider;i._commonParams={renderLabel:2,location:10};f&&i._loadLegacyCommandMap();i._commandMap=l.pureCompute(i._computeCommandMap);i._fullCommandMap=l.pureCompute(i._computeFullCommandMap);i._flatten=l.pureCompute(i._computeFlatten);i.newFileCommands=l.pureCompute(i._computeNewFileCommands);i.openWithCommands=l.pureCompute(i._computeOpenWithCommands);var c=l.createArray(),h=i.scope.attach(c.filter(function(e){return e.isVisible()}));i.actionsCommand=new i._commandViewModelType({text:S.Actions,icon:l.pureCompute(function(){return h().length>1?new o.e("SetAction"):void 0}),renderLabel:2,requiredChildren:1,collapseSingleChildCommands:!0,children:c});var p=l.pureCompute(i._computeCustomCommands);l.backgroundCompute(function(){c.splice.apply(c,Object(r.__spreadArray)([0,1/0],p(),!1))});return i}t.prototype._computeNewFileCommands=function(){var e=this._fileHandlerProvider;return e?e.data().actions.create.map(this._createNewFileCommand,this):[]};t.prototype._createNewFileCommand=function(e,t){var n=e.handler,r={text:e.handler.fileTypeDisplayName||x.format(S.CreateFileWithExtension,e.availableOn.file.extensions[0]),action:new(this.managed(v))({fileHandlerAction:e}),renderLabel:2,engagementName:"FileHandlerCreate",source:this._sourceEngagementName};0===t&&(r.hasLineBreakBefore=!0);var i=this._fileHandlerProvider.getIconUrl(e.icon||n.fileTypeIcon);i?r.iconUrl=i:r.icon=new o.e("Page");return new this._commandViewModelType(r)};t.prototype._computeOpenWithCommands=function(){var e=this._fileHandlerProvider;return e?e.data().actions.open.map(this._createOpenFileCommand,this):[]};t.prototype._createOpenFileCommand=function(e){var t=e.handler,n={fileHandlerAction:e};this._overrideItem&&(n.item=this._overrideItem);var r={text:e.displayName||x.format(S.OpenWithFileHandler,t.displayName),collapsedText:this.createObservable(S.Open),action:new(this.managed(b.e))(n),renderLabel:2,engagementName:t.isPromoted?"PromotedFileHandlerOpen":"FileHandlerOpen",source:this._sourceEngagementName,iconUrl:this._fileHandlerProvider.getIconUrl(e.icon||t.fileTypeIcon)};return new this._commandViewModelType(r)};t.prototype._computeCommandMap=function(){for(var e=this,t=this._fileHandlerProvider,n=t?t.data().actions.custom:[],i=this._commonParams,s={},o=this.observables,u=function(n){var u=n.handler,f=u.appId,l=s[f]||(s[f]=new a._commandViewModelType(Object(r.__assign)(Object(r.__assign)({},i),{iconUrl:t.getIconUrl(u.appIcon),text:u.actionMenuDisplayName||u.displayName,requiredChildren:1,collapseSingleChildCommands:!0}))),c=new a._commandViewModelType(Object(r.__assign)(Object(r.__assign)({},i),{text:o.pureCompute(function(){return!e._flatten()&&n.shortDisplayName||n.displayName}),collapsedText:o.create(n.displayName),iconUrl:t.getIconUrl(n.icon),action:new(a.managed(y))({fileHandlerAction:n}),engagementName:"FileHandlerCustom",source:a._sourceEngagementName}));l.children.push(c)},a=this,f=0,l=n;f<l.length;f++){u(l[f])}return s};t.prototype._loadLegacyCommandMap=function(){var e=this,t=this._customActionProvider,n=this._actionMap;t&&n&&t.getCustomActionData().then(function(i){var s={},o=[],u=i.ContextMenu;if(u&&0!==u.length){for(var a=e._commandViewModelType,f=e.managed(n.CustomActionNavigationAction),l=e.observables,c=e._commonParams,h=0,p=u;h<p.length;h++){var d=p[h],v=Object(r.__assign)(Object(r.__assign)({},c),{text:d.text});if(t.isGroup(d)){var m=d.children.map(function(e){return new a({text:e.text,engagementName:"CustomActionRibbonTab",iconUrl:e.iconUrl,renderLabel:2,action:new f({customAction:e})})});o.push(new a(Object(r.__assign)(Object(r.__assign)({},v),{tooltip:d.tooltip,requiredChildren:1,children:l.createArray(m)})))}else o.push(new a(Object(r.__assign)(Object(r.__assign)({},v),{iconUrl:d.iconUrl,engagementName:"CustomActionECB",action:new f({customAction:d})})))}s["Add-ins"]=new a(Object(r.__assign)(Object(r.__assign)({},c),{text:S.AddIns,children:l.createArray(o),requiredChildren:1}));e._legacyCommandMap(s)}})};t.prototype._computeFullCommandMap=function(){return Object(r.__assign)(Object(r.__assign)({},this._commandMap&&this._commandMap()||{}),this._legacyCommandMap&&this._legacyCommandMap()||{})};t.prototype._computeCustomCommands=function(){var e=this._fullCommandMap(),t=[],n=[],r=this._flatten();for(var i in e){for(var s=e[i],o=s.visibleChildren(),u=0,a=o;u<a.length;u++){var f=a[u];f.parentCommand=r?void 0:s;r&&(f.visibleChildren().length>1?t:n).push(f)}!r&&s.isVisible()&&(o.length>1?t:n).push(s)}return t.concat(n)};t.prototype._computeFlatten=function(){var e=this._fullCommandMap(),t=0,n=0,r=0;for(var i in e){var s=e[i].visibleChildren().length;s>1&&r++;s&&n++;t+=s;if(r>0&&n>1&&t>4)return!1}return!0};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.default.dependencies),{actionMap:w.e.optional,customActionProvider:E.t.optional,fileHandlerProvider:u.e.optional});return t})(i.default),k=new T.t({name:"FileHandlerCommands",factory:new N.r(C)})}],Array(18),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e,t){return{definitionKey:e,params:t}}},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n("react-lib"),s=n(63),o=n(87),u=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.state={hasError:!1};return n}t.getDerivedStateFromError=function(e){return{hasError:!0}};t.prototype.render=function(){return this.state.hasError?null:i.createElement(i.Fragment,null,this.props.children)};t.prototype.componentDidCatch=function(e,t){var n=this.props.onError;o.e.logError(e,{"react.componentStack":t.componentStack,"react.component":this.props.componentName},{eventName:"ReactRenderError",resultCode:"",resultType:s.e.Failure});n&&n(e)};return t})(i.PureComponent)}],Array(119),[function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(1121),s=n(119),o=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r._recordsByThumbnailKey={};r._bucketsByImageKey={};var i=r.observables;r.lastAccessedDate=i.create(new Date);var s=n.pruneThumbnailsExtenders,o=void 0===s?{rateLimit:{timeout:6e5}}:s;i.backgroundCompute(r._pruneThumbnails).extend(o);return r}t.prototype.getCoveragePercent=function(e,t){var n=l(e),r=l(t);return Math.sqrt(r/n)};t.prototype.register=function(e,t,n,r){void 0===n&&(n=t);void 0===r&&(r=!0);var i=this.lastAccessedDate;i(new Date);var s=f(this.getCoveragePercent(e,n)),o=a(e),u=a(t),l=this._recordsByThumbnailKey,c=this._bucketsByImageKey,h=l[o]||{lastAccessed:void 0,buckets:{}};h.lastAccessed=i.peek();var p=h.buckets[s];if(!p||this.getCoveragePercent(p.size,n)>1){p&&delete c[p.key];p=h.buckets[s]={key:u,size:n,image:t,isLoaded:r,lastAccessed:i.peek()}}c[u]=p;l[o]=h};t.prototype.record=function(e){var t=this.lastAccessedDate;t(new Date);var n=a(e),r=this._bucketsByImageKey,i=r[n];i?i.isLoaded=!0:r[n]={key:n,size:e,image:e,isLoaded:!0,lastAccessed:t.peek()}};t.prototype.isLoaded=function(e){var t=this.lastAccessedDate;t(new Date);var n=a(e),r=this._bucketsByImageKey[n];r&&(r.lastAccessed=t.peek());return!!r&&r.isLoaded};t.prototype.retrieve=function(e,t,n){void 0===t&&(t=1);void 0===n&&(n=t);var r=a(e),i=this._recordsByThumbnailKey[r],s=this.lastAccessedDate;s(new Date);if(i){var o=i.buckets;i.lastAccessed=s.peek();var u=f(t),l=f(n),c=-1/0,h=!1;for(var p in o){var d=Number(p);if(d<=u&&d>=l&&o[d].isLoaded){c=Math.max(c,d);h=!0}}var v=h&&o[c];return v&&v.image}};t.prototype._pruneThumbnails=function(){var e=this.lastAccessedDate().getTime();c(this._recordsByThumbnailKey,e);c(this._bucketsByImageKey,e)};return t})(i.default),u=Object(s.s)("ThumbnailCache",o);function a(e){var t=e.url,n=e.width,r=e.height;return JSON.stringify({url:t,width:n,height:r})}function f(e){return Math.floor(Math.log(e)/Math.log(2)*4)}function l(e){return e.width*e.height}function c(e,t){for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];t-e[i].lastAccessed.getTime()>432e5&&delete e[i]}}},function(e,t,n){"use strict";var r=n("knockout-lib"),i=(function(){function e(){}e.init=function(e,t,n,i,s){var o=r.utils.unwrapObservable(t()),u=o&&o.activate||o;u&&u.call(s.$data,e)};e.supportsVirtualElements=!0;return e})();t.e=i},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.share=1]="share";e[e.copyLink=2]="copyLink";e[e.manageAccess=5]="manageAccess";e[e.addPeople=7]="addPeople"})(r||(r={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r={sharepoint:0,microservice:1}},function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.commandSets,i=void 0===r?[]:r;n._commandSets=n.wrapObservable(i);n.createComputed(n._computeUpdateCommandSet);return n}t.prototype._computeUpdateCommandSet=function(){for(var e,t,n=[],i=[],s=[],o=0,u=this._commandSets();o<u.length;o++){for(var a=u[o],f=this.observables.unwrap(a),l=[],c=0,h=f.commands();c<h.length;c++){var p=h[c];p===f.overflowHostCommand?s.push.apply(s,p.children()):4==(4&p.location)?l.push(p):n.push(p)}i.unshift.apply(i,l)}var d=this.overflowHostCommand.children.peek();(e=this.overflowHostCommand.children).splice.apply(e,Object(r.__spreadArray)([0,d.length],s,!1));n.push(this.overflowHostCommand);n.push.apply(n,i);(t=this.commands).splice.apply(t,Object(r.__spreadArray)([0,this.commands.peek().length],n,!1))};return t})(n(2158).t);t.e=i},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(7),i=n(119),s=new r.t({name:"LegacyDetailsPaneHost.key",loader:new i.t(function(){return n.ee([317,"deferred","deferred.items-view","deferred.odsp-common","deferred.odsp-datasources","deferred.odsp-shared-react","deferred.office-ui-fabric-react","deferred.resx-deferred","odsp.react.lib","ondemand.resx-ondemand"],3767).then(function(e){return e.resourceKey.local})})})}],Array(54),[function(e,t,n){"use strict";var r=n(170);Object(r.n)([{rawString:".Carousel{position:absolute;left:0;right:0;top:0;bottom:0;overflow:hidden;-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.Carousel-platform{z-index:0;position:absolute;top:0;left:0;width:100%;height:100%;transform-origin:0 0;touch-action:none}.Carousel-platform.is-enabled{will-change:transform;-webkit-backface-visibility:hidden;backface-visibility:hidden;perspective:1000}.Carousel-slide{position:absolute;left:0;top:0;width:100%;height:100%;z-index:1;opacity:0;visibility:hidden;transition:opacity 0s linear .3s,visibility 0s linear .3s,transform 0s linear}.Carousel-slide.is-current.is-loaded{opacity:1;visibility:inherit;transition-delay:0s,0s,0s}.Carousel-slide.is-current.is-deleted,.Carousel-slide.is-deleted{z-index:0;opacity:0;visibility:hidden;transition-duration:0s,0s,0s;transition-delay:0s,0s,0s}.Carousel-platform.is-enabled .Carousel-slide{will-change:transform;-webkit-backface-visibility:hidden;backface-visibility:hidden;perspective:1000}.Carousel-platform.is-flipping .Carousel-slide{transition-duration:0s,0s,0s;transition-delay:0s,0s,0s}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='1']{z-index:10}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='1'].is-current.is-loaded{transition-duration:.3s,0s,.3s}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='2']{z-index:9}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='2'].is-loaded{transition-duration:.3s,0s,.3s;transition-delay:.3s,.6s,0s}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='3']{z-index:8}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='4']{z-index:7}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='5']{z-index:6}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='6']{z-index:5}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='7']{z-index:4}.Carousel-platform.is-flipping .Carousel-slide[data-item-order='8']{z-index:3}html[dir=ltr] .Carousel-platform.is-flipping .Carousel-slide[data-item-direction='1']{transform:translate(2%,0)}html[dir=rtl] .Carousel-platform.is-flipping .Carousel-slide[data-item-direction='1']{transform:translate(-2%,0)}html[dir=ltr] .Carousel-platform.is-flipping .Carousel-slide[data-item-direction='-1']{transform:translate(-2%,0)}html[dir=rtl] .Carousel-platform.is-flipping .Carousel-slide[data-item-direction='-1']{transform:translate(2%,0)}.Carousel-platform.is-rotating .Carousel-slide{transition-delay:0s,0s,0s;transition-duration:0s,0s,0s}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='2']{transform:translate(204%,0)}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='1']{transform:translate(102%,0)}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='-1']{transform:translate(-102%,0)}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='-2']{transform:translate(-204%,0)}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='-1'],.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='-2'],.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='1'],.Carousel-platform.is-rotating .Carousel-slide[data-item-offset='2']{visibility:inherit;opacity:1}.Carousel-platform.is-gliding{transition:transform .3s ease-out}.Carousel-platform.is-gliding .Carousel-slide[data-item-offset='-1'],.Carousel-platform.is-gliding .Carousel-slide[data-item-offset='-2'],.Carousel-platform.is-gliding .Carousel-slide[data-item-offset='1'],.Carousel-platform.is-gliding .Carousel-slide[data-item-offset='2']{transition-delay:.3s,.3s,0s}"}]);var i=n(2045),s=n(0),o=n("knockout-lib"),u=n(265),a=n(667),f=n(1761),l=n(2654),c=n(2044),h=n(2085),p=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({host:h.e});n.item=t.item;n.offset=t.offset;n.loadState=t.loadState||n.observables.create(0);n.order=t.order||n.observables.create(1);n.direction=n.createComputed(n._computeDirection);return n}t.prototype._computeDirection=function(){var e=this.offset();return e>0?1:e<0?-1:0};return t})(c.t),d=n(2746),v=(function(e){Object(s.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.addBindingHandlers({host:h.e,pan:d.t});var i=t.item,s=t.items,o=t.isEnabled,u=void 0===o||o,a=t.isRotating,l=void 0===a?r.createObservable(!1):a,c=t.loadState,p=void 0===c?r.createObservable(0):c,v=t.allocationRange,m=void 0===v?r.createObservable({start:0,end:0}):v;r.item=i;r._items=s;r._slideAllocationCount=r.createPureComputed(function(){return!t.canNavigate||t.canNavigate()?15:1});r._allocationRange=m;r.isEnabled=r.wrapObservable(u);r.isRotating=l;r.loadState=p;r._rotationThreshold=.3;r._velocityThreshold=1;r._index=r.createPureComputed(r._computeIndex);r._lastValidIndex=r.createPureComputed(r._computeLastValidIndex);r._itemsInSlides=r.observables.createArray();r._itemHistory=r.observables.createArray();r.createBackgroundComputed(r._computeUpdateItemHistory);r.createBackgroundComputed(r._computeCleanItemHistory).extend({rateLimit:{timeout:600,method:"notifyWhenChangesStop"}});r._elementsToRemove=r.observables.createArray();r._initializeSlides();r._initializeMotion();r.carouselTransform=r.createPureComputed(r._computeCarouselTransform);r.carouselTransform.equalityComparer=f.e;r._initializeDirection();r.createBackgroundComputed(r._computeSwitchItemsOnItemRemoval);r.createBackgroundComputed(r._computeAllocationRange);r.createBackgroundComputed(r._computeItemsInSlides);r.createBackgroundComputed(r._computeElementsToRemove).extend({rateLimit:{timeout:1e3,method:"notifyWhenChangesStop"}});r.platformStyle=r.createPureComputed(r._computePlatformStyle);r.panBindingParams={isActive:r.isPowered,isEnabled:r.isEnabled,transform:r.panTransform,mayStartPan:function(e,t,n){return r.isEnabled.peek()&&Math.abs(e.translate.x)>=10&&t<5&&n.length<2},allowedModes:7};return r}t.prototype.onSlideRemoved=function(e){o.utils.toggleDomNodeCssClass(e,"is-deleted",!0);o.utils.toggleDomNodeCssClass(e,"is-current",!1);this._elementsToRemove.push(e)};t.prototype._initializeMotion=function(){this.isFlipping=this.createObservable(!0);this.isPowered=this.createObservable(!1);this.isGliding=this.createObservable(!1);this.panTransform=this.createObservable(a.e.IDENTITY);this.panTransform.equalityComparer=f.e;this._initializeVelocity();this.createBackgroundComputed(this._computeStartPowered);this.createBackgroundComputed(this._computeRotateToSlide);l.e(this.createBackgroundComputed(this._computeStartGlide),this.async);this.createBackgroundComputed(this._computeEndGlide).extend({rateLimit:{timeout:600,method:"notifyWhenChangesStop"}});this.createBackgroundComputed(this._computeEndRotation)};t.prototype._computeStartPowered=function(){if(this.isPowered()){this.isRotating(!0);this.isGliding(!1);this.isFlipping(!1)}};t.prototype._computeStartGlide=function(){var e=this.isPowered(),t=this.isFlipping.peek();if(!e&&!t){this.panTransform(a.e.IDENTITY);this.isGliding(!0);this.isRotating(!0)}};t.prototype._computeEndGlide=function(){var e=this.isPowered.peek(),t=this.isGliding();if(!e&&t){this.isGliding(!1);this.isRotating(!1)}};t.prototype._computeEndRotation=function(){this.isRotating()||this.isFlipping(!0)};t.prototype._initializeDirection=function(){var e=this,t=this._index.peek();this.addDisposable(this.item.subscribe(function(){t=e._index.peek()},this,"beforeChange"));this.createBackgroundComputed(function(){e.isFlipping()&&(t=e._index.peek())});this.direction=this.createPureComputed(function(){var n=e._index();return e.isFlipping()&&n>-1&&t>-1?Math.max(-1,Math.min(1,n-t)):0})};t.prototype._initializeSlides=function(){var e=this,t=this.addDisposable(this._itemsInSlides.filter(function(t){return t&&(e._items.indexOf(t)>-1||t===e.item())}));this.slides=this.addDisposable(t.map({mappingWithDisposeCallback:function(t){var n=e.createObservable(0),r=e.createPureComputed(function(){return e._items.indexOf(t)}),i=e.createPureComputed(function(){return r()-e._index()}),s=e.createComputed(function(){i()||e.loadState(n())}),o=e.createPureComputed(function(){return e._itemHistory.indexOf(t)+1}),u=new(e.resources.injected(p))({item:t,offset:i,loadState:n,order:o});return{mappedValue:u,dispose:function(){u.dispose();i.dispose();r.dispose();s.dispose();o.dispose()}}}}))};t.prototype._computeAllocationRange=function(){var e=this.item(),t=this._items,n=t().length,r=this._itemsInSlides.peek(),i=t.indexOf(e),s=r.indexOf(e),o=this._slideAllocationCount();if((-1===s||i>=2&&s<2||i<=n-1-2&&s>r.length-1-2||n<=o&&n!==r.length)&&i>-1)if(o>1){var u=i+this.direction.peek()*(.8*(Math.floor(o/2)-2)),a=Math.max(0,Math.min(n-o,u-Math.floor(o/2))),f=Math.min(n,a+o);this._allocationRange({start:a,end:f})}else this._allocationRange({start:i,end:i+1})};t.prototype._computeItemsInSlides=function(){var e,t,n=this._allocationRange();if(this._index()>-1&&n.end-n.start>0)t=this._items.slice(n.start,n.end);else{var r=this.item();t=r?[r]:[]}(e=this._itemsInSlides).splice.apply(e,Object(s.__spreadArray)([0,this._itemsInSlides.peek().length],t,!1))};t.prototype._computeSwitchItemsOnItemRemoval=function(){var e=this.item.peek(),t=this._items.indexOf(e),n=this._lastValidIndex();if(-1===t&&e&&n>-1){var r=this._items.peek(),i=Math.max(0,Math.min(r.length-1,n));r[i]&&this.item(r[i])}};t.prototype._computeUpdateItemHistory=function(){var e=this.item();this._itemHistory.unshift(e)};t.prototype._computeCleanItemHistory=function(){this._itemHistory().length>1&&this._itemHistory.splice(1,this._itemHistory().length)};t.prototype._computeElementsToRemove=function(){this.item();this._itemsInSlides();for(var e;e=this._elementsToRemove.shift();)o.removeNode(e)};t.prototype._initializeVelocity=function(){var e=this,t=this.panTransform.peek(),n=0;this.velocity=this.createPureComputed(function(){var r=e.panTransform(),i=(new Date).getTime(),s=r.translate.subtract(t.translate).scale(1e3/(i-n));n=i;t=r;return s});this.velocity.equalityComparer=f.e};t.prototype._computeRotateToSlide=function(){var e=this.isPowered(),t=this.isFlipping.peek();if(!e&&!t){var n=this.panTransform.peek().translate.negate(),r=this.velocity.peek().negate(),i=this._index.peek(),s=this._calculateFractionalIndexOffset(n,r)+n.x;this.item(this._items.peek()[Math.max(0,Math.min(this._items.peek().length-1,i+Math.round(s)))]);this.panTransform(new a.e(new u.e(this._index.peek(),0).subtract(new u.e(i,0).add(n))))}};t.prototype._calculateFractionalIndexOffset=function(e,t){var n=0;e.x>this._rotationThreshold&&e.x<.5?n+=.5:e.x<-this._rotationThreshold&&e.x>-.5&&(n-=.5);t.x>this._velocityThreshold&&e.x<.5?n+=.5:t.x<-this._velocityThreshold&&e.x>-.5&&(n-=.5);return n=Math.max(-1,Math.min(1,n))};t.prototype._computeCarouselTransform=function(){var e=this.panTransform().translate,t=this._items.peek().length,n=this._index.peek();if(-1===n){n=0;t=1}var r=-e.x,i=r,s=n+r;if(s<0||s>t-1){var o=r>0?Math.floor:Math.ceil,f=Math.max(0-n,Math.min(t-1-n,o(r))),l=Math.PI;i=Math.atan(l*(r-f))/l+f}return new a.e(new u.e(-i,e.y))};t.prototype._computeIndex=function(){return this._items.indexOf(this.item())};t.prototype._computeLastValidIndex=function(){var e=this._items.indexOf(this.item());if(e<0){var t=this._lastValidIndex.peek();if("number"==typeof t)return t}return e};t.prototype._computePlatformStyle=function(){var e=this.carouselTransform(),t="translate(".concat(100*e.translate.x,"%, 0)");return{"-ms-transform":t,"-webkit-transform":t,transform:t}};return t})(c.t),m=i.e({tagName:"ms-carousel",template:"<div class=\"Carousel\"><div class=\"Carousel-platform\" data-bind=\"template:{foreach:slides,beforeRemove:$component.onSlideRemoved.bind($component),dontLimitMoves:true},pan:panBindingParams,style:platformStyle,css:{'is-flipping':isFlipping,'is-rotating':isRotating,'is-enabled':isEnabled,'is-powered':isPowered,'is-gliding':isGliding,'is-rotating-forward':direction()>0,'is-rotating-backward':direction()<0}\"><div class=\"Carousel-slide\" data-bind=\"host:{},attr:{'data-item-offset':offset,'data-item-order':order,'data-item-direction':direction},css:{'is-current':item&&item===$component.item(),'is-loaded':!!loadState()}\"></div></div></div>",viewModel:v,synchronous:!0});t.e=m}],Array(17),[function(e,t,n){"use strict";var r=n(0),i=n(1121),s=n(91),o=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.key=t.key;var r=n.observables,i=t.count,s=void 0===i?r.create(1):i,o=t.isAvailable,a=void 0===o?r.create(!0):o,f=t.onExecute,l=void 0===f?u:f;n.count=s;n.isAvailable=a;n._onExecute=l.bind(t.operation);return n}t.prototype.dispose=function(){e.prototype.dispose.call(this);this._onExecute=u};t.prototype.execute=function(){return this._onExecute()};return t})(i.default);function u(){return s.n.wrap()}t.e=o},function(e,t,n){"use strict";n(1735);var r=n(640),i=n("knockout-lib"),s=(function(){function e(e,t){var n=this;this._source=e;this._getKey=t;this._groupsByKeyId={};this.groups=i.observableArray();this._initializeGroups();Object(r.e)(this.groups,function(){n._mapping.dispose()})}e.group=function(t,n){return new e(t,n).groups};e.prototype._initializeGroups=function(){var e=this;this._mapping=this._source.map({mappingWithDisposeCallback:function(t){var n=e._getKey(t),r=JSON.stringify(n),s=e._groupsByKeyId[r];if(s)s.values.push(t);else{s={key:n,values:i.observableArray([t])};e._groupsByKeyId[r]=s;e.groups.push(s)}return{mappedValue:r,dispose:function(){if(s.values.peek().length>1)s.values.remove(t);else{delete e._groupsByKeyId[r];e.groups.remove(s)}}}}})};return e})();t.e=s},function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){var t;t={};for(var n=[],r=0,i=e;r<i.length;r++){var s=i[r],o="".concat(s);if(!t[o]){t[o]=!0;n.push(s)}}return n}},,,function(e,t,n){"use strict";var r=n("knockout-lib");n(2252),n(2594);window.__ko=r},,,,function(e,t,n){"use strict";var r=n(0),i=n(1121),s=n(898),o=(function(e){Object(r.__extends)(t,e);function t(n){var r=e.call(this,n)||this;r._clearFocusIsUserInput=function(){r.isDisposed||(r._focusIsUserInput=!1)};r._keyForItem=new Map;r._focusIsUserInput=!1;r.mode=n.mode||0;r.maximumSelectedCount=n.maximumSelectedCount;r.getItemKey=n.getItemKey;r._canSelectItem=n.canSelectItem||u;r._selectionModelGroup=n.selectionModelGroup;r._allSelectables={};r._items=[];r.selectedCount=r.createObservable();r.selection=r.observables.createArray().extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}});r.isAllSelected=r.createObservable(!1).extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}});r.focusedItem=r.createObservable();r.focusedItem.equalityComparer=s.n;r.isActive=r.createObservable(!0);r.clear(!0);r._clearFocusIsUserInput=r.async.throttle(r._clearFocusIsUserInput,0,{trailing:!0});r._selectionModelId="".concat(++t._nextSelectionModelId);r._selectionModelGroup&&r._selectionModelGroup.registerSelectionModel(r,r._selectionModelId);return r}Object.defineProperty(t.prototype,"getItemKey",{get:function(){return this._getItemKey},set:function(e){var t=this._keyForItem;t.clear();this._getItemKey=function(n){var r=t.get(n);if(!r){r=e(n);t.set(n,r)}return r}},enumerable:!1,configurable:!0});t.prototype.dispose=function(){e.prototype.dispose.call(this);this._selectionModelGroup&&this._selectionModelGroup.unregisterSelectionModel(this._selectionModelId);this._allSelectables={};this._keyForItem.clear()};t.prototype.clear=function(e){this.isSelectedDefaultState=!1;this._keysExempt={};this._exemptCount=0;if(e){this._focusIndex=-1;this._anchorIndex=-1;this._anchorKey=null;this._focusIsUserInput=!1;this.focusedItem(null)}this.selection.removeAll();this.isAllSelected(!1);this._updateAllSelectables();this._updateSelectedCount()};t.prototype.setItems=function(e,t){this._items=e;this._selectableItems=this._items;t&&this.clear(!0);this._onItemsChanged(!0)};t.prototype.setAllFocusableItems=function(e){this._items=e;this._focusIndex=-1;this._onItemsChanged(!1)};t.prototype.getItems=function(){return this._items};t.prototype.canSelectItem=function(e){var t=this.getItemKey(e);return(!this.maximumSelectedCount||this.selectedCount()<this.maximumSelectedCount||this.isItemSelected(e))&&t&&this._selectableItemsMap[t]&&this._canSelectItem(e)};t.prototype.isItemSelected=function(e){var t=this.getItemKey(e),n=!!this._keysExempt[t];return this._canSelectItem(e)&&(this.isSelectedDefaultState&&!n||!this.isSelectedDefaultState&&n)};t.prototype.setSelectedKeys=function(e){var t=[];this._keysExempt={};for(var n=0,r=e;n<r.length;n++){var i=r[n],s=this._keyToIndex[i];if(s>=0){var o=this._items[s];if(this.canSelectItem(o)){this._keysExempt[i]=o;t.push(o)}}}this._exemptCount=t.length;this.isSelectedDefaultState=!1;this.selection(t);this._updateIsAllSelected();this._updateSelectedCount();this._updateAllSelectables();this._selectionModelGroup&&t.length&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)};t.prototype.isKeySelected=function(e){var t=!!this._keysExempt[e];return!!(this.selectedCount.peek()>0&&this.isAllSelected.peek()&&!t||!this.isAllSelected.peek()&&t)};t.prototype.getFocusedKey=function(){var e=this.focusedItem.peek();return e?this.getItemKey(e):null};t.prototype.isIndexSelected=function(e){var t=this._items[e];return this.isItemSelected(t)};t.prototype.setItemSelected=function(e,t){this._setItemSelectedCore(e,t,!0)};t.prototype.setIndexSelected=function(e,t){this.setItemSelected(this._items[e],t)};t.prototype.toggleItemSelected=function(e){this.setItemSelected(e,!this.isItemSelected(e))};t.prototype.toggleIndexSelected=function(e){this.toggleItemSelected(this._items[e])};t.prototype.setItemFocus=function(e,t){void 0===t&&(t={});var n=t.preventAnchor,r=void 0!==n&&n,i=t.isFocusInput,s=void 0===i||i,o=this.focusedItem.peek(),u=this.getItemKey(e),a=this._keyToIndex[u];this._focusIsUserInput=s;if(e!==o){var f=this.getItemKey(o);this._updateSelectable(f,{focusState:0,isFocused:!1})}if(a>=0){f=this.getItemKey(e);this._focusIndex=a;this.focusedItem(e||null);f&&this._updateSelectable(f,{focusState:s?2:1,isFocused:!0})}else this.focusedItem(null);if(!r){this._anchorIndex=a||-1;this._anchorKey=u}this._clearFocusIsUserInput()};t.prototype.setIndexFocus=function(e,t){void 0===t&&(t={});this.setItemFocus(this._items[e],t)};t.prototype.invokeFocusedItem=function(e){var t=this.focusedItem.peek(),n=this.getItemKey(t),r=this._allSelectables[n];if(r&&r.length)for(var i=0;i<r.length;i++){var s=r[i];if(s.onInvoke)return s.onInvoke(e)}return!0};t.prototype.setIsActive=function(e){this.isActive(e)};t.prototype.selectToItem=function(e){if(1===this.mode)this.setItemSelected(e,!0);else{var t=this._items,n=this.getItemKey(e);if(n){var r=this._keyToIndex[n],i=Math.min(t.length-1,Math.max(0,this._anchorIndex)),s=Math.max(r,i),o=[];if(t.length&&s>=0)for(var u=Math.min(r,i);u<=s;u++)o.push(t[u]);this._setItemsSelected(o,!0)}}};t.prototype.selectToIndex=function(e){this.selectToItem(this._items[e])};t.prototype.selectAll=function(){if(!(this.maximumSelectedCount&&this.maximumSelectedCount<this._selectableItems.length)&&0===this.mode){this.isSelectedDefaultState=!0;for(var e=[],t=0,n=this._selectableItems;t<n.length;t++){var r=n[t];this._canSelectItem(r)&&e.push(r)}this.selection(e);this._keysExempt={};this._exemptCount=0;this._updateIsAllSelected();this._updateAllSelectables();this._updateSelectedCount();this._selectionModelGroup&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)}};t.prototype.toggleSelectAll=function(){this.isAllSelected.peek()||this.maximumSelectedCount<this._selectableItems.length&&this.selectedCount.peek()||1===this.mode&&this.selectedCount.peek()>0?this.clear():this.selectAll()};t.prototype.registerSelectable=function(e,t){var n,r=this;if(!e)throw new Error("Need to specify key or targetItem to register the selectable.");n="string"==typeof e?e:this.getItemKey(e);this._allSelectables[n]||(this._allSelectables[n]=[]);this._allSelectables[n].push(t);var i=this._items[this._keyToIndex[n]],s=this.focusedItem.peek()===i,o=s?this._focusIsUserInput?2:1:0,u=this.isItemSelected(i);this._updateSelectable(n,{focusState:o,isFocused:s,isSelected:u});return{dispose:function(){if(r._allSelectables&&r._allSelectables[n]){var e=r._allSelectables[n];if(1===e.length)delete r._allSelectables[n];else{var i=e.indexOf(t);i>=0&&e.splice(i,1)}}}}};t.prototype.getFocusIndex=function(){return this._focusIndex};t.prototype.getMissingIndicies=function(){for(var e=[],t=this._items,n=0;t&&n<t.length;n++){var r=t[n];this.isItemSelected(r)&&!this.getItemKey(r)&&e.push(n)}return e};t.prototype.getSelectionModelGroup=function(){return this._selectionModelGroup};t.prototype.getItemByKey=function(e){var t=e?this._keyToIndex[e]:-1;return this.getItemByIndex(t)};t.prototype.getItemByIndex=function(e){return e>=0?this._items[e]:null};t.prototype._setItemSelectedCore=function(e,t,n){var r=this,i=this.getItemKey(e);if(i&&i in this._keyToIndex&&t!==this.isItemSelected(e)){if(t&&!this.observables.ignore(function(){return r.canSelectItem(e)}))return;1===this.mode&&t&&this.clear();this._keysExempt[i]?delete this._keysExempt[i]:this._keysExempt[i]=e;var s=this.selection.peek(),o=[];o=t?s.concat([e]):s.filter(function(e){return r.getItemKey(e)!==i});this.selection(o);this._updateSelectable(i,{isSelected:this.isItemSelected(e)});this._exemptCount+=t?1:-1;this._updateIsAllSelected();this._updateSelectedCount();this._selectionModelGroup&&t&&n&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)}};t.prototype._setItemsSelected=function(e,t){var n=this,r=this.selection.peek(),i=[],s=[],o=[];e.forEach(function(e){var r=n.getItemKey(e);if(r&&r in n._keyToIndex&&t!==n.isItemSelected(e)&&n.canSelectItem(e)){s.push(r);t&&o.push(e);n._keysExempt[r]?delete n._keysExempt[r]:n._keysExempt[r]=e}});i=t?r.concat(o):r.filter(function(e){return-1===s.indexOf(n.getItemKey(e))});this.selection(i);s.forEach(function(e){n._updateSelectable(e,{isSelected:t});n._exemptCount+=t?1:-1});this._updateIsAllSelected();this._updateSelectedCount();this._selectionModelGroup&&t&&this._selectionModelGroup.clearOtherSelectionModels(this._selectionModelId)};t.prototype._updateIsAllSelected=function(){if(!this._selectableItems||!this._selectableItems.length)return!1;var e=this.isSelectedDefaultState?this._selectableItems.length-this._exemptCount:this._exemptCount,t=0===this.mode?e===this._selectableItems.length:e>0;this.isAllSelected(t)};t.prototype._updateSelectable=function(e,t){var n=this._allSelectables[e];if(n)for(var r=0,i=n;r<i.length;r++){var s=i[r];for(var o in t){var u=t[o],a=s[o];this.isObservable(a)&&a(u)}}};t.prototype._updateAllSelectables=function(){var e=this;this.observables.ignore(function(){for(var t in e._allSelectables){var n=e._items[e._keyToIndex[t]];n&&e._canSelectItem(n)&&e._updateSelectable(t,{isSelected:e.isItemSelected(n)})}})};t.prototype._onItemsChanged=function(e){var t=this;this._keyToIndex={};this._keyForItem.clear();e&&(this._selectableItemsMap={});var n=this._items,r=[],i=this.getItemKey(this.focusedItem.peek()),s=this._anchorKey;if(n){for(var o=0,u=function(u){var f=n[u],l=a.observables.ignore(function(){return t.getItemKey(f)});if(l){a._keyToIndex[l]=u;e&&(a._selectableItemsMap[l]=!0);i&&i===l&&(a._focusIndex=u);s&&s===l&&(a._anchorIndex=u)}if(a.isItemSelected(f)){if(a.onAddItem&&!1===a.onAddItem(f)){o++;a._keysExempt[l]=f;return"continue"}r.push(f)}},a=this,f=0;f<n.length;f++)u(f);this._exemptCount+=o;this._focusIndex=n.length?Math.min(n.length-1,this._focusIndex):-1;this.setIndexFocus(this._focusIndex,{preventAnchor:!0,isFocusInput:!1});this.selection(r);this._updateIsAllSelected();this._updateSelectedCount()}};t.prototype._updateSelectedCount=function(){var e=this.isSelectedDefaultState?this._selectableItems.length-this._exemptCount:this._exemptCount;this.selectedCount(e)};t._nextSelectionModelId=1;return t})(i.default);t.e=o;function u(e){return!0}},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(119),i=(function(){function e(e,t){this._itemRefreshMessages={};this._itemKeysRefreshed=[]}e.prototype.getItemRefreshMessage=function(e){return this._itemRefreshMessages?this._itemRefreshMessages[e]:null};e.prototype.setRefreshMessages=function(e){this.clearRefreshMessages();for(var t=0,n=e;t<n.length;t++){var r=n[t];this._itemRefreshMessages[r.id]=r}};e.prototype.clearRefreshMessages=function(){this._itemRefreshMessages={}};e.prototype.hasItemRefreshedRecently=function(e){return-1!==this._itemKeysRefreshed.indexOf(e)};e.prototype.markRecentlyRefreshedItem=function(e){this._itemKeysRefreshed.push(e)};e.prototype.clearRecentlyRefreshedItems=function(){this._itemKeysRefreshed=[]};e.dependencies={};return e})(),s=Object(r.s)("RefreshMessageHelper",i)},function(e,t,n){"use strict";var r=n(0),i=n(2052),s=n(63),o=n(2060),u=n(91),a=n(2163),f=n(344),l=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="FileHandlerOpen";var r=n._fileHandlerAction=t.fileHandlerAction;n._fileHandlerProvider=n.resources.consume(a.e);n._itemSelectionHelper=new(n.child(o.e))({overrideItem:t.item,allowMultiSelect:!1,canFallback:!1});n._defaultHandlerAction=n.observables.pureCompute(n._computeDefaultHandlerAction);r&&r.handler&&r.handler.isPromoted&&(n.name="PromotedFileHandlerOpen");return n}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(!e||!e.graph)return!1;var t=e.extension,n=this._fileHandlerProvider,r=this._fileHandlerAction;return r?n.isActionForExtension(r,t):!!this._defaultHandlerAction()};t.prototype.onExecute=function(e){var t,n=this,r=this._fileHandlerAction;if(!r||!r.handler.isPromoted){if(!(t=window.open("","_blank")))return u.n.reject({resultType:s.e.ExpectedFailure,resultCode:"window.open"});t.opener=null}return this._itemSelectionHelper.resolveFirst().then(function(e){var i=r||n._defaultHandlerAction.peek();return i?n.resources.consumeAsync(f.t).then(function(n){return n.invokeAction({items:[e],action:i,target:t})}):u.n.reject("No action available for file handler")}).then(function(){return u.n.wrap({resultType:s.e.Success})},function(e){return u.n.wrap({resultType:u.n.isCanceled(e)?s.e.ExpectedFailure:s.e.Failure})})};t.prototype._computeDefaultHandlerAction=function(){if(!this._fileHandlerAction){var e=this._itemSelectionHelper.firstItem();if(e&&e.graph)return this._fileHandlerProvider.getDefaultOpenHandler(e.extension)}};return t})(i.e);t.e=l},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(7),i=n(119),s=new r.t({name:"ItemActionBar.key",loader:new i.t(function(){return n.ee([767,"deferred"],4130).then(function(e){return e.resourceKey.local})})})},function(e,t,n){"use strict";var r=(function(){function e(){}e.isMsPdfViewerSupported=function(){if(void 0===e._isWasmSupported){var t=!1;try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){var n=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));n instanceof WebAssembly.Module&&(t=new WebAssembly.Instance(n)instanceof WebAssembly.Instance)}}catch(e){}e._isWasmSupported=t}return e._isWasmSupported};return e})();t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});var r=n(456),i=n(9),s=n(461),o=new(n(131).e)("childItemKeys",function(e,t){var n=t.itemKey,s=e.demandItemFacet(r.e,n),o=e.demandItemFacet(i.e,n),u=o&&o.itemKeys;return r.e.evaluate(s)(e,{itemKey:n,itemKeys:u}).itemKeys});function u(e,t){return Object(s.t)(e.demandItemFacet(o,t.itemSetKey))}}],Array(83),[function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n("react-lib"),i=n(7),s=n(119),o=new i.t({name:"LegacyKnockoutEngagementHandlers.key",loader:new s.t(function(){return n.ee([806,"deferred","deferred.odsp-common"],5316).then(function(e){return e.resourceKey})})}),u=n(82),a=n(370),f=n(59),l=Object(f.r)(function(e){e.exposeFactory(u.c,new s.e(o));e.block(a.e)},{owner:"WithKnockoutEngagement"})(r.Fragment)}],Array(22),[function(e,t,n){"use strict";var r=0,i=(function(){function e(e){var t=this._viewModel=e.viewModel,n=t.__ResourceComponentLoader$componentId="".concat(++r);t.__ResourceComponentLoader$componentBindingElement=e.element;t.__ResourceComponentLoader$childComponents={};t.__ResourceComponentLoader$componentName=e.name;for(var i=e.bindingContext;i&&(!i.$data||i.$data===t||!i.$data.__ResourceComponentLoader$childComponents);)i=i.$parentContext;if(i){var s=this._parentViewModel=i.$data;s.__ResourceComponentLoader$childComponents[n]=t;t.__ResourceComponentLoader$parentComponentViewModel=s}}e.prototype.dispose=function(){var e=this._viewModel,t=this._parentViewModel,n=e.__ResourceComponentLoader$componentId,r=t&&t.__ResourceComponentLoader$childComponents;n&&r&&delete r[n];if(e){delete e.__ResourceComponentLoader$parentComponentViewModel;delete e.__ResourceComponentLoader$childComponents;delete e.__ResourceComponentLoader$componentBindingElement;delete e.__ResourceComponentLoader$componentName}};return e})();t.e=i},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n("react-lib"),s=n("react-dom-lib"),o=n(128),u=n(120),a=0,f=Object(o.e)(function(e){return"".concat(++a)});function l(){var e=i.useState(function(){return{}}),t=e[0],n=e[1],o=Object(u.e)(function(e,t){n(function(n){var i,o=f(t);return Object(r.__assign)(Object(r.__assign)({},n),((i={})[o]=s.createPortal(e,t),i))})}),a=Object(u.e)(function(e){n(function(t){var n=t,i=f(e);n[i];return Object(r.__rest)(n,["symbol"==typeof i?i:i+""])})}),l=i.useRef(),c=l.current||(l.current={render:o,unmount:a}),h=i.useMemo(function(){return i.createElement(i.Fragment,null,Object.keys(t).map(function(e){return i.createElement(i.Fragment,{key:e},t[e])}))},[t]);return i.useMemo(function(){return[c,h]},[c,h])}},function(e,t,n){"use strict";var r=n(1357),i=(function(){function e(e,t){this.value=e;this.extraClasses=t}e.prototype.getClass=function(){var e=this.value?Object(r.e)(this.value):void 0;0;return"ms-Icon ms-Icon--".concat(this.value," ").concat(e||"").concat(this.extraClasses?" "+this.extraClasses:"")};e.prototype.getExtraClasses=function(){return this.extraClasses};e.prototype.toString=function(){return this.value};return e})();t.e=i},,,function(e,t,n){"use strict";var r=n(0),i=n(2046),s=n("knockout-lib"),o=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.valueAccessor(),i=n._getComponentBindingContext(),o=i.$parentContext;if((function(e){return"function"==typeof e})(r)){r({bindingContext:o,templateNodes:n.bindingContext.$componentTemplateNodes})}else{s.applyBindingsToDescendants(n.bindingContext.extend({$componentParentContext:i}),n.element);n.controlsDescendantBindings=!0}return n}t.prototype._getComponentBindingContext=function(){for(var e=this.bindingContext.$component,t=this.bindingContext;t.$data!==e&&t.$parentContext;)t=t.$parentContext;return t};t.supportsVirtualElements=!0;return t})(i.t);t.e=o},function(e,t,n){"use strict";var r=n(0),i=n(2046),s=n(265),o=n("knockout-lib"),u=n(224),a="function"==typeof PointerEvent,f=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.valueAccessor();r._isIdle=i.isIdle||o.observable(!1);r._isEnabled=i.isEnabled||o.observable(!0);r._isInIdleZone=o.observable(!1);r._idleZoneElement=i.idleZoneElement||r.element;r._shouldClicksWake=i.shouldClicksWake;r._lastTouchPosition=null;r._lastMousePosition=null;r._lastPointerExitPosition=null;r._pointerCount=0;r._pointers={};r._isMouseDown=!1;r._isSuspended=!1;r._idle=r.createComputed(r._computeIdle).extend({rateLimit:{timeout:4e3,method:"notifyWhenChangesStop"}});r.createComputed(r._computeAwakenWhenNotEnabled);r.createComputed(r._computeSuspendIdleEvents);r.events.on(r._idleZoneElement,"click",r._onClick);r.events.on(document,"mousedown",r._onMouseDown,!0);r.events.on(document,"mousemove",r._onMouseMove,!0);r.events.on(document,"mouseup",r._onMouseUp,!0);r.events.on(document,"mouseout",r._onMouseOut,!0);r.events.on(document,"mousewheel",r._onMouseWheel,!0);r.events.on(window,"blur",r._onWindowBlur,!0);r.events.on(window,"focus",r._onWindowFocus,!0);if(a){r.events.on(document,"pointerdown",r._onPointerDown,!0);r.events.on(document,"pointermove",r._onPointerMove,!0);r.events.on(document,"pointerup",r._onPointerUp,!0);r.events.on(document,"pointercancel",r._onPointerCancel,!0);r.events.on(document,"lostpointercapture",r._onLostPointerCapture,!0)}else{r.events.on(document,"touchstart",r._onTouchStart,!0);r.events.on(document,"touchmove",r._onTouchMove,!0);r.events.on(document,"touchend",r._onTouchEnd,!0);r.events.on(document,"touchcancel",r._onTouchCancel,!0)}return r}t.prototype._computeIdle=function(){var e=this._isIdle(),t=this._isInIdleZone(),n=this._isEnabled();!e&&t&&n&&this._isIdle(!0)};t.prototype._computeAwakenWhenNotEnabled=function(){this._isEnabled()||this._isIdle(!1)};t.prototype._resetPosition=function(){this._lastMousePosition=null;this._lastTouchPosition=null};t.prototype._onClick=function(e){if(0===e.button){var t=this._lastMousePosition,n=new s.e(e.clientX,e.clientY);this._resetPosition();if(!(t&&n.distance(t)>=10)){this._isInIdleZone(!0);!this._isSuspended&&this._isEnabled.peek()&&(this._shouldClicksWake?this._isIdle(!1):this._isIdle(!this._isIdle.peek()))}}};t.prototype._onMouseDown=function(e){if(0===e.button){this._isMouseDown=!0;var t=new s.e(e.clientX,e.clientY);this._lastMousePosition=t}};t.prototype._onMouseMove=function(e){var t=this._lastTouchPosition,n=this._lastMousePosition,r=new s.e(e.clientX,e.clientY);if(!(t&&r.distance(t)<10)){var i=(function(e,t){for(;e;){if(e===t)return!0;e=Object(u.e)(e)}return!1})(e.target,this._idleZoneElement);this._isInIdleZone(i);if(!this._isMouseDown&&!this._pointerCount&&n&&r.distance(n)>=10){this._resetPosition();!this._isSuspended&&this._isEnabled.peek()&&this._isIdle(!1)}this._lastMousePosition||(this._lastMousePosition=r)}};t.prototype._onMouseUp=function(e){0===e.button&&(this._isMouseDown=!1)};t.prototype._onMouseOut=function(e){if(!this._isMouseDown){var t=this._lastPointerExitPosition,n=new s.e(e.clientX,e.clientY);this._resetPosition();this._lastPointerExitPosition=null;if(!(t&&n.distance(t)<10)&&(function(e){var t=e.relatedTarget||e.toElement;return!t||"HTML"===t.nodeName})(e)){var r=this._isInIdleZone.peek();this._isInIdleZone(!0);r&&this._idle()}}};t.prototype._onMouseWheel=function(e){this._isIdle(!1)};t.prototype._onWindowBlur=function(e){this._isIdle(!0)};t.prototype._onWindowFocus=function(e){this._isIdle(!1)};t.prototype._onTouchStart=function(e){this._pointerCount+=e.changedTouches.length;this._trackTouch(e);this._lastMousePosition=this._lastTouchPosition};t.prototype._onTouchMove=function(e){this._trackTouch(e)};t.prototype._onTouchEnd=function(e){this._pointerCount-=e.changedTouches.length;this._trackTouch(e)};t.prototype._onTouchCancel=function(e){this._pointerCount-=e.changedTouches.length};t.prototype._trackTouch=function(e){this._lastTouchPosition=new s.e(e.changedTouches[0].clientX,e.changedTouches[0].clientY)};t.prototype._onPointerDown=function(e){if("mouse"!==e.pointerType&&!this._pointers[e.pointerId]){this._pointerCount++;this._trackPointer(e);this._lastMousePosition=this._lastTouchPosition}};t.prototype._onPointerMove=function(e){"mouse"!==e.pointerType&&this._pointers[e.pointerId]&&this._trackPointer(e)};t.prototype._onPointerUp=function(e){if("mouse"!==e.pointerType){this._trackPointer(e);this._removePointer(e)}};t.prototype._onPointerCancel=function(e){if("mouse"!==e.pointerType){this._trackPointer(e);this._removePointer(e)}};t.prototype._onLostPointerCapture=function(e){"mouse"!==e.pointerType&&this._removePointer(e)};t.prototype._trackPointer=function(e){var t=new s.e(e.clientX,e.clientY);this._pointers[e.pointerId]=t;this._lastTouchPosition=t};t.prototype._removePointer=function(e){if(this._pointers[e.pointerId]){this._lastPointerExitPosition=this._pointers[e.pointerId];delete this._pointers[e.pointerId];this._pointerCount--}};t.prototype._computeSuspendIdleEvents=function(){this._isIdle();this._isSuspended=!0;this.async.clearTimeout(this._suspendIdleEventsTimeoutId);this._suspendIdleEventsTimeoutId=this.async.setTimeout(this._onSuspensionCompleted,500)};t.prototype._onSuspensionCompleted=function(){this._isSuspended=!1};return t})(i.t);t.e=f},function(e,t,n){"use strict";var r=(function(){function e(){}e.isFullScreen=function(){var e=window.document;return e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement};e.enterFullScreen=function(){var t=window.document.body;e.isFullScreen()||(t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen())};e.exitFullScreen=function(){var e=window.document;e.exitFullscreen?e.exitFullscreen():e.msExitFullscreen?e.msExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitExitFullscreen&&e.webkitExitFullscreen()};e.isFullScreenAllowed=function(){var e=window.document;return e.fullscreenEnabled||e.webkitFullscreenEnabled||e.mozFullScreenEnabled||e.msFullscreenEnabled};return e})();t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(7),i=n("knockout-lib"),s=new r.t({name:"DeeplinkCommentId.key",factory:{dependencies:{},create:function(){return{instance:i.observable({})}}}})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(7),i=new r.t({name:"".concat("MalwareDetection.key",".allowInfectedFileDownloads"),factory:new r.e(!1)})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(7),i=new r.t({name:"".concat("BlockDownloadPolicy.key",".m365GroupsBlockDownloadsExperienceEnabled"),factory:new r.e(!1)})},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r={defaultValue:-1/0,reducer:function(e,t){return e>0?t:t>0?e:Math.max(e,t)}}},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(7),i=n(2432),s=new r.t({name:"PaneProvider.key",factory:i.e})},function(e,t,n){"use strict";n.d(t,"n",function(){return f});n.d(t,"e",function(){return l});n.d(t,"t",function(){return c});var r=n(61),i=n(9),s=n(2479),o=n(461),u={suppressGetItems:!0};function a(e,t,n){return e.demandItemFacet(t,n,u)}function f(e,t,n){for(var u=new Set(n),f=[],l=0,c=t.length;l<c;l++){var h=t[l],p=a(e,i.r,h)||a(e,r.s,h),d=u.has(h);f[l]=p||!d?void 0:e.demandItemFacet(s.t,h)}return Object(o.t)(f)}function l(e,t){for(var n=[],u=0,f=t.length;u<f;u++){var l=t[u],c=a(e,i.r,l)||a(e,r.s,l);n[u]=c?void 0:e.demandItemFacet(s.t,l)}return Object(o.t)(n)}function c(e,t){var n=e.demandItemFacet(s.t,t.focusItemKey),u=t.itemKeys,f=t.fetchRadius,l=void 0===f?2:f;if(!n||!u.length)return o.e;for(var c=[],h=0,p=u.length;h<p;h++){var d=u[h];a(e,i.r,d)||a(e,r.s,d)?c[h]=void 0:c[h]=e.demandItemFacet(s.t,d)}var v=c.indexOf(n);if(v<0)return o.e;var m=Math.max(0,v-l),g=Math.min(v+l,c.length-1);for(h=m;h<=g;h++)c[h]||e.demandItemFacet(i.e,u[h]);return Object(o.t)(c)}}],Array(238),[function(e,t,n){"use strict";var r=n(170);Object(r.n)([{rawString:".OneUp-slide{position:absolute;left:0;right:0;top:0;bottom:0}.OneUp-slide:after,.OneUp-slide:before{display:block;position:absolute;width:2%;height:100%;content:''}html[dir=ltr] .OneUp-slide:before{right:100%}html[dir=rtl] .OneUp-slide:before{left:100%}html[dir=ltr] .OneUp-slide:after{left:100%}html[dir=rtl] .OneUp-slide:after{right:100%}.od-OneUpVideo{position:absolute;left:0;right:0;top:0;bottom:0}.OneUp-other{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}.OneUp-other .OneUp-other-content{text-align:center}.OneUp-other .OneUp-other-content .OneUp-other-fileName{font-size:21px}.OneUp-other .OneUp-other-content .OneUp-other-download{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-other .OneUp-other-content .OneUp-other-message{margin-top:15px;margin-bottom:15px}.OneUp-other .OneUp-other-content .OneUp-other-actions .od-ButtonBar-main{float:none}.OneUp-other .OneUp-other-content .OneUp-other-fileIcon .FileTypeIcon{outline:0}.OneUp-other .OneUp-other-content .od-ButtonBarCommand:not(.od-Button--primary){background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.OneUp-error{display:flex;justify-content:center;align-items:center;height:100%}.OneUp-slide-error{overflow-x:hidden;overflow-y:auto;position:absolute;left:0;right:0;top:0;bottom:0}.OneUp-photo .od-Projector--live .od-ImageTile-background{transition:max-width 267ms cubic-bezier(.1,.9,.2,1),max-height 267ms cubic-bezier(.1,.9,.2,1)}.OneUp-photo .od-Projector--live.od-Projector--panning .od-ImageTile-background{transition-duration:0s,0s}.OneUp-otherTile{width:240px;height:240px;margin:auto;position:relative}.OneUp-fileHandler,.OneUp-fileHandler-frame{border:0;width:100%;height:100%}.OneUp-other-malwareDetectedIcon{height:208px;width:208px}"}]);var i=n(2045),s=n(0),o=n(2044),u=n(783),a=n(88),f=n(63),l=n(1886),c=n(370),h=n(2049),p=n(33),d=n(7),v=n(119),m=new d.t({name:"OneUp3d.key",loader:new v.t(function(){return n.ee([764],5346).then(function(e){return e.resourceKey.local})})}),g=n(2321),y=n(2635),b=n(13),w=(function(e){Object(s.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({control:h.r});var i=t.slide.item.peek(),s=i&&i.error&&i.error.data,o=t.slide.renderOptions,u=t.showErrorActions,a=void 0===u||u;r.errorComponent={specification:Object(h.i)(y.resourceKey,{error:s,hideAction:Object(p.isFeatureEnabled)(p.EmbedAccessOnEmbedAspx)&&Object(p.isFeatureEnabled)(p.EmbedLinkSupportOnEmbedAspx)&&s.actionUrl?!a:!!o||!a}),afterRender:function(){return r._activate()}};return r}t.prototype._activate=function(){var e,t=this.slide,n=t.item.peek(),r=n&&n.error&&n.error.data;if(b.e.isActivated("e162d174-9d50-4dc0-b26a-0aba06a7560c","6/10/2021","Mark error as expected when error code is 404,403"))e=this.observables.create({resultType:f.e.Failure,resultCode:"".concat(r.errorCode),error:r&&r.errorDetailedText,extraData:{CorrelationId:r&&r.correlationId}});else{var i="".concat(r.errorCode),s=-1!==["403","404"].indexOf(i);e=this.observables.create({resultType:s?f.e.ExpectedFailure:f.e.Failure,resultCode:i,error:r&&r.errorDetailedText,extraData:{CorrelationId:r&&r.correlationId}})}this.scope.attach(t.loadResult.register(e));t.loadState(3)};return t})(g.e),E=Object(h.n)({automationName:"od-one-up-error",name:"OneUpError",template:'<div class="OneUp-error" data-bind="control:errorComponent"></div>',viewModelType:w}),S=new d.t({name:"OneUpFileHandler.key",loader:new v.t(function(){return n.ee([765],5381).then(function(e){return e.resourceKey.local})})});Object(r.n)([{rawString:".OneUp-html{position:absolute;top:0;left:0;right:0;bottom:0;margin:20px 20px;-webkit-overflow-scrolling:touch}.OneUp-html.iOS{overflow:auto}.OneUp-html iframe{width:100%;height:100%;background-color:#fff;border:0;box-shadow:0 0 7px 2px rgba(0,0,0,.15);overflow:auto;-webkit-overflow-scrolling:touch}"}]);var x=n(598),T=n(91),N=n(354),C=n(901),k=n(2932),L=n(2803),A=n(2517),O=n(82),M=n(182),_=(function(e){Object(s.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({control:h.r,iframe:L.e});var i=r,o=i.observables,u=i.slide,a=Object(s.__assign)(Object(s.__assign)({},u),{loadResult:o.createCallback(Object(x.t)())}),f=n.platformDetection.isIOS;r.className=f?"iOS":"";r.showError=o.create(!1);r.showHtml=o.pureCompute(r._computeShowHtml);r.fallbackControl=Object(h.i)(A.e,{slide:a,oneUp:r.oneUp});r.iframeOptions=o.create();r._downloadDataSource=n.downloadDataSource;r._graphDataSource=n.graphDataSource;var l=r._loadResult=o.create();r.scope.attach(u.loadResult.register(l));r._populateContent(f);return r}t.prototype._computeShowHtml=function(){return!this.slide.offset()&&!!this.iframeOptions()};t.prototype._populateContent=function(e){var t=this,n=this.slide.item.peek();this.showError(!1);this.trackPromise(this._getContents(n).then(function(n){if(n)t.iframeOptions({type:"content",sandbox:"",content:n,onLoad:function(n){t.slide.loadState(3);t._loadResult({resultType:f.e.Success});var r=n.target;if(e&&r){var i=r.clientWidth,s=r.clientHeight;r.style.width="".concat(i,"px");r.style.height="".concat(s,"px")}}});else{t._loadResult({resultType:f.e.ExpectedFailure,resultCode:"NoContent",error:"HTML is empty"});t._showError()}},function(e){t._loadResult({resultType:e&&e.isExpected?f.e.ExpectedFailure:f.e.Failure,resultCode:e&&(e.code||e.name),error:e&&e.message});t._showError()}))};t.prototype._showError=function(){this.showError(!0);this.slide.loadState(3)};t.prototype._getContents=function(e){var t=e.extension,n=e.htmlConversion,r=t&&t.toLowerCase();if(n&&!(".htm"===r||".html"===r||".svg"===r)){var i=this._graphDataSource,s=n.url||i.getAuthenticationParams(e).then(function(t){return"".concat(i.getItemUrl(e,{useDirectEndpoint:!0}),"/content?format=html&").concat(Object(N.e)(t))});return T.n.resolve(s).then(function(e){return C.e.startAndPostProcess({url:e},function(e,t){return e.responseText})}).catch(function(e){if(e instanceof XMLHttpRequest){var t=new Error("HTTP ".concat(e.status)),n=e.getResponseHeader("X-ErrorCode");t.code="".concat(n||e.status);t.isExpected=406===e.status;return T.n.reject(t)}return T.n.reject(e)})}return this._downloadDataSource.getItemContents(e).then(function(e){return k.t(e,"text/html")}).then(function(e){return e.text})};t.dependencies=Object(s.__assign)(Object(s.__assign)({},g.e.dependencies),{downloadDataSource:O.a,graphDataSource:O.w,platformDetection:M.e});return t})(g.e),D=Object(h.n)({automationName:"od-one-up-html",name:"OneUpHtml",template:'\x3c!--ko if:showError--\x3e\x3c!--ko control:fallbackControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:showHtml--\x3e<div class="OneUp-html" data-bind="iframe:iframeOptions,class:className" style="-webkit-overflow-scrolling: touch"></div>\x3c!--/ko--\x3e',viewModelType:_}),P=new d.t({name:"OneUpImage360.key",loader:new v.t(function(){return n.ee(94,5347).then(function(e){return e.resourceKey.local})})}),H=new d.t({name:"OneUpOnePlayer.key",loader:new v.t(function(){return n.ee([768,"deferred"],5277).then(function(e){return e.resourceKey.local})})}),B=new d.t({name:"OneUpPanorama.key",loader:new v.t(function(){return n.ee(95,5293).then(function(e){return e.resourceKey.local})})});Object(r.n)([{rawString:".od-Projector{position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden}.od-Projector-image{position:absolute;left:0;top:0;width:100%;height:100%;transform-origin:0 0;touch-action:none;will-change:transform;-webkit-backface-visibility:hidden;backface-visibility:hidden;perspective:1000}.od-Projector--gliding.od-Projector--preview .od-Projector-image{transition:transform 267ms cubic-bezier(.1,.9,.2,1)}.od-Projector--gliding.od-Projector--live .od-Projector-image{transition:left 267ms cubic-bezier(.1,.9,.2,1),top 267ms cubic-bezier(.1,.9,.2,1),width 267ms cubic-bezier(.1,.9,.2,1),height 267ms cubic-bezier(.1,.9,.2,1)}"}]);var j,F=n(2085),I=n(2746),q=n(2125),R=n(667),U=n(1118),z=n(1666),W=n(265),X=n(2654),V=new U.e(0,0,1,1),$=V.getCenter();(function(e){e[e.live=0]="live";e[e.preview=1]="preview"})(j||(j={}));var J=(function(e){Object(s.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.addBindingHandlers({host:F.e,pan:I.t,clientRect:q.e});var i=t.isZoomed,s=void 0===i?r.createObservable(!1):i,o=t.isEnabled,u=void 0===o?r.createObservable(!0):o,a=t.mode,f=void 0===a?j.live:a;r.panTransform=r.createObservable(R.e.IDENTITY);r.panTransform.equalityComparer=I.e;r.contentTransform=r.createObservable(R.e.IDENTITY);r.contentTransform.equalityComparer=I.e;r.imageTransform=r.createObservable(R.e.IDENTITY);r.imageTransform.equalityComparer=I.e;r.isPanning=r.createObservable(!1);r.isGliding=r.createObservable(!1);r.isZoomed=s;r.isEnabled=u;r.size=r.createObservable();r._lastZoomTogglePosition=null;r._mode=f;r.mode=j[r._mode];r.createBackgroundComputed(r._computeResetGlide);r.createBackgroundComputed(r._computePreviewTransform);r.createBackgroundComputed(r._computeCommitTransform);var l=r.createBackgroundComputed(r._computeStartGlide);r.createBackgroundComputed(r._computeEndGlide).extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}});var c=r.createBackgroundComputed(r._computeApplyTransformOnZoomed);r.createBackgroundComputed(r._computeResetZoomOnTransformed);r.imageStyle=r.createPureComputed(r._computeImageStyle,{deferEvaluation:!0});if(!n||!n.disableFrameSkip){X.e(l,r.async);X.e(c,r.async)}r.host={transform:r._mode===j.live?r.panTransform:r.contentTransform,isGliding:r.isGliding};return r}t.prototype.toggleIsZoomed=function(e,t){var n=this.size.peek(),r=n&&new W.e(t.clientX/n.width,t.clientY/n.height)||$;this._lastZoomTogglePosition=r;this.isZoomed(!this.isZoomed())};t.prototype.mayStartPan=function(e,t,n){return this.isEnabled.peek()&&(Math.abs(t)>=10&&n.length>=2||this.isZoomed.peek()&&e.translate.abs()>=10)};t.prototype.constrainPanScale=function(e){return Math.max(1,Math.min(4,e))};t.prototype._computeResetGlide=function(){if(this.isPanning()){this.isGliding(!1);this.isZoomed(!0)}};t.prototype._computePreviewTransform=function(){if(this.isPanning()){var e=this.panTransform();e=K(e,!0);this.imageTransform(this.contentTransform().invert().multiply(e))}};t.prototype._computeCommitTransform=function(){if(!this.isPanning()&&!this.isGliding.peek()){var e=this.panTransform.peek();e=e.scale<R.e.IDENTITY.scale?R.e.IDENTITY:K(e);this._applyTransform(e)}};t.prototype._computeStartGlide=function(){if(!this.isPanning()&&!R.e.areEqual(this.imageTransform(),R.e.IDENTITY)){this.isGliding(!0);this.imageTransform(R.e.IDENTITY)}};t.prototype._computeEndGlide=function(){var e=this.isPanning(),t=this.isGliding();!e&&t&&this.isGliding(!1)};t.prototype._computeApplyTransformOnZoomed=function(){var e=this.isZoomed(),t=this.isEnabled(),n=this.isPanning.peek(),r=this.contentTransform.peek();n||(e&&t?R.e.areEqual(r,R.e.IDENTITY)&&this._applyTransform(R.e.zoom(W.e.ORIGIN,this._lastZoomTogglePosition||$,3)):R.e.areEqual(r,R.e.IDENTITY)||this._applyTransform(R.e.IDENTITY));this._lastZoomTogglePosition=null};t.prototype._computeResetZoomOnTransformed=function(){var e=this.isPanning(),t=this.contentTransform();!e&&R.e.areEqual(t,R.e.IDENTITY)&&this.isZoomed(!1)};t.prototype._computeImageStyle=function(){var e=this.contentTransform(),t=this.imageTransform();if(this._mode===j.live){var n=e.multiply(t);return{left:"".concat(100*n.translate.x,"%"),top:"".concat(100*n.translate.y,"%"),width:"".concat(100*n.scale,"%"),height:"".concat(100*n.scale,"%")}}var r="translate(".concat(100*t.translate.x,"%, ").concat(100*t.translate.y,"%)");return{left:100*e.translate.x+"%",top:100*e.translate.y+"%",width:100*e.scale+"%",height:100*e.scale+"%","-ms-transform":r,"-webkit-transform":r,transform:r}};t.prototype._applyTransform=function(e){var t=this.contentTransform.peek().multiply(this.imageTransform.peek());this.contentTransform(e);this.imageTransform(e.invert().multiply(t));this.panTransform(e)};return t})(o.t);function K(e,t){void 0===t&&(t=!1);var n=Math.max(R.e.IDENTITY.scale,e.scale),r=new U.e(e.apply($).subtract(new W.e(n,n).scale(.5)),new z.e(n,n)),i=V,s=i.nudge(r),o=i.getCenter().subtract(s.getCenter());t&&(o=o.unit().scale(o.abs()-Math.atan(Math.PI*o.abs())/Math.PI*Math.log(e.scale/R.e.IDENTITY.scale)));return new R.e(o).multiply(e)}var Q=i.e({tagName:"od-projector",template:'<div class="od-Projector" data-bind="class:\'od-Projector--\'+mode,css:{\'od-Projector--gliding\':isGliding,\'od-Projector--panning\':isPanning},pan:{isActive:isPanning,transform:panTransform,mayStartPan:$component.mayStartPan.bind($component),constrainScale:$component.constrainPanScale.bind($component)},clientRect:{size:size},event:{dblclick:$component.toggleIsZoomed.bind($component)}"><div class="od-Projector-image" data-bind="style:imageStyle,host:{data:host}"></div></div>',viewModel:J,synchronous:!0}),G=n(2637),Y=n(1761),Z=(function(e){Object(s.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({control:h.r});r.slide.isEditCaptionEnabled(!0);var i=t.item,s=void 0===i?r.slide.item:i;r._item=s;r._isZoomed=r.createObservable(!1);var o={isEnabled:r.createPureComputed(function(){return!r.slide.offset()&&!r.oneUp.isRotating()}),isZoomed:r._isZoomed};r.projector={name:Q.tagName,params:o};r.createBackgroundComputed(r._computeChangesOnZoom);return r}t.prototype.getThumbnailControl=function(e){var t=this,n=e.transform,r=e.isGliding,i=this.createPureComputed(function(){return n().scale}),s=this.createPureComputed(function(){var e=t.oneUp.size();return{width:e.width*n().scale,height:e.height*n().scale}});s.equalityComparer=Y.e;var o=this.createPureComputed(function(){return!r()});return Object(h.i)(G.e,{slide:this.slide,oneUp:this.oneUp,size:s,scale:i,fallbackThumbnail:this.createPureComputed(this._computeFallbackThumbnail),allowLoading:o,item:this._item,expectLoadingFailure:!1})};t.prototype._computeFallbackThumbnail=function(){var e=this._item().photo;if(e){var t=e.originalUrl,n=e.width,r=e.height;if(t)return{url:t,width:n,height:r}}};t.prototype._computeChangesOnZoom=function(){var e=this._isZoomed();this.slide.isPanningEnabled(!e)};return t})(g.e),ee=Object(h.n)({automationName:"od-one-up-photo",name:"OneUpPhoto",template:'<div class="OneUp-photo" data-bind="component:projector">\x3c!--ko control:getThumbnailControl($host)--\x3e\x3c!--/ko--\x3e</div>',viewModelType:Z});n(1279).e.addConfig({map:{"*":{"../build/pdf.js":"pdfjs-dist/build/pdf"}}});var te=new d.t({name:"OneUpPdf.key",loader:new v.t(function(){return n.ee([770,"deferred"],5320).then(function(e){return e.resourceKey.local})})}),ne=new d.t({name:"OneUpMSPdf.key",loader:new v.t(function(){return n.ee([766,"deferred.office-ui-fabric-react"],5248).then(function(e){return e.resourceKey.local})})}),re=Object(p.isFeatureEnabled)(p.EnableOneUpTextFileV2)?new d.t({name:"OneUpTextFile.key",loader:new v.t(function(){return n.ee(96,5321).then(function(e){return e.resourceKey.local})})}):new d.t({name:"OneUpTextFile.key",loader:new v.t(function(){return n.ee(96,5348).then(function(e){return e.resourceKey.local})})}),ie=new d.t({name:"OneUpVideo.key",loader:new v.t(function(){return n.ee([773,"deferred"],5250).then(function(e){return e.resourceKey.local})})}),se=new d.t({name:"OneUpWAC.key",loader:new v.t(function(){return n.ee([774],5322).then(function(e){return e.resourceKey.local})})}),oe=new d.t({name:"OneUpWrs.key",loader:new v.t(function(){return n.ee([775,"deferred"],5294).then(function(e){return e.resourceKey.local})})}),ue=new d.t({name:"OneUpZip.key",loader:new v.t(function(){return n.ee(97,5323).then(function(e){return e.resourceKey.local})})}),ae=n(898),fe=n(2163),le=n(1263),ce=n(2745),he=n(3225),pe=n(2877),de=n(19),ve={"3d":m,Audio:ie,Error:E,FileHandler:S,Html:D,OnePlayerAudio:H,OnePlayerVideo:H,Other:A.e,Panorama:B,Image360:P,Pdf:te,MSPdf:ne,Photo:ee,TextFile:re,Thumbnail:G.e,Video:ie,WAC:se,Wrs:oe,Zip:ue},me=(function(e){Object(s.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({control:h.r});r._offset=t.slide.offset;var i=r._oneUp=t.oneUp,s=t.renderOptions,o=r.observables,u=r._loadResult=o.createCallback({defaultValue:void 0,reducer:be});t.loadResult&&r.scope.attach(t.loadResult.register(u));r.slide={loadState:t.slide.loadState,offset:r._getSlideOffset(),item:t.slide.item,isIdleEnabled:o.create(!0),isEditCaptionEnabled:o.create(!1),isPanningEnabled:o.create(!s),hasHorizontalScrollbar:o.create(!1),hasVerticalScrollbar:o.create(!1),isFirstSlideOpened:o.create(!1),commandSet:o.create(),augmentCommandSet:o.create(),loadResult:u,renderOptions:s};var a=r.resources;r._fileHandlerProvider=a.consume(fe.e.optional);var f=a.consume(M.e);r._enableHTML=Object(p.isFeatureEnabled)(p.UseSandboxHtmlViewer)&&(Object(ce.e)()||f.isEdge);r._enablePdf=Object(p.isFeatureEnabled)(p.UseWebPdfViewer);r._enableImage360=Object(p.isFeatureEnabled)(p.Image360Viewer)&&!f.isMobile;r._enablePriority=!de.e.isActivated("C721A5CD-435A-48E4-A155-1CAD6BD1F7FB","10/21/2021","Slide priority");r._enableOnePlayer=!!a.consume(pe.e.optional);r._enableMsPdfviewer=Object(p.isFeatureEnabled)(p.UseMsPdfViewer);r._enablePreviewTif=Object(p.isFeatureEnabled)(p.UsePdfViewerToPreviewTif);var l=r.priority=o.pureCompute(r._computePriority);r.scope.attach(i.currentPriority.register(l));r.name=o.pureCompute(r._computeName);r.isError=o.create(!1);r.name.equalityComparer=ae.n;r.key=o.pureCompute(r._computeKey);r.key.equalityComparer=ae.n;r.component=o.pureCompute(r._computeComponent);r._qos=o.compute(r._computeQos);r._engagementReported=!1;o.compute(r._computeUpdateOneUpSlide);o.backgroundCompute(r._computeCompleteQos);return r}t.prototype.dispose=function(){e.prototype.dispose.call(this);this._oneUp.slide.peek()===this.slide&&this._oneUp.slide(void 0)};t.prototype._computeComponent=function(){var e=this.key(),t={slide:this.slide,oneUp:this._oneUp};return e&&Object(h.i)(e.bypass,t)};t.prototype._computeName=function(){var e=this.slide.item(),t=this._extension(e),n=(this.slide.renderOptions||{}).viewer;if(e&&!e.isPlaceholder){if(e.error){Object(p.isFeatureEnabled)(p.EmbedAccessOnEmbedAspx)&&Object(p.isFeatureEnabled)(p.EmbedLinkSupportOnEmbedAspx)&&self!==top&&2===e.error.type&&this.isError(!0);return"Error"}return e.folder||3===e.itemStatus||e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected?"Other":n||(e.officeBundle?"Wrs":e.wopiFrameUrl?"WAC":this._hasFileHandler(e,t)?"FileHandler":this._enableHTML&&e.htmlConversion?"Html":this._enablePdf&&(this._enablePreviewTif||".tif"!==t&&".tiff"!==t)&&(".pdf"===t||".ai"===t||e.pdfConversion)?this._enableMsPdfviewer&&he.e.isMsPdfViewerSupported()?"MSPdf":"Pdf":e.video?this._enableOnePlayer?"OnePlayerVideo":"Video":e.audio?this._enableOnePlayer?"OnePlayerAudio":"Audio":e.panorama?"Panorama":this._enableImage360&&e.image360?"Image360":e.model3d?"3d":e.zip?"Zip":this._useTextEditor(e)?"TextFile":e.photo?"Photo":e.thumbnail?"Thumbnail":"Other")}};t.prototype._computeKey=function(){if(this._enablePriority){if(this.priority()<this._oneUp.currentPriority())return}var e=this.name();return e&&ve[e]};t.prototype._computePriority=function(){var e=this.slide,t=e.loadState()>=3,n=e.offset(),r=(n>0?n:n<0?-n:0)+1;return t?r:-r};t.prototype._useTextEditor=function(e){return Object(p.isFeatureEnabled)(p.UseOneUpTextEditor)&&Object(le.r)(e)};t.prototype._extension=function(e){return e&&e.extension&&e.extension.toLowerCase()||""};t.prototype._hasFileHandler=function(e,t){var n=this._fileHandlerProvider;return!!n&&(!!e.graph&&!!n.getDefaultPreviewHandler(t))};t.prototype._computeUpdateOneUpSlide=function(){this._offset()?this._oneUp.slide.peek()===this.slide&&this._oneUp.slide(void 0):this._oneUp.slide(this.slide)};t.prototype._getSlideOffset=function(){var e=this,t=this.createPureComputed(function(){var n=t.peek();return void 0!==n&&e._oneUp.isRotating()?n:e._offset()});return t};t.prototype._computeQos=function(){var e=this.slide,t=this._qosValue,n=this.name();if(n){if(t&&t.loaded.data.extraData.viewer===n)return t;if(!e.offset()&&!(e.loadState()>0||e.loadResult())){var r=e.item.peek(),i=r.size,o=e.renderOptions,f=o&&o.qosEvent,c=r.urls?r.urls[u.t.mediaBaseUrl]:"",h=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},f&&f.data.extraData||{}),c?{mediaServiceRegion:c}:{}),{viewer:n,extension:this._extension(r),fileSize:i,fileSizeRange:ge(i)});this._cpEvent=new l.e({scenario:"ItemViewer.".concat(n,".Load"),extraData:{extension:this._extension(r)}});return this._qosValue={loaded:new a.e({name:"LoadSlide",extraData:h}),loaded2:new a.e({name:"ItemViewer.".concat(n,".Load"),extraData:h}),rendered:new a.e({name:"ItemViewer.".concat(n,".Render"),extraData:h})}}}};t.prototype._computeCompleteQos=function(){var e,t=this.slide;if(!t.offset()){var n=this._qos();if(n){var r=n.loaded,i=n.loaded2,o=n.rendered,u=this.name.peek(),a=t.item.peek(),l={extension:this._extension(a),fileSizeRange:ge(a.size),viewer:u},h=this.key(),d=t.loadState();h&&d>=1&&o.end({resultType:f.e.Success,extraData:Object(s.__assign)(Object(s.__assign)({},o.data.extraData),l)});var v=this._loadResult();if(h&&v){var m=t.renderOptions,g=m&&m.qosEvent,y=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},r.data.extraData),l),v.extraData||{}),b=Object(s.__assign)(Object(s.__assign)({},v),{extraData:y});r.end(b);i.end(b);this._cpEvent&&this._cpEvent.end({resultType:v.resultType,errorCode:v.resultCode});if(g){g.end(b);if(Object(p.isFeatureEnabled)(p.EngagementTelemetryEnhancement)&&!this._engagementReported){null===(e=this.resources.consume(c.e))||void 0===e||e.logData(g.data);this._engagementReported=!0}}if(this._oneUp.shareLinkId){var w={};try{w.previewLoaded=Date.now();w.navigationStart=performance.timing.navigationStart;w.redirectStart=performance.timing.redirectStart;w.redirectEnd=performance.timing.redirectEnd}catch(e){}var E=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},v),y),w),{slrid:this._oneUp.shareLinkId});this.resources.consume(c.e).logData({name:"ShareLinkClicked.PreviewLoaded",extraData:E})}}}}};return t})(o.t);function ge(e){if(!e)return"NA";if(e<0)return"Unknown";var t=Math.log(e)/Math.LN2|0;return"".concat(1<<t%10,"-").concat(1<<t%10+1).concat(t<10?" B":" ".concat("KMGTPEZY"[t/10-1|0],"iB"))}function ye(e){e&&(e=(e=e.replace(/(tempauth|token|authkey)=[^&'"]+/g,"token=*")).replace(/[\w-]+:\/\/\S+/g,"*URI*"));return e}function be(e,t){return t&&Object(s.__assign)(Object(s.__assign)({},t),{error:ye(t.error)})}var we=i.e({tagName:"od-one-up-slide",template:"<div data-bind=\"control:component,css:{'OneUp-slide-error':isError(),'OneUp-slide':!isError()}\" role=\"presentation\"></div>",viewModel:me,synchronous:!0});t.e=we}],Array(60),[function(e,t,n){"use strict";var r=n(0),i=n(2084),s=n(2094),o=n(3212),u=n(91),a=n(1121),f=n(3810),l=n(3213),c=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.operations=t.operations;n.name="";n.iconName="";n.progress={minimum:n.createObservable(0),maximum:n.createObservable(0),current:n.createObservable(0)};n.batch=t.batch;n.error=n.createObservable();n.count=n.createObservable(0);n._initializeType();n.payloads=n.createPureComputed(n._computePayloads);n.actions=n.createObservable({});n.states=n.createObservable({created:0,started:0,completed:0,failed:0,canceled:0,expired:0});n._initializeOperations();n.state=n.createPureComputed(n._computeState);n.visibility=n.createPureComputed(n._computeVisibility);return n}t.prototype._initializeType=function(){var e=this.addDisposable(l.e.group(this.operations,function(e){return e.type()}));this.type=this.createPureComputed(function(){return 1===e().length&&e()[0].key||i.e.multiple})};t.prototype._computePayloads=function(){var e=this.operations()[0];return e&&e.payloads()||{}};t.prototype._initializeOperations=function(){var e=this;this.addDisposable(this.operations.map({mappingWithDisposeCallback:function(t){var n=e.createPureComputed(function(){return s.e[t.state()]}),r=e.addDisposable(f.t(t.progress.minimum,e.progress.minimum)),i=e.addDisposable(f.t(t.progress.maximum,e.progress.maximum)),o=e.addDisposable(f.t(t.progress.current,e.progress.current)),u=e.addDisposable(f.e(n,e.states)),a=e.addDisposable(f.n(t.error,e.error)),l=e.addDisposable(f.t(t.count,e.count)),c=e.createComputed(function(){var n=!1,r=e.actions.peek();for(var i in t.actions())if(!(i in r)){r[i]=e._initializeAction(i);n=!0}n&&e.actions.valueHasMutated()});return{mappedValue:t,dispose:function(){n.dispose();r.dispose();i.dispose();o.dispose();u.dispose();c.dispose();a.dispose();l.dispose()}}}}))};t.prototype._computeState=function(){var e=this.states();return e.started||e.created&&(e.failed||e.completed||e.canceled)?s.e.started:e.created?s.e.created:e.failed?s.e.failed:e.completed?s.e.completed:e.canceled?s.e.canceled:s.e.expired};t.prototype._computeVisibility=function(){return this.operations().reduce(function(e,t){var n=t.visibility.peek();return n<e?n:e},2)};t.prototype._initializeAction=function(e){var t=this.addDisposable(this.operations.filter(function(t){var n=t.actions()[e];return n&&n.isAvailable()}));return this.addDisposable(new o.e({count:this.createPureComputed(function(){return t().length}),key:e,operation:this,isAvailable:this.createPureComputed(function(){return!!t().length}),onExecute:function(){return u.n.all(t().slice().map(function(t){var n=t.actions.peek()[e];return n&&n.execute()||u.n.wrap()}))}}))};return t})(a.default);t.e=c},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return v});var r=n(0),i=n(2052),s=n(91),o=n(63),u=n(2246),a=n(2319),f=n(171),l=n(243),c=n(2060),h=n(205),p=n(33),d=new a.e,v=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="Open";var i=t.item,s=t.openRelation,o=void 0===s?0:s,u=t.ignoreHistory,a=void 0!==u&&u,l=t.itemSet,h=t.openLocal,p=void 0!==h&&h,d=t.urlType,v=void 0===d?"default":d,m=t.preserveAction,g=void 0!==m&&m,y=t.nonFoldersOnly,b=void 0!==y&&y,w=t.openOnly,E=void 0!==w&&w;r._openRelation=o;r._nonFoldersOnly=b;r._urlType=r.wrapObservable(v);r._openOnly=E;r._itemSelectionHelper=new(r.child(c.e))({overrideItem:2===o?i:void 0,allowMultiSelect:!1,canFallback:0!==o,ignoreSelection:0!==o});r.item=r.createComputed(r._computeItem,{deferEvaluation:!0,pure:!0});var S=r.resources.consume(f.e);r._navigateToItemAction=new(r.managed(S.NavigateToItemAction))({item:r.item,itemSet:l,parentItem:r._itemSelectionHelper.currentItem,urlType:r._urlType,forceInSameWindow:p,isRedirect:a,shouldPreserveAction:g});return r}t.prototype.onIsAvailable=function(){var e=this.item();return(!this._nonFoldersOnly||!!e&&!e.folder)&&this._navigateToItemAction.isAvailable()};t.prototype.onExecute=function(t,n){if(Object(p.isFeatureEnabled)(p.EngagementTelemetryEnhancement)&&this._openOnly)return e.prototype.onExecute.call(this,t,n);var r=this.item.peek();if(!r)return s.n.resolve({resultType:o.e.ExpectedFailure});r.type===l.e.Folder&&n&&n.data&&(n.data.folder=!0);n.data.extraData||(n.data.extraData={});h.e(n.data.extraData,{uniqueId:r.properties?r.properties.uniqueId:void 0});return this._navigateToItemAction.execute(t).then(function(){var e={fileType:l.e[r.type||l.e.Unknown],extension:r.extension||""};return s.n.resolve({resultType:o.e.Success,extraData:e})})};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(u.e,{item:this.item})};t.prototype.trackUserAction=function(t){var n=this.item.peek();if(n)switch(n.type){case l.e.File:e.prototype.trackUserAction.call(this,"Open.File");break;case l.e.Media:e.prototype.trackUserAction.call(this,"Open.Media");break;default:e.prototype.trackUserAction.call(this,t)}};t.prototype._computeItem=function(){var e,t=this._itemSelectionHelper.firstItem();switch(this._openRelation){case 3:e=t&&t.UNSAFE_parent;break;case 1:case 2:e=t;break;default:case 0:e=t}return e||d};return t})(i.e);t.t=v},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(7),i=n(33),s=new r.t({name:"EnableDarkThemeForOneUpMediaResourceKey",factory:new r.e(Object(i.isFeatureEnabled)(i.EnableDarkThemeForOneUpMediaViewer))})},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(7),i=n(33),s=new r.t({name:"EnableNewOneUpCommandBarResourceKey",factory:new r.e(Object(i.isFeatureEnabled)(i.EnableNewOneUpCommandBar))})},function(e,t,n){"use strict";n.d(t,"t",function(){return O});n.d(t,"e",function(){return M});var r=n(898),i=n(7),s=n(119),o=n(153),u=n(2518),a=n(495),f=n(2319),l=n(2592),c=n(2479),h=n(272),p=n(41),d=n(3347),v=n(3226),m=n(3657),g=n(2743),y=n(341),b=n(1121),w=n(273),E=n(501),S=n(27),x=n(82),T=n(135),N=n(1363),C=new i.t({name:"".concat("ItemCacheDataManager",".enableOneUpLensRouting"),factory:new i.e(!0)}),k=new f.e,L=[],A=(function(){function e(e,t){var n=this;this._computeParentItemInner=function(e){var t=Object(o.e)(e,{itemsScopeItemKey:n._itemsScopeItemKey});return e.demandItemFacet(c.t,t)||n._emptyItem};this._computeParentItem=function(){var e=n._parentItemObservable,t=e&&e();return t&&t()};this._computeExpandedKeys=function(e){var t=Object(p.e)(e,n._itemsScopeItemKey),r=Object(v.t)(e,{itemSetKey:t});return Object(m.e)(e,{itemKeys:r})};this._computeItems=function(e){if(M(e,{itemsScopeItemKey:n._itemsScopeItemKey,urlDataSource:n._urlDataSource,enableOneUpLensRouting:n._enableOneUpLensRouting}))return L;var t=n.expandedChildKeys(),r=Object(T.e)(e,{itemsScopeItemKey:n._itemsScopeItemKey});return Object(d.n)(e,t,r)};this._computeCurrentItemSet=function(){var e=n._emptyItem,t=n._parentItemObservable(),r=new l.e;r.item=t;r.isPlaceholder=t===e;return r};this._computeOnItemSetContentChange=function(){var e=n.currentItemSet(),t=new g.e;t.items=n._itemsObservable();e.content(t)};this._computeViewParams=function(e){return e.demandItemFacet(h.e,n._itemsScopeItemKey)};var i=t.itemsScopeItemKey,s=t.itemCacheObservablesFactory,u=t.urlDataSource,a=t.enableOneUpLensRouting,f=t.observablesFactoryType;this._itemsScopeItemKey=i;this._urlDataSource=u;this._enableOneUpLensRouting=a;this._scope=new y.e;var b=this._scope.attach(new f({owner:this}));this._parentItemObservable=this._scope.attach(s.pureCompute(this._computeParentItemInner));this._parentItemObservable.equalityComparer=r.n;var w=b.pureCompute(this._computeParentItem);w.equalityComparer=r.n;this.currentItem=w;this.expandedChildKeys=this._scope.attach(s.pureCompute(this._computeExpandedKeys));this.expandedChildKeys.equalityComparer=r.e;this._itemsObservable=this._scope.attach(s.pureCompute(this._computeItems));this._itemsObservable.equalityComparer=r.e;this._emptyItem=b.create(k);this.currentItemSet=b.pureCompute(this._computeCurrentItemSet);b.compute(this._computeOnItemSetContentChange);(this.viewParams=this._scope.attach(s.pureCompute(this._computeViewParams))).equalityComparer=r.n}e.prototype.dispose=function(){this._scope.dispose()};e.dependencies={itemsScopeItemKey:a.e,itemCacheObservablesFactory:u.e,observablesFactoryType:b.observablesFactoryTypeResourceKey,urlDataSource:x.ve,enableOneUpLensRouting:C};return e})(),O=Object(s.s)("ItemCacheDataManager",A);function M(e,t){var n,r=t.itemsScopeItemKey,i=t.urlDataSource;if(t.enableOneUpLensRouting){var s=Object(N.e)(e,{itemsScopeItemKey:r});n=null==s?void 0:s.focusItemKey}else{var o=e.demandItemFacet(h.e,r),u=i.getFocusItemKey(o),a=u&&i.getKeyParams(u);if(!a)return;var f=e.demandItemFacet(E.e,S.a);n=E.e.evaluate(f)(e,{viewParams:a,isNavigation:!1}).itemKey}return n?Object(w.e)(e,{itemKey:n}):void 0}},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(61),i=n(9),s=n(461),o=n(3226);function u(e,t){var n=t.maxLevels,u=[],a=function(t,s){for(var f=0,l=t;f<l.length;f++){var c=l[f];if(("number"!=typeof n||s<n)&&e.demandItemFacet(r.s,c,{suppressGetItems:!0})){var h=e.isItemFacetResolved(i.e,c),p=e.demandItemFacet(r.e,c,{suppressGetItems:!0}),d="number"==typeof p?p:1,v=e.demandItemFacet(o.e,c,{suppressGetItems:!h});if(v)a(v,s+1);else for(var m=0;m<d;m++)u.push(c)}else u.push(c)}};a(t.itemKeys,0);return Object(s.t)(u)}}],Array(103),[function(e,t,n){"use strict";var r=n(2045),i=n(0),s=n(2044),o=n(2452),u=n(2493),a=n(2046),f=n(1121),l=n(334),c=n(119),h=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=r._images=[];r.async.setInterval(function(){i.length>300&&i.splice(300,1/0)},6e4);return r}t.prototype.checkOutImage=function(){return this._images.shift()||document.createElement("img")};t.prototype.checkInImage=function(e){var t=this,n=new l.e,r=this.async;r.setTimeout(function(){e.setAttribute("src","data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=");e.removeAttribute("style");e.removeAttribute("class");r.setTimeout(function(){e.removeAttribute("src");t._images.push(e);n.complete()},1e3)},0);return n.getPromise()};return t})(f.default),p=Object(c.s)("ImageRecycler",h),d=n("knockout-lib"),v=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.resources.consume(p),s=n.valueAccessor(),o=r.checkOutImage(),a=n.bindingContext,f=s.attr,l=void 0===f?{}:f,c=s.style,h=s.css,v=s.class;d.applyBindingsToNode(o,{attr:Object(i.__assign)({alt:""},l)},a);c&&d.applyBindingsToNode(o,{style:c},a);h&&d.applyBindingsToNode(o,{css:h},a);v&&d.applyBindingsToNode(o,{class:v},a);new(n.managed(u.e))({element:o,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return s.imageLoader},bindingContext:a});d.virtualElements.setDomNodeChildren(n.element,[o]);n.addDisposable({dispose:function(){if(o){d.cleanNode(o);r.checkInImage(o).done()}}});n.controlsDescendantBindings=!0;return n}t.supportsVirtualElements=!0;return t})(a.t),m=n(18),g=n(667),y=n(1118),b=n(2381),w=n(3134),E=n(1761),S=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.addBindingHandlers({imageLoader:u.e,imageRecycler:v});var i=t.image,s=t.rotation,a=void 0===s?o.e.none:s,f=t.desiredSize,l=t.scale,c=void 0===l?1:l,h=t.isLoaded,p=void 0===h?r.createObservable(!1):h,d=t.position,m=t.loadedImage,g=t.error,y=t.loadImageScenarioName,S=n.thumbnailCache,x=void 0===S?r.resources.consume(w.e):S,T=n.outputExtenders,N=void 0===T?{deferred:!0}:T;r._image=r.wrapObservable(i);r._rotation=r.wrapObservable(a);r._scale=r.wrapObservable(c);r._desiredSize=r.wrapObservable(f);r._alignment=b.n(t.alignment);r._thumbnailCache=x;r._loadedImage=r.wrapObservable(m);r._error=r.wrapObservable(g);r.isRotating=r._getIsRotating();r.alignmentName=r.createPureComputed(r._computeAlignmentName);r.actualSize=r.createPureComputed(r._computeActualSize);r.actualSize.equalityComparer=E.e;r.isLoaded=r.createPureComputed(r._computeIsLoaded);r._imageUrl=r.createPureComputed(r._computeImageUrl);r._finalSize=r.createPureComputed(r._computeFinalSize);r._finalSize.equalityComparer=E.e;r._position=r.createPureComputed(r._computePosition);r._position.equalityComparer=E.e;r.imageElementStyle=r.createPureComputed(r._computeImageElementStyle);r.imageElementStyle.equalityComparer=E.e;r.imageBackgroundStyle=r.createPureComputed(r._computeImageBackgroundStyle);r.imageBackgroundStyle.equalityComparer=E.e;r.createBackgroundComputed(r._computeRecordImage);r.imageLoaderParams={src:r._imageUrl,image:r._loadedImage,error:r._error,scenarioName:y};d&&r.createBackgroundComputed(function(){return d(r._position())}).extend(N);p&&r.createBackgroundComputed(function(){return p(r.isLoaded())}).extend(N);return r}t.prototype._computeImageUrl=function(){var e=this._image();return e&&e.url&&m.format(e.url,e.width,e.height)||""};t.prototype._computeFinalSize=function(){var e,t=this._image(),n=this._scale();if(t&&!t.width){var r=this.actualSize(),i=window.devicePixelRatio||1;e=r&&{width:r.width*n/i,height:r.height*n/i}}else e=t&&{width:t.width*n,height:t.height*n};return e};t.prototype._computeImageElementStyle=function(){var e,t=this._desiredSize(),n=this._finalSize(),r=this._rotation();if(n){var i=void 0;i=t&&t.width&&t.height?t:n;var s=this._alignment.getTransform(n,i),o=s.translate.x/i.width,u=s.translate.y/i.height,a=s.scale*n.width/i.width,f=void 0;if(r){var l=void 0;if(r%2==1){var c={width:n.height,height:n.width};l=this._alignment.getTransform(c,i).multiply(s.invert())}else l=g.e.IDENTITY;f="rotate(".concat(90*r,"deg) scale(").concat(l.scale.toFixed(6),")")}else f="";e={left:"".concat((100*o).toFixed(2),"%"),top:"".concat((100*u).toFixed(2),"%"),width:"".concat((100*a).toFixed(2),"%"),"-webkit-transform":f,"-ms-transform":f,transform:f}}else e={left:"",top:"",width:"","-webkit-transform":"","-ms-transform":"",transform:""};return e};t.prototype._computeImageBackgroundStyle=function(){var e=this._finalSize(),t=this._imageUrl();return{"max-width":e?"".concat(e.width.toFixed(2),"px"):"","max-height":e?"".concat(e.height.toFixed(2),"px"):"","background-image":'url("'.concat(t,'")')}};t.prototype._getIsRotating=function(){var e,t=this,n=this.createObservable(this._rotation.peek()),r=this.createPureComputed(function(){var r=t._rotation();e&&t.async.clearTimeout(e);e=t.async.setTimeout(function(){return n(r)},300);return n()});return this.createPureComputed(function(){return t._rotation()!==r()})};t.prototype._computeRecordImage=function(){var e=this._image();e&&this.isLoaded()&&this._thumbnailCache.record(e)};t.prototype._computeIsLoaded=function(){return!!this._loadedImage()};t.prototype._computeActualSize=function(){var e,t=this._loadedImage();if(t){e={width:t.width,height:t.height}}return e};t.prototype._computePosition=function(){var e,t=this._desiredSize(),n=this._finalSize(),r=this._rotation();if(n){var i=void 0;i=t&&t.width&&t.height?t:n;var s=void 0;s=r%2==1?{width:n.height,height:n.width}:n;var o=this._alignment.getTransform(s,i),u=o.translate.x,a=o.translate.y,f=o.scale*s.width,l=o.scale*s.height;e=new y.e(u,a,f,l)}return e};t.prototype._computeAlignmentName=function(){var e;if(!this._rotation())switch(this._alignment.name){case"cover-center":e="cover";break;case"fit-center":e="fit"}return e};return t})(s.t),x=Object(r.e)({tagName:"od-image-tile",template:"<span class=\"od-ImageTile\" data-bind=\"css:{'od-ImageTile--isLoaded':isLoaded,'od-ImageTile--isDimensioned':!!actualSize(),'od-ImageTile--isRotating':isRotating,'od-ImageTile--isAligned':!!alignmentName(),'od-ImageTile--isCustom':!alignmentName()},class:alignmentName()?'od-ImageTile--'+alignmentName():''\"><span class=\"od-ImageTile-background\" data-bind=\"style:imageBackgroundStyle\"></span>\x3c!--ko imageRecycler:{imageLoader:imageLoaderParams,class:'od-ImageTile-image',style:imageElementStyle}--\x3e\x3c!--/ko--\x3e</span>",viewModel:S,synchronous:!0});t.e=x}],Array(48),[function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});n.d(t,"n",function(){return o});var r=n("knockout-lib");function i(e,t){var n,r=function(e){t(t.peek()+e)},i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),s=e.subscribe(function(){r(e.peek()-n)});r(e.peek());return{dispose:function(){i.dispose();s.dispose();r(-e.peek())}}}function s(e,t){var n,r=function(e,n){var r=t.peek();void 0!==e&&r[e]--;void 0!==n&&(r[n]=(r[n]||0)+1);t.valueHasMutated()},i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),s=e.subscribe(function(){r(n,e.peek())});r(void 0,e.peek());return{dispose:function(){i.dispose();s.dispose();r(e.peek(),void 0)}}}function o(e,t){var n=e.peek(),i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),s=r.computed(function(){!t()&&e()&&t(e())}),o=e.subscribe(function(e){!e&&n&&t.peek()===n&&t(void 0)});return{dispose:function(){s.dispose();o.dispose();i.dispose()}}}}],Array(794),[function(e,t,n){"use strict";var r;(function(e){e[e.share=1]="share";e[e.copy=2]="copy";e[e.atMention=3]="atMention";e[e.linkSettings=4]="linkSettings";e[e.manageAccess=5]="manageAccess";e[e.notify=6]="notify";e[e.addPeople=7]="addPeople"})(r||(r={}));t.e=r}],Array(753),[function(e,t,n){"use strict";n.r(t);n.d(t,"typeResourceKey",function(){return Y});var r=n("react-lib"),i=n(2538),s=n(2049),o=n(1874),u=n(2492),a=n(7),f=n(0),l=n(1121),c=n(898),h=n(119),p=n(273),d=n(153),v=n(41),m=n(773),g=n(2518),y=n(495),b=n(82),w=n(2319),E=n(2592),S=n(2743),x=n(2479),T=n(500),N=n(3226),C=n(3657),k=n(3347),L=n(501),A=n(27),O=n(3656),M=n(272),_=n(1363),D=new a.t({name:"".concat("OneUpItemCacheDataManager",".enableOneUpLensRouting"),factory:new a.e(!0)}),P=m.e,H=new w.e,B=(function(e){Object(f.__extends)(t,e);function t(t,n){var r,i=e.call(this,t,n)||this,s=n.itemsScopeItemKey,o=n.urlDataSource,u=n.itemCacheObservablesFactory,a=n.itemCacheDataManager,f=n.enableOneUpLensRouting,l=i.observables;P||(r=function(e){var t;if(f){var n=Object(_.e)(e,{itemsScopeItemKey:s});t=null==n?void 0:n.focusItemKey}else{var r=e.demandItemFacet(M.e,s),i=o.getFocusItemKey(r),u=i&&o.getKeyParams(i);if(!u)return;var a=e.demandItemFacet(L.e,A.a);t=L.e.evaluate(a)(e,{viewParams:u,isNavigation:!1}).itemKey}return t?Object(p.e)(e,{itemKey:t}):void 0});var h,m,g=u.pureCompute(function(e){var t=r?r(e):Object(O.e)(e,{itemsScopeItemKey:s,urlDataSource:o,enableOneUpLensRouting:f});return e.demandItemFacet(x.t,t)});g.equalityComparer=c.n;if(r){(m=u.pureCompute(function(e){var t=Object(d.e)(e,{itemsScopeItemKey:s});return e.demandItemFacet(x.t,t)})).equalityComparer=c.n;(h=u.pureCompute(function(e){if(!(r&&r(e)))return[];var t=Object(v.e)(e,s),n=Object(N.t)(e,{itemSetKey:t});return Object(C.e)(e,{itemKeys:n})})).equalityComparer=c.e}var y,b=[],w=u.pureCompute(function(e){var t=r?r(e):Object(O.e)(e,{itemsScopeItemKey:s,urlDataSource:o,enableOneUpLensRouting:f});if(!t)return b;var n=h?h():a.expandedChildKeys();return Object(k.t)(e,{itemKeys:n,focusItemKey:t})});w.equalityComparer=c.e;m&&((y=l.pureCompute(function(){var e=m&&m();return e&&e()})).equalityComparer=c.n);var D=new E.e;D.item=y||a.currentItem;l.compute(function(){var e=new S.e;e.items=w();D.content(e)});var B,j,F=l.create(D);if(m){var I=l.create(H);j=l.pureCompute(function(){var e=m&&m()||I,t=new E.e;t.item=e;t.isPlaceholder=!1;return t});(B=u.pureCompute(function(e){return e.demandItemFacet(M.e,s)})).equalityComparer=c.n}var q=u.pureCompute(function(e){var t=r?r(e):Object(O.e)(e,{itemsScopeItemKey:s,urlDataSource:o,enableOneUpLensRouting:f});return!!t&&Object(T.e)(e,t)});i.currentItem=y||a.currentItem;i.focusItem=g;i.focusItemSet=F;i.viewParams=B||a.viewParams;i.currentItemSet=j||a.currentItemSet;i.isOneUp=q;return i}t.dependencies=Object(f.__assign)(Object(f.__assign)({},l.default.dependencies),{itemsScopeItemKey:y.e,itemCacheObservablesFactory:g.e,urlDataSource:b.ve,itemCacheDataManager:O.t,enableOneUpLensRouting:D});return t})(l.default),j=Object(h.s)("OneUpItemCacheDataManager",B),F=n(171),I=n(59),q=n(2060),R=n("knockout-lib"),U=n(2110),z=n(1273),W=(function(e){Object(f.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._keyboardManager=t.keyboardManager;n.isActive=n.observables.create(n._keyboardManager.getIsActive());n.isDescendantActive=n.observables.create(n._keyboardManager.hasActiveChildren());n.isDescendantOrSelfActive=n.observables.pureCompute(function(){return n.isActive()||n.isDescendantActive()});n.events.on(n._keyboardManager,"change",function(){n.isActive(n._keyboardManager.getIsActive());n.isDescendantActive(n._keyboardManager.hasActiveChildren())});return n}t.prototype.register=function(e){var t=this,n=e.isDescendantOrSelfActive.subscribe(function(e){t._keyboardManager.registerActiveChild(e)});return{dispose:function(){n.dispose();t.events.dispose();t._keyboardManager.registerActiveChild(!1)}}};return t})(l.default);var X=n(204),V=n(3310),$=n(13),J=Object(s.i)(o.resourceKey,{}),K=Object(s.i)(u.t,{});function Q(e){var t=Object(I.n)(),n=(function(){var e=r.useContext(z.e).keyboardManager,t=new W({keyboardManager:e});r.useEffect(function(){return function(){return t.dispose()}},[]);return function(e){R.utils.domData.set(e,U.e,t)}})();return r.createElement(i.e,{specification:K,resources:t,onApplyBindings:n},r.createElement(i.e,{specification:J,resources:t}))}var G=$.e.isActivated("BF4B66EB-EC50-45F8-9EC3-FBE0A4B1EDBD","03/28/2022","Uses the Knockout engagement shim for OneUp in order to enable richer telemetry")?Q:Object(X.n)(V.e)(Q),Y=new a.t({name:"OneUp",factory:{dependencies:{oneUpItemCacheDataManager:j},create:function(e){var t=e.oneUpItemCacheDataManager;return{instance:Object(I.r)(function(e){var n=t.currentItem,r=t.focusItem,i=t.focusItemSet;e.expose(F.o,n);e.expose(F.m,r);e.expose(F.g,i);e.block(q.e)})(G)}}}})}])]);